{"version":3,"sources":["webpack:///src/app/utils/geolocation.ts","webpack:///src/app/shared/image/image.component.html","webpack:///src/app/shared/image/image.component.ts","webpack:///src/app/utils/crypto.ts","webpack:///src/app/features/home/home.page.html","webpack:///src/app/features/home/home.page.ts","webpack:///node_modules/@ngrx/component/__ivy_ngcc__/fesm2015/ngrx-component.js","webpack:///node_modules/image-blob-reduce/dist/image-blob-reduce.esm.mjs","webpack:///src/app/shared/moment/moment-repository.service.ts","webpack:///src/app/shared/copy-clipboard/copy-clipboard.component.ts","webpack:///src/app/shared/copy-clipboard/copy-clipboard.component.html","webpack:///node_modules/mime/lite.js","webpack:///node_modules/mime/types/standard.js","webpack:///src/app/shared/shared.module.ts","webpack:///src/app/utils/encoding.ts","webpack:///src/app/features/home/home-routing.module.ts","webpack:///src/app/utils/thumbnail.ts","webpack:///src/app/features/home/home.module.ts","webpack:///src/app/shared/extension/extension.pipe.ts","webpack:///src/app/features/home/moment-thumbnail/moment-thumbnail.component.ts","webpack:///src/app/features/home/moment-thumbnail/moment-thumbnail.component.html","webpack:///node_modules/mime/Mime.js","webpack:///src/app/utils/errors.ts","webpack:///src/app/shared/moment/moment.ts"],"names":["getCurrentPosition","Promise","resolve","reject","navigator","geolocation","success","error","enableHighAccuracy","timeout","maximumAge","getCurrentPositionOrUndefined","undefined","ImageComponent","_src$","src$","pipe","TINIEST_GIF","isImageError","value","next","event","imgElement","target","fadeInAnimation","addElement","duration","iterations","fromTo","play","sha256WithBlob","blob","crypto","subtle","arrayBuffer","digest","digested","HomePage","momentRepository","moments$","all$","_ionContent$","ionContent$","_scrollEvent$","scrollEvent$","noFooterBorder$","ionContent","detectBottom","getScrollElement","scrollElement","scrollTop","scrollHeight","clientHeight","_","item","id","CdAware","createCdAware","cfg","potentialObservablesSubject","observablesFromTemplate$","rendering$","observable$","updateViewContextObserver","render","ob$","resetContextObserver","e","nextPotentialObservable","subscribe","hasZone","z","RenderConfig","createRender","config","ngZone","cdRef","markForCheck","detectChanges","PushPipe","renderedValue","cdAware","subscription","potentialObservable","unsubscribe","ɵfac","PushPipe_Factory","t","ɵpipe","name","type","pure","LetViewContext","LetDirective","templateRef","viewContainerRef","ViewContext","$implicit","ngrxLet","$error","$complete","embeddedView","createEmbeddedView","complete","clear","dir","ctx","LetDirective_Factory","ɵdir","selectors","inputs","DECLARATIONS","EXPORTS","ReactiveComponentModule","ReactiveComponentModule_Factory","ɵmod","ɵinj","ngJitMode","declarations","exports","assign","to","from","s","arguments","length","Object","key","prototype","hasOwnProperty","call","pick","props","forEach","pick_pica_resize_options","pick_1","pick_pica_resize_options_1","utils","createCommonjsModule","fn","module","commonjsRequire","Error","pica","f","r","n","o","i","c","u","a","code","p","_dereq_","inherits","Multimath","mm_unsharp_mask","mm_resize","MathLib","requested_features","__requested_features","features","js","indexOf","wasm","has_wasm","use","resizeAndUnsharp","options","cache","result","resize","unsharpAmount","unsharp_mask","toWidth","toHeight","unsharpRadius","unsharpThreshold","clampTo8","convolveHorizontally","src","dest","srcW","srcH","destW","filters","g","b","filterPtr","filterShift","filterSize","srcPtr","srcY","destX","filterVal","srcOffset","destOffset","convolveVertically","wasm_fn","wasm_src","createFilters","resetAlpha","dst","width","height","ptr","len","destH","scaleX","scaleY","offsetX","offsetY","Uint8Array","quality","alpha","filtersX","filtersY","tmp","FILTER_INFO","FIXED_FRAC_BITS","toFixedPoint","num","Math","round","resizeFilterGen","srcSize","destSize","scale","offset","filterFunction","filter","scaleInverted","scaleClamped","min","srcWindow","win","destPixel","srcPixel","srcFirst","srcLast","filterElementSize","floatFilter","fxpFilter","total","pxl","idx","floatVal","filterTotal","leftNotEmpty","rightNotEmpty","maxFilterElementSize","floor","packedFilter","Int16Array","packedFilterPtr","slowCopy","subarray","set","max","ceil","Float32Array","x","xpi","PI","sin","cos","asUint8Array","buffer","byteLength","IS_LE","Uint32Array","__","copyInt16asLE","target_offset","data","resize_wasm","src_offset","tmp_offset","__align","filtersX_offset","filtersY_offset","alloc_bytes","instance","__instance","mem","__memory","mem32","src32","convolveHV","_convolveHV","dest32","GC_INTERVAL","Pool","create","idle","available","acquired","lastId","timeoutId","acquire","_this","resource","pop","release","_this2","lastUsed","Date","now","push","setTimeout","gc","_this3","destroy","MIN_INNER_TILE_SIZE","createStages","fromWidth","fromHeight","srcTileSize","destTileBorder","minScale","stageCount","log","pow","PIXEL_EPSILON","pixelFloor","nearest","abs","pixelCeil","createRegions","innerTileWidth","innerTileHeight","y","innerX","innerY","toTileWidth","toTileHeight","tiles","tile","toX","toY","toInnerX","toInnerY","toInnerWidth","toInnerHeight","objClass","obj","toString","isCanvas","element","cname","isImage","isImageBitmap","limiter","concurrency","active","queue","roll","shift","limit","then","err","cib_quality_name","cib_support","createCanvas","createImageBitmap","resizeWidth","resizeHeight","resizeQuality","bitmap","status","close","mathLib","onmessage","ev","opts","postMessage","a0","a1","a2","a3","b1","b2","left_corner","right_corner","gaussCoef","sigma","exp","g1","g2","k","convolveMono16","out","line","coeff","prev_src","curr_src","curr_out","prev_out","prev_prev_out","src_index","out_index","line_index","j","coeff_a0","coeff_a1","coeff_b1","coeff_b2","blurMono16","radius","Uint16Array","tmp_line","ctor","superCtor","super_","constructor","enumerable","writable","configurable","TempCtor","base64decode","hasWebAssembly","DEFAULT_OPTIONS","MultiMath","__cache","__init_promise","__modules","modules","__wasm","__isLE","init","self","all","keys","map","WebAssembly","compile","__base64decode","m","__reallocate","mem_grow_to","bytes","Memory","initial","mem_size","grow","memsize","env_extra","Module","env_base","memoryBase","memory","tableBase","table","Table","Instance","env","align","number","base","reminder","BASE64_MAP","str","input","replace","bits","charAt","tailbits","hsl_l16_js","img","size","glur_mono16","hsl_l16","unsharp","amount","threshold","h","l","m1","m2","hShifted","diff","iTimes4","lightness","blured","amountFp","thresholdFp","pixels","img_bytes_cnt","hsl_bytes_cnt","blur_bytes_cnt","blur_line_byte_cnt","blur_coeffs_byte_cnt","img_offset","hsl_offset","blur_offset","blur_tmp_offset","blur_line_offset","blur_coeffs_offset","img32","_hsl_l16","_blurMono16","_unsharp","wa","bin","test","getOwnPropertySymbols","propIsEnumerable","propertyIsEnumerable","toObject","val","TypeError","shouldUseNative","test1","String","getOwnPropertyNames","test2","fromCharCode","order2","join","test3","split","letter","source","symbols","bundleFn","sources","stringify","JSON","wkey","cacheKeys","random","wcache","skey","scache","workerSources","resolveSources","depPath","depKey","URL","window","webkitURL","mozURL","msURL","Blob","bare","workerUrl","createObjectURL","worker","Worker","objectURL","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","minLen","_arrayLikeToArray","slice","Array","arr2","Symbol","iterator","_arr","_n","_d","_e","_i","_s","done","isArray","webworkify","singletones","NEED_SAFARI_FIX","userAgent","hardwareConcurrency","DEFAULT_PICA_OPTS","tmpCanvas","document","createElement","DEFAULT_RESIZE_OPTS","CAN_NEW_IMAGE_DATA","CAN_CREATE_IMAGE_BITMAP","workerFabric","terminate","url","revokeObjectURL","Pica","limiter_key","concat","__limit","cib","ww","__workersPool","__mathlib","__initPromise","ImageData","Uint8ClampedArray","ImageBitmap","debug","wkr","wpool_key","initMath","mathlib","checkCibResize","isNaN","naturalWidth","naturalHeight","canceled","cancelToken","DEST_TILE_BORDER","toCtx","getContext","Boolean","imageBitmap","drawImage","tmpCtx","iData","getImageData","putImageData","invokeResize","w","preload","wasm_nodule","tileAndResize","srcCtx","srcImageBitmap","isImageBitmapReused","processTile","srcImageData","globalCompositeOperation","toImageData","createImageData","regions","jobs","cleanup","processStages","stages","_stages$shift","_stages$shift2","isLastStage","res","resizeBuffer","toBlob","canvas","mimeType","convertToBlob","asString","atob","toDataURL","asBuffer","charCodeAt","image_traverse","message","to_hex","toUpperCase","utf8_encode","unescape","encodeURIComponent","utf8_decode","decodeURIComponent","escape","is_uint8array","ExifParser","jpeg_bin","exif_start","exif_end","start","sig","apply","big_endian","each","on_entry","aborted","read_uint32","ifds_to_read","scan_ifd","ifds","ifd0","entries","entry","is_subifd_link","count","format","ifd","ifd1","ifd_no","data_length","output","write_uint16","write_uint32","written_offset","ifd_start","ifd_end","sort","tag","entry_offset","link_offset","data_offset","next_ifd","read_uint16","d","exif_format_length","exif_format_read","v","entry_count","comp_length","comp_offset","Number","isInteger","is_big_endian","is_jpeg","jpeg_segments_each","on_segment","inside_scan","segment_code","segment_length","byte1","byte2","pos","jpeg_segments_filter","ranges","out_length","segment","new_segment","new_range","end","range","jpeg_exif_tags_each","on_exif_entry","jpeg_exif_tags_filter","stop_search","new_exif","header","jpeg_add_comment","comment","comment_inserted","segment_count","csegment","jpeg_patch_exif","_getUint8Array","orig_blob","exif_is_big_endian","orientation_offset","orientation","orientation_patch","jpeg_rotate_canvas","out_canvas","save","transform","restore","jpeg_attach_orig_segments","out_blob","data_out","segments","hdr","assign$1","reducer","before","after","jpeg_patch_exif_1","jpeg_rotate_canvas_1","jpeg_attach_orig_segments_1","assign_1","jpeg_plugins","ImageBlobReduce","initialized","plugin","args","Infinity","_blob_to_image","_calculate_size","_transform","_cleanup","_create_blob","_env","toCanvas","method_name","old_fn","image","image_url","onerror","onload","scale_factor","transform_width","transform_height","pica_opts","buf","fr","FileReader","readAsArrayBuffer","abort","onabort","imageBlobReduce","MomentRepository","database","collection$","main$","addCollections","COLLECTION_NAME","schema","bufferSize","refCount","find","timestamp","$","documents","photo","collection","geolocationPosition","atomicUpsert","latitude","coords","longitude","putAttachment","PHOTO_ATTACHMENT_ID","attachment","doc","bulkRemove","CopyClipboardComponent","toastController","translocoService","text","payload","listener","clipboard","clipboardData","setData","preventDefault","addEventListener","execCommand","removeEventListener","presentToast","translate","toast","present","copy","Mime","SharedModule","arrayBufferToHex","padStart","routes","path","component","loadChildren","PhotoPageModule","SettingsPageModule","CameraPageModule","HomePageRoutingModule","forChild","makeThumbnail","maxSize","HomePageModule","ExtensionPipe","getExtension","MomentThumbnailComponent","_moment$","moment$","_types","_extensions","define","bind","getType","typeMap","force","extensions","toLowerCase","ext","substr","last","hasPath","hasDot","RegExp","$1","DataNotFoundError","version","properties","primary","required","indexes","attachments","encrypted","Moment","getAttachment","photo$","getData","photoUrl$","thumbnailUrl$","THUMBNAIL_ATTACHMENT_ID","thumbnail"],"mappings":"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","file":"2-es5.91e1a809722dfe738359.js","sourcesContent":["async function getCurrentPosition() {\n  return new Promise<GeolocationPosition>((resolve, reject) => {\n    navigator.geolocation.getCurrentPosition(\n      success => resolve(success),\n      error => reject(error),\n      { enableHighAccuracy: true, timeout: 10000, maximumAge: 60000 }\n    );\n  });\n}\n\nexport async function getCurrentPositionOrUndefined() {\n  try {\n    return await getCurrentPosition();\n  } catch {\n    return undefined;\n  }\n}\n","<ion-icon\n  *ngIf=\"isImageError\"\n  src=\"/assets/icons/broken-image.svg\"\n  color=\"danger\"\n  size=\"large\"\n></ion-icon>\n<ion-img\n  *ngIf=\"!isImageError\"\n  (ionImgDidLoad)=\"onImageLoaded($event)\"\n  (ionError)=\"onImageError()\"\n  [attr.src]=\"src$ | ngrxPush\"\n></ion-img>\n<ng-content *ngIf=\"!isImageError\"></ng-content>\n","import { Component, Input } from '@angular/core';\nimport { createAnimation } from '@ionic/angular';\nimport { BehaviorSubject } from 'rxjs';\nimport { distinctUntilChanged, startWith, tap } from 'rxjs/operators';\nimport { isNonNullable } from '../../utils/rx-operators';\n\n@Component({\n  selector: 'app-image',\n  templateUrl: './image.component.html',\n  styleUrls: ['./image.component.scss'],\n})\nexport class ImageComponent {\n  private readonly _src$ = new BehaviorSubject<string | undefined>(undefined);\n\n  readonly src$ = this._src$.pipe(\n    startWith(TINIEST_GIF),\n    isNonNullable(),\n    distinctUntilChanged(),\n    tap(() => (this.isImageError = false))\n  );\n\n  @Input()\n  set src(value: string) {\n    this._src$.next(value);\n  }\n\n  isImageError = false;\n\n  async onImageLoaded(event: Event) {\n    const imgElement = event.target as HTMLIonImgElement;\n    const fadeInAnimation = createAnimation()\n      .addElement(imgElement)\n      .duration(300)\n      .iterations(1)\n      .fromTo('opacity', '0', '1');\n    return fadeInAnimation.play();\n  }\n\n  onImageError() {\n    this.isImageError = true;\n  }\n}\n\nconst TINIEST_GIF =\n  'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n","import { arrayBufferToHex } from './encoding';\n\nexport async function sha256WithBlob(blob: Blob) {\n  const digested = await crypto.subtle.digest(\n    'SHA-256',\n    await blob.arrayBuffer()\n  );\n  return arrayBufferToHex(digested);\n}\n","<ion-content *transloco=\"let t\" scrollEvents (ionScroll)=\"onScroll($event)\">\n  <ion-grid>\n    <ion-row>\n      <ion-col\n        #col\n        *ngFor=\"let moment of moments$ | ngrxPush; trackBy: trackMoment\"\n        size=\"6\"\n        size-sm=\"4\"\n        size-md=\"3\"\n        size-lg=\"2\"\n      >\n        <app-moment-thumbnail [moment]=\"moment\"></app-moment-thumbnail>\n      </ion-col>\n    </ion-row>\n  </ion-grid>\n  <div *ngIf=\"(moments$ | ngrxPush)?.length === 0\" class=\"empty-illustration\">\n    <ion-img src=\"./assets/icons/undraw-blank-canvas.svg\"></ion-img>\n    <h3>{{ t('nothingInAlbum') }}</h3>\n    <p>{{ t('message.emptyAlbum') }}</p>\n  </div>\n  <ion-fab vertical=\"bottom\" horizontal=\"center\" slot=\"fixed\" edge>\n    <ion-fab-button routerLink=\"camera\">\n      <ion-icon name=\"camera-outline\"></ion-icon>\n    </ion-fab-button>\n  </ion-fab>\n</ion-content>\n<ion-footer [class.ion-no-border]=\"noFooterBorder$ | ngrxPush\">\n  <ion-toolbar>\n    <ion-buttons slot=\"primary\">\n      <ion-button routerLink=\"settings\" slot=\"secondary\">\n        <ion-icon slot=\"icon-only\" name=\"settings-outline\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-footer>\n","import { Component, ViewChild } from '@angular/core';\nimport { IonContent } from '@ionic/angular';\nimport { BehaviorSubject, combineLatest, Subject } from 'rxjs';\nimport { distinctUntilChanged, switchMap } from 'rxjs/operators';\nimport { Moment } from '../../shared/moment/moment';\nimport { MomentRepository } from '../../shared/moment/moment-repository.service';\nimport { isNonNullable } from '../../utils/rx-operators';\n\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n})\nexport class HomePage {\n  readonly moments$ = this.momentRepository.all$;\n\n  private readonly _ionContent$ = new BehaviorSubject<IonContent | undefined>(\n    undefined\n  );\n\n  private readonly ionContent$ = this._ionContent$.pipe(\n    isNonNullable(),\n    distinctUntilChanged()\n  );\n\n  @ViewChild(IonContent)\n  set ionContent(value: IonContent) {\n    this._ionContent$.next(value);\n  }\n\n  private readonly _scrollEvent$ = new Subject<Event>();\n\n  private readonly scrollEvent$ = this._scrollEvent$.pipe(\n    distinctUntilChanged()\n  );\n\n  readonly noFooterBorder$ = combineLatest([\n    this.ionContent$,\n    this.scrollEvent$,\n  ]).pipe(switchMap(([ionContent]) => this.detectBottom(ionContent)));\n\n  constructor(private readonly momentRepository: MomentRepository) {}\n\n  onScroll(event: Event) {\n    this._scrollEvent$.next(event);\n  }\n\n  private async detectBottom(ionContent: IonContent) {\n    const scrollElement = await ionContent.getScrollElement();\n    return (\n      scrollElement.scrollTop ===\n      scrollElement.scrollHeight - scrollElement.clientHeight\n    );\n  }\n\n  trackMoment(_: number, item: Moment) {\n    return item.id;\n  }\n}\n","import { NgZone, Pipe, ChangeDetectorRef, Directive, TemplateRef, ViewContainerRef, Input, NgModule } from '@angular/core';\nimport { Subject, EMPTY, isObservable, from } from 'rxjs';\nimport { distinctUntilChanged, switchMap, tap, catchError } from 'rxjs/operators';\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/core/cd-aware/cd-aware_creator.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @record\n * @template U\n */\nimport * as ɵngcc0 from '@angular/core';\nfunction CdAware() { }\nif (false) {\n    /** @type {?} */\n    CdAware.prototype.nextPotentialObservable;\n}\n/**\n * class CdAware\n *\n * \\@description\n * This abstract class holds all the shared logic for the push pipe and the let directive\n * responsible for change detection\n * If you extend this class you need to implement how the update of the rendered value happens.\n * Also custom behaviour is something you need to implement in the extending class\n * @template U\n * @param {?} cfg\n * @return {?}\n */\nfunction createCdAware(cfg) {\n    /** @type {?} */\n    const potentialObservablesSubject = new Subject();\n    /** @type {?} */\n    const observablesFromTemplate$ = potentialObservablesSubject.pipe(distinctUntilChanged());\n    /** @type {?} */\n    const rendering$ = observablesFromTemplate$.pipe(\n    // Compose the observables from the template and the strategy\n    switchMap((/**\n     * @param {?} observable$\n     * @return {?}\n     */\n    (observable$) => {\n        // If the passed observable is:\n        // - undefined - No value set\n        // - null - null passed directly or no value set over `async` pipe\n        if (observable$ == null) {\n            // Update the value to render_creator with null/undefined\n            cfg.updateViewContextObserver.next((/** @type {?} */ (observable$)));\n            // Render the view\n            cfg.render();\n            // Stop further processing\n            return EMPTY;\n        }\n        /** @type {?} */\n        const ob$ = isObservable(observable$)\n            ? ((/** @type {?} */ (observable$)))\n            : from(observable$);\n        // If a new Observable arrives, reset the value to render_creator\n        // We do this because we don't know when the next value arrives and want to get rid of the old value\n        cfg.resetContextObserver.next();\n        cfg.render();\n        return ((/** @type {?} */ (ob$))).pipe(distinctUntilChanged(), tap(cfg.updateViewContextObserver), tap((/**\n         * @return {?}\n         */\n        () => cfg.render())), catchError((/**\n         * @param {?} e\n         * @return {?}\n         */\n        (e) => {\n            return EMPTY;\n        })));\n    })));\n    return (/** @type {?} */ ({\n        /**\n         * @param {?} value\n         * @return {?}\n         */\n        nextPotentialObservable(value) {\n            potentialObservablesSubject.next(value);\n        },\n        /**\n         * @return {?}\n         */\n        subscribe() {\n            return rendering$.subscribe();\n        },\n    }));\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/core/utils/has-zone.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * \\@description\n *\n * Determines if the application uses `NgZone` or `NgNoopZone` as ngZone service instance.\n *\n * The function can be just imported and used everywhere.\n *\n * ```ts\n * import { hasZone } from `utils/has-zone`;\n *\n * console.log(hasZone());\n * ```\n * @param {?} z\n * @return {?}\n */\nfunction hasZone(z) {\n    return z instanceof NgZone;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/core/cd-aware/creator_render.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @record\n */\nfunction RenderConfig() { }\nif (false) {\n    /** @type {?} */\n    RenderConfig.prototype.ngZone;\n    /** @type {?} */\n    RenderConfig.prototype.cdRef;\n}\n/**\n * @template T\n * @param {?} config\n * @return {?}\n */\nfunction createRender(config) {\n    /**\n     * @return {?}\n     */\n    function render() {\n        if (hasZone(config.ngZone)) {\n            config.cdRef.markForCheck();\n        }\n        else {\n            config.cdRef.detectChanges();\n        }\n    }\n    return render;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/push/push.pipe.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * \\@Pipe PushPipe\n *\n * \\@description\n *\n * The `ngrxPush` pipe serves as a drop-in replacement for the `async` pipe.\n * It contains intelligent handling of change detection to enable us\n * running in zone-full as well as zone-less mode without any changes to the code.\n *\n * The current way of binding an observable to the view looks like that:\n *  ```html\n *  {{observable$ | async}}\n * <ng-container *ngIf=\"observable$ | async as o\">{{o}}</ng-container>\n * <component [value]=\"observable$ | async\"></component>\n * ```\n *\n * The problem is `async` pipe just marks the component and all its ancestors as dirty.\n * It needs zone.js microtask queue to exhaust until `ApplicationRef.tick` is called to render_creator all dirty marked\n *     components.\n *\n * Heavy dynamic and interactive UIs suffer from zones change detection a lot and can\n * lean to bad performance or even unusable applications, but the `async` pipe does not work in zone-less mode.\n *\n * `ngrxPush` pipe solves that problem.\n *\n * Included Features:\n *  - Take observables or promises, retrieve their values and render_creator the value to the template\n *  - Handling null and undefined values in a clean unified/structured way\n *  - Triggers change-detection differently if `zone.js` is present or not (`detectChanges` or `markForCheck`)\n *  - Distinct same values in a row to increase performance\n *  - Coalescing of change detection calls to boost performance\n *\n * \\@usageNotes\n *\n * `ngrxPush` pipe solves that problem. It can be used like shown here:\n * ```html\n * {{observable$ | ngrxPush}}\n * <ng-container *ngIf=\"observable$ | ngrxPush as o\">{{o}}</ng-container>\n * <component [value]=\"observable$ | ngrxPush\"></component>\n * ```\n *\n * \\@publicApi\n * @template S\n */\nclass PushPipe {\n    /**\n     * @param {?} cdRef\n     * @param {?} ngZone\n     */\n    constructor(cdRef, ngZone) {\n        this.resetContextObserver = {\n            next: (/**\n             * @return {?}\n             */\n            () => (this.renderedValue = undefined)),\n        };\n        this.updateViewContextObserver = {\n            next: (/**\n             * @param {?} value\n             * @return {?}\n             */\n            (value) => (this.renderedValue = value)),\n        };\n        this.cdAware = createCdAware({\n            render: createRender({ cdRef, ngZone }),\n            updateViewContextObserver: this.updateViewContextObserver,\n            resetContextObserver: this.resetContextObserver,\n        });\n        this.subscription = this.cdAware.subscribe();\n    }\n    /**\n     * @template T\n     * @param {?} potentialObservable\n     * @return {?}\n     */\n    transform(potentialObservable) {\n        this.cdAware.nextPotentialObservable(potentialObservable);\n        return (/** @type {?} */ (this.renderedValue));\n    }\n    /**\n     * @return {?}\n     */\n    ngOnDestroy() {\n        this.subscription.unsubscribe();\n    }\n}\nPushPipe.ɵfac = function PushPipe_Factory(t) { return new (t || PushPipe)(ɵngcc0.ɵɵinjectPipeChangeDetectorRef(), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone)); };\nPushPipe.ɵpipe = ɵngcc0.ɵɵdefinePipe({ name: \"ngrxPush\", type: PushPipe, pure: false });\n/** @nocollapse */\nPushPipe.ctorParameters = () => [\n    { type: ChangeDetectorRef },\n    { type: NgZone }\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(PushPipe, [{\n        type: Pipe,\n        args: [{ name: 'ngrxPush', pure: false }]\n    }], function () { return [{ type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.NgZone }]; }, null); })();\nif (false) {\n    /**\n     * @type {?}\n     * @private\n     */\n    PushPipe.prototype.renderedValue;\n    /**\n     * @type {?}\n     * @private\n     */\n    PushPipe.prototype.subscription;\n    /**\n     * @type {?}\n     * @private\n     */\n    PushPipe.prototype.cdAware;\n    /**\n     * @type {?}\n     * @private\n     */\n    PushPipe.prototype.resetContextObserver;\n    /**\n     * @type {?}\n     * @private\n     */\n    PushPipe.prototype.updateViewContextObserver;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/let/let.directive.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @record\n * @template T\n */\nfunction LetViewContext() { }\nif (false) {\n    /** @type {?} */\n    LetViewContext.prototype.$implicit;\n    /** @type {?} */\n    LetViewContext.prototype.ngrxLet;\n    /** @type {?} */\n    LetViewContext.prototype.$error;\n    /** @type {?} */\n    LetViewContext.prototype.$complete;\n}\n/**\n * \\@Directive LetDirective\n *\n * \\@description\n *\n * The `*ngrxLet` directive serves a convenient way of binding observables to a view context (a dom element scope).\n * It also helps with several internal processing under the hood.\n *\n * The current way of binding an observable to the view looks like that:\n * ```html\n * <ng-container *ngIf=\"observableNumber$ as n\">\n * <app-number [number]=\"n\">\n * </app-number>\n * <app-number-special [number]=\"n\">\n * </app-number-special>\n * </ng-container>\n *  ```\n *\n *  The problem is `*ngIf` is also interfering with rendering and in case of a `0` the component would be hidden\n *\n * Included Features:\n * - binding is always present. (`*ngIf=\"truthy$\"`)\n * - it takes away the multiple usages of the `async` or `ngrxPush` pipe\n * - a unified/structured way of handling null and undefined\n * - triggers change-detection differently if `zone.js` is present or not (`ChangeDetectorRef.detectChanges` or `ChangeDetectorRef.markForCheck`)\n * - triggers change-detection differently if ViewEngine or Ivy is present (`ChangeDetectorRef.detectChanges` or `ɵdetectChanges`)\n * - distinct same values in a row (distinctUntilChanged operator),\n *\n * \\@usageNotes\n *\n * The `*ngrxLet` directive take over several things and makes it more convenient and save to work with streams in the template\n * `<ng-container *ngrxLet=\"observableNumber$ as c\"></ng-container>`\n *\n * ```html\n * <ng-container *ngrxLet=\"observableNumber$ as n\">\n * <app-number [number]=\"n\">\n * </app-number>\n * </ng-container>\n *\n * <ng-container *ngrxLet=\"observableNumber$; let n\">\n * <app-number [number]=\"n\">\n * </app-number>\n * </ng-container>\n * ```\n *\n * In addition to that it provides us information from the whole observable context.\n * We can track the observables:\n * - next value\n * - error value\n * - complete state\n *\n * ```html\n * <ng-container *ngrxLet=\"observableNumber$; let n; let e = $error, let c = $complete\">\n * <app-number [number]=\"n\"  *ngIf=\"!e && !c\">\n * </app-number>\n * <ng-container *ngIf=\"e\">\n * There is an error: {{e}}\n * </ng-container>\n * <ng-container *ngIf=\"c\">\n * Observable completed: {{c}}\n * </ng-container>\n * </ng-container>\n * ```\n *\n * \\@publicApi\n * @template U\n */\nclass LetDirective {\n    /**\n     * @param {?} cdRef\n     * @param {?} ngZone\n     * @param {?} templateRef\n     * @param {?} viewContainerRef\n     */\n    constructor(cdRef, ngZone, templateRef, viewContainerRef) {\n        this.templateRef = templateRef;\n        this.viewContainerRef = viewContainerRef;\n        this.ViewContext = {\n            $implicit: undefined,\n            ngrxLet: undefined,\n            $error: false,\n            $complete: false,\n        };\n        this.resetContextObserver = {\n            next: (/**\n             * @return {?}\n             */\n            () => {\n                // if not initialized no need to set undefined\n                if (this.embeddedView) {\n                    this.ViewContext.$implicit = undefined;\n                    this.ViewContext.ngrxLet = undefined;\n                    this.ViewContext.$error = false;\n                    this.ViewContext.$complete = false;\n                }\n            }),\n        };\n        this.updateViewContextObserver = {\n            next: (/**\n             * @param {?} value\n             * @return {?}\n             */\n            (value) => {\n                // to have init lazy\n                if (!this.embeddedView) {\n                    this.createEmbeddedView();\n                }\n                this.ViewContext.$implicit = value;\n                this.ViewContext.ngrxLet = value;\n            }),\n            error: (/**\n             * @param {?} error\n             * @return {?}\n             */\n            (error) => {\n                // to have init lazy\n                if (!this.embeddedView) {\n                    this.createEmbeddedView();\n                }\n                this.ViewContext.$error = true;\n            }),\n            complete: (/**\n             * @return {?}\n             */\n            () => {\n                // to have init lazy\n                if (!this.embeddedView) {\n                    this.createEmbeddedView();\n                }\n                this.ViewContext.$complete = true;\n            }),\n        };\n        this.cdAware = createCdAware({\n            render: createRender({ cdRef, ngZone }),\n            resetContextObserver: this.resetContextObserver,\n            updateViewContextObserver: this.updateViewContextObserver,\n        });\n        this.subscription = this.cdAware.subscribe();\n    }\n    /**\n     * @template U\n     * @param {?} dir\n     * @param {?} ctx\n     * @return {?}\n     */\n    static ngTemplateContextGuard(dir, ctx) {\n        return true;\n    }\n    /**\n     * @param {?} potentialObservable\n     * @return {?}\n     */\n    set ngrxLet(potentialObservable) {\n        this.cdAware.nextPotentialObservable(potentialObservable);\n    }\n    /**\n     * @return {?}\n     */\n    createEmbeddedView() {\n        this.embeddedView = this.viewContainerRef.createEmbeddedView(this.templateRef, this.ViewContext);\n    }\n    /**\n     * @return {?}\n     */\n    ngOnDestroy() {\n        this.subscription.unsubscribe();\n        this.viewContainerRef.clear();\n    }\n}\nLetDirective.ɵfac = function LetDirective_Factory(t) { return new (t || LetDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ViewContainerRef)); };\nLetDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: LetDirective, selectors: [[\"\", \"ngrxLet\", \"\"]], inputs: { ngrxLet: \"ngrxLet\" } });\n/** @nocollapse */\nLetDirective.ctorParameters = () => [\n    { type: ChangeDetectorRef },\n    { type: NgZone },\n    { type: TemplateRef },\n    { type: ViewContainerRef }\n];\nLetDirective.propDecorators = {\n    ngrxLet: [{ type: Input }]\n};\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(LetDirective, [{\n        type: Directive,\n        args: [{ selector: '[ngrxLet]' }]\n    }], function () { return [{ type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.TemplateRef }, { type: ɵngcc0.ViewContainerRef }]; }, { ngrxLet: [{\n            type: Input\n        }] }); })();\nif (false) {\n    /** @type {?} */\n    LetDirective.ngTemplateGuard_ngrxLet;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.embeddedView;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.ViewContext;\n    /**\n     * @type {?}\n     * @protected\n     */\n    LetDirective.prototype.subscription;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.cdAware;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.resetContextObserver;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.updateViewContextObserver;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.templateRef;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.viewContainerRef;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/reactive-component.module.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/** @type {?} */\nconst DECLARATIONS = [LetDirective, PushPipe];\n/** @type {?} */\nconst EXPORTS = [DECLARATIONS];\nclass ReactiveComponentModule {\n}\nReactiveComponentModule.ɵfac = function ReactiveComponentModule_Factory(t) { return new (t || ReactiveComponentModule)(); };\nReactiveComponentModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: ReactiveComponentModule });\nReactiveComponentModule.ɵinj = ɵngcc0.ɵɵdefineInjector({});\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(ReactiveComponentModule, { declarations: [LetDirective, PushPipe], exports: [LetDirective, PushPipe] }); })();\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ReactiveComponentModule, [{\n        type: NgModule,\n        args: [{\n                declarations: [DECLARATIONS],\n                exports: [EXPORTS]\n            }]\n    }], null, null); })();\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/index.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * @fileoverview added by tsickle\n * Generated from: public_api.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * @fileoverview added by tsickle\n * Generated from: index.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * @fileoverview added by tsickle\n * Generated from: ngrx-component.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\nexport { LetDirective, PushPipe, ReactiveComponentModule };\n\n//# sourceMappingURL=ngrx-component.js.map","\n/*! image-blob-reduce 2.2.2 https://github.com/nodeca/image-blob-reduce @license MIT */\nvar assign = function assign(to) {\n  var from;\n\n  for (var s = 1; s < arguments.length; s++) {\n    from = Object(arguments[s]);\n\n    for (var key in from) {\n      if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n    }\n  }\n\n  return to;\n};\n\n\nfunction pick(from, props) {\n  var to = {};\n\n  props.forEach(function (key) {\n    if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n  });\n\n  return to;\n}\n\n\nfunction pick_pica_resize_options(from) {\n  return pick(from, [\n    'alpha',\n    'unsharpAmount',\n    'unsharpRadius',\n    'unsharpThreshold',\n    'cancelToken'\n  ]);\n}\n\n\nvar pick_1 = pick;\nvar pick_pica_resize_options_1 = pick_pica_resize_options;\n\nvar utils = {\n\tassign: assign,\n\tpick: pick_1,\n\tpick_pica_resize_options: pick_pica_resize_options_1\n};\n\nfunction createCommonjsModule(fn) {\n  var module = { exports: {} };\n\treturn fn(module, module.exports), module.exports;\n}\n\nfunction commonjsRequire (target) {\n\tthrow new Error('Could not dynamically require \"' + target + '\". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.');\n}\n\n/*!\n\npica\nhttps://github.com/nodeca/pica\n\n*/\n\nvar pica = createCommonjsModule(function (module, exports) {\n(function(f){{module.exports=f();}})(function(){return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof commonjsRequire&&commonjsRequire;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t);}return n[i].exports}for(var u=\"function\"==typeof commonjsRequire&&commonjsRequire,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(_dereq_,module,exports){\n\nvar inherits = _dereq_('inherits');\n\nvar Multimath = _dereq_('multimath');\n\nvar mm_unsharp_mask = _dereq_('multimath/lib/unsharp_mask');\n\nvar mm_resize = _dereq_('./mm_resize');\n\nfunction MathLib(requested_features) {\n  var __requested_features = requested_features || [];\n\n  var features = {\n    js: __requested_features.indexOf('js') >= 0,\n    wasm: __requested_features.indexOf('wasm') >= 0\n  };\n  Multimath.call(this, features);\n  this.features = {\n    js: features.js,\n    wasm: features.wasm && this.has_wasm()\n  };\n  this.use(mm_unsharp_mask);\n  this.use(mm_resize);\n}\n\ninherits(MathLib, Multimath);\n\nMathLib.prototype.resizeAndUnsharp = function resizeAndUnsharp(options, cache) {\n  var result = this.resize(options, cache);\n\n  if (options.unsharpAmount) {\n    this.unsharp_mask(result, options.toWidth, options.toHeight, options.unsharpAmount, options.unsharpRadius, options.unsharpThreshold);\n  }\n\n  return result;\n};\n\nmodule.exports = MathLib;\n\n},{\"./mm_resize\":4,\"inherits\":15,\"multimath\":16,\"multimath/lib/unsharp_mask\":19}],2:[function(_dereq_,module,exports){\n//var FIXED_FRAC_BITS = 14;\n\nfunction clampTo8(i) {\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n} // Convolve image in horizontal directions and transpose output. In theory,\n// transpose allow:\n//\n// - use the same convolver for both passes (this fails due different\n//   types of input array and temporary buffer)\n// - making vertical pass by horisonltal lines inprove CPU cache use.\n//\n// But in real life this doesn't work :)\n//\n\n\nfunction convolveHorizontally(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Bring this value back in range. All of the filter scaling factors\n      // are in fixed point with FIXED_FRAC_BITS bits of fractional part.\n      //\n      // (!) Add 1/2 of value before clamping to get proper rounding. In other\n      // case brightness loss will be noticeable if you resize image with white\n      // border and place it on white background.\n      //\n\n\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Technically, convolvers are the same. But input array and temporary\n// buffer can be of different type (especially, in old browsers). So,\n// keep code in separate functions to avoid deoptimizations & speed loss.\n\n\nfunction convolveVertically(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Bring this value back in range. All of the filter scaling factors\n      // are in fixed point with FIXED_FRAC_BITS bits of fractional part.\n      //\n      // (!) Add 1/2 of value before clamping to get proper rounding. In other\n      // case brightness loss will be noticeable if you resize image with white\n      // border and place it on white background.\n      //\n\n\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n}\n\nmodule.exports = {\n  convolveHorizontally: convolveHorizontally,\n  convolveVertically: convolveVertically\n};\n\n},{}],3:[function(_dereq_,module,exports){\n/* eslint-disable max-len */\n\nmodule.exports = 'AGFzbQEAAAABFAJgBn9/f39/fwBgB39/f39/f38AAg8BA2VudgZtZW1vcnkCAAEDAwIAAQQEAXAAAAcZAghjb252b2x2ZQAACmNvbnZvbHZlSFYAAQkBAArmAwLBAwEQfwJAIANFDQAgBEUNACAFQQRqIRVBACEMQQAhDQNAIA0hDkEAIRFBACEHA0AgB0ECaiESAn8gBSAHQQF0IgdqIgZBAmouAQAiEwRAQQAhCEEAIBNrIRQgFSAHaiEPIAAgDCAGLgEAakECdGohEEEAIQlBACEKQQAhCwNAIBAoAgAiB0EYdiAPLgEAIgZsIAtqIQsgB0H/AXEgBmwgCGohCCAHQRB2Qf8BcSAGbCAKaiEKIAdBCHZB/wFxIAZsIAlqIQkgD0ECaiEPIBBBBGohECAUQQFqIhQNAAsgEiATagwBC0EAIQtBACEKQQAhCUEAIQggEgshByABIA5BAnRqIApBgMAAakEOdSIGQf8BIAZB/wFIG0EQdEGAgPwHcUEAIAZBAEobIAtBgMAAakEOdSIGQf8BIAZB/wFIG0EYdEEAIAZBAEobciAJQYDAAGpBDnUiBkH/ASAGQf8BSBtBCHRBgP4DcUEAIAZBAEobciAIQYDAAGpBDnUiBkH/ASAGQf8BSBtB/wFxQQAgBkEAShtyNgIAIA4gA2ohDiARQQFqIhEgBEcNAAsgDCACaiEMIA1BAWoiDSADRw0ACwsLIQACQEEAIAIgAyAEIAUgABAAIAJBACAEIAUgBiABEAALCw==';\n\n},{}],4:[function(_dereq_,module,exports){\n\nmodule.exports = {\n  name: 'resize',\n  fn: _dereq_('./resize'),\n  wasm_fn: _dereq_('./resize_wasm'),\n  wasm_src: _dereq_('./convolve_wasm_base64')\n};\n\n},{\"./convolve_wasm_base64\":3,\"./resize\":5,\"./resize_wasm\":8}],5:[function(_dereq_,module,exports){\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nvar convolveHorizontally = _dereq_('./convolve').convolveHorizontally;\n\nvar convolveVertically = _dereq_('./convolve').convolveVertically;\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nmodule.exports = function resize(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0;\n  var offsetY = options.offsetY || 0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var quality = typeof options.quality === 'undefined' ? 3 : options.quality;\n  var alpha = options.alpha || false;\n  var filtersX = createFilters(quality, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(quality, srcH, destH, scaleY, offsetY);\n  var tmp = new Uint8Array(destW * srcH * 4); // To use single function we need src & tmp of the same type.\n  // But src can be CanvasPixelArray, and tmp - Uint8Array. So, keep\n  // vertical and horizontal passes separately to avoid deoptimization.\n\n  convolveHorizontally(src, tmp, srcW, srcH, destW, filtersX);\n  convolveVertically(tmp, dest, srcH, destW, destH, filtersY); // That's faster than doing checks in convolver.\n  // !!! Note, canvas data is not premultipled. We don't need other\n  // alpha corrections.\n\n  if (!alpha) resetAlpha(dest, destW, destH);\n  return dest;\n};\n\n},{\"./convolve\":2,\"./resize_filter_gen\":6}],6:[function(_dereq_,module,exports){\n\nvar FILTER_INFO = _dereq_('./resize_filter_info'); // Precision of fixed FP values\n\n\nvar FIXED_FRAC_BITS = 14;\n\nfunction toFixedPoint(num) {\n  return Math.round(num * ((1 << FIXED_FRAC_BITS) - 1));\n}\n\nmodule.exports = function resizeFilterGen(quality, srcSize, destSize, scale, offset) {\n  var filterFunction = FILTER_INFO[quality].filter;\n  var scaleInverted = 1.0 / scale;\n  var scaleClamped = Math.min(1.0, scale); // For upscale\n  // Filter window (averaging interval), scaled to src image\n\n  var srcWindow = FILTER_INFO[quality].win / scaleClamped;\n  var destPixel, srcPixel, srcFirst, srcLast, filterElementSize, floatFilter, fxpFilter, total, pxl, idx, floatVal, filterTotal, filterVal;\n  var leftNotEmpty, rightNotEmpty, filterShift, filterSize;\n  var maxFilterElementSize = Math.floor((srcWindow + 1) * 2);\n  var packedFilter = new Int16Array((maxFilterElementSize + 2) * destSize);\n  var packedFilterPtr = 0;\n  var slowCopy = !packedFilter.subarray || !packedFilter.set; // For each destination pixel calculate source range and built filter values\n\n  for (destPixel = 0; destPixel < destSize; destPixel++) {\n    // Scaling should be done relative to central pixel point\n    srcPixel = (destPixel + 0.5) * scaleInverted + offset;\n    srcFirst = Math.max(0, Math.floor(srcPixel - srcWindow));\n    srcLast = Math.min(srcSize - 1, Math.ceil(srcPixel + srcWindow));\n    filterElementSize = srcLast - srcFirst + 1;\n    floatFilter = new Float32Array(filterElementSize);\n    fxpFilter = new Int16Array(filterElementSize);\n    total = 0.0; // Fill filter values for calculated range\n\n    for (pxl = srcFirst, idx = 0; pxl <= srcLast; pxl++, idx++) {\n      floatVal = filterFunction((pxl + 0.5 - srcPixel) * scaleClamped);\n      total += floatVal;\n      floatFilter[idx] = floatVal;\n    } // Normalize filter, convert to fixed point and accumulate conversion error\n\n\n    filterTotal = 0;\n\n    for (idx = 0; idx < floatFilter.length; idx++) {\n      filterVal = floatFilter[idx] / total;\n      filterTotal += filterVal;\n      fxpFilter[idx] = toFixedPoint(filterVal);\n    } // Compensate normalization error, to minimize brightness drift\n\n\n    fxpFilter[destSize >> 1] += toFixedPoint(1.0 - filterTotal); //\n    // Now pack filter to useable form\n    //\n    // 1. Trim heading and tailing zero values, and compensate shitf/length\n    // 2. Put all to single array in this format:\n    //\n    //    [ pos shift, data length, value1, value2, value3, ... ]\n    //\n\n    leftNotEmpty = 0;\n\n    while (leftNotEmpty < fxpFilter.length && fxpFilter[leftNotEmpty] === 0) {\n      leftNotEmpty++;\n    }\n\n    if (leftNotEmpty < fxpFilter.length) {\n      rightNotEmpty = fxpFilter.length - 1;\n\n      while (rightNotEmpty > 0 && fxpFilter[rightNotEmpty] === 0) {\n        rightNotEmpty--;\n      }\n\n      filterShift = srcFirst + leftNotEmpty;\n      filterSize = rightNotEmpty - leftNotEmpty + 1;\n      packedFilter[packedFilterPtr++] = filterShift; // shift\n\n      packedFilter[packedFilterPtr++] = filterSize; // size\n\n      if (!slowCopy) {\n        packedFilter.set(fxpFilter.subarray(leftNotEmpty, rightNotEmpty + 1), packedFilterPtr);\n        packedFilterPtr += filterSize;\n      } else {\n        // fallback for old IE < 11, without subarray/set methods\n        for (idx = leftNotEmpty; idx <= rightNotEmpty; idx++) {\n          packedFilter[packedFilterPtr++] = fxpFilter[idx];\n        }\n      }\n    } else {\n      // zero data, write header only\n      packedFilter[packedFilterPtr++] = 0; // shift\n\n      packedFilter[packedFilterPtr++] = 0; // size\n    }\n  }\n\n  return packedFilter;\n};\n\n},{\"./resize_filter_info\":7}],7:[function(_dereq_,module,exports){\n\nmodule.exports = [{\n  // Nearest neibor (Box)\n  win: 0.5,\n  filter: function filter(x) {\n    return x >= -0.5 && x < 0.5 ? 1.0 : 0.0;\n  }\n}, {\n  // Hamming\n  win: 1.0,\n  filter: function filter(x) {\n    if (x <= -1.0 || x >= 1.0) {\n      return 0.0;\n    }\n\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * (0.54 + 0.46 * Math.cos(xpi / 1.0));\n  }\n}, {\n  // Lanczos, win = 2\n  win: 2.0,\n  filter: function filter(x) {\n    if (x <= -2.0 || x >= 2.0) {\n      return 0.0;\n    }\n\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * Math.sin(xpi / 2.0) / (xpi / 2.0);\n  }\n}, {\n  // Lanczos, win = 3\n  win: 3.0,\n  filter: function filter(x) {\n    if (x <= -3.0 || x >= 3.0) {\n      return 0.0;\n    }\n\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * Math.sin(xpi / 3.0) / (xpi / 3.0);\n  }\n}];\n\n},{}],8:[function(_dereq_,module,exports){\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nfunction asUint8Array(src) {\n  return new Uint8Array(src.buffer, 0, src.byteLength);\n}\n\nvar IS_LE = true; // should not crash everything on module load in old browsers\n\ntry {\n  IS_LE = new Uint32Array(new Uint8Array([1, 0, 0, 0]).buffer)[0] === 1;\n} catch (__) {}\n\nfunction copyInt16asLE(src, target, target_offset) {\n  if (IS_LE) {\n    target.set(asUint8Array(src), target_offset);\n    return;\n  }\n\n  for (var ptr = target_offset, i = 0; i < src.length; i++) {\n    var data = src[i];\n    target[ptr++] = data & 0xFF;\n    target[ptr++] = data >> 8 & 0xFF;\n  }\n}\n\nmodule.exports = function resize_wasm(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0.0;\n  var offsetY = options.offsetY || 0.0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var quality = typeof options.quality === 'undefined' ? 3 : options.quality;\n  var alpha = options.alpha || false;\n  var filtersX = createFilters(quality, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(quality, srcH, destH, scaleY, offsetY); // destination is 0 too.\n\n  var src_offset = 0; // buffer between convolve passes\n\n  var tmp_offset = this.__align(src_offset + Math.max(src.byteLength, dest.byteLength));\n\n  var filtersX_offset = this.__align(tmp_offset + srcH * destW * 4);\n\n  var filtersY_offset = this.__align(filtersX_offset + filtersX.byteLength);\n\n  var alloc_bytes = filtersY_offset + filtersY.byteLength;\n\n  var instance = this.__instance('resize', alloc_bytes); //\n  // Fill memory block with data to process\n  //\n\n\n  var mem = new Uint8Array(this.__memory.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer); // 32-bit copy is much faster in chrome\n\n  var src32 = new Uint32Array(src.buffer);\n  mem32.set(src32); // We should guarantee LE bytes order. Filters are not big, so\n  // speed difference is not significant vs direct .set()\n\n  copyInt16asLE(filtersX, mem, filtersX_offset);\n  copyInt16asLE(filtersY, mem, filtersY_offset); //\n  // Now call webassembly method\n  // emsdk does method names with '_'\n\n  var fn = instance.exports.convolveHV || instance.exports._convolveHV;\n  fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH); //\n  // Copy data back to typed array\n  //\n  // 32-bit copy is much faster in chrome\n\n  var dest32 = new Uint32Array(dest.buffer);\n  dest32.set(new Uint32Array(this.__memory.buffer, 0, destH * destW)); // That's faster than doing checks in convolver.\n  // !!! Note, canvas data is not premultipled. We don't need other\n  // alpha corrections.\n\n  if (!alpha) resetAlpha(dest, destW, destH);\n  return dest;\n};\n\n},{\"./resize_filter_gen\":6}],9:[function(_dereq_,module,exports){\n\nvar GC_INTERVAL = 100;\n\nfunction Pool(create, idle) {\n  this.create = create;\n  this.available = [];\n  this.acquired = {};\n  this.lastId = 1;\n  this.timeoutId = 0;\n  this.idle = idle || 2000;\n}\n\nPool.prototype.acquire = function () {\n  var _this = this;\n\n  var resource;\n\n  if (this.available.length !== 0) {\n    resource = this.available.pop();\n  } else {\n    resource = this.create();\n    resource.id = this.lastId++;\n\n    resource.release = function () {\n      return _this.release(resource);\n    };\n  }\n\n  this.acquired[resource.id] = resource;\n  return resource;\n};\n\nPool.prototype.release = function (resource) {\n  var _this2 = this;\n\n  delete this.acquired[resource.id];\n  resource.lastUsed = Date.now();\n  this.available.push(resource);\n\n  if (this.timeoutId === 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this2.gc();\n    }, GC_INTERVAL);\n  }\n};\n\nPool.prototype.gc = function () {\n  var _this3 = this;\n\n  var now = Date.now();\n  this.available = this.available.filter(function (resource) {\n    if (now - resource.lastUsed > _this3.idle) {\n      resource.destroy();\n      return false;\n    }\n\n    return true;\n  });\n\n  if (this.available.length !== 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this3.gc();\n    }, GC_INTERVAL);\n  } else {\n    this.timeoutId = 0;\n  }\n};\n\nmodule.exports = Pool;\n\n},{}],10:[function(_dereq_,module,exports){\n// min size = 1 can consume large amount of memory\n\nvar MIN_INNER_TILE_SIZE = 2;\n\nmodule.exports = function createStages(fromWidth, fromHeight, toWidth, toHeight, srcTileSize, destTileBorder) {\n  var scaleX = toWidth / fromWidth;\n  var scaleY = toHeight / fromHeight; // derived from createRegions equation:\n  // innerTileWidth = pixelFloor(srcTileSize * scaleX) - 2 * destTileBorder;\n\n  var minScale = (2 * destTileBorder + MIN_INNER_TILE_SIZE + 1) / srcTileSize; // refuse to scale image multiple times by less than twice each time,\n  // it could only happen because of invalid options\n\n  if (minScale > 0.5) return [[toWidth, toHeight]];\n  var stageCount = Math.ceil(Math.log(Math.min(scaleX, scaleY)) / Math.log(minScale)); // no additional resizes are necessary,\n  // stageCount can be zero or be negative when enlarging the image\n\n  if (stageCount <= 1) return [[toWidth, toHeight]];\n  var result = [];\n\n  for (var i = 0; i < stageCount; i++) {\n    var width = Math.round(Math.pow(Math.pow(fromWidth, stageCount - i - 1) * Math.pow(toWidth, i + 1), 1 / stageCount));\n    var height = Math.round(Math.pow(Math.pow(fromHeight, stageCount - i - 1) * Math.pow(toHeight, i + 1), 1 / stageCount));\n    result.push([width, height]);\n  }\n\n  return result;\n};\n\n},{}],11:[function(_dereq_,module,exports){\n/*\n * pixelFloor and pixelCeil are modified versions of Math.floor and Math.ceil\n * functions which take into account floating point arithmetic errors.\n * Those errors can cause undesired increments/decrements of sizes and offsets:\n * Math.ceil(36 / (36 / 500)) = 501\n * pixelCeil(36 / (36 / 500)) = 500\n */\n\nvar PIXEL_EPSILON = 1e-5;\n\nfunction pixelFloor(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.floor(x);\n}\n\nfunction pixelCeil(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.ceil(x);\n}\n\nmodule.exports = function createRegions(options) {\n  var scaleX = options.toWidth / options.width;\n  var scaleY = options.toHeight / options.height;\n  var innerTileWidth = pixelFloor(options.srcTileSize * scaleX) - 2 * options.destTileBorder;\n  var innerTileHeight = pixelFloor(options.srcTileSize * scaleY) - 2 * options.destTileBorder; // prevent infinite loop, this should never happen\n\n  if (innerTileWidth < 1 || innerTileHeight < 1) {\n    throw new Error('Internal error in pica: target tile width/height is too small.');\n  }\n\n  var x, y;\n  var innerX, innerY, toTileWidth, toTileHeight;\n  var tiles = [];\n  var tile; // we go top-to-down instead of left-to-right to make image displayed from top to\n  // doesn in the browser\n\n  for (innerY = 0; innerY < options.toHeight; innerY += innerTileHeight) {\n    for (innerX = 0; innerX < options.toWidth; innerX += innerTileWidth) {\n      x = innerX - options.destTileBorder;\n\n      if (x < 0) {\n        x = 0;\n      }\n\n      toTileWidth = innerX + innerTileWidth + options.destTileBorder - x;\n\n      if (x + toTileWidth >= options.toWidth) {\n        toTileWidth = options.toWidth - x;\n      }\n\n      y = innerY - options.destTileBorder;\n\n      if (y < 0) {\n        y = 0;\n      }\n\n      toTileHeight = innerY + innerTileHeight + options.destTileBorder - y;\n\n      if (y + toTileHeight >= options.toHeight) {\n        toTileHeight = options.toHeight - y;\n      }\n\n      tile = {\n        toX: x,\n        toY: y,\n        toWidth: toTileWidth,\n        toHeight: toTileHeight,\n        toInnerX: innerX,\n        toInnerY: innerY,\n        toInnerWidth: innerTileWidth,\n        toInnerHeight: innerTileHeight,\n        offsetX: x / scaleX - pixelFloor(x / scaleX),\n        offsetY: y / scaleY - pixelFloor(y / scaleY),\n        scaleX: scaleX,\n        scaleY: scaleY,\n        x: pixelFloor(x / scaleX),\n        y: pixelFloor(y / scaleY),\n        width: pixelCeil(toTileWidth / scaleX),\n        height: pixelCeil(toTileHeight / scaleY)\n      };\n      tiles.push(tile);\n    }\n  }\n\n  return tiles;\n};\n\n},{}],12:[function(_dereq_,module,exports){\n\nfunction objClass(obj) {\n  return Object.prototype.toString.call(obj);\n}\n\nmodule.exports.isCanvas = function isCanvas(element) {\n  var cname = objClass(element);\n  return cname === '[object HTMLCanvasElement]'\n  /* browser */\n  || cname === '[object OffscreenCanvas]' || cname === '[object Canvas]'\n  /* node-canvas */\n  ;\n};\n\nmodule.exports.isImage = function isImage(element) {\n  return objClass(element) === '[object HTMLImageElement]';\n};\n\nmodule.exports.isImageBitmap = function isImageBitmap(element) {\n  return objClass(element) === '[object ImageBitmap]';\n};\n\nmodule.exports.limiter = function limiter(concurrency) {\n  var active = 0,\n      queue = [];\n\n  function roll() {\n    if (active < concurrency && queue.length) {\n      active++;\n      queue.shift()();\n    }\n  }\n\n  return function limit(fn) {\n    return new Promise(function (resolve, reject) {\n      queue.push(function () {\n        fn().then(function (result) {\n          resolve(result);\n          active--;\n          roll();\n        }, function (err) {\n          reject(err);\n          active--;\n          roll();\n        });\n      });\n      roll();\n    });\n  };\n};\n\nmodule.exports.cib_quality_name = function cib_quality_name(num) {\n  switch (num) {\n    case 0:\n      return 'pixelated';\n\n    case 1:\n      return 'low';\n\n    case 2:\n      return 'medium';\n  }\n\n  return 'high';\n};\n\nmodule.exports.cib_support = function cib_support(createCanvas) {\n  return Promise.resolve().then(function () {\n    if (typeof createImageBitmap === 'undefined') {\n      return false;\n    }\n\n    var c = createCanvas(100, 100);\n    return createImageBitmap(c, 0, 0, 100, 100, {\n      resizeWidth: 10,\n      resizeHeight: 10,\n      resizeQuality: 'high'\n    }).then(function (bitmap) {\n      var status = bitmap.width === 10; // Branch below is filtered on upper level. We do not call resize\n      // detection for basic ImageBitmap.\n      //\n      // https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap\n      // old Crome 51 has ImageBitmap without .close(). Then this code\n      // will throw and return 'false' as expected.\n      //\n\n      bitmap.close();\n      c = null;\n      return status;\n    });\n  })[\"catch\"](function () {\n    return false;\n  });\n};\n\n},{}],13:[function(_dereq_,module,exports){\n\nmodule.exports = function () {\n  var MathLib = _dereq_('./mathlib');\n\n  var mathLib;\n  /* eslint-disable no-undef */\n\n  onmessage = function onmessage(ev) {\n    var opts = ev.data.opts;\n    if (!mathLib) mathLib = new MathLib(ev.data.features); // Use multimath's sync auto-init. Avoid Promise use in old browsers,\n    // because polyfills are not propagated to webworker.\n\n    var result = mathLib.resizeAndUnsharp(opts);\n    postMessage({\n      result: result\n    }, [result.buffer]);\n  };\n};\n\n},{\"./mathlib\":1}],14:[function(_dereq_,module,exports){\n// Calculate Gaussian blur of an image using IIR filter\n// The method is taken from Intel's white paper and code example attached to it:\n// https://software.intel.com/en-us/articles/iir-gaussian-blur-filter\n// -implementation-using-intel-advanced-vector-extensions\n\nvar a0, a1, a2, a3, b1, b2, left_corner, right_corner;\n\nfunction gaussCoef(sigma) {\n  if (sigma < 0.5) {\n    sigma = 0.5;\n  }\n\n  var a = Math.exp(0.726 * 0.726) / sigma,\n      g1 = Math.exp(-a),\n      g2 = Math.exp(-2 * a),\n      k = (1 - g1) * (1 - g1) / (1 + 2 * a * g1 - g2);\n\n  a0 = k;\n  a1 = k * (a - 1) * g1;\n  a2 = k * (a + 1) * g1;\n  a3 = -k * g2;\n  b1 = 2 * g1;\n  b2 = -g2;\n  left_corner = (a0 + a1) / (1 - b1 - b2);\n  right_corner = (a2 + a3) / (1 - b1 - b2);\n\n  // Attempt to force type to FP32.\n  return new Float32Array([ a0, a1, a2, a3, b1, b2, left_corner, right_corner ]);\n}\n\nfunction convolveMono16(src, out, line, coeff, width, height) {\n  // takes src image and writes the blurred and transposed result into out\n\n  var prev_src, curr_src, curr_out, prev_out, prev_prev_out;\n  var src_index, out_index, line_index;\n  var i, j;\n  var coeff_a0, coeff_a1, coeff_b1, coeff_b2;\n\n  for (i = 0; i < height; i++) {\n    src_index = i * width;\n    out_index = i;\n    line_index = 0;\n\n    // left to right\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[6];\n    prev_out = prev_prev_out;\n\n    coeff_a0 = coeff[0];\n    coeff_a1 = coeff[1];\n    coeff_b1 = coeff[4];\n    coeff_b2 = coeff[5];\n\n    for (j = 0; j < width; j++) {\n      curr_src = src[src_index];\n\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n      prev_src = curr_src;\n\n      line[line_index] = prev_out;\n      line_index++;\n      src_index++;\n    }\n\n    src_index--;\n    line_index--;\n    out_index += height * (width - 1);\n\n    // right to left\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[7];\n    prev_out = prev_prev_out;\n    curr_src = prev_src;\n\n    coeff_a0 = coeff[2];\n    coeff_a1 = coeff[3];\n\n    for (j = width - 1; j >= 0; j--) {\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n\n      prev_src = curr_src;\n      curr_src = src[src_index];\n\n      out[out_index] = line[line_index] + prev_out;\n\n      src_index--;\n      line_index--;\n      out_index -= height;\n    }\n  }\n}\n\n\nfunction blurMono16(src, width, height, radius) {\n  // Quick exit on zero radius\n  if (!radius) { return; }\n\n  var out      = new Uint16Array(src.length),\n      tmp_line = new Float32Array(Math.max(width, height));\n\n  var coeff = gaussCoef(radius);\n\n  convolveMono16(src, out, tmp_line, coeff, width, height);\n  convolveMono16(out, src, tmp_line, coeff, height, width);\n}\n\nmodule.exports = blurMono16;\n\n},{}],15:[function(_dereq_,module,exports){\nif (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor;\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor;\n      var TempCtor = function () {};\n      TempCtor.prototype = superCtor.prototype;\n      ctor.prototype = new TempCtor();\n      ctor.prototype.constructor = ctor;\n    }\n  };\n}\n\n},{}],16:[function(_dereq_,module,exports){\n\n\nvar assign         = _dereq_('object-assign');\nvar base64decode   = _dereq_('./lib/base64decode');\nvar hasWebAssembly = _dereq_('./lib/wa_detect');\n\n\nvar DEFAULT_OPTIONS = {\n  js: true,\n  wasm: true\n};\n\n\nfunction MultiMath(options) {\n  if (!(this instanceof MultiMath)) return new MultiMath(options);\n\n  var opts = assign({}, DEFAULT_OPTIONS, options || {});\n\n  this.options         = opts;\n\n  this.__cache         = {};\n\n  this.__init_promise  = null;\n  this.__modules       = opts.modules || {};\n  this.__memory        = null;\n  this.__wasm          = {};\n\n  this.__isLE = ((new Uint32Array((new Uint8Array([ 1, 0, 0, 0 ])).buffer))[0] === 1);\n\n  if (!this.options.js && !this.options.wasm) {\n    throw new Error('mathlib: at least \"js\" or \"wasm\" should be enabled');\n  }\n}\n\n\nMultiMath.prototype.has_wasm = hasWebAssembly;\n\n\nMultiMath.prototype.use = function (module) {\n  this.__modules[module.name] = module;\n\n  // Pin the best possible implementation\n  if (this.options.wasm && this.has_wasm() && module.wasm_fn) {\n    this[module.name] = module.wasm_fn;\n  } else {\n    this[module.name] = module.fn;\n  }\n\n  return this;\n};\n\n\nMultiMath.prototype.init = function () {\n  if (this.__init_promise) return this.__init_promise;\n\n  if (!this.options.js && this.options.wasm && !this.has_wasm()) {\n    return Promise.reject(new Error('mathlib: only \"wasm\" was enabled, but it\\'s not supported'));\n  }\n\n  var self = this;\n\n  this.__init_promise = Promise.all(Object.keys(self.__modules).map(function (name) {\n    var module = self.__modules[name];\n\n    if (!self.options.wasm || !self.has_wasm() || !module.wasm_fn) return null;\n\n    // If already compiled - exit\n    if (self.__wasm[name]) return null;\n\n    // Compile wasm source\n    return WebAssembly.compile(self.__base64decode(module.wasm_src))\n      .then(function (m) { self.__wasm[name] = m; });\n  }))\n    .then(function () { return self; });\n\n  return this.__init_promise;\n};\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Methods below are for internal use from plugins\n\n\n// Simple decode base64 to typed array. Useful to load embedded webassembly\n// code. You probably don't need to call this method directly.\n//\nMultiMath.prototype.__base64decode = base64decode;\n\n\n// Increase current memory to include specified number of bytes. Do nothing if\n// size is already ok. You probably don't need to call this method directly,\n// because it will be invoked from `.__instance()`.\n//\nMultiMath.prototype.__reallocate = function mem_grow_to(bytes) {\n  if (!this.__memory) {\n    this.__memory = new WebAssembly.Memory({\n      initial: Math.ceil(bytes / (64 * 1024))\n    });\n    return this.__memory;\n  }\n\n  var mem_size = this.__memory.buffer.byteLength;\n\n  if (mem_size < bytes) {\n    this.__memory.grow(Math.ceil((bytes - mem_size) / (64 * 1024)));\n  }\n\n  return this.__memory;\n};\n\n\n// Returns instantinated webassembly item by name, with specified memory size\n// and environment.\n// - use cache if available\n// - do sync module init, if async init was not called earlier\n// - allocate memory if not enougth\n// - can export functions to webassembly via \"env_extra\",\n//   for example, { exp: Math.exp }\n//\nMultiMath.prototype.__instance = function instance(name, memsize, env_extra) {\n  if (memsize) this.__reallocate(memsize);\n\n  // If .init() was not called, do sync compile\n  if (!this.__wasm[name]) {\n    var module = this.__modules[name];\n    this.__wasm[name] = new WebAssembly.Module(this.__base64decode(module.wasm_src));\n  }\n\n  if (!this.__cache[name]) {\n    var env_base = {\n      memoryBase: 0,\n      memory: this.__memory,\n      tableBase: 0,\n      table: new WebAssembly.Table({ initial: 0, element: 'anyfunc' })\n    };\n\n    this.__cache[name] = new WebAssembly.Instance(this.__wasm[name], {\n      env: assign(env_base, env_extra || {})\n    });\n  }\n\n  return this.__cache[name];\n};\n\n\n// Helper to calculate memory aligh for pointers. Webassembly does not require\n// this, but you may wish to experiment. Default base = 8;\n//\nMultiMath.prototype.__align = function align(number, base) {\n  base = base || 8;\n  var reminder = number % base;\n  return number + (reminder ? base - reminder : 0);\n};\n\n\nmodule.exports = MultiMath;\n\n},{\"./lib/base64decode\":17,\"./lib/wa_detect\":23,\"object-assign\":24}],17:[function(_dereq_,module,exports){\n\n\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n\nmodule.exports = function base64decode(str) {\n  var input = str.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max   = input.length;\n\n  var out = new Uint8Array((max * 3) >> 2);\n\n  // Collect by 6*4 bits (3 bytes)\n\n  var bits = 0;\n  var ptr  = 0;\n\n  for (var idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      out[ptr++] = (bits >> 16) & 0xFF;\n      out[ptr++] = (bits >> 8) & 0xFF;\n      out[ptr++] = bits & 0xFF;\n    }\n\n    bits = (bits << 6) | BASE64_MAP.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  var tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    out[ptr++] = (bits >> 16) & 0xFF;\n    out[ptr++] = (bits >> 8) & 0xFF;\n    out[ptr++] = bits & 0xFF;\n  } else if (tailbits === 18) {\n    out[ptr++] = (bits >> 10) & 0xFF;\n    out[ptr++] = (bits >> 2) & 0xFF;\n  } else if (tailbits === 12) {\n    out[ptr++] = (bits >> 4) & 0xFF;\n  }\n\n  return out;\n};\n\n},{}],18:[function(_dereq_,module,exports){\n\n\nmodule.exports = function hsl_l16_js(img, width, height) {\n  var size = width * height;\n  var out = new Uint16Array(size);\n  var r, g, b, min, max;\n  for (var i = 0; i < size; i++) {\n    r = img[4 * i];\n    g = img[4 * i + 1];\n    b = img[4 * i + 2];\n    max = (r >= g && r >= b) ? r : (g >= b && g >= r) ? g : b;\n    min = (r <= g && r <= b) ? r : (g <= b && g <= r) ? g : b;\n    out[i] = (max + min) * 257 >> 1;\n  }\n  return out;\n};\n\n},{}],19:[function(_dereq_,module,exports){\n\nmodule.exports = {\n  name:     'unsharp_mask',\n  fn:       _dereq_('./unsharp_mask'),\n  wasm_fn:  _dereq_('./unsharp_mask_wasm'),\n  wasm_src: _dereq_('./unsharp_mask_wasm_base64')\n};\n\n},{\"./unsharp_mask\":20,\"./unsharp_mask_wasm\":21,\"./unsharp_mask_wasm_base64\":22}],20:[function(_dereq_,module,exports){\n\n\nvar glur_mono16 = _dereq_('glur/mono16');\nvar hsl_l16     = _dereq_('./hsl_l16');\n\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  var r, g, b;\n  var h, s, l;\n  var min, max;\n  var m1, m2, hShifted;\n  var diff, iTimes4;\n\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var lightness = hsl_l16(img, width, height);\n\n  var blured = new Uint16Array(lightness); // copy, because blur modify src\n\n  glur_mono16(blured, width, height, radius);\n\n  var amountFp = (amount / 100 * 0x1000 + 0.5)|0;\n  var thresholdFp = (threshold * 257)|0;\n\n  var size = width * height;\n\n  /* eslint-disable indent */\n  for (var i = 0; i < size; i++) {\n    diff = 2 * (lightness[i] - blured[i]);\n\n    if (Math.abs(diff) >= thresholdFp) {\n      iTimes4 = i * 4;\n      r = img[iTimes4];\n      g = img[iTimes4 + 1];\n      b = img[iTimes4 + 2];\n\n      // convert RGB to HSL\n      // take RGB, 8-bit unsigned integer per each channel\n      // save HSL, H and L are 16-bit unsigned integers, S is 12-bit unsigned integer\n      // math is taken from here: http://www.easyrgb.com/index.php?X=MATH&H=18\n      // and adopted to be integer (fixed point in fact) for sake of performance\n      max = (r >= g && r >= b) ? r : (g >= r && g >= b) ? g : b; // min and max are in [0..0xff]\n      min = (r <= g && r <= b) ? r : (g <= r && g <= b) ? g : b;\n      l = (max + min) * 257 >> 1; // l is in [0..0xffff] that is caused by multiplication by 257\n\n      if (min === max) {\n        h = s = 0;\n      } else {\n        s = (l <= 0x7fff) ?\n          (((max - min) * 0xfff) / (max + min))|0 :\n          (((max - min) * 0xfff) / (2 * 0xff - max - min))|0; // s is in [0..0xfff]\n        // h could be less 0, it will be fixed in backward conversion to RGB, |h| <= 0xffff / 6\n        h = (r === max) ? (((g - b) * 0xffff) / (6 * (max - min)))|0\n          : (g === max) ? 0x5555 + ((((b - r) * 0xffff) / (6 * (max - min)))|0) // 0x5555 == 0xffff / 3\n          : 0xaaaa + ((((r - g) * 0xffff) / (6 * (max - min)))|0); // 0xaaaa == 0xffff * 2 / 3\n      }\n\n      // add unsharp mask mask to the lightness channel\n      l += (amountFp * diff + 0x800) >> 12;\n      if (l > 0xffff) {\n        l = 0xffff;\n      } else if (l < 0) {\n        l = 0;\n      }\n\n      // convert HSL back to RGB\n      // for information about math look above\n      if (s === 0) {\n        r = g = b = l >> 8;\n      } else {\n        m2 = (l <= 0x7fff) ? (l * (0x1000 + s) + 0x800) >> 12 :\n          l  + (((0xffff - l) * s + 0x800) >>  12);\n        m1 = 2 * l - m2 >> 8;\n        m2 >>= 8;\n        // save result to RGB channels\n        // R channel\n        hShifted = (h + 0x5555) & 0xffff; // 0x5555 == 0xffff / 3\n        r = (hShifted >= 0xaaaa) ? m1 // 0xaaaa == 0xffff * 2 / 3\n          : (hShifted >= 0x7fff) ?  m1 + ((m2 - m1) * 6 * (0xaaaa - hShifted) + 0x8000 >> 16)\n          : (hShifted >= 0x2aaa) ? m2 // 0x2aaa == 0xffff / 6\n          : m1 + ((m2 - m1) * 6 * hShifted + 0x8000 >> 16);\n        // G channel\n        hShifted = h & 0xffff;\n        g = (hShifted >= 0xaaaa) ? m1 // 0xaaaa == 0xffff * 2 / 3\n          : (hShifted >= 0x7fff) ?  m1 + ((m2 - m1) * 6 * (0xaaaa - hShifted) + 0x8000 >> 16)\n          : (hShifted >= 0x2aaa) ? m2 // 0x2aaa == 0xffff / 6\n          : m1 + ((m2 - m1) * 6 * hShifted + 0x8000 >> 16);\n        // B channel\n        hShifted = (h - 0x5555) & 0xffff;\n        b = (hShifted >= 0xaaaa) ? m1 // 0xaaaa == 0xffff * 2 / 3\n          : (hShifted >= 0x7fff) ?  m1 + ((m2 - m1) * 6 * (0xaaaa - hShifted) + 0x8000 >> 16)\n          : (hShifted >= 0x2aaa) ? m2 // 0x2aaa == 0xffff / 6\n          : m1 + ((m2 - m1) * 6 * hShifted + 0x8000 >> 16);\n      }\n\n      img[iTimes4] = r;\n      img[iTimes4 + 1] = g;\n      img[iTimes4 + 2] = b;\n    }\n  }\n};\n\n},{\"./hsl_l16\":18,\"glur/mono16\":14}],21:[function(_dereq_,module,exports){\n\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var pixels = width * height;\n\n  var img_bytes_cnt        = pixels * 4;\n  var hsl_bytes_cnt        = pixels * 2;\n  var blur_bytes_cnt       = pixels * 2;\n  var blur_line_byte_cnt   = Math.max(width, height) * 4; // float32 array\n  var blur_coeffs_byte_cnt = 8 * 4; // float32 array\n\n  var img_offset         = 0;\n  var hsl_offset         = img_bytes_cnt;\n  var blur_offset        = hsl_offset + hsl_bytes_cnt;\n  var blur_tmp_offset    = blur_offset + blur_bytes_cnt;\n  var blur_line_offset   = blur_tmp_offset + blur_bytes_cnt;\n  var blur_coeffs_offset = blur_line_offset + blur_line_byte_cnt;\n\n  var instance = this.__instance(\n    'unsharp_mask',\n    img_bytes_cnt + hsl_bytes_cnt + blur_bytes_cnt * 2 + blur_line_byte_cnt + blur_coeffs_byte_cnt,\n    { exp: Math.exp }\n  );\n\n  // 32-bit copy is much faster in chrome\n  var img32 = new Uint32Array(img.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer);\n  mem32.set(img32);\n\n  // HSL\n  var fn = instance.exports.hsl_l16 || instance.exports._hsl_l16;\n  fn(img_offset, hsl_offset, width, height);\n\n  // BLUR\n  fn = instance.exports.blurMono16 || instance.exports._blurMono16;\n  fn(hsl_offset, blur_offset, blur_tmp_offset,\n    blur_line_offset, blur_coeffs_offset, width, height, radius);\n\n  // UNSHARP\n  fn = instance.exports.unsharp || instance.exports._unsharp;\n  fn(img_offset, img_offset, hsl_offset,\n    blur_offset, width, height, amount, threshold);\n\n  // 32-bit copy is much faster in chrome\n  img32.set(new Uint32Array(this.__memory.buffer, 0, pixels));\n};\n\n},{}],22:[function(_dereq_,module,exports){\n\n/* eslint-disable max-len */\nmodule.exports = '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';\n\n},{}],23:[function(_dereq_,module,exports){\n\n\nvar wa;\n\n\nmodule.exports = function hasWebAssembly() {\n  // use cache if called before;\n  if (typeof wa !== 'undefined') return wa;\n\n  wa = false;\n\n  if (typeof WebAssembly === 'undefined') return wa;\n\n  // If WebAssenbly is disabled, code can throw on compile\n  try {\n    // https://github.com/brion/min-wasm-fail/blob/master/min-wasm-fail.in.js\n    // Additional check that WA internals are correct\n\n    /* eslint-disable comma-spacing, max-len */\n    var bin      = new Uint8Array([ 0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11 ]);\n    var module   = new WebAssembly.Module(bin);\n    var instance = new WebAssembly.Instance(module, {});\n\n    // test storing to and loading from a non-zero location via a parameter.\n    // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n    if (instance.exports.test(4) !== 0) wa = true;\n\n    return wa;\n  } catch (__) {}\n\n  return wa;\n};\n\n},{}],24:[function(_dereq_,module,exports){\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n},{}],25:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],\"/index.js\":[function(_dereq_,module,exports){\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar assign = _dereq_('object-assign');\n\nvar webworkify = _dereq_('webworkify');\n\nvar MathLib = _dereq_('./lib/mathlib');\n\nvar Pool = _dereq_('./lib/pool');\n\nvar utils = _dereq_('./lib/utils');\n\nvar worker = _dereq_('./lib/worker');\n\nvar createStages = _dereq_('./lib/stepper');\n\nvar createRegions = _dereq_('./lib/tiler'); // Deduplicate pools & limiters with the same configs\n// when user creates multiple pica instances.\n\n\nvar singletones = {};\nvar NEED_SAFARI_FIX = false;\n\ntry {\n  if (typeof navigator !== 'undefined' && navigator.userAgent) {\n    NEED_SAFARI_FIX = navigator.userAgent.indexOf('Safari') >= 0;\n  }\n} catch (e) {}\n\nvar concurrency = 1;\n\nif (typeof navigator !== 'undefined') {\n  concurrency = Math.min(navigator.hardwareConcurrency || 1, 4);\n}\n\nvar DEFAULT_PICA_OPTS = {\n  tile: 1024,\n  concurrency: concurrency,\n  features: ['js', 'wasm', 'ww'],\n  idle: 2000,\n  createCanvas: function createCanvas(width, height) {\n    var tmpCanvas = document.createElement('canvas');\n    tmpCanvas.width = width;\n    tmpCanvas.height = height;\n    return tmpCanvas;\n  }\n};\nvar DEFAULT_RESIZE_OPTS = {\n  quality: 3,\n  alpha: false,\n  unsharpAmount: 0,\n  unsharpRadius: 0.0,\n  unsharpThreshold: 0\n};\nvar CAN_NEW_IMAGE_DATA;\nvar CAN_CREATE_IMAGE_BITMAP;\n\nfunction workerFabric() {\n  return {\n    value: webworkify(worker),\n    destroy: function destroy() {\n      this.value.terminate();\n\n      if (typeof window !== 'undefined') {\n        var url = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n        if (url && url.revokeObjectURL && this.value.objectURL) {\n          url.revokeObjectURL(this.value.objectURL);\n        }\n      }\n    }\n  };\n} ////////////////////////////////////////////////////////////////////////////////\n// API methods\n\n\nfunction Pica(options) {\n  if (!(this instanceof Pica)) return new Pica(options);\n  this.options = assign({}, DEFAULT_PICA_OPTS, options || {});\n  var limiter_key = \"lk_\".concat(this.options.concurrency); // Share limiters to avoid multiple parallel workers when user creates\n  // multiple pica instances.\n\n  this.__limit = singletones[limiter_key] || utils.limiter(this.options.concurrency);\n  if (!singletones[limiter_key]) singletones[limiter_key] = this.__limit; // List of supported features, according to options & browser/node.js\n\n  this.features = {\n    js: false,\n    // pure JS implementation, can be disabled for testing\n    wasm: false,\n    // webassembly implementation for heavy functions\n    cib: false,\n    // resize via createImageBitmap (only FF at this moment)\n    ww: false // webworkers\n\n  };\n  this.__workersPool = null; // Store requested features for webworkers\n\n  this.__requested_features = [];\n  this.__mathlib = null;\n}\n\nPica.prototype.init = function () {\n  var _this = this;\n\n  if (this.__initPromise) return this.__initPromise; // Test if we can create ImageData without canvas and memory copy\n\n  if (CAN_NEW_IMAGE_DATA !== false && CAN_NEW_IMAGE_DATA !== true) {\n    CAN_NEW_IMAGE_DATA = false;\n\n    if (typeof ImageData !== 'undefined' && typeof Uint8ClampedArray !== 'undefined') {\n      try {\n        /* eslint-disable no-new */\n        new ImageData(new Uint8ClampedArray(400), 10, 10);\n        CAN_NEW_IMAGE_DATA = true;\n      } catch (__) {}\n    }\n  } // ImageBitmap can be effective in 2 places:\n  //\n  // 1. Threaded jpeg unpack (basic)\n  // 2. Built-in resize (blocked due problem in chrome, see issue #89)\n  //\n  // For basic use we also need ImageBitmap wo support .close() method,\n  // see https://developer.mozilla.org/ru/docs/Web/API/ImageBitmap\n\n\n  if (CAN_CREATE_IMAGE_BITMAP !== false && CAN_CREATE_IMAGE_BITMAP !== true) {\n    CAN_CREATE_IMAGE_BITMAP = false;\n\n    if (typeof ImageBitmap !== 'undefined') {\n      if (ImageBitmap.prototype && ImageBitmap.prototype.close) {\n        CAN_CREATE_IMAGE_BITMAP = true;\n      } else {\n        this.debug('ImageBitmap does not support .close(), disabled');\n      }\n    }\n  }\n\n  var features = this.options.features.slice();\n\n  if (features.indexOf('all') >= 0) {\n    features = ['cib', 'wasm', 'js', 'ww'];\n  }\n\n  this.__requested_features = features;\n  this.__mathlib = new MathLib(features); // Check WebWorker support if requested\n\n  if (features.indexOf('ww') >= 0) {\n    if (typeof window !== 'undefined' && 'Worker' in window) {\n      // IE <= 11 don't allow to create webworkers from string. We should check it.\n      // https://connect.microsoft.com/IE/feedback/details/801810/web-workers-from-blob-urls-in-ie-10-and-11\n      try {\n        var wkr = _dereq_('webworkify')(function () {});\n\n        wkr.terminate();\n        this.features.ww = true; // pool uniqueness depends on pool config + webworker config\n\n        var wpool_key = \"wp_\".concat(JSON.stringify(this.options));\n\n        if (singletones[wpool_key]) {\n          this.__workersPool = singletones[wpool_key];\n        } else {\n          this.__workersPool = new Pool(workerFabric, this.options.idle);\n          singletones[wpool_key] = this.__workersPool;\n        }\n      } catch (__) {}\n    }\n  }\n\n  var initMath = this.__mathlib.init().then(function (mathlib) {\n    // Copy detected features\n    assign(_this.features, mathlib.features);\n  });\n\n  var checkCibResize;\n\n  if (!CAN_CREATE_IMAGE_BITMAP) {\n    checkCibResize = Promise.resolve(false);\n  } else {\n    checkCibResize = utils.cib_support(this.options.createCanvas).then(function (status) {\n      if (_this.features.cib && features.indexOf('cib') < 0) {\n        _this.debug('createImageBitmap() resize supported, but disabled by config');\n\n        return;\n      }\n\n      if (features.indexOf('cib') >= 0) _this.features.cib = status;\n    });\n  } // Init math lib. That's async because can load some\n\n\n  this.__initPromise = Promise.all([initMath, checkCibResize]).then(function () {\n    return _this;\n  });\n  return this.__initPromise;\n};\n\nPica.prototype.resize = function (from, to, options) {\n  var _this2 = this;\n\n  this.debug('Start resize...');\n  var opts = assign({}, DEFAULT_RESIZE_OPTS);\n\n  if (!isNaN(options)) {\n    opts = assign(opts, {\n      quality: options\n    });\n  } else if (options) {\n    opts = assign(opts, options);\n  }\n\n  opts.toWidth = to.width;\n  opts.toHeight = to.height;\n  opts.width = from.naturalWidth || from.width;\n  opts.height = from.naturalHeight || from.height; // Prevent stepper from infinite loop\n\n  if (to.width === 0 || to.height === 0) {\n    return Promise.reject(new Error(\"Invalid output size: \".concat(to.width, \"x\").concat(to.height)));\n  }\n\n  if (opts.unsharpRadius > 2) opts.unsharpRadius = 2;\n  var canceled = false;\n  var cancelToken = null;\n\n  if (opts.cancelToken) {\n    // Wrap cancelToken to avoid successive resolve & set flag\n    cancelToken = opts.cancelToken.then(function (data) {\n      canceled = true;\n      throw data;\n    }, function (err) {\n      canceled = true;\n      throw err;\n    });\n  }\n\n  var DEST_TILE_BORDER = 3; // Max possible filter window size\n\n  var destTileBorder = Math.ceil(Math.max(DEST_TILE_BORDER, 2.5 * opts.unsharpRadius | 0));\n  return this.init().then(function () {\n    if (canceled) return cancelToken; // if createImageBitmap supports resize, just do it and return\n\n    if (_this2.features.cib) {\n      var toCtx = to.getContext('2d', {\n        alpha: Boolean(opts.alpha)\n      });\n\n      _this2.debug('Resize via createImageBitmap()');\n\n      return createImageBitmap(from, {\n        resizeWidth: opts.toWidth,\n        resizeHeight: opts.toHeight,\n        resizeQuality: utils.cib_quality_name(opts.quality)\n      }).then(function (imageBitmap) {\n        if (canceled) return cancelToken; // if no unsharp - draw directly to output canvas\n\n        if (!opts.unsharpAmount) {\n          toCtx.drawImage(imageBitmap, 0, 0);\n          imageBitmap.close();\n          toCtx = null;\n\n          _this2.debug('Finished!');\n\n          return to;\n        }\n\n        _this2.debug('Unsharp result');\n\n        var tmpCanvas = _this2.options.createCanvas(opts.toWidth, opts.toHeight);\n\n        var tmpCtx = tmpCanvas.getContext('2d', {\n          alpha: Boolean(opts.alpha)\n        });\n        tmpCtx.drawImage(imageBitmap, 0, 0);\n        imageBitmap.close();\n        var iData = tmpCtx.getImageData(0, 0, opts.toWidth, opts.toHeight);\n\n        _this2.__mathlib.unsharp_mask(iData.data, opts.toWidth, opts.toHeight, opts.unsharpAmount, opts.unsharpRadius, opts.unsharpThreshold);\n\n        toCtx.putImageData(iData, 0, 0); // Safari 12 workaround\n        // https://github.com/nodeca/pica/issues/199\n\n        tmpCanvas.width = tmpCanvas.height = 0;\n        iData = tmpCtx = tmpCanvas = toCtx = null;\n\n        _this2.debug('Finished!');\n\n        return to;\n      });\n    } //\n    // No easy way, let's resize manually via arrays\n    //\n    // Share cache between calls:\n    //\n    // - wasm instance\n    // - wasm memory object\n    //\n\n\n    var cache = {}; // Call resizer in webworker or locally, depending on config\n\n    var invokeResize = function invokeResize(opts) {\n      return Promise.resolve().then(function () {\n        if (!_this2.features.ww) return _this2.__mathlib.resizeAndUnsharp(opts, cache);\n        return new Promise(function (resolve, reject) {\n          var w = _this2.__workersPool.acquire();\n\n          if (cancelToken) cancelToken[\"catch\"](function (err) {\n            return reject(err);\n          });\n\n          w.value.onmessage = function (ev) {\n            w.release();\n            if (ev.data.err) reject(ev.data.err);else resolve(ev.data.result);\n          };\n\n          w.value.postMessage({\n            opts: opts,\n            features: _this2.__requested_features,\n            preload: {\n              wasm_nodule: _this2.__mathlib.__\n            }\n          }, [opts.src.buffer]);\n        });\n      });\n    };\n\n    var tileAndResize = function tileAndResize(from, to, opts) {\n      var srcCtx;\n      var srcImageBitmap;\n      var isImageBitmapReused = false;\n      var toCtx;\n\n      var processTile = function processTile(tile) {\n        return _this2.__limit(function () {\n          if (canceled) return cancelToken;\n          var srcImageData; // Extract tile RGBA buffer, depending on input type\n\n          if (utils.isCanvas(from)) {\n            _this2.debug('Get tile pixel data'); // If input is Canvas - extract region data directly\n\n\n            srcImageData = srcCtx.getImageData(tile.x, tile.y, tile.width, tile.height);\n          } else {\n            // If input is Image or decoded to ImageBitmap,\n            // draw region to temporary canvas and extract data from it\n            //\n            // Note! Attempt to reuse this canvas causes significant slowdown in chrome\n            //\n            _this2.debug('Draw tile imageBitmap/image to temporary canvas');\n\n            var tmpCanvas = _this2.options.createCanvas(tile.width, tile.height);\n\n            var tmpCtx = tmpCanvas.getContext('2d', {\n              alpha: Boolean(opts.alpha)\n            });\n            tmpCtx.globalCompositeOperation = 'copy';\n            tmpCtx.drawImage(srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height, 0, 0, tile.width, tile.height);\n\n            _this2.debug('Get tile pixel data');\n\n            srcImageData = tmpCtx.getImageData(0, 0, tile.width, tile.height); // Safari 12 workaround\n            // https://github.com/nodeca/pica/issues/199\n\n            tmpCanvas.width = tmpCanvas.height = 0;\n            tmpCtx = tmpCanvas = null;\n          }\n\n          var o = {\n            src: srcImageData.data,\n            width: tile.width,\n            height: tile.height,\n            toWidth: tile.toWidth,\n            toHeight: tile.toHeight,\n            scaleX: tile.scaleX,\n            scaleY: tile.scaleY,\n            offsetX: tile.offsetX,\n            offsetY: tile.offsetY,\n            quality: opts.quality,\n            alpha: opts.alpha,\n            unsharpAmount: opts.unsharpAmount,\n            unsharpRadius: opts.unsharpRadius,\n            unsharpThreshold: opts.unsharpThreshold\n          };\n\n          _this2.debug('Invoke resize math');\n\n          return Promise.resolve().then(function () {\n            return invokeResize(o);\n          }).then(function (result) {\n            if (canceled) return cancelToken;\n            srcImageData = null;\n            var toImageData;\n\n            _this2.debug('Convert raw rgba tile result to ImageData');\n\n            if (CAN_NEW_IMAGE_DATA) {\n              // this branch is for modern browsers\n              // If `new ImageData()` & Uint8ClampedArray suported\n              toImageData = new ImageData(new Uint8ClampedArray(result), tile.toWidth, tile.toHeight);\n            } else {\n              // fallback for `node-canvas` and old browsers\n              // (IE11 has ImageData but does not support `new ImageData()`)\n              toImageData = toCtx.createImageData(tile.toWidth, tile.toHeight);\n\n              if (toImageData.data.set) {\n                toImageData.data.set(result);\n              } else {\n                // IE9 don't have `.set()`\n                for (var i = toImageData.data.length - 1; i >= 0; i--) {\n                  toImageData.data[i] = result[i];\n                }\n              }\n            }\n\n            _this2.debug('Draw tile');\n\n            if (NEED_SAFARI_FIX) {\n              // Safari draws thin white stripes between tiles without this fix\n              toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth + 1e-5, tile.toInnerHeight + 1e-5);\n            } else {\n              toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth, tile.toInnerHeight);\n            }\n\n            return null;\n          });\n        });\n      }; // Need to normalize data source first. It can be canvas or image.\n      // If image - try to decode in background if possible\n\n\n      return Promise.resolve().then(function () {\n        toCtx = to.getContext('2d', {\n          alpha: Boolean(opts.alpha)\n        });\n\n        if (utils.isCanvas(from)) {\n          srcCtx = from.getContext('2d', {\n            alpha: Boolean(opts.alpha)\n          });\n          return null;\n        }\n\n        if (utils.isImageBitmap(from)) {\n          srcImageBitmap = from;\n          isImageBitmapReused = true;\n          return null;\n        }\n\n        if (utils.isImage(from)) {\n          // try do decode image in background for faster next operations\n          if (!CAN_CREATE_IMAGE_BITMAP) return null;\n\n          _this2.debug('Decode image via createImageBitmap');\n\n          return createImageBitmap(from).then(function (imageBitmap) {\n            srcImageBitmap = imageBitmap;\n          }) // Suppress error to use fallback, if method fails\n          // https://github.com/nodeca/pica/issues/190\n\n          /* eslint-disable no-unused-vars */\n          [\"catch\"](function (e) {\n            return null;\n          });\n        }\n\n        throw new Error('Pica: \".from\" should be Image, Canvas or ImageBitmap');\n      }).then(function () {\n        if (canceled) return cancelToken;\n\n        _this2.debug('Calculate tiles'); //\n        // Here we are with \"normalized\" source,\n        // follow to tiling\n        //\n\n\n        var regions = createRegions({\n          width: opts.width,\n          height: opts.height,\n          srcTileSize: _this2.options.tile,\n          toWidth: opts.toWidth,\n          toHeight: opts.toHeight,\n          destTileBorder: destTileBorder\n        });\n        var jobs = regions.map(function (tile) {\n          return processTile(tile);\n        });\n\n        function cleanup() {\n          if (srcImageBitmap) {\n            if (!isImageBitmapReused) srcImageBitmap.close();\n            srcImageBitmap = null;\n          }\n        }\n\n        _this2.debug('Process tiles');\n\n        return Promise.all(jobs).then(function () {\n          _this2.debug('Finished!');\n\n          cleanup();\n          return to;\n        }, function (err) {\n          cleanup();\n          throw err;\n        });\n      });\n    };\n\n    var processStages = function processStages(stages, from, to, opts) {\n      if (canceled) return cancelToken;\n\n      var _stages$shift = stages.shift(),\n          _stages$shift2 = _slicedToArray(_stages$shift, 2),\n          toWidth = _stages$shift2[0],\n          toHeight = _stages$shift2[1];\n\n      var isLastStage = stages.length === 0;\n      opts = assign({}, opts, {\n        toWidth: toWidth,\n        toHeight: toHeight,\n        // only use user-defined quality for the last stage,\n        // use simpler (Hamming) filter for the first stages where\n        // scale factor is large enough (more than 2-3)\n        quality: isLastStage ? opts.quality : Math.min(1, opts.quality)\n      });\n      var tmpCanvas;\n\n      if (!isLastStage) {\n        // create temporary canvas\n        tmpCanvas = _this2.options.createCanvas(toWidth, toHeight);\n      }\n\n      return tileAndResize(from, isLastStage ? to : tmpCanvas, opts).then(function () {\n        if (isLastStage) return to;\n        opts.width = toWidth;\n        opts.height = toHeight;\n        return processStages(stages, tmpCanvas, to, opts);\n      }).then(function (res) {\n        if (tmpCanvas) {\n          // Safari 12 workaround\n          // https://github.com/nodeca/pica/issues/199\n          tmpCanvas.width = tmpCanvas.height = 0;\n        }\n\n        return res;\n      });\n    };\n\n    var stages = createStages(opts.width, opts.height, opts.toWidth, opts.toHeight, _this2.options.tile, destTileBorder);\n    return processStages(stages, from, to, opts);\n  });\n}; // RGBA buffer resize\n//\n\n\nPica.prototype.resizeBuffer = function (options) {\n  var _this3 = this;\n\n  var opts = assign({}, DEFAULT_RESIZE_OPTS, options);\n  return this.init().then(function () {\n    return _this3.__mathlib.resizeAndUnsharp(opts);\n  });\n};\n\nPica.prototype.toBlob = function (canvas, mimeType, quality) {\n  mimeType = mimeType || 'image/png';\n  return new Promise(function (resolve) {\n    if (canvas.toBlob) {\n      canvas.toBlob(function (blob) {\n        return resolve(blob);\n      }, mimeType, quality);\n      return;\n    }\n\n    if (canvas.convertToBlob) {\n      resolve(canvas.convertToBlob({\n        type: mimeType,\n        quality: quality\n      }));\n      return;\n    } // Fallback for old browsers\n\n\n    var asString = atob(canvas.toDataURL(mimeType, quality).split(',')[1]);\n    var len = asString.length;\n    var asBuffer = new Uint8Array(len);\n\n    for (var i = 0; i < len; i++) {\n      asBuffer[i] = asString.charCodeAt(i);\n    }\n\n    resolve(new Blob([asBuffer], {\n      type: mimeType\n    }));\n  });\n};\n\nPica.prototype.debug = function () {};\n\nmodule.exports = Pica;\n\n},{\"./lib/mathlib\":1,\"./lib/pool\":9,\"./lib/stepper\":10,\"./lib/tiler\":11,\"./lib/utils\":12,\"./lib/worker\":13,\"object-assign\":24,\"webworkify\":25}]},{},[])(\"/index.js\")\n});\n});\n\nvar image_traverse = createCommonjsModule(function (module) {\n\n//////////////////////////////////////////////////////////////////////////\n// Helpers\n//\nfunction error(message, code) {\n  var err = new Error(message);\n  err.code = code;\n  return err;\n}\n\n\n// Convert number to 0xHH string\n//\nfunction to_hex(number) {\n  var n = number.toString(16).toUpperCase();\n  for (var i = 2 - n.length; i > 0; i--) n = '0' + n;\n  return '0x' + n;\n}\n\n\nfunction utf8_encode(str) {\n  try {\n    return unescape(encodeURIComponent(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\nfunction utf8_decode(str) {\n  try {\n    return decodeURIComponent(escape(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\n// Check if input is a Uint8Array\n//\nfunction is_uint8array(bin) {\n  return Object.prototype.toString.call(bin) === '[object Uint8Array]';\n}\n\n\n//////////////////////////////////////////////////////////////////////////\n// Exif parser\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - exif_start: Number     - start of TIFF header (after Exif\\0\\0)\n//  - exif_end:   Number     - end of Exif segment\n//  - on_entry:   Number     - callback\n//\nfunction ExifParser(jpeg_bin, exif_start, exif_end) {\n  // Uint8Array, exif without signature (which isn't included in offsets)\n  this.input      = jpeg_bin.subarray(exif_start, exif_end);\n\n  // offset correction for `on_entry` callback\n  this.start      = exif_start;\n\n  // Check TIFF header (includes byte alignment and first IFD offset)\n  var sig = String.fromCharCode.apply(null, this.input.subarray(0, 4));\n\n  if (sig !== 'II\\x2A\\0' && sig !== 'MM\\0\\x2A') {\n    throw error('invalid TIFF signature', 'EBADDATA');\n  }\n\n  // true if motorola (big endian) byte alignment, false if intel\n  this.big_endian = sig[0] === 'M';\n}\n\n\nExifParser.prototype.each = function (on_entry) {\n  // allow premature exit\n  this.aborted = false;\n\n  var offset = this.read_uint32(4);\n\n  this.ifds_to_read = [ {\n    id:     0,\n    offset: offset\n  } ];\n\n  while (this.ifds_to_read.length > 0 && !this.aborted) {\n    var i = this.ifds_to_read.shift();\n    if (!i.offset) continue;\n    this.scan_ifd(i.id, i.offset, on_entry);\n  }\n};\n\n\nExifParser.prototype.filter = function (on_entry) {\n  var ifds = {};\n\n  // make sure IFD0 always exists\n  ifds.ifd0 = { id: 0, entries: [] };\n\n  this.each(function (entry) {\n    if (on_entry(entry) === false && !entry.is_subifd_link) return;\n    if (entry.is_subifd_link && entry.count !== 1 && entry.format !== 4) return; // filter out bogus links\n\n    if (!ifds['ifd' + entry.ifd]) {\n      ifds['ifd' + entry.ifd] = { id: entry.ifd, entries: [] };\n    }\n\n    ifds['ifd' + entry.ifd].entries.push(entry);\n  });\n\n  // thumbnails are not supported just yet, so delete all information related to it\n  delete ifds.ifd1;\n\n  // Calculate output size\n  var length = 8;\n  Object.keys(ifds).forEach(function (ifd_no) {\n    length += 2;\n\n    ifds[ifd_no].entries.forEach(function (entry) {\n      length += 12 + (entry.data_length > 4 ? Math.ceil(entry.data_length / 2) * 2 : 0);\n    });\n\n    length += 4;\n  });\n\n  this.output = new Uint8Array(length);\n  this.output[0] = this.output[1] = (this.big_endian ? 'M' : 'I').charCodeAt(0);\n  this.write_uint16(2, 0x2A);\n\n  var offset = 8;\n  var self = this;\n  this.write_uint32(4, offset);\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    ifds[ifd_no].written_offset = offset;\n\n    var ifd_start = offset;\n    var ifd_end   = ifd_start + 2 + ifds[ifd_no].entries.length * 12 + 4;\n    offset = ifd_end;\n\n    self.write_uint16(ifd_start, ifds[ifd_no].entries.length);\n\n    ifds[ifd_no].entries.sort(function (a, b) {\n      // IFD entries must be in order of increasing tag IDs\n      return a.tag - b.tag;\n    }).forEach(function (entry, idx) {\n      var entry_offset = ifd_start + 2 + idx * 12;\n\n      self.write_uint16(entry_offset, entry.tag);\n      self.write_uint16(entry_offset + 2, entry.format);\n      self.write_uint32(entry_offset + 4, entry.count);\n\n      if (entry.is_subifd_link) {\n        // filled in later\n        if (ifds['ifd' + entry.tag]) ifds['ifd' + entry.tag].link_offset = entry_offset + 8;\n      } else if (entry.data_length <= 4) {\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + 4),\n          entry_offset + 8\n        );\n      } else {\n        self.write_uint32(entry_offset + 8, offset);\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + entry.data_length),\n          offset\n        );\n        offset += Math.ceil(entry.data_length / 2) * 2;\n      }\n    });\n\n    var next_ifd = ifds['ifd' + (ifds[ifd_no].id + 1)];\n    if (next_ifd) next_ifd.link_offset = ifd_end - 4;\n  });\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    if (ifds[ifd_no].written_offset && ifds[ifd_no].link_offset) {\n      self.write_uint32(ifds[ifd_no].link_offset, ifds[ifd_no].written_offset);\n    }\n  });\n\n  if (this.output.length !== offset) throw error('internal error: incorrect buffer size allocated');\n\n  return this.output;\n};\n\n\nExifParser.prototype.read_uint16 = function (offset) {\n  var d = this.input;\n  if (offset + 2 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x100 + d[offset + 1] :\n    d[offset] + d[offset + 1] * 0x100;\n};\n\n\nExifParser.prototype.read_uint32 = function (offset) {\n  var d = this.input;\n  if (offset + 4 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x1000000 + d[offset + 1] * 0x10000 + d[offset + 2] * 0x100 + d[offset + 3] :\n    d[offset] + d[offset + 1] * 0x100 + d[offset + 2] * 0x10000 + d[offset + 3] * 0x1000000;\n};\n\n\nExifParser.prototype.write_uint16 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 8) & 0xFF;\n    d[offset + 1] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.write_uint32 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 24) & 0xFF;\n    d[offset + 1] = (value >>> 16) & 0xFF;\n    d[offset + 2] = (value >>> 8) & 0xFF;\n    d[offset + 3] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n    d[offset + 2] = (value >>> 16) & 0xFF;\n    d[offset + 3] = (value >>> 24) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.is_subifd_link = function (ifd, tag) {\n  return (ifd === 0 && tag === 0x8769) || // SubIFD\n         (ifd === 0 && tag === 0x8825) || // GPS Info\n         (ifd === 0x8769 && tag === 0xA005); // Interop IFD\n};\n\n\n// Returns byte length of a single component of a given format\n//\nExifParser.prototype.exif_format_length = function (format) {\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n    case 6: // sbyte\n    case 7: // undefined\n      return 1;\n\n    case 3: // short\n    case 8: // sshort\n      return 2;\n\n    case 4:  // long\n    case 9:  // slong\n    case 11: // float\n      return 4;\n\n    case 5:  // rational\n    case 10: // srational\n    case 12: // double\n      return 8;\n\n    default:\n      // unknown type\n      return 0;\n  }\n};\n\n\n// Reads Exif data\n//\nExifParser.prototype.exif_format_read = function (format, offset) {\n  var v;\n\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n      v = this.input[offset];\n      return v;\n\n    case 6: // sbyte\n      v = this.input[offset];\n      return v | (v & 0x80) * 0x1fffffe;\n\n    case 3: // short\n      v = this.read_uint16(offset);\n      return v;\n\n    case 8: // sshort\n      v = this.read_uint16(offset);\n      return v | (v & 0x8000) * 0x1fffe;\n\n    case 4: // long\n      v = this.read_uint32(offset);\n      return v;\n\n    case 9: // slong\n      v = this.read_uint32(offset);\n      return v | 0;\n\n    case 5:  // rational\n    case 10: // srational\n    case 11: // float\n    case 12: // double\n      return null; // not implemented\n\n    case 7: // undefined\n      return null; // blob\n\n    default:\n      // unknown type\n      return null;\n  }\n};\n\n\nExifParser.prototype.scan_ifd = function (ifd_no, offset, on_entry) {\n  var entry_count = this.read_uint16(offset);\n\n  offset += 2;\n\n  for (var i = 0; i < entry_count; i++) {\n    var tag    = this.read_uint16(offset);\n    var format = this.read_uint16(offset + 2);\n    var count  = this.read_uint32(offset + 4);\n\n    var comp_length    = this.exif_format_length(format);\n    var data_length    = count * comp_length;\n    var data_offset    = data_length <= 4 ? offset + 8 : this.read_uint32(offset + 8);\n    var is_subifd_link = false;\n\n    if (data_offset + data_length > this.input.length) {\n      throw error('unexpected EOF', 'EBADDATA');\n    }\n\n    var value = [];\n    var comp_offset = data_offset;\n\n    for (var j = 0; j < count; j++, comp_offset += comp_length) {\n      var item = this.exif_format_read(format, comp_offset);\n      if (item === null) {\n        value = null;\n        break;\n      }\n      value.push(item);\n    }\n\n    if (Array.isArray(value) && format === 2) {\n      try {\n        value = utf8_decode(String.fromCharCode.apply(null, value));\n      } catch (_) {\n        value = null;\n      }\n\n      if (value && value[value.length - 1] === '\\0') value = value.slice(0, -1);\n    }\n\n    if (this.is_subifd_link(ifd_no, tag)) {\n      if (Array.isArray(value) && Number.isInteger(value[0]) && value[0] > 0) {\n        this.ifds_to_read.push({\n          id:     tag,\n          offset: value[0]\n        });\n        is_subifd_link = true;\n      }\n    }\n\n    var entry = {\n      is_big_endian:  this.big_endian,\n      ifd:            ifd_no,\n      tag:            tag,\n      format:         format,\n      count:          count,\n      entry_offset:   offset + this.start,\n      data_length:    data_length,\n      data_offset:    data_offset + this.start,\n      value:          value,\n      is_subifd_link: is_subifd_link\n    };\n\n    if (on_entry(entry) === false) {\n      this.aborted = true;\n      return;\n    }\n\n    offset += 12;\n  }\n\n  if (ifd_no === 0) {\n    this.ifds_to_read.push({\n      id:     1,\n      offset: this.read_uint32(offset)\n    });\n  }\n};\n\n\n// Check whether input is a JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//\n// Returns true if it is and false otherwise\n//\nmodule.exports.is_jpeg = function (jpeg_bin) {\n  return jpeg_bin.length >= 4 && jpeg_bin[0] === 0xFF && jpeg_bin[1] === 0xD8 && jpeg_bin[2] === 0xFF;\n};\n\n\n// Call an iterator on each segment in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// Iteration stops when `EOI` (0xFFD9) marker is reached or if `on_segment`\n// function returns `false`.\n//\nmodule.exports.jpeg_segments_each = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  if (!module.exports.is_jpeg(jpeg_bin)) {\n    throw error('Unknown file format', 'ENOTJPEG');\n  }\n\n  var offset = 0, length = jpeg_bin.length, inside_scan = false;\n\n  for (;;) {\n    var segment_code, segment_length;\n\n    if (offset + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n    var byte1 = jpeg_bin[offset];\n    var byte2 = jpeg_bin[offset + 1];\n\n    if (byte1 === 0xFF && byte2 === 0xFF) {\n      // padding\n      segment_code = 0xFF;\n      segment_length = 1;\n\n    } else if (byte1 === 0xFF && byte2 !== 0) {\n      // marker\n      segment_code = byte2;\n      segment_length = 2;\n\n      if ((0xD0 <= segment_code && segment_code <= 0xD9) || segment_code === 0x01) ; else {\n        if (offset + 3 >= length) throw error('Unexpected EOF', 'EBADDATA');\n        segment_length += jpeg_bin[offset + 2] * 0x100 + jpeg_bin[offset + 3];\n        if (segment_length < 2) throw error('Invalid segment length', 'EBADDATA');\n        if (offset + segment_length - 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n      }\n\n      if (inside_scan) {\n        if (segment_code >= 0xD0 && segment_code <= 0xD7) ; else {\n          inside_scan = false;\n        }\n      }\n\n      if (segment_code === 0xDA /* SOS */) inside_scan = true;\n    } else if (inside_scan) {\n      // entropy-encoded segment\n      for (var pos = offset + 1; ; pos++) {\n        // scan until we find FF\n        if (pos >= length) throw error('Unexpected EOF', 'EBADDATA');\n        if (jpeg_bin[pos] === 0xFF) {\n          if (pos + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n          if (jpeg_bin[pos + 1] !== 0) {\n            segment_code = 0;\n            segment_length = pos - offset;\n            break;\n          }\n        }\n      }\n    } else {\n      throw error('Unexpected byte at segment start: ' + to_hex(byte1) +\n        ' (offset ' + to_hex(offset) + ')', 'EBADDATA');\n    }\n\n    if (on_segment({ code: segment_code, offset: offset, length: segment_length }) === false) break;\n    if (segment_code === 0xD9 /* EOI */) break;\n    offset += segment_length;\n  }\n};\n\n\n// Replace or remove segments in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// `on_segment` function should return one of the following:\n//  - `false`        - segment is removed from the output\n//  - Uint8Array     - segment is replaced with the new data\n//  - [ Uint8Array ] - segment is replaced with the new data\n//  - anything else  - segment is copied to the output as is\n//\n// Any data after `EOI` (0xFFD9) marker is removed.\n//\nmodule.exports.jpeg_segments_filter = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  var ranges = [];\n  var out_length = 0;\n\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    var new_segment = on_segment(segment);\n\n    if (is_uint8array(new_segment)) {\n      ranges.push({ data: new_segment });\n      out_length += new_segment.length;\n    } else if (Array.isArray(new_segment)) {\n      new_segment.filter(is_uint8array).forEach(function (s) {\n        ranges.push({ data: s });\n        out_length += s.length;\n      });\n    } else if (new_segment !== false) {\n      var new_range = { start: segment.offset, end: segment.offset + segment.length };\n\n      if (ranges.length > 0 && ranges[ranges.length - 1].end === new_range.start) {\n        ranges[ranges.length - 1].end = new_range.end;\n      } else {\n        ranges.push(new_range);\n      }\n\n      out_length += segment.length;\n    }\n  });\n\n  var result = new Uint8Array(out_length);\n  var offset = 0;\n\n  ranges.forEach(function (range) {\n    var data = range.data || jpeg_bin.subarray(range.start, range.end);\n    result.set(data, offset);\n    offset += data.length;\n  });\n\n  return result;\n};\n\n\n// Call an iterator on each Exif entry in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                 0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                 (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// Iteration stops early if iterator returns `false`.\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed.\n//\nmodule.exports.jpeg_exif_tags_each = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  /* eslint-disable consistent-return */\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    if (segment.code === 0xDA /* SOS */) return false;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length).each(on_exif_entry);\n      return false;\n    }\n  });\n};\n\n\n// Remove Exif entries in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                  0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                  (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// This function removes following from Exif:\n//  - all entries where iterator returned false (except subifd links which are mandatory)\n//  - IFD1 and thumbnail image (the purpose of this function is to reduce file size,\n//    so thumbnail is usually the first thing to go)\n//  - all other data that isn't in IFD0, SubIFD, GPSIFD, InteropIFD\n//    (theoretically possible proprietary extensions, I haven't seen any of these yet)\n//\n// Changing data inside Exif entries is NOT supported yet (modifying `entry` object inside callback may break stuff).\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed, and original JPEG is returned as is.\n//\nmodule.exports.jpeg_exif_tags_filter = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  var stop_search = false;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    if (stop_search) return;\n    if (segment.code === 0xDA /* SOS */) stop_search = true;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      var new_exif = new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length)\n        .filter(on_exif_entry);\n      if (!new_exif) return false;\n\n      var header = new Uint8Array(10);\n\n      header.set(jpeg_bin.slice(segment.offset, segment.offset + 10));\n      header[2] = ((new_exif.length + 8) >>> 8) & 0xFF;\n      header[3] = (new_exif.length + 8) & 0xFF;\n\n      stop_search = true;\n      return [ header, new_exif ];\n    }\n  });\n};\n\n\n// Inserts a custom comment marker segment into JPEG file.\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - comment:  String\n//\n// Comment is inserted after first two bytes (FFD8, SOI).\n//\n// If JFIF (APP0) marker exists immediately after SOI (as mandated by the JFIF\n// spec), we insert comment after it instead.\n//\nmodule.exports.jpeg_add_comment = function (jpeg_bin, comment) {\n  var comment_inserted = false, segment_count = 0;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    segment_count++;\n    if (segment_count === 1 && segment.code === 0xD8 /* SOI  */) return;\n    if (segment_count === 2 && segment.code === 0xE0 /* APP0 */) return;\n\n    if (comment_inserted) return;\n    comment = utf8_encode(comment);\n\n    // comment segment\n    var csegment = new Uint8Array(5 + comment.length);\n    var offset = 0;\n\n    csegment[offset++] = 0xFF;\n    csegment[offset++] = 0xFE;\n    csegment[offset++] = ((comment.length + 3) >>> 8) & 0xFF;\n    csegment[offset++] = (comment.length + 3) & 0xFF;\n\n    comment.split('').forEach(function (c) {\n      csegment[offset++] = c.charCodeAt(0) & 0xFF;\n    });\n\n    csegment[offset++] = 0;\n    comment_inserted = true;\n\n    return [ csegment, jpeg_bin.subarray(segment.offset, segment.offset + segment.length) ];\n  });\n};\n});\n\nfunction jpeg_patch_exif(env) {\n  return this._getUint8Array(env.blob).then(function (data) {\n    env.is_jpeg = image_traverse.is_jpeg(data);\n\n    if (!env.is_jpeg) return Promise.resolve(env);\n\n    env.orig_blob = env.blob;\n\n    try {\n      var exif_is_big_endian, orientation_offset;\n\n      /* eslint-disable consistent-return */\n      image_traverse.jpeg_exif_tags_each(data, function (entry) {\n        if (entry.ifd === 0 && entry.tag === 0x112 && Array.isArray(entry.value)) {\n          env.orientation    = entry.value[0] || 1;\n          exif_is_big_endian = entry.big_endian;\n          orientation_offset = entry.data_offset;\n          return false;\n        }\n      });\n\n      if (orientation_offset) {\n        var orientation_patch = exif_is_big_endian ?\n          new Uint8Array([ 0, 1 ]) :\n          new Uint8Array([ 1, 0 ]);\n\n        env.blob = new Blob([\n          data.slice(0, orientation_offset),\n          orientation_patch,\n          data.slice(orientation_offset + 2)\n        ], { type: 'image/jpeg' });\n      }\n    } catch (_) {}\n\n    return env;\n  });\n}\n\n\nfunction jpeg_rotate_canvas(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  var orientation = env.orientation - 1;\n  if (!orientation) return Promise.resolve(env);\n\n  var canvas;\n\n  if (orientation & 4) {\n    canvas = this.pica.options.createCanvas(env.out_canvas.height, env.out_canvas.width);\n  } else {\n    canvas = this.pica.options.createCanvas(env.out_canvas.width, env.out_canvas.height);\n  }\n\n  var ctx = canvas.getContext('2d');\n\n  ctx.save();\n\n  if (orientation & 1) ctx.transform(-1, 0, 0, 1, canvas.width, 0);\n  if (orientation & 2) ctx.transform(-1, 0, 0, -1, canvas.width, canvas.height);\n  if (orientation & 4) ctx.transform(0, 1, 1, 0, 0, 0);\n\n  ctx.drawImage(env.out_canvas, 0, 0);\n  ctx.restore();\n\n  // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n  env.out_canvas.width = env.out_canvas.height = 0;\n\n  env.out_canvas = canvas;\n\n  return Promise.resolve(env);\n}\n\n\nfunction jpeg_attach_orig_segments(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  return Promise.all([\n    this._getUint8Array(env.blob),\n    this._getUint8Array(env.out_blob)\n  ]).then(function (res) {\n    var data = res[0];\n    var data_out = res[1];\n\n    if (image_traverse.is_jpeg(data_out)) return Promise.resolve(env);\n\n    var segments = [];\n\n    image_traverse.jpeg_segments_each(data, function (segment) {\n      if (segment.code === 0xDA /* SOS */) return false;\n      segments.push(segment);\n    });\n\n    segments = segments\n      .filter(function (segment) {\n        if (segment.code === 0xE2) {\n          var hdr = data.slice(segment.offset + 4, segment.offset + 11);\n          if (String.fromCharCode.apply(hdr) === 'ICC_PROFILE') {\n            return false;\n          }\n        }\n\n        // Keep all APPn segments excluding APP2 (ICC_PROFILE),\n        // remove others because most of them depend on image data (DCT and such).\n        //\n        // APP0 - JFIF, APP1 - Exif, the rest are photoshop metadata and such\n        //\n        // See full list at https://www.w3.org/Graphics/JPEG/itu-t81.pdf (table B.1 on page 32)\n        //\n        if (segment.code >= 0xE0 && segment.code < 0xF0) return true;\n\n        // Keep comments\n        //\n        if (segment.code === 0xFE) return true;\n\n        return false;\n      })\n      .map(function (segment) {\n        return data.slice(segment.offset, segment.offset + segment.length);\n      });\n\n    env.blob = new Blob(\n      [ data.slice(0, 20) ].concat(segments).concat([ data.slice(20) ]),\n      { type: 'image/jpeg' }\n    );\n\n    return env;\n  });\n}\n\n\nfunction assign$1(reducer) {\n  reducer.before('_blob_to_image', jpeg_patch_exif);\n  reducer.after('_transform',      jpeg_rotate_canvas);\n  reducer.after('_create_blob',    jpeg_attach_orig_segments);\n}\n\n\nvar jpeg_patch_exif_1 = jpeg_patch_exif;\nvar jpeg_rotate_canvas_1 = jpeg_rotate_canvas;\nvar jpeg_attach_orig_segments_1 = jpeg_attach_orig_segments;\nvar assign_1 = assign$1;\n\nvar jpeg_plugins = {\n\tjpeg_patch_exif: jpeg_patch_exif_1,\n\tjpeg_rotate_canvas: jpeg_rotate_canvas_1,\n\tjpeg_attach_orig_segments: jpeg_attach_orig_segments_1,\n\tassign: assign_1\n};\n\nfunction ImageBlobReduce(options) {\n  if (!(this instanceof ImageBlobReduce)) return new ImageBlobReduce(options);\n\n  options = options || {};\n\n  this.pica = options.pica || pica({});\n  this.initialized = false;\n\n  this.utils = utils;\n}\n\n\nImageBlobReduce.prototype.use = function (plugin /*, params, ... */) {\n  var args = [ this ].concat(Array.prototype.slice.call(arguments, 1));\n  plugin.apply(plugin, args);\n  return this;\n};\n\n\nImageBlobReduce.prototype.init = function () {\n  this.use(jpeg_plugins.assign);\n};\n\n\nImageBlobReduce.prototype.toBlob = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(this._create_blob)\n    .then(function (_env) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      _env.out_canvas.width = _env.out_canvas.height = 0;\n\n      return _env.out_blob;\n    });\n};\n\n\nImageBlobReduce.prototype.toCanvas = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(function (_env) { return _env.out_canvas; });\n};\n\n\nImageBlobReduce.prototype.before = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return fn.call(self, env).then(function (_env) {\n      return old_fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype.after = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return old_fn.call(self, env).then(function (_env) {\n      return fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype._blob_to_image = function (env) {\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n  env.image = document.createElement('img');\n  env.image_url = URL.createObjectURL(env.blob);\n  env.image.src = env.image_url;\n\n  return new Promise(function (resolve, reject) {\n    env.image.onerror = function () { reject(new Error('ImageBlobReduce: failed to create Image() from blob')); };\n    env.image.onload = function () { resolve(env); };\n  });\n};\n\n\nImageBlobReduce.prototype._calculate_size = function (env) {\n  //\n  // Note, if your need not \"symmetric\" resize logic, you MUST check\n  // `env.orientation` (set by plugins) and swap width/height appropriately.\n  //\n  var scale_factor = env.opts.max / Math.max(env.image.width, env.image.height);\n\n  if (scale_factor > 1) scale_factor = 1;\n\n  env.transform_width = Math.max(Math.round(env.image.width * scale_factor), 1);\n  env.transform_height = Math.max(Math.round(env.image.height * scale_factor), 1);\n\n  // Info for user plugins, to check if scaling applied\n  env.scale_factor = scale_factor;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._transform = function (env) {\n  env.out_canvas = this.pica.options.createCanvas(env.transform_width, env.transform_height);\n\n  // Dim env temporary vars to prohibit use and avoid confusion when orientation\n  // changed. You should take real size from canvas.\n  env.transform_width = null;\n  env.transform_height = null;\n\n  // By default use alpha for png only\n  var pica_opts = { alpha: env.blob.type === 'image/png' };\n\n  // Extract pica options if been passed\n  this.utils.assign(pica_opts, this.utils.pick_pica_resize_options(env.opts));\n\n  return this.pica\n    .resize(env.image, env.out_canvas, pica_opts)\n    .then(function () { return env; });\n};\n\n\nImageBlobReduce.prototype._cleanup = function (env) {\n  env.image.src = '';\n  env.image = null;\n\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n  if (URL.revokeObjectURL) URL.revokeObjectURL(env.image_url);\n\n  env.image_url = null;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._create_blob = function (env) {\n  return this.pica.toBlob(env.out_canvas, env.blob.type)\n    .then(function (blob) {\n      env.out_blob = blob;\n      return env;\n    });\n};\n\n\nImageBlobReduce.prototype._getUint8Array = function (blob) {\n  if (blob.arrayBuffer) {\n    return blob.arrayBuffer().then(function (buf) {\n      return new Uint8Array(buf);\n    });\n  }\n\n  return new Promise(function (resolve, reject) {\n    var fr = new FileReader();\n\n    fr.readAsArrayBuffer(blob);\n\n    fr.onload = function () { resolve(new Uint8Array(fr.result)); };\n    fr.onerror = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob'));\n      fr.abort();\n    };\n    fr.onabort = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob (aborted)'));\n    };\n  });\n};\n\n\nImageBlobReduce.pica = pica;\n\nvar imageBlobReduce = ImageBlobReduce;\n\nexport default imageBlobReduce;\n","import { Injectable } from '@angular/core';\nimport { RxCollection } from 'rxdb';\nimport { defer, forkJoin, Observable } from 'rxjs';\nimport { concatMap, first, map, pluck, shareReplay } from 'rxjs/operators';\nimport { sha256WithBlob } from '../../utils/crypto';\nimport { getCurrentPositionOrUndefined } from '../../utils/geolocation';\nimport { Database } from '../database/database.service';\nimport { MemontIndex, Moment, schema } from './moment';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class MomentRepository {\n  private readonly collection$: Observable<\n    RxCollection<MemontIndex>\n  > = this.database.main$.pipe(\n    concatMap(database =>\n      database.addCollections({\n        [COLLECTION_NAME]: { schema },\n      })\n    ),\n    pluck(COLLECTION_NAME),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n\n  readonly all$ = this.collection$.pipe(\n    concatMap(c => c.find().sort({ timestamp: 'desc' }).$),\n    map(documents => documents.map(d => new Moment(d)))\n  );\n\n  constructor(private readonly database: Database) {}\n\n  add$(photo: Blob) {\n    return defer(() =>\n      forkJoin([\n        this.collection$.pipe(first()),\n        sha256WithBlob(photo),\n        getCurrentPositionOrUndefined(),\n      ])\n    ).pipe(\n      concatMap(([collection, id, geolocationPosition]) =>\n        collection.atomicUpsert({\n          id,\n          timestamp: Date.now(),\n          geolocationPosition: geolocationPosition\n            ? {\n                latitude: geolocationPosition.coords.latitude,\n                longitude: geolocationPosition.coords.longitude,\n              }\n            : undefined,\n        })\n      ),\n      concatMap(document =>\n        document.putAttachment(\n          { id: Moment.PHOTO_ATTACHMENT_ID, data: photo, type: photo.type },\n          true\n        )\n      ),\n      map(attachment => attachment.doc)\n    );\n  }\n\n  remove$(id: string) {\n    return this.collection$.pipe(concatMap(c => c.bulkRemove([id])));\n  }\n}\n\nconst COLLECTION_NAME = 'moments';\n","import { Component, Input } from '@angular/core';\nimport { ToastController } from '@ionic/angular';\nimport { TranslocoService } from '@ngneat/transloco';\n\n@Component({\n  selector: 'app-copy-clipboard',\n  templateUrl: './copy-clipboard.component.html',\n  styleUrls: ['./copy-clipboard.component.scss'],\n})\nexport class CopyClipboardComponent {\n  @Input()\n  text?: string;\n\n  constructor(\n    private readonly toastController: ToastController,\n    private readonly translocoService: TranslocoService\n  ) {}\n\n  async copy() {\n    if (!this.text) return;\n    const payload = this.text;\n    const listener = (e: ClipboardEvent) => {\n      const clipboard = e.clipboardData;\n      clipboard?.setData('text', payload.toString());\n      e.preventDefault();\n    };\n\n    document.addEventListener('copy', listener, false);\n    document.execCommand('copy');\n    document.removeEventListener('copy', listener, false);\n    return this.presentToast();\n  }\n\n  async presentToast() {\n    const toast = await this.toastController.create({\n      message: this.translocoService.translate('message.copiedToClipboard'),\n      duration: 2000,\n    });\n    return toast.present();\n  }\n}\n","<ion-button (click)=\"copy()\" fill=\"clear\">\n  <ion-icon name=\"copy-outline\" slot=\"icon-only\"></ion-icon>\n</ion-button>\n","'use strict';\n\nlet Mime = require('./Mime');\nmodule.exports = new Mime(require('./types/standard'));\n","module.exports = {\"application/andrew-inset\":[\"ez\"],\"application/applixware\":[\"aw\"],\"application/atom+xml\":[\"atom\"],\"application/atomcat+xml\":[\"atomcat\"],\"application/atomdeleted+xml\":[\"atomdeleted\"],\"application/atomsvc+xml\":[\"atomsvc\"],\"application/atsc-dwd+xml\":[\"dwd\"],\"application/atsc-held+xml\":[\"held\"],\"application/atsc-rsat+xml\":[\"rsat\"],\"application/bdoc\":[\"bdoc\"],\"application/calendar+xml\":[\"xcs\"],\"application/ccxml+xml\":[\"ccxml\"],\"application/cdfx+xml\":[\"cdfx\"],\"application/cdmi-capability\":[\"cdmia\"],\"application/cdmi-container\":[\"cdmic\"],\"application/cdmi-domain\":[\"cdmid\"],\"application/cdmi-object\":[\"cdmio\"],\"application/cdmi-queue\":[\"cdmiq\"],\"application/cu-seeme\":[\"cu\"],\"application/dash+xml\":[\"mpd\"],\"application/davmount+xml\":[\"davmount\"],\"application/docbook+xml\":[\"dbk\"],\"application/dssc+der\":[\"dssc\"],\"application/dssc+xml\":[\"xdssc\"],\"application/ecmascript\":[\"ecma\",\"es\"],\"application/emma+xml\":[\"emma\"],\"application/emotionml+xml\":[\"emotionml\"],\"application/epub+zip\":[\"epub\"],\"application/exi\":[\"exi\"],\"application/fdt+xml\":[\"fdt\"],\"application/font-tdpfr\":[\"pfr\"],\"application/geo+json\":[\"geojson\"],\"application/gml+xml\":[\"gml\"],\"application/gpx+xml\":[\"gpx\"],\"application/gxf\":[\"gxf\"],\"application/gzip\":[\"gz\"],\"application/hjson\":[\"hjson\"],\"application/hyperstudio\":[\"stk\"],\"application/inkml+xml\":[\"ink\",\"inkml\"],\"application/ipfix\":[\"ipfix\"],\"application/its+xml\":[\"its\"],\"application/java-archive\":[\"jar\",\"war\",\"ear\"],\"application/java-serialized-object\":[\"ser\"],\"application/java-vm\":[\"class\"],\"application/javascript\":[\"js\",\"mjs\"],\"application/json\":[\"json\",\"map\"],\"application/json5\":[\"json5\"],\"application/jsonml+json\":[\"jsonml\"],\"application/ld+json\":[\"jsonld\"],\"application/lgr+xml\":[\"lgr\"],\"application/lost+xml\":[\"lostxml\"],\"application/mac-binhex40\":[\"hqx\"],\"application/mac-compactpro\":[\"cpt\"],\"application/mads+xml\":[\"mads\"],\"application/manifest+json\":[\"webmanifest\"],\"application/marc\":[\"mrc\"],\"application/marcxml+xml\":[\"mrcx\"],\"application/mathematica\":[\"ma\",\"nb\",\"mb\"],\"application/mathml+xml\":[\"mathml\"],\"application/mbox\":[\"mbox\"],\"application/mediaservercontrol+xml\":[\"mscml\"],\"application/metalink+xml\":[\"metalink\"],\"application/metalink4+xml\":[\"meta4\"],\"application/mets+xml\":[\"mets\"],\"application/mmt-aei+xml\":[\"maei\"],\"application/mmt-usd+xml\":[\"musd\"],\"application/mods+xml\":[\"mods\"],\"application/mp21\":[\"m21\",\"mp21\"],\"application/mp4\":[\"mp4s\",\"m4p\"],\"application/mrb-consumer+xml\":[\"*xdf\"],\"application/mrb-publish+xml\":[\"*xdf\"],\"application/msword\":[\"doc\",\"dot\"],\"application/mxf\":[\"mxf\"],\"application/n-quads\":[\"nq\"],\"application/n-triples\":[\"nt\"],\"application/node\":[\"cjs\"],\"application/octet-stream\":[\"bin\",\"dms\",\"lrf\",\"mar\",\"so\",\"dist\",\"distz\",\"pkg\",\"bpk\",\"dump\",\"elc\",\"deploy\",\"exe\",\"dll\",\"deb\",\"dmg\",\"iso\",\"img\",\"msi\",\"msp\",\"msm\",\"buffer\"],\"application/oda\":[\"oda\"],\"application/oebps-package+xml\":[\"opf\"],\"application/ogg\":[\"ogx\"],\"application/omdoc+xml\":[\"omdoc\"],\"application/onenote\":[\"onetoc\",\"onetoc2\",\"onetmp\",\"onepkg\"],\"application/oxps\":[\"oxps\"],\"application/p2p-overlay+xml\":[\"relo\"],\"application/patch-ops-error+xml\":[\"*xer\"],\"application/pdf\":[\"pdf\"],\"application/pgp-encrypted\":[\"pgp\"],\"application/pgp-signature\":[\"asc\",\"sig\"],\"application/pics-rules\":[\"prf\"],\"application/pkcs10\":[\"p10\"],\"application/pkcs7-mime\":[\"p7m\",\"p7c\"],\"application/pkcs7-signature\":[\"p7s\"],\"application/pkcs8\":[\"p8\"],\"application/pkix-attr-cert\":[\"ac\"],\"application/pkix-cert\":[\"cer\"],\"application/pkix-crl\":[\"crl\"],\"application/pkix-pkipath\":[\"pkipath\"],\"application/pkixcmp\":[\"pki\"],\"application/pls+xml\":[\"pls\"],\"application/postscript\":[\"ai\",\"eps\",\"ps\"],\"application/provenance+xml\":[\"provx\"],\"application/pskc+xml\":[\"pskcxml\"],\"application/raml+yaml\":[\"raml\"],\"application/rdf+xml\":[\"rdf\",\"owl\"],\"application/reginfo+xml\":[\"rif\"],\"application/relax-ng-compact-syntax\":[\"rnc\"],\"application/resource-lists+xml\":[\"rl\"],\"application/resource-lists-diff+xml\":[\"rld\"],\"application/rls-services+xml\":[\"rs\"],\"application/route-apd+xml\":[\"rapd\"],\"application/route-s-tsid+xml\":[\"sls\"],\"application/route-usd+xml\":[\"rusd\"],\"application/rpki-ghostbusters\":[\"gbr\"],\"application/rpki-manifest\":[\"mft\"],\"application/rpki-roa\":[\"roa\"],\"application/rsd+xml\":[\"rsd\"],\"application/rss+xml\":[\"rss\"],\"application/rtf\":[\"rtf\"],\"application/sbml+xml\":[\"sbml\"],\"application/scvp-cv-request\":[\"scq\"],\"application/scvp-cv-response\":[\"scs\"],\"application/scvp-vp-request\":[\"spq\"],\"application/scvp-vp-response\":[\"spp\"],\"application/sdp\":[\"sdp\"],\"application/senml+xml\":[\"senmlx\"],\"application/sensml+xml\":[\"sensmlx\"],\"application/set-payment-initiation\":[\"setpay\"],\"application/set-registration-initiation\":[\"setreg\"],\"application/shf+xml\":[\"shf\"],\"application/sieve\":[\"siv\",\"sieve\"],\"application/smil+xml\":[\"smi\",\"smil\"],\"application/sparql-query\":[\"rq\"],\"application/sparql-results+xml\":[\"srx\"],\"application/srgs\":[\"gram\"],\"application/srgs+xml\":[\"grxml\"],\"application/sru+xml\":[\"sru\"],\"application/ssdl+xml\":[\"ssdl\"],\"application/ssml+xml\":[\"ssml\"],\"application/swid+xml\":[\"swidtag\"],\"application/tei+xml\":[\"tei\",\"teicorpus\"],\"application/thraud+xml\":[\"tfi\"],\"application/timestamped-data\":[\"tsd\"],\"application/toml\":[\"toml\"],\"application/ttml+xml\":[\"ttml\"],\"application/ubjson\":[\"ubj\"],\"application/urc-ressheet+xml\":[\"rsheet\"],\"application/urc-targetdesc+xml\":[\"td\"],\"application/voicexml+xml\":[\"vxml\"],\"application/wasm\":[\"wasm\"],\"application/widget\":[\"wgt\"],\"application/winhlp\":[\"hlp\"],\"application/wsdl+xml\":[\"wsdl\"],\"application/wspolicy+xml\":[\"wspolicy\"],\"application/xaml+xml\":[\"xaml\"],\"application/xcap-att+xml\":[\"xav\"],\"application/xcap-caps+xml\":[\"xca\"],\"application/xcap-diff+xml\":[\"xdf\"],\"application/xcap-el+xml\":[\"xel\"],\"application/xcap-error+xml\":[\"xer\"],\"application/xcap-ns+xml\":[\"xns\"],\"application/xenc+xml\":[\"xenc\"],\"application/xhtml+xml\":[\"xhtml\",\"xht\"],\"application/xliff+xml\":[\"xlf\"],\"application/xml\":[\"xml\",\"xsl\",\"xsd\",\"rng\"],\"application/xml-dtd\":[\"dtd\"],\"application/xop+xml\":[\"xop\"],\"application/xproc+xml\":[\"xpl\"],\"application/xslt+xml\":[\"*xsl\",\"xslt\"],\"application/xspf+xml\":[\"xspf\"],\"application/xv+xml\":[\"mxml\",\"xhvml\",\"xvml\",\"xvm\"],\"application/yang\":[\"yang\"],\"application/yin+xml\":[\"yin\"],\"application/zip\":[\"zip\"],\"audio/3gpp\":[\"*3gpp\"],\"audio/adpcm\":[\"adp\"],\"audio/amr\":[\"amr\"],\"audio/basic\":[\"au\",\"snd\"],\"audio/midi\":[\"mid\",\"midi\",\"kar\",\"rmi\"],\"audio/mobile-xmf\":[\"mxmf\"],\"audio/mp3\":[\"*mp3\"],\"audio/mp4\":[\"m4a\",\"mp4a\"],\"audio/mpeg\":[\"mpga\",\"mp2\",\"mp2a\",\"mp3\",\"m2a\",\"m3a\"],\"audio/ogg\":[\"oga\",\"ogg\",\"spx\",\"opus\"],\"audio/s3m\":[\"s3m\"],\"audio/silk\":[\"sil\"],\"audio/wav\":[\"wav\"],\"audio/wave\":[\"*wav\"],\"audio/webm\":[\"weba\"],\"audio/xm\":[\"xm\"],\"font/collection\":[\"ttc\"],\"font/otf\":[\"otf\"],\"font/ttf\":[\"ttf\"],\"font/woff\":[\"woff\"],\"font/woff2\":[\"woff2\"],\"image/aces\":[\"exr\"],\"image/apng\":[\"apng\"],\"image/avif\":[\"avif\"],\"image/bmp\":[\"bmp\"],\"image/cgm\":[\"cgm\"],\"image/dicom-rle\":[\"drle\"],\"image/emf\":[\"emf\"],\"image/fits\":[\"fits\"],\"image/g3fax\":[\"g3\"],\"image/gif\":[\"gif\"],\"image/heic\":[\"heic\"],\"image/heic-sequence\":[\"heics\"],\"image/heif\":[\"heif\"],\"image/heif-sequence\":[\"heifs\"],\"image/hej2k\":[\"hej2\"],\"image/hsj2\":[\"hsj2\"],\"image/ief\":[\"ief\"],\"image/jls\":[\"jls\"],\"image/jp2\":[\"jp2\",\"jpg2\"],\"image/jpeg\":[\"jpeg\",\"jpg\",\"jpe\"],\"image/jph\":[\"jph\"],\"image/jphc\":[\"jhc\"],\"image/jpm\":[\"jpm\"],\"image/jpx\":[\"jpx\",\"jpf\"],\"image/jxr\":[\"jxr\"],\"image/jxra\":[\"jxra\"],\"image/jxrs\":[\"jxrs\"],\"image/jxs\":[\"jxs\"],\"image/jxsc\":[\"jxsc\"],\"image/jxsi\":[\"jxsi\"],\"image/jxss\":[\"jxss\"],\"image/ktx\":[\"ktx\"],\"image/ktx2\":[\"ktx2\"],\"image/png\":[\"png\"],\"image/sgi\":[\"sgi\"],\"image/svg+xml\":[\"svg\",\"svgz\"],\"image/t38\":[\"t38\"],\"image/tiff\":[\"tif\",\"tiff\"],\"image/tiff-fx\":[\"tfx\"],\"image/webp\":[\"webp\"],\"image/wmf\":[\"wmf\"],\"message/disposition-notification\":[\"disposition-notification\"],\"message/global\":[\"u8msg\"],\"message/global-delivery-status\":[\"u8dsn\"],\"message/global-disposition-notification\":[\"u8mdn\"],\"message/global-headers\":[\"u8hdr\"],\"message/rfc822\":[\"eml\",\"mime\"],\"model/3mf\":[\"3mf\"],\"model/gltf+json\":[\"gltf\"],\"model/gltf-binary\":[\"glb\"],\"model/iges\":[\"igs\",\"iges\"],\"model/mesh\":[\"msh\",\"mesh\",\"silo\"],\"model/mtl\":[\"mtl\"],\"model/obj\":[\"obj\"],\"model/stl\":[\"stl\"],\"model/vrml\":[\"wrl\",\"vrml\"],\"model/x3d+binary\":[\"*x3db\",\"x3dbz\"],\"model/x3d+fastinfoset\":[\"x3db\"],\"model/x3d+vrml\":[\"*x3dv\",\"x3dvz\"],\"model/x3d+xml\":[\"x3d\",\"x3dz\"],\"model/x3d-vrml\":[\"x3dv\"],\"text/cache-manifest\":[\"appcache\",\"manifest\"],\"text/calendar\":[\"ics\",\"ifb\"],\"text/coffeescript\":[\"coffee\",\"litcoffee\"],\"text/css\":[\"css\"],\"text/csv\":[\"csv\"],\"text/html\":[\"html\",\"htm\",\"shtml\"],\"text/jade\":[\"jade\"],\"text/jsx\":[\"jsx\"],\"text/less\":[\"less\"],\"text/markdown\":[\"markdown\",\"md\"],\"text/mathml\":[\"mml\"],\"text/mdx\":[\"mdx\"],\"text/n3\":[\"n3\"],\"text/plain\":[\"txt\",\"text\",\"conf\",\"def\",\"list\",\"log\",\"in\",\"ini\"],\"text/richtext\":[\"rtx\"],\"text/rtf\":[\"*rtf\"],\"text/sgml\":[\"sgml\",\"sgm\"],\"text/shex\":[\"shex\"],\"text/slim\":[\"slim\",\"slm\"],\"text/spdx\":[\"spdx\"],\"text/stylus\":[\"stylus\",\"styl\"],\"text/tab-separated-values\":[\"tsv\"],\"text/troff\":[\"t\",\"tr\",\"roff\",\"man\",\"me\",\"ms\"],\"text/turtle\":[\"ttl\"],\"text/uri-list\":[\"uri\",\"uris\",\"urls\"],\"text/vcard\":[\"vcard\"],\"text/vtt\":[\"vtt\"],\"text/xml\":[\"*xml\"],\"text/yaml\":[\"yaml\",\"yml\"],\"video/3gpp\":[\"3gp\",\"3gpp\"],\"video/3gpp2\":[\"3g2\"],\"video/h261\":[\"h261\"],\"video/h263\":[\"h263\"],\"video/h264\":[\"h264\"],\"video/iso.segment\":[\"m4s\"],\"video/jpeg\":[\"jpgv\"],\"video/jpm\":[\"*jpm\",\"jpgm\"],\"video/mj2\":[\"mj2\",\"mjp2\"],\"video/mp2t\":[\"ts\"],\"video/mp4\":[\"mp4\",\"mp4v\",\"mpg4\"],\"video/mpeg\":[\"mpeg\",\"mpg\",\"mpe\",\"m1v\",\"m2v\"],\"video/ogg\":[\"ogv\"],\"video/quicktime\":[\"qt\",\"mov\"],\"video/webm\":[\"webm\"]};","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { TranslocoModule } from '@ngneat/transloco';\nimport { TranslocoLocaleModule } from '@ngneat/transloco-locale';\nimport { ReactiveComponentModule } from '@ngrx/component';\nimport { CopyClipboardComponent } from './copy-clipboard/copy-clipboard.component';\nimport { ExtensionPipe } from './extension/extension.pipe';\nimport { ImageComponent } from './image/image.component';\n\n@NgModule({\n  declarations: [ImageComponent, CopyClipboardComponent, ExtensionPipe],\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    HttpClientModule,\n    ReactiveComponentModule,\n    TranslocoModule,\n    TranslocoLocaleModule,\n  ],\n  exports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    ReactiveComponentModule,\n    TranslocoModule,\n    TranslocoLocaleModule,\n    ImageComponent,\n    CopyClipboardComponent,\n    ExtensionPipe,\n  ],\n})\nexport class SharedModule {}\n","export function arrayBufferToHex(arrayBuffer: ArrayBuffer) {\n  return [...new Uint8Array(arrayBuffer)]\n    .map(b => b.toString(16).padStart(2, '0'))\n    .join('');\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { HomePage } from './home.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomePage,\n  },\n  {\n    path: 'photo',\n    loadChildren: () =>\n      import('./photo/photo.module').then(m => m.PhotoPageModule),\n  },\n  {\n    path: 'settings',\n    loadChildren: () =>\n      import('./settings/settings.module').then(m => m.SettingsPageModule),\n  },\n  {\n    path: 'camera',\n    loadChildren: () =>\n      import('./camera/camera.module').then(m => m.CameraPageModule),\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class HomePageRoutingModule {}\n","import ImageBlobReduce from 'image-blob-reduce';\n\nconst imageBlobReduce = new ImageBlobReduce();\n\nexport async function makeThumbnail({\n  image,\n  maxSize,\n}: {\n  image: Blob;\n  maxSize: number;\n}) {\n  return imageBlobReduce.toBlob(image, { max: maxSize });\n}\n","import { NgModule } from '@angular/core';\nimport { SharedModule } from '../../shared/shared.module';\nimport { HomePageRoutingModule } from './home-routing.module';\nimport { HomePage } from './home.page';\nimport { MomentThumbnailComponent } from './moment-thumbnail/moment-thumbnail.component';\n\n@NgModule({\n  imports: [SharedModule, HomePageRoutingModule],\n  declarations: [HomePage, MomentThumbnailComponent],\n})\nexport class HomePageModule {}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport mime from 'mime/lite';\n\n@Pipe({\n  name: 'extension',\n})\nexport class ExtensionPipe implements PipeTransform {\n  transform(mimeType: string) {\n    //@ts-expect-error: https://github.com/broofa/mime/issues/255\n    return mime.getExtension(mimeType);\n  }\n}\n","import { Component, Input } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\nimport { distinctUntilChanged } from 'rxjs/operators';\nimport { Moment } from '../../../shared/moment/moment';\nimport { isNonNullable } from '../../../utils/rx-operators';\n\n@Component({\n  selector: 'app-moment-thumbnail',\n  templateUrl: './moment-thumbnail.component.html',\n  styleUrls: ['./moment-thumbnail.component.scss'],\n})\nexport class MomentThumbnailComponent {\n  private readonly _moment$ = new BehaviorSubject<undefined | Moment>(\n    undefined\n  );\n\n  readonly moment$ = this._moment$.pipe(\n    isNonNullable(),\n    distinctUntilChanged((x, y) => x.id === y.id)\n  );\n\n  @Input() set moment(value: Moment) {\n    this._moment$.next(value);\n  }\n}\n","<ng-container *ngrxLet=\"moment$ as moment\">\n  <app-image\n    *ngrxLet=\"moment.thumbnailUrl$ as thumbnailUrl\"\n    routerLink=\"photo\"\n    [queryParams]=\"{ id: moment.id }\"\n    [src]=\"thumbnailUrl\"\n    class=\"ion-activatable\"\n  >\n    <ion-ripple-effect></ion-ripple-effect>\n  </app-image>\n</ng-container>\n","'use strict';\n\n/**\n * @param typeMap [Object] Map of MIME type -> Array[extensions]\n * @param ...\n */\nfunction Mime() {\n  this._types = Object.create(null);\n  this._extensions = Object.create(null);\n\n  for (let i = 0; i < arguments.length; i++) {\n    this.define(arguments[i]);\n  }\n\n  this.define = this.define.bind(this);\n  this.getType = this.getType.bind(this);\n  this.getExtension = this.getExtension.bind(this);\n}\n\n/**\n * Define mimetype -> extension mappings.  Each key is a mime-type that maps\n * to an array of extensions associated with the type.  The first extension is\n * used as the default extension for the type.\n *\n * e.g. mime.define({'audio/ogg', ['oga', 'ogg', 'spx']});\n *\n * If a type declares an extension that has already been defined, an error will\n * be thrown.  To suppress this error and force the extension to be associated\n * with the new type, pass `force`=true.  Alternatively, you may prefix the\n * extension with \"*\" to map the type to extension, without mapping the\n * extension to the type.\n *\n * e.g. mime.define({'audio/wav', ['wav']}, {'audio/x-wav', ['*wav']});\n *\n *\n * @param map (Object) type definitions\n * @param force (Boolean) if true, force overriding of existing definitions\n */\nMime.prototype.define = function(typeMap, force) {\n  for (let type in typeMap) {\n    let extensions = typeMap[type].map(function(t) {\n      return t.toLowerCase();\n    });\n    type = type.toLowerCase();\n\n    for (let i = 0; i < extensions.length; i++) {\n      const ext = extensions[i];\n\n      // '*' prefix = not the preferred type for this extension.  So fixup the\n      // extension, and skip it.\n      if (ext[0] === '*') {\n        continue;\n      }\n\n      if (!force && (ext in this._types)) {\n        throw new Error(\n          'Attempt to change mapping for \"' + ext +\n          '\" extension from \"' + this._types[ext] + '\" to \"' + type +\n          '\". Pass `force=true` to allow this, otherwise remove \"' + ext +\n          '\" from the list of extensions for \"' + type + '\".'\n        );\n      }\n\n      this._types[ext] = type;\n    }\n\n    // Use first extension as default\n    if (force || !this._extensions[type]) {\n      const ext = extensions[0];\n      this._extensions[type] = (ext[0] !== '*') ? ext : ext.substr(1);\n    }\n  }\n};\n\n/**\n * Lookup a mime type based on extension\n */\nMime.prototype.getType = function(path) {\n  path = String(path);\n  let last = path.replace(/^.*[/\\\\]/, '').toLowerCase();\n  let ext = last.replace(/^.*\\./, '').toLowerCase();\n\n  let hasPath = last.length < path.length;\n  let hasDot = ext.length < last.length - 1;\n\n  return (hasDot || !hasPath) && this._types[ext] || null;\n};\n\n/**\n * Return file extension associated with a mime type\n */\nMime.prototype.getExtension = function(type) {\n  type = /^\\s*([^;\\s]*)/.test(type) && RegExp.$1;\n  return type && this._extensions[type.toLowerCase()] || null;\n};\n\nmodule.exports = Mime;\n","export class DataNotFoundError extends Error {\n  name = DataNotFoundError.name;\n}\n","import { RxDocument, RxJsonSchema } from 'rxdb';\nimport { defer, of } from 'rxjs';\nimport { concatMap, map, shareReplay } from 'rxjs/operators';\nimport { DataNotFoundError } from '../../utils/errors';\nimport { makeThumbnail } from '../../utils/thumbnail';\n\nexport interface MemontIndex {\n  readonly id: string;\n  readonly timestamp: number;\n  readonly geolocationPosition?: {\n    readonly latitude: number;\n    readonly longitude: number;\n  };\n}\n\nexport const schema: RxJsonSchema<MemontIndex> = {\n  version: 0,\n  type: 'object',\n  properties: {\n    id: {\n      type: 'string',\n      primary: true,\n    },\n    timestamp: { type: 'number' },\n    geolocationPosition: {\n      type: 'object',\n      properties: {\n        latitude: { type: 'number' },\n        longitude: { type: 'number' },\n      },\n      required: ['latitude', 'longitude'],\n    },\n  },\n  indexes: ['timestamp'],\n  required: ['timestamp'],\n  attachments: {\n    encrypted: false,\n  },\n};\n\nexport class Moment {\n  static readonly PHOTO_ATTACHMENT_ID = 'original';\n\n  private static readonly THUMBNAIL_ATTACHMENT_ID = 'thumbnail';\n\n  readonly id = this.document.id;\n\n  readonly mimeType = this.getAttachment(Moment.PHOTO_ATTACHMENT_ID).type;\n\n  readonly timestamp = this.document.timestamp;\n\n  readonly geolocationPosition = this.document.geolocationPosition;\n\n  readonly photo$ = defer(() =>\n    this.getAttachment(Moment.PHOTO_ATTACHMENT_ID).getData()\n  );\n\n  readonly photoUrl$ = this.photo$.pipe(\n    map(blob => URL.createObjectURL(blob)),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n\n  readonly thumbnailUrl$ = defer(() =>\n    of(this.document.getAttachment(Moment.THUMBNAIL_ATTACHMENT_ID))\n  ).pipe(\n    concatMap(async attachment => {\n      if (attachment) return attachment.getData();\n      const thumbnail = await makeThumbnail({\n        image: await this.getAttachment(Moment.PHOTO_ATTACHMENT_ID).getData(),\n        maxSize: 300,\n      });\n      await this.document.putAttachment(\n        {\n          id: Moment.THUMBNAIL_ATTACHMENT_ID,\n          data: thumbnail,\n          type: this.mimeType,\n        },\n        true\n      );\n      return thumbnail;\n    }),\n    map(blob => URL.createObjectURL(blob)),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n\n  constructor(private readonly document: RxDocument<MemontIndex>) {}\n\n  private getAttachment(\n    id:\n      | typeof Moment.PHOTO_ATTACHMENT_ID\n      | typeof Moment.THUMBNAIL_ATTACHMENT_ID\n  ) {\n    const attachment = this.document.getAttachment(id);\n    if (attachment) return attachment;\n    throw new DataNotFoundError(`Cannot get the attachment with ID: ${id}`);\n  }\n}\n"]}