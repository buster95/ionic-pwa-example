!function(){function e(n){var i="function"==typeof Map?new Map:void 0;return(e=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(e))return i.get(e);i.set(e,o)}function o(){return t(e,arguments,s(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),r(o,e)})(n)}function t(e,n,i){return(t=a()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o}).apply(null,arguments)}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=a();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"/T4s":function(e,t,n){"use strict";n.d(t,"a",function(){return y});var r=n("mrSG"),i=n("1Bn7"),o=n("2Vo4"),a=n("JX91"),s=n("/uUt"),u=n("vkgz"),c=n("KJy6"),h=n("fXoL"),l=n("ofXK"),d=n("TEn/"),g=n("9A8T");function b(e,t){1&e&&h.Lb(0,"ion-icon",3)}function m(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-img",4),h.Xb("ionImgDidLoad",function(e){return h.ic(n),h.Zb().onImageLoaded(e)})("ionError",function(){return h.ic(n),h.Zb().onImageError()}),h.ac(1,"ngrxPush"),h.Ob()}if(2&e){var r=h.Zb();h.Bb("src",h.bc(1,1,r.src$))}}function A(e,t){1&e&&h.dc(0,0,["*ngIf","!isImageError"])}var v=["*"],y=function(){var e=function(){function e(){var t=this;f(this,e),this._src$=new o.a(void 0),this.src$=this._src$.pipe(Object(a.a)(w),Object(c.b)(),Object(s.a)(),Object(u.a)(function(){return t.isImageError=!1})),this.isImageError=!1}return p(e,[{key:"src",set:function(e){this._src$.next(e)}},{key:"onImageLoaded",value:function(e){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.target,t.abrupt("return",Object(i.h)().addElement(n).duration(300).iterations(1).fromTo("opacity","0","1").play());case 2:case"end":return t.stop()}},t)}))}},{key:"onImageError",value:function(){this.isImageError=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Eb({type:e,selectors:[["app-image"]],inputs:{src:"src"},ngContentSelectors:v,decls:3,vars:3,consts:[["src","/assets/icons/broken-image.svg","color","danger","size","large",4,"ngIf"],[3,"ionImgDidLoad","ionError",4,"ngIf"],[4,"ngIf"],["src","/assets/icons/broken-image.svg","color","danger","size","large"],[3,"ionImgDidLoad","ionError"]],template:function(e,t){1&e&&(h.ec(),h.lc(0,b,1,0,"ion-icon",0),h.lc(1,m,2,3,"ion-img",1),h.lc(2,A,1,0,"ng-content",2)),2&e&&(h.fc("ngIf",t.isImageError),h.Ab(1),h.fc("ngIf",!t.isImageError),h.Ab(1),h.fc("ngIf",!t.isImageError))},directives:[l.k,d.n,d.o],pipes:[g.b],styles:["[_nghost-%COMP%]{display:block;overflow:hidden;-o-object-fit:cover;object-fit:cover;position:relative;-webkit-animation:loading 2.5s ease-in-out infinite alternate;animation:loading 2.5s ease-in-out infinite alternate}ion-img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:inherit;object-fit:inherit;-o-object-position:inherit;object-position:inherit;opacity:0}@-webkit-keyframes loading{0%{background-color:var(--ion-color-light-shade)}to{background-color:var(--ion-color-light)}}@keyframes loading{0%{background-color:var(--ion-color-light-shade)}to{background-color:var(--ion-color-light)}}@media (prefers-color-scheme:dark){@-webkit-keyframes loading{0%{background-color:var(--ion-color-step-150)}to{background-color:var(--ion-color-step-100)}}@keyframes loading{0%{background-color:var(--ion-color-step-150)}to{background-color:var(--ion-color-step-100)}}}ion-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;margin-right:-50%;transform:translate(-50%,-50%)}"]}),e}(),w="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="},"6g0+":function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"b",function(){return g});var r=n("fXoL"),i=n("O1h7"),o=n("TEn/"),a=n("ofXK"),s=["sliderRef"],u=function(e){return{"no-title":e}},h=function(e){return{"no-text":e}},l=function(){var e=function(){function e(t){f(this,e),this.modalController=t,this.alt="",this.scheme="auto",this.slideOptions={},this.srcFallback="",this.srcHighRes="",this.swipeToClose=!0,this.text="",this.title="",this.titleSize="",this.defaultSlideOptions={centeredSlides:!0,passiveListeners:!1,zoom:{enabled:!0}},this.options={},this.swipeState={phase:"init",direction:"none",swipeType:"none",startX:0,startY:0,distance:0,distanceX:0,distanceY:0,threshold:150,restraint:100,allowedTime:500,elapsedTime:0,startTime:0}}return p(e,[{key:"ngOnInit",value:function(){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.options=Object.assign({},this.defaultSlideOptions,this.slideOptions),this.src=this.srcHighRes||this.src,this.setStyle(),this.setScheme(this.scheme),this.initSwipeToClose(this.swipeToClose),e.next=7,this.slides.getSwiper();case 7:e.sent.appendSlide('<ion-slide><img alt="'.concat(this.alt,'" src="').concat(this.src,'" onerror="this.src=\'').concat(this.srcFallback,"'\"/></ion-slide>"));case 8:case"end":return e.stop()}},e,this)}))}},{key:"setStyle",value:function(){var e=document.querySelector(".ion-img-viewer");e.style.setProperty("--height","100%"),e.style.setProperty("--width","100%"),e.style.setProperty("--border-radius","0")}},{key:"setScheme",value:function(e){if("auto"!==e){var t=document.querySelector(".ion-img-viewer");"light"===this.scheme&&(t.style.setProperty("--ion-background-color","#ffffff"),t.style.setProperty("--ion-background-color-rgb","255, 255, 255"),t.style.setProperty("--ion-text-color","#000"),t.style.setProperty("--ion-text-color-rgb","0,0,0")),"dark"===this.scheme&&(t.classList.contains("ios")?(t.style.setProperty("--ion-background-color","#000000"),t.style.setProperty("--ion-background-color-rgb","0, 0, 0")):(t.style.setProperty("--ion-background-color","#121212"),t.style.setProperty("--ion-background-color-rgb","18,18,18")),t.style.setProperty("--ion-text-color","#ffffff"),t.style.setProperty("--ion-text-color-rgb","255,255,255"))}}},{key:"initSwipeToClose",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(t){var n=document.querySelector("ion-modal");n.addEventListener("mousedown",function(t){return e.swipeStart(t)},!0),n.addEventListener("mousemove",function(t){return e.swipeMove(t)},!0),n.addEventListener("mouseup",function(t){return e.swipeEnd(t)},!0),n.addEventListener("touchstart",function(t){return e.swipeStart(t)},!0),n.addEventListener("touchmove",function(t){return e.swipeMove(t)},!0),n.addEventListener("touchend",function(t){return e.swipeEnd(t)},!0),this.modalController.getTop().then(function(t){t.onWillDismiss().then(function(){document.removeEventListener("mousedown",e.swipeStart,!0),document.removeEventListener("mousemove",e.swipeMove,!0),document.removeEventListener("mouseup",e.swipeMove,!0),document.removeEventListener("touchstart",e.swipeStart,!0),document.removeEventListener("touchmove",e.swipeMove,!0),document.removeEventListener("touchend",e.swipeMove,!0)})})}}},{key:"swipeStart",value:function(e){var t="touchstart"===e.type?e.changedTouches[0]:e,n=t.pageX,r=t.pageY;this.swipeState=Object.assign({},this.swipeState,{phase:"start",direction:"none",distance:0,startX:n,startY:r,startTime:(new Date).getTime()})}},{key:"swipeMove",value:function(e){if("none"!==this.swipeState.phase){var t,n,r="touchmove"===e.type?e.changedTouches[0]:e,i=r.pageX,o=r.pageY,a=i-this.swipeState.startX,s=o-this.swipeState.startY;Math.abs(a)>Math.abs(s)?(t=a<0?"left":"right",n=a):(t=s<0?"up":"down",n=s),this.swipeState=Object.assign({},this.swipeState,{phase:"move",direction:t,distance:n,distanceX:a,distanceY:s}),e.preventDefault()}}},{key:"swipeEnd",value:function(e){if("none"!==this.swipeState.phase){var t,n=this.swipeState,r=n.allowedTime,i=n.direction,o=n.restraint,a=n.startTime,s=n.threshold,u=n.distanceX,c=n.distanceY;return(new Date).getTime()-a<=r&&(Math.abs(u)>=s&&Math.abs(c)<=o||Math.abs(c)>=s&&Math.abs(u)<=o)&&(t=i),this.swipeState=Object.assign({},this.swipeState,{phase:"end",swipeType:t}),"down"===t?this.closeModal():void 0}}},{key:"closeModal",value:function(){this.modalController.dismiss()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Kb(o.F))},e.\u0275cmp=r.Eb({type:e,selectors:[["ion-viewer-modal"]],viewQuery:function(e,t){var n;(1&e&&r.qc(s,3),2&e)&&(r.hc(n=r.Yb())&&(t.slides=n.first))},inputs:{alt:"alt",scheme:"scheme",slideOptions:"slideOptions",srcFallback:"srcFallback",srcHighRes:"srcHighRes",swipeToClose:"swipeToClose",text:"text",title:"title",titleSize:"titleSize",src:"src"},decls:14,vars:11,consts:[[3,"ngClass"],["slot","primary"],[3,"click"],["slot","icon-only","name","close"],[3,"size"],[3,"forceOverscroll"],[3,"options"],["sliderRef",""],[1,"ion-text-center"]],template:function(e,t){1&e&&(r.Pb(0,"ion-header",0),r.Pb(1,"ion-toolbar"),r.Pb(2,"ion-buttons",1),r.Pb(3,"ion-button",2),r.Xb("click",function(){return t.closeModal()}),r.Lb(4,"ion-icon",3),r.Ob(),r.Ob(),r.Pb(5,"ion-title",4),r.mc(6),r.Ob(),r.Ob(),r.Ob(),r.Pb(7,"ion-content",5),r.Lb(8,"ion-slides",6,7),r.Ob(),r.Pb(10,"ion-footer",0),r.Pb(11,"ion-toolbar",8),r.Pb(12,"ion-text"),r.mc(13),r.Ob(),r.Ob(),r.Ob()),2&e&&(r.fc("ngClass",r.gc(7,u,t.title.length<=0)),r.Ab(5),r.fc("size",t.titleSize),r.Ab(1),r.nc(t.title),r.Ab(1),r.fc("forceOverscroll",!1),r.Ab(1),r.fc("options",t.options),r.Ab(2),r.fc("ngClass",r.gc(9,h,t.text.length<=0)),r.Ab(3),r.nc(t.text))},directives:[o.m,a.i,o.C,o.f,o.e,o.n,o.B,o.h,o.z,o.k,o.A],styles:["ion-slides[_ngcontent-%COMP%]{--height:100%;height:100%}ion-toolbar[_ngcontent-%COMP%]{--border-style:none;--background:rgba(var(--ion-background-color-rgb, (255, 255, 255)), 0.6);background:rgba(var(--ion-background-color-rgb,255,255,255),.6)}ion-header[_ngcontent-%COMP%]{opacity:1;position:absolute}ion-header.no-title[_ngcontent-%COMP%]:after{content:none}ion-header.no-title[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:rgba(0, 0, 0, 0);background:rgba(0,0,0,0)}ion-footer[_ngcontent-%COMP%]{position:absolute;bottom:0}ion-footer.no-text[_ngcontent-%COMP%]:before{content:none}ion-footer.no-text[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:rgba(0, 0, 0, 0);background:rgba(0,0,0,0)}"]}),e}(),d=function(){var e=function(){function e(t,n,r){f(this,e),this.el=t,this.renderer=n,this.modalController=r}return p(e,[{key:"onClick",value:function(){this.viewImage(this.src,this.srcFallback,this.srcHighRes,this.title,this.titleSize,this.text,this.scheme,this.slideOptions,this.swipeToClose)}},{key:"onError",value:function(e){this.src!==this.el.nativeElement.src&&(this.src=this.el.nativeElement.src),this.srcFallback&&this.renderer.setAttribute(this.el.nativeElement,"src",this.srcFallback)}},{key:"ngOnInit",value:function(){this.el.nativeElement.hasAttribute("src")||this.renderer.setAttribute(this.el.nativeElement,"src",this.src)}},{key:"viewImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"auto",u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},h=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var f;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.modalController.create({component:l,componentProps:{src:e,srcFallback:t,srcHighRes:n,title:r,titleSize:o,text:a,scheme:s,slideOptions:u,swipeToClose:h},cssClass:this.cssClass instanceof Array?["ion-img-viewer"].concat(c(this.cssClass)):["ion-img-viewer",this.cssClass],keyboardClose:!0,showBackdrop:!0});case 2:return f=i.sent,i.next=5,f.present();case 5:return i.abrupt("return",i.sent);case 6:case"end":return i.stop()}},i,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Kb(r.m),r.Kb(r.F),r.Kb(o.F))},e.\u0275dir=r.Fb({type:e,selectors:[["","ionImgViewer",""]],hostBindings:function(e,t){1&e&&r.Xb("click",function(){return t.onClick()})("error",function(e){return t.onError(e)})},inputs:{src:"src",cssClass:"cssClass",scheme:"scheme",slideOptions:"slideOptions",srcFallback:"srcFallback",srcHighRes:"srcHighRes",swipeToClose:"swipeToClose",text:"text",title:"title",titleSize:"titleSize"}}),e}(),g=function(){var e=function e(){f(this,e)};return e.\u0275mod=r.Ib({type:e}),e.\u0275inj=r.Hb({factory:function(t){return new(t||e)},imports:[[a.b,o.D]]}),e}()},"9A8T":function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return v}),n.d(t,"c",function(){return w});var r=n("fXoL"),i=n("XNiG"),o=n("EY2u"),a=n("HDdC"),s=n("Cfvw"),u=n("/uUt"),c=n("eIep"),h=n("vkgz"),l=n("JIr8");function d(e){var t=new i.a,n=t.pipe(Object(u.a)()).pipe(Object(c.a)(function(t){if(null==t)return e.updateViewContextObserver.next(t),e.render(),o.a;var n,r=(n=t)&&(n instanceof a.a||"function"==typeof n.lift&&"function"==typeof n.subscribe)?t:Object(s.a)(t);return e.resetContextObserver.next(),e.render(),r.pipe(Object(u.a)(),Object(h.a)(e.updateViewContextObserver),Object(h.a)(function(){return e.render()}),Object(l.a)(function(e){return o.a}))}));return{nextPotentialObservable:function(e){t.next(e)},subscribe:function(){return n.subscribe()}}}function g(e){return function(){e.ngZone instanceof r.B?e.cdRef.markForCheck():e.cdRef.detectChanges()}}var b,m,A,v=((A=function(){function e(t,n){var r=this;f(this,e),this.resetContextObserver={next:function(){return r.renderedValue=void 0}},this.updateViewContextObserver={next:function(e){return r.renderedValue=e}},this.cdAware=d({render:g({cdRef:t,ngZone:n}),updateViewContextObserver:this.updateViewContextObserver,resetContextObserver:this.resetContextObserver}),this.subscription=this.cdAware.subscribe()}return p(e,[{key:"transform",value:function(e){return this.cdAware.nextPotentialObservable(e),this.renderedValue}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||A)(r.Vb(),r.Kb(r.B))},A.\u0275pipe=r.Jb({name:"ngrxPush",type:A,pure:!1}),A),y=((m=function(){function e(t,n,r,i){var o=this;f(this,e),this.templateRef=r,this.viewContainerRef=i,this.ViewContext={$implicit:void 0,ngrxLet:void 0,$error:!1,$complete:!1},this.resetContextObserver={next:function(){o.embeddedView&&(o.ViewContext.$implicit=void 0,o.ViewContext.ngrxLet=void 0,o.ViewContext.$error=!1,o.ViewContext.$complete=!1)}},this.updateViewContextObserver={next:function(e){o.embeddedView||o.createEmbeddedView(),o.ViewContext.$implicit=e,o.ViewContext.ngrxLet=e},error:function(e){o.embeddedView||o.createEmbeddedView(),o.ViewContext.$error=!0},complete:function(){o.embeddedView||o.createEmbeddedView(),o.ViewContext.$complete=!0}},this.cdAware=d({render:g({cdRef:t,ngZone:n}),resetContextObserver:this.resetContextObserver,updateViewContextObserver:this.updateViewContextObserver}),this.subscription=this.cdAware.subscribe()}return p(e,[{key:"ngrxLet",set:function(e){this.cdAware.nextPotentialObservable(e)}},{key:"createEmbeddedView",value:function(){this.embeddedView=this.viewContainerRef.createEmbeddedView(this.templateRef,this.ViewContext)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe(),this.viewContainerRef.clear()}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}()).\u0275fac=function(e){return new(e||m)(r.Kb(r.i),r.Kb(r.B),r.Kb(r.M),r.Kb(r.Q))},m.\u0275dir=r.Fb({type:m,selectors:[["","ngrxLet",""]],inputs:{ngrxLet:"ngrxLet"}}),m),w=((b=function e(){f(this,e)}).\u0275mod=r.Ib({type:b}),b.\u0275inj=r.Hb({factory:function(e){return new(e||b)}}),b)},PCNd:function(e,t,r){"use strict";r.d(t,"a",function(){return se});var o=r("ofXK"),a=r("fXoL"),s=r("LRne"),h=r("HDdC"),l=r("bOdf"),d=r("pLZG"),g=r("lJxs"),b=function e(){f(this,e)},m=function e(){f(this,e)},A=function(){function e(t){var n=this;f(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),o=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(o):n.headers.set(i,[o])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return p(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,c(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var o=this.headers.get(t);if(!o)return;0===(o=o.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),v=function(){function e(){f(this,e)}return p(e,[{key:"encodeKey",value:function(e){return y(e)}},{key:"encodeValue",value:function(e){return y(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}();function y(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}var w=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(f(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new v,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),i=u(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),o=i[0],a=i[1],s=n.get(o)||[];s.push(a),n.set(o,s)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}return p(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(t.value),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(t.value);-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}();function _(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function I(e){return"undefined"!=typeof Blob&&e instanceof Blob}function E(e){return"undefined"!=typeof FormData&&e instanceof FormData}var C=function(){function e(t,n,r,i){var o;if(f(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.params&&(this.params=o.params)),this.headers||(this.headers=new A),this.params){var a=this.params.toString();if(0===a.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+a}}else this.params=new w,this.urlWithParams=n}return p(e,[{key:"serializeBody",value:function(){return null===this.body?null:_(this.body)||I(this.body)||E(this.body)||"string"==typeof this.body?this.body:this.body instanceof w?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||E(this.body)?null:I(this.body)?this.body.type||null:_(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof w?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.method||this.method,r=t.url||this.url,i=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,a=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress,u=t.headers||this.headers,c=t.params||this.params;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce(function(e,n){return e.set(n,t.setHeaders[n])},u)),t.setParams&&(c=Object.keys(t.setParams).reduce(function(e,n){return e.set(n,t.setParams[n])},c)),new e(n,r,o,{params:c,headers:u,reportProgress:s,responseType:i,withCredentials:a})}}]),e}(),x=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}({}),O=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";f(this,e),this.headers=t.headers||new A,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300},k=function(e){n(r,e);var t=i(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f(this,r),(e=t.call(this,n)).type=x.ResponseHeader,e}return p(r,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new r({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),r}(O),B=function(e){n(r,e);var t=i(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f(this,r),(e=t.call(this,n)).type=x.Response,e.body=void 0!==n.body?n.body:null,e}return p(r,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new r({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),r}(O),j=function(e){n(r,e);var t=i(r);function r(e){var n;return f(this,r),(n=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",n.ok=!1,n.message=n.status>=200&&n.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),n.error=e.error||null,n}return r}(O);function P(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var T,Q,L,M,R,U,S,D,H,z,F=((T=function(){function e(t){f(this,e),this.handler=t}return p(e,[{key:"request",value:function(e,t){var n,r,i,o=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof C?n=e:(r=a.headers instanceof A?a.headers:new A(a.headers),a.params&&(i=a.params instanceof w?a.params:new w({fromObject:a.params})),n=new C(e,t,void 0!==a.body?a.body:null,{headers:r,params:i,reportProgress:a.reportProgress,responseType:a.responseType||"json",withCredentials:a.withCredentials}));var u=Object(s.a)(n).pipe(Object(l.a)(function(e){return o.handler.handle(e)}));if(e instanceof C||"events"===a.observe)return u;var c=u.pipe(Object(d.a)(function(e){return e instanceof B}));switch(a.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return c.pipe(Object(g.a)(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return c.pipe(Object(g.a)(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return c.pipe(Object(g.a)(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));case"json":default:return c.pipe(Object(g.a)(function(e){return e.body}))}case"response":return c;default:throw new Error("Unreachable: unhandled observe type ".concat(a.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new w).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,P(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,P(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,P(n,t))}}]),e}()).\u0275fac=function(e){return new(e||T)(a.Tb(b))},T.\u0275prov=a.Gb({token:T,factory:T.\u0275fac}),T),N=function(){function e(t,n){f(this,e),this.next=t,this.interceptor=n}return p(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),q=new a.s("HTTP_INTERCEPTORS"),G=((Q=function(){function e(){f(this,e)}return p(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||Q)},Q.\u0275prov=a.Gb({token:Q,factory:Q.\u0275fac}),Q),X=/^\)\]\}',?\n/,V=function e(){f(this,e)},$=((M=function(){function e(){f(this,e)}return p(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}()).\u0275fac=function(e){return new(e||M)},M.\u0275prov=a.Gb({token:M,factory:M.\u0275fac}),M),K=((L=function(){function e(t){f(this,e),this.xhrFactory=t}return p(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new h.a(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var o=e.responseType.toLowerCase();r.responseType="json"!==o?o:"text"}var a=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new A(r.getAllResponseHeaders()),o=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new k({headers:i,status:t,statusText:n,url:o})},c=function(){var t=u(),i=t.headers,o=t.status,a=t.statusText,s=t.url,c=null;204!==o&&(c=void 0===r.response?r.responseText:r.response),0===o&&(o=c?200:0);var h=o>=200&&o<300;if("json"===e.responseType&&"string"==typeof c){var l=c;c=c.replace(X,"");try{c=""!==c?JSON.parse(c):null}catch(f){c=l,h&&(h=!1,c={error:f,text:c})}}h?(n.next(new B({body:c,headers:i,status:o,statusText:a,url:s||void 0})),n.complete()):n.error(new j({error:c,headers:i,status:o,statusText:a,url:s||void 0}))},h=function(e){var t=u().url,i=new j({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},l=!1,f=function(t){l||(n.next(u()),l=!0);var i={type:x.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:x.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",h),r.addEventListener("timeout",h),r.addEventListener("abort",h),e.reportProgress&&(r.addEventListener("progress",f),null!==a&&r.upload&&r.upload.addEventListener("progress",d)),r.send(a),n.next({type:x.Sent}),function(){r.removeEventListener("error",h),r.removeEventListener("abort",h),r.removeEventListener("load",c),r.removeEventListener("timeout",h),e.reportProgress&&(r.removeEventListener("progress",f),null!==a&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}()).\u0275fac=function(e){return new(e||L)(a.Tb(V))},L.\u0275prov=a.Gb({token:L,factory:L.\u0275fac}),L),Y=new a.s("XSRF_COOKIE_NAME"),W=new a.s("XSRF_HEADER_NAME"),J=function e(){f(this,e)},Z=((H=function(){function e(t,n,r){f(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return p(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Object(o.s)(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}()).\u0275fac=function(e){return new(e||H)(a.Tb(o.c),a.Tb(a.D),a.Tb(Y))},H.\u0275prov=a.Gb({token:H,factory:H.\u0275fac}),H),ee=((D=function(){function e(t,n){f(this,e),this.tokenService=t,this.headerName=n}return p(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null===r||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||D)(a.Tb(J),a.Tb(W))},D.\u0275prov=a.Gb({token:D,factory:D.\u0275fac}),D),te=((S=function(){function e(t,n){f(this,e),this.backend=t,this.injector=n,this.chain=null}return p(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(q,[]);this.chain=t.reduceRight(function(e,t){return new N(e,t)},this.backend)}return this.chain.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||S)(a.Tb(m),a.Tb(a.t))},S.\u0275prov=a.Gb({token:S,factory:S.\u0275fac}),S),ne=((U=function(){function e(){f(this,e)}return p(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:ee,useClass:G}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:Y,useValue:t.cookieName}:[],t.headerName?{provide:W,useValue:t.headerName}:[]]}}}]),e}()).\u0275mod=a.Ib({type:U}),U.\u0275inj=a.Hb({factory:function(e){return new(e||U)},providers:[ee,{provide:q,useExisting:ee,multi:!0},{provide:J,useClass:Z},{provide:Y,useValue:"XSRF-TOKEN"},{provide:W,useValue:"X-XSRF-TOKEN"}]}),U),re=((R=function e(){f(this,e)}).\u0275mod=a.Ib({type:R}),R.\u0275inj=a.Hb({factory:function(e){return new(e||R)},providers:[F,{provide:b,useClass:te},K,{provide:m,useExisting:K},$,{provide:V,useExisting:$}],imports:[[ne.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),R),ie=r("3Pt+"),oe=r("TEn/"),ae=r("9A8T"),se=((z=function e(){f(this,e)}).\u0275mod=a.Ib({type:z}),z.\u0275inj=a.Hb({factory:function(e){return new(e||z)},imports:[[o.b,ie.a,ie.d,oe.D,re,ae.c],o.b,ie.a,ie.d,oe.D,ae.c]}),z)},fOOd:function(e,t,r){"use strict";r.r(t),r.d(t,"HomePageModule",function(){return ee});var o=r("6g0+"),a=r("PCNd"),s=r("tyNb"),c=r("mrSG"),h=r("TEn/"),l=r("2Vo4"),d=r("XNiG"),g=r("itXk"),b=r("/uUt"),m=r("eIep"),A=r("KJy6"),v=r("VfN6"),y=r("NXyV"),w=r("JIr8"),_=r("UXun"),I=r("lJxs"),E=r("7o/Q"),C=function(){function e(){f(this,e)}return p(e,[{key:"call",value:function(e,t){return t.subscribe(new x(e))}}]),e}(),x=function(e){n(r,e);var t=i(r);function r(e){var n;return f(this,r),(n=t.call(this,e)).hasPrev=!1,n}return p(r,[{key:"_next",value:function(e){var t;this.hasPrev?t=[this.prev,e]:this.hasPrev=!0,this.prev=e,t&&this.destination.next(t)}}]),r}(E.a),O=r("vkgz"),k=r("fXoL"),B=r("kTgZ"),j=r("9A8T"),P=r("/T4s"),T=["video"];function Q(e,t){if(1&e&&(k.Pb(0,"div",7),k.Lb(1,"app-image",8),k.Ob()),2&e){var n=t.ngrxLet;k.Ab(1),k.fc("src",n)}}var L,M=((L=function(){function e(t,n,r){var i=this;f(this,e),this.modalController=t,this.alertController=n,this.junctureRepository=r,this._videoElement$=new l.a(void 0),this.videoElement$=this._videoElement$.pipe(Object(A.b)(),Object(b.a)()),this.mediaStream$=Object(y.a)(function(){return navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}})}).pipe(Object(w.a)(function(e){return Object(c.a)(i,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.presentErrorDialog(e);case 2:return t.next=4,this.dismiss();case 4:case"end":return t.stop()}},t,this)}))}),Object(_.a)({bufferSize:1,refCount:!0})),this.imageCapture$=this.mediaStream$.pipe(Object(A.b)(),Object(I.a)(function(e){return new ImageCapture(e.getVideoTracks()[0])}),Object(_.a)({bufferSize:1,refCount:!0})),this._capturedImageUrl$=new l.a(void 0),this.revokePreviousImageUrl$=this._capturedImageUrl$.pipe(function(e){return e.lift(new C)},Object(O.a)(function(e){var t=u(e,1)[0];t&&URL.revokeObjectURL(t)})),this.capturedImageUrl$=this._capturedImageUrl$.pipe(Object(A.b)(),Object(b.a)()),this.cameraPreview$=Object(g.a)([this.videoElement$,this.mediaStream$.pipe(Object(A.b)())]).pipe(Object(O.a)(function(e){var t=u(e,2),n=t[0],r=t[1];n.srcObject=r})),this.revokePreviousImageUrl$.pipe(Object(v.b)(this)).subscribe(),this.cameraPreview$.pipe(Object(v.b)(this)).subscribe()}return p(e,[{key:"videoElement",set:function(e){this._videoElement$.next(e.nativeElement)}},{key:"capture",value:function(){var e=this;this.imageCapture$.pipe(Object(m.a)(function(e){return e.takePhoto()}),Object(O.a)(function(t){e._capturedImageUrl$.next(URL.createObjectURL(t))}),Object(A.a)(function(t){return e.junctureRepository.add$(t)}),Object(w.a)(function(t){return Object(c.a)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.error(t),e.next=3,this.presentErrorDialog(t);case 3:case"end":return e.stop()}},e,this)}))}),Object(v.b)(this)).subscribe()}},{key:"dismiss",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.modalController.dismiss());case 1:case"end":return e.stop()}},e,this)}))}},{key:"presentErrorDialog",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:e instanceof Error?e.name:"Unknown Error",message:e instanceof Error?e.message:JSON.stringify(e),buttons:[{text:"ok"}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}},t,this)}))}},{key:"ngOnDestroy",value:function(){this.mediaStream$.pipe(Object(A.b)(),Object(O.a)(function(e){return e.getTracks().forEach(function(e){return e.stop()})})).subscribe()}}]),e}()).\u0275fac=function(e){return new(e||L)(k.Kb(h.F),k.Kb(h.a),k.Kb(B.a))},L.\u0275cmp=k.Eb({type:L,selectors:[["app-camera"]],viewQuery:function(e,t){var n;1&e&&k.qc(T,1),2&e&&k.hc(n=k.Yb())&&(t.videoElement=n.first)},decls:7,vars:1,consts:[["fill","clear",1,"dismiss",3,"click"],["slot","icon-only","name","close-outline","color","light"],["fill","clear",1,"capture",3,"click"],["slot","icon-only","name","radio-button-on-outline","color","light"],["class","captured ion-margin",4,"ngrxLet"],["playsinline","","autoplay",""],["video",""],[1,"captured","ion-margin"],["ionImgViewer","",3,"src"]],template:function(e,t){1&e&&(k.Pb(0,"ion-button",0),k.Xb("click",function(){return t.dismiss()}),k.Lb(1,"ion-icon",1),k.Ob(),k.Pb(2,"ion-button",2),k.Xb("click",function(){return t.capture()}),k.Lb(3,"ion-icon",3),k.Ob(),k.lc(4,Q,2,1,"div",4),k.Lb(5,"video",5,6)),2&e&&(k.Ab(4),k.fc("ngrxLet",t.capturedImageUrl$))},directives:[h.e,h.n,j.a,P.a,o.a],styles:["[_nghost-%COMP%]{display:contents;position:relative}video[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center}ion-button.dismiss[_ngcontent-%COMP%]{right:0;width:48px;height:48px}ion-button.capture[_ngcontent-%COMP%], ion-button.dismiss[_ngcontent-%COMP%]{position:absolute;z-index:1;--border-radius:50%;--padding-end:0;--padding-start:0}ion-button.capture[_ngcontent-%COMP%]{bottom:0;left:50%;transform:translate(-50%);height:72px;width:72px;margin:0 0 var(--ion-margin,16px);--background:rgba(0,0,0,0.4)}ion-button.capture[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px}.captured[_ngcontent-%COMP%]{position:absolute;bottom:16px;right:16px;overflow:hidden;border-radius:4px;border:1px solid var(--ion-color-light-shade)}.captured[_ngcontent-%COMP%]   app-image[_ngcontent-%COMP%]{z-index:1;width:60px;height:60px}"]}),L=Object(c.b)([Object(v.a)()],L)),R=r("kiQV"),U=r("kgew"),S=r("ofXK");function D(e,t){if(1&e&&(k.Pb(0,"ion-select-option",7),k.mc(1),k.Ob()),2&e){var n=t.$implicit;k.fc("value",n),k.Ab(1),k.oc(" ",n," ")}}function H(e,t){if(1&e){var n=k.Qb();k.Pb(0,"ion-select",5),k.Xb("ionChange",function(e){return k.ic(n),k.Zb().onChangeDarkTheme(e)}),k.lc(1,D,2,2,"ion-select-option",6),k.Ob()}if(2&e){var r=t.ngrxLet,i=k.Zb();k.fc("value",r),k.Ab(1),k.fc("ngForOf",i.themes)}}var z,F=((z=function(){function e(t){f(this,e),this.settingsService=t,this.themes=U.a.THEMES,this.theme$=this.settingsService.theme$,this.version=R.a}return p(e,[{key:"onChangeDarkTheme",value:function(e){return this.settingsService.setTheme$(e.detail.value).pipe(Object(v.b)(this)).subscribe()}}]),e}()).\u0275fac=function(e){return new(e||z)(k.Kb(U.a))},z.\u0275cmp=k.Eb({type:z,selectors:[["app-settings"]],decls:12,vars:2,consts:[["lines","none"],["name","moon-outline","slot","start"],[3,"value","ionChange",4,"ngrxLet"],["name","information-outline","slot","start"],["slot","end"],[3,"value","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(k.Pb(0,"ion-list",0),k.Pb(1,"ion-item"),k.Lb(2,"ion-icon",1),k.Pb(3,"ion-label"),k.mc(4,"Theme"),k.Ob(),k.lc(5,H,2,2,"ion-select",2),k.Ob(),k.Pb(6,"ion-item"),k.Lb(7,"ion-icon",3),k.Pb(8,"ion-label"),k.mc(9,"Version"),k.Ob(),k.Pb(10,"ion-note",4),k.mc(11),k.Ob(),k.Ob(),k.Ob()),2&e&&(k.Ab(5),k.fc("ngrxLet",t.theme$),k.Ab(6),k.nc(t.version))},directives:[h.r,h.p,h.n,h.q,j.a,h.s,h.w,h.J,S.j,h.x],styles:["ion-select[_ngcontent-%COMP%]{max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content}"]}),z=Object(c.b)([Object(v.a)()],z)),N=function(e){return{id:e}};function q(e,t){if(1&e&&(k.Pb(0,"app-image",2),k.Lb(1,"ion-ripple-effect"),k.Ob()),2&e){var n=t.ngrxLet,r=k.Zb().ngrxLet;k.fc("queryParams",k.gc(2,N,r.id))("src",n)}}function G(e,t){if(1&e&&(k.Nb(0),k.lc(1,q,2,4,"app-image",1),k.Mb()),2&e){var n=t.ngrxLet;k.Ab(1),k.fc("ngrxLet",n.thumbnailUrl$)}}var X,V=((X=function(){function e(){f(this,e),this._juncture$=new l.a(void 0),this.juncture$=this._juncture$.pipe(Object(A.b)(),Object(b.a)(function(e,t){return e.id===t.id}))}return p(e,[{key:"juncture",set:function(e){this._juncture$.next(e)}}]),e}()).\u0275fac=function(e){return new(e||X)},X.\u0275cmp=k.Eb({type:X,selectors:[["app-juncture-thumbnail"]],inputs:{juncture:"juncture"},decls:1,vars:1,consts:[[4,"ngrxLet"],["routerLink","photo","class","ion-activatable",3,"queryParams","src",4,"ngrxLet"],["routerLink","photo",1,"ion-activatable",3,"queryParams","src"]],template:function(e,t){1&e&&k.lc(0,G,2,1,"ng-container",0),2&e&&k.fc("ngrxLet",t.juncture$)},directives:[j.a,P.a,h.I,s.h,h.t],styles:["[_nghost-%COMP%]{display:block;overflow:hidden}app-image[_ngcontent-%COMP%]{position:relative;height:100%;width:100%}"]}),X);function $(e,t){if(1&e&&(k.Pb(0,"ion-col",8,9),k.Lb(2,"app-juncture-thumbnail",10),k.Ob()),2&e){var n=t.$implicit;k.Ab(2),k.fc("juncture",n)}}var K,Y,W,J=[{path:"",component:(K=function(){function e(t,n,r){var i=this;f(this,e),this.popoverController=t,this.modalController=n,this.junctureRepository=r,this.junctures$=this.junctureRepository.all$,this._ionContent$=new l.a(void 0),this.ionContent$=this._ionContent$.pipe(Object(A.b)(),Object(b.a)()),this._scrollEvent$=new d.a,this.scrollEvent$=this._scrollEvent$.pipe(Object(b.a)()),this.noFooterBorder$=Object(g.a)([this.ionContent$,this.scrollEvent$]).pipe(Object(m.a)(function(e){var t=u(e,1)[0];return i.detectBottom(t)}))}return p(e,[{key:"ionContent",set:function(e){this._ionContent$.next(e)}},{key:"onScroll",value:function(e){this._scrollEvent$.next(e)}},{key:"detectBottom",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getScrollElement();case 2:return n=t.sent,t.abrupt("return",n.scrollTop===n.scrollHeight-n.clientHeight);case 4:case"end":return t.stop()}},t)}))}},{key:"presentSettings",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.popoverController.create({component:F,event:e});case 2:return n=t.sent,t.next=5,n.present();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}))}},{key:"presentCamera",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:M});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}))}},{key:"trackJuncture",value:function(e,t){return t.id}}]),e}(),K.\u0275fac=function(e){return new(e||K)(k.Kb(h.H),k.Kb(h.F),k.Kb(B.a))},K.\u0275cmp=k.Eb({type:K,selectors:[["app-home"]],viewQuery:function(e,t){var n;1&e&&k.qc(h.h,1),2&e&&k.hc(n=k.Yb())&&(t.ionContent=n.first)},decls:14,vars:8,consts:[["scrollEvents","",3,"ionScroll"],["size","6","size-sm","4","size-md","3","size-lg","2",4,"ngFor","ngForOf","ngForTrackBy"],["vertical","bottom","horizontal","center","slot","fixed","edge",""],[3,"click"],["name","camera-outline"],["slot","primary"],["slot","secondary",3,"click"],["slot","icon-only","name","settings-outline"],["size","6","size-sm","4","size-md","3","size-lg","2"],["col",""],[3,"juncture"]],template:function(e,t){1&e&&(k.Pb(0,"ion-content",0),k.Xb("ionScroll",function(e){return t.onScroll(e)}),k.Pb(1,"ion-grid"),k.Pb(2,"ion-row"),k.lc(3,$,3,1,"ion-col",1),k.ac(4,"ngrxPush"),k.Ob(),k.Ob(),k.Pb(5,"ion-fab",2),k.Pb(6,"ion-fab-button",3),k.Xb("click",function(){return t.presentCamera()}),k.Lb(7,"ion-icon",4),k.Ob(),k.Ob(),k.Ob(),k.Pb(8,"ion-footer"),k.ac(9,"ngrxPush"),k.Pb(10,"ion-toolbar"),k.Pb(11,"ion-buttons",5),k.Pb(12,"ion-button",6),k.Xb("click",function(e){return t.presentSettings(e)}),k.Lb(13,"ion-icon",7),k.Ob(),k.Ob(),k.Ob(),k.Ob()),2&e&&(k.Ab(3),k.fc("ngForOf",k.bc(4,4,t.junctures$))("ngForTrackBy",t.trackJuncture),k.Ab(5),k.Cb("ion-no-border",k.bc(9,6,t.noFooterBorder$)))},directives:[h.h,h.l,h.v,S.j,h.i,h.j,h.n,h.k,h.C,h.f,h.e,h.g,V],pipes:[j.b],styles:["app-juncture-thumbnail[_ngcontent-%COMP%]{height:150px;border-radius:4px;box-shadow:0 2px 8px 0 rgba(99,99,99,.2)}"]}),K)},{path:"photo",loadChildren:function(){return r.e(61).then(r.bind(null,"MTLF")).then(function(e){return e.PhotoPageModule})}}],Z=((W=function e(){f(this,e)}).\u0275mod=k.Ib({type:W}),W.\u0275inj=k.Hb({factory:function(e){return new(e||W)},imports:[[s.i.forChild(J)],s.i]}),W),ee=((Y=function e(){f(this,e)}).\u0275mod=k.Ib({type:Y}),Y.\u0275inj=k.Hb({factory:function(e){return new(e||Y)},imports:[[a.a,Z,o.b]]}),Y)},kTgZ:function(t,r,o){"use strict";o.d(r,"a",function(){return H});var a=o("NXyV"),s=o("cp0P"),h=o("bOdf"),l=o("wO+i"),d=o("UXun"),g=o("lJxs"),b=o("SxV6"),m=o("mrSG");function A(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=crypto.subtle,t.next=3,e.arrayBuffer();case 3:return t.t1=t.sent,t.next=6,t.t0.digest.call(t.t0,"SHA-256",t.t1);case 6:return n=t.sent,t.abrupt("return",c(new Uint8Array(n)).map(function(e){return e.toString(16).padStart(2,"0")}).join(""));case 8:case"end":return t.stop()}},t)}))}function v(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,t){navigator.geolocation.getCurrentPosition(function(t){return e(t)},function(e){return t(e)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}));case 1:case"end":return e.stop()}},e)}))}());case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return");case 7:case"end":return e.stop()}},e,null,[[0,4]])}))}var y=o("LRne"),w=function(e){n(r,e);var t=i(r);function r(){var e;return f(this,r),(e=t.apply(this,arguments)).name=r.name,e}return r}(e(Error));function _(e,t){var n={};return t.forEach(function(t){Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}),n}var I={assign:function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=Object(arguments[n]))Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},pick:_,pick_pica_resize_options:function(e){return _(e,["alpha","unsharpAmount","unsharpRadius","unsharpThreshold","cancelToken"])}};function E(e){var t={exports:{}};return e(t,t.exports),t.exports}function C(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}var x=E(function(e,t){e.exports=function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){if(!s&&C)return C(a);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){return i(t[a][1][e]||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var o=C,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){var r=e("inherits"),i=e("multimath"),o=e("multimath/lib/unsharp_mask"),a=e("./mm_resize");function s(e){var t=e||[],n={js:t.indexOf("js")>=0,wasm:t.indexOf("wasm")>=0};i.call(this,n),this.features={js:n.js,wasm:n.wasm&&this.has_wasm()},this.use(o),this.use(a)}r(s,i),s.prototype.resizeAndUnsharp=function(e,t){var n=this.resize(e,t);return e.unsharpAmount&&this.unsharp_mask(n,e.toWidth,e.toHeight,e.unsharpAmount,e.unsharpRadius,e.unsharpThreshold),n},t.exports=s},{"./mm_resize":4,inherits:15,multimath:16,"multimath/lib/unsharp_mask":19}],2:[function(e,t,n){function r(e){return e<0?0:e>255?255:e}t.exports={convolveHorizontally:function(e,t,n,i,o,a){var s,u,c,h,l,f,d,p,g,b,m,A=0,v=0;for(g=0;g<i;g++){for(l=0,b=0;b<o;b++){for(f=a[l++],d=a[l++],p=A+4*f|0,s=u=c=h=0;d>0;d--)h=h+(m=a[l++])*e[p+3]|0,c=c+m*e[p+2]|0,u=u+m*e[p+1]|0,s=s+m*e[p]|0,p=p+4|0;t[v+3]=r(h+8192>>14),t[v+2]=r(c+8192>>14),t[v+1]=r(u+8192>>14),t[v]=r(s+8192>>14),v=v+4*i|0}v=4*(g+1)|0,A=(g+1)*n*4|0}},convolveVertically:function(e,t,n,i,o,a){var s,u,c,h,l,f,d,p,g,b,m,A=0,v=0;for(g=0;g<i;g++){for(l=0,b=0;b<o;b++){for(f=a[l++],d=a[l++],p=A+4*f|0,s=u=c=h=0;d>0;d--)h=h+(m=a[l++])*e[p+3]|0,c=c+m*e[p+2]|0,u=u+m*e[p+1]|0,s=s+m*e[p]|0,p=p+4|0;t[v+3]=r(h+8192>>14),t[v+2]=r(c+8192>>14),t[v+1]=r(u+8192>>14),t[v]=r(s+8192>>14),v=v+4*i|0}v=4*(g+1)|0,A=(g+1)*n*4|0}}}},{}],3:[function(e,t,n){t.exports="AGFzbQEAAAABFAJgBn9/f39/fwBgB39/f39/f38AAg8BA2VudgZtZW1vcnkCAAEDAwIAAQQEAXAAAAcZAghjb252b2x2ZQAACmNvbnZvbHZlSFYAAQkBAArmAwLBAwEQfwJAIANFDQAgBEUNACAFQQRqIRVBACEMQQAhDQNAIA0hDkEAIRFBACEHA0AgB0ECaiESAn8gBSAHQQF0IgdqIgZBAmouAQAiEwRAQQAhCEEAIBNrIRQgFSAHaiEPIAAgDCAGLgEAakECdGohEEEAIQlBACEKQQAhCwNAIBAoAgAiB0EYdiAPLgEAIgZsIAtqIQsgB0H/AXEgBmwgCGohCCAHQRB2Qf8BcSAGbCAKaiEKIAdBCHZB/wFxIAZsIAlqIQkgD0ECaiEPIBBBBGohECAUQQFqIhQNAAsgEiATagwBC0EAIQtBACEKQQAhCUEAIQggEgshByABIA5BAnRqIApBgMAAakEOdSIGQf8BIAZB/wFIG0EQdEGAgPwHcUEAIAZBAEobIAtBgMAAakEOdSIGQf8BIAZB/wFIG0EYdEEAIAZBAEobciAJQYDAAGpBDnUiBkH/ASAGQf8BSBtBCHRBgP4DcUEAIAZBAEobciAIQYDAAGpBDnUiBkH/ASAGQf8BSBtB/wFxQQAgBkEAShtyNgIAIA4gA2ohDiARQQFqIhEgBEcNAAsgDCACaiEMIA1BAWoiDSADRw0ACwsLIQACQEEAIAIgAyAEIAUgABAAIAJBACAEIAUgBiABEAALCw=="},{}],4:[function(e,t,n){t.exports={name:"resize",fn:e("./resize"),wasm_fn:e("./resize_wasm"),wasm_src:e("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(e,t,n){var r=e("./resize_filter_gen"),i=e("./convolve").convolveHorizontally,o=e("./convolve").convolveVertically;t.exports=function(e){var t=e.src,n=e.width,a=e.height,s=e.toWidth,u=e.toHeight,c=e.scaleX||e.toWidth/e.width,h=e.scaleY||e.toHeight/e.height,l=e.offsetX||0,f=e.offsetY||0,d=e.dest||new Uint8Array(s*u*4),p=void 0===e.quality?3:e.quality,g=e.alpha||!1,b=r(p,n,s,c,l),m=r(p,a,u,h,f),A=new Uint8Array(s*a*4);return i(t,A,n,a,s,b),o(A,d,a,s,u,m),g||function(e,t,n){for(var r=3,i=t*n*4|0;r<i;)e[r]=255,r=r+4|0}(d,s,u),d}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(e,t,n){var r=e("./resize_filter_info");function i(e){return Math.round(16383*e)}t.exports=function(e,t,n,o,a){var s,u,c,h,l,f,d,p,g,b,m,A,v,y,w,_,I=r[e].filter,E=1/o,C=Math.min(1,o),x=r[e].win/C,O=Math.floor(2*(x+1)),k=new Int16Array((O+2)*n),B=0,j=!k.subarray||!k.set;for(s=0;s<n;s++){for(u=(s+.5)*E+a,c=Math.max(0,Math.floor(u-x)),l=(h=Math.min(t-1,Math.ceil(u+x)))-c+1,f=new Float32Array(l),d=new Int16Array(l),p=0,g=c,b=0;g<=h;g++,b++)p+=m=I((g+.5-u)*C),f[b]=m;for(A=0,b=0;b<f.length;b++)A+=v=f[b]/p,d[b]=i(v);for(d[n>>1]+=i(1-A),y=0;y<d.length&&0===d[y];)y++;if(y<d.length){for(w=d.length-1;w>0&&0===d[w];)w--;if(_=w-y+1,k[B++]=c+y,k[B++]=_,j)for(b=y;b<=w;b++)k[B++]=d[b];else k.set(d.subarray(y,w+1),B),B+=_}else k[B++]=0,k[B++]=0}return k}},{"./resize_filter_info":7}],7:[function(e,t,n){t.exports=[{win:.5,filter:function(e){return e>=-.5&&e<.5?1:0}},{win:1,filter:function(e){if(e<=-1||e>=1)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*(.54+.46*Math.cos(t/1))}},{win:2,filter:function(e){if(e<=-2||e>=2)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/2)/(t/2)}},{win:3,filter:function(e){if(e<=-3||e>=3)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/3)/(t/3)}}]},{}],8:[function(e,t,n){var r=e("./resize_filter_gen"),i=!0;try{i=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]}catch(a){}function o(e,t,n){if(i)t.set(function(e){return new Uint8Array(e.buffer,0,e.byteLength)}(e),n);else for(var r=n,o=0;o<e.length;o++){var a=e[o];t[r++]=255&a,t[r++]=a>>8&255}}t.exports=function(e){var t=e.src,n=e.width,i=e.height,a=e.toWidth,s=e.toHeight,u=e.scaleX||e.toWidth/e.width,c=e.scaleY||e.toHeight/e.height,h=e.offsetX||0,l=e.offsetY||0,f=e.dest||new Uint8Array(a*s*4),d=void 0===e.quality?3:e.quality,p=e.alpha||!1,g=r(d,n,a,u,h),b=r(d,i,s,c,l),m=this.__align(0+Math.max(t.byteLength,f.byteLength)),A=this.__align(m+i*a*4),v=this.__align(A+g.byteLength),y=this.__instance("resize",v+b.byteLength),w=new Uint8Array(this.__memory.buffer),_=new Uint32Array(this.__memory.buffer),I=new Uint32Array(t.buffer);return _.set(I),o(g,w,A),o(b,w,v),(y.exports.convolveHV||y.exports._convolveHV)(A,v,m,n,i,a,s),new Uint32Array(f.buffer).set(new Uint32Array(this.__memory.buffer,0,s*a)),p||function(e,t,n){for(var r=3,i=t*n*4|0;r<i;)e[r]=255,r=r+4|0}(f,a,s),f}},{"./resize_filter_gen":6}],9:[function(e,t,n){function r(e,t){this.create=e,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=t||2e3}r.prototype.acquire=function(){var e,t=this;return 0!==this.available.length?e=this.available.pop():((e=this.create()).id=this.lastId++,e.release=function(){return t.release(e)}),this.acquired[e.id]=e,e},r.prototype.release=function(e){var t=this;delete this.acquired[e.id],e.lastUsed=Date.now(),this.available.push(e),0===this.timeoutId&&(this.timeoutId=setTimeout(function(){return t.gc()},100))},r.prototype.gc=function(){var e=this,t=Date.now();this.available=this.available.filter(function(n){return!(t-n.lastUsed>e.idle&&(n.destroy(),1))}),this.timeoutId=0!==this.available.length?setTimeout(function(){return e.gc()},100):0},t.exports=r},{}],10:[function(e,t,n){t.exports=function(e,t,n,r,i,o){var a=(2*o+2+1)/i;if(a>.5)return[[n,r]];var s=Math.ceil(Math.log(Math.min(n/e,r/t))/Math.log(a));if(s<=1)return[[n,r]];for(var u=[],c=0;c<s;c++){var h=Math.round(Math.pow(Math.pow(e,s-c-1)*Math.pow(n,c+1),1/s)),l=Math.round(Math.pow(Math.pow(t,s-c-1)*Math.pow(r,c+1),1/s));u.push([h,l])}return u}},{}],11:[function(e,t,n){function r(e){var t=Math.round(e);return Math.abs(e-t)<1e-5?t:Math.floor(e)}function i(e){var t=Math.round(e);return Math.abs(e-t)<1e-5?t:Math.ceil(e)}t.exports=function(e){var t,n,o,a,s,u,c=e.toWidth/e.width,h=e.toHeight/e.height,l=r(e.srcTileSize*c)-2*e.destTileBorder,f=r(e.srcTileSize*h)-2*e.destTileBorder;if(l<1||f<1)throw new Error("Internal error in pica: target tile width/height is too small.");var d,p=[];for(a=0;a<e.toHeight;a+=f)for(o=0;o<e.toWidth;o+=l)(t=o-e.destTileBorder)<0&&(t=0),t+(s=o+l+e.destTileBorder-t)>=e.toWidth&&(s=e.toWidth-t),(n=a-e.destTileBorder)<0&&(n=0),n+(u=a+f+e.destTileBorder-n)>=e.toHeight&&(u=e.toHeight-n),d={toX:t,toY:n,toWidth:s,toHeight:u,toInnerX:o,toInnerY:a,toInnerWidth:l,toInnerHeight:f,offsetX:t/c-r(t/c),offsetY:n/h-r(n/h),scaleX:c,scaleY:h,x:r(t/c),y:r(n/h),width:i(s/c),height:i(u/h)},p.push(d);return p}},{}],12:[function(e,t,n){function r(e){return Object.prototype.toString.call(e)}t.exports.isCanvas=function(e){var t=r(e);return"[object HTMLCanvasElement]"===t||"[object OffscreenCanvas]"===t||"[object Canvas]"===t},t.exports.isImage=function(e){return"[object HTMLImageElement]"===r(e)},t.exports.isImageBitmap=function(e){return"[object ImageBitmap]"===r(e)},t.exports.limiter=function(e){var t=0,n=[];function r(){t<e&&n.length&&(t++,n.shift()())}return function(e){return new Promise(function(i,o){n.push(function(){e().then(function(e){i(e),t--,r()},function(e){o(e),t--,r()})}),r()})}},t.exports.cib_quality_name=function(e){switch(e){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},t.exports.cib_support=function(e){return Promise.resolve().then(function(){if("undefined"==typeof createImageBitmap)return!1;var t=e(100,100);return createImageBitmap(t,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(e){var n=10===e.width;return e.close(),t=null,n})}).catch(function(){return!1})}},{}],13:[function(e,t,n){t.exports=function(){var t,n=e("./mathlib");onmessage=function(e){var r=e.data.opts;t||(t=new n(e.data.features));var i=t.resizeAndUnsharp(r);postMessage({result:i},[i.buffer])}}},{"./mathlib":1}],14:[function(e,t,n){var r,i,o,a,s,u;function c(e,t,n,r,i,o){var a,s,u,c,h,l,f,d,p,g,b,m,A,v;for(p=0;p<o;p++){for(f=p,d=0,c=h=(a=e[l=p*i])*r[6],b=r[0],m=r[1],A=r[4],v=r[5],g=0;g<i;g++)u=(s=e[l])*b+a*m+c*A+h*v,h=c,a=s,n[d]=c=u,d++,l++;for(d--,f+=o*(i-1),c=h=(a=e[--l])*r[7],s=a,b=r[2],m=r[3],g=i-1;g>=0;g--)u=s*b+a*m+c*A+h*v,h=c,a=s,s=e[l],t[f]=n[d]+(c=u),l--,d--,f-=o}}t.exports=function(e,t,n,h){if(h){var l=new Uint16Array(e.length),f=new Float32Array(Math.max(t,n)),d=function(e){e<.5&&(e=.5);var t=Math.exp(.527076)/e,n=Math.exp(-t),c=Math.exp(-2*t),h=(1-n)*(1-n)/(1+2*t*n-c);return r=h,i=h*(t-1)*n,o=h*(t+1)*n,a=-h*c,s=2*n,u=-c,new Float32Array([r,i,o,a,s,u,(r+i)/(1-s-u),(o+a)/(1-s-u)])}(h);c(e,l,f,d,t,n),c(l,e,f,d,n,t)}}},{}],15:[function(e,t,n){t.exports="function"==typeof Object.create?function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},{}],16:[function(e,t,n){var r=e("object-assign"),i=e("./lib/base64decode"),o=e("./lib/wa_detect"),a={js:!0,wasm:!0};function s(e){if(!(this instanceof s))return new s(e);var t=r({},a,e||{});if(this.options=t,this.__cache={},this.__init_promise=null,this.__modules=t.modules||{},this.__memory=null,this.__wasm={},this.__isLE=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0],!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}s.prototype.has_wasm=o,s.prototype.use=function(e){return this.__modules[e.name]=e,this[e.name]=this.options.wasm&&this.has_wasm()&&e.wasm_fn?e.wasm_fn:e.fn,this},s.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error('mathlib: only "wasm" was enabled, but it\'s not supported'));var e=this;return this.__init_promise=Promise.all(Object.keys(e.__modules).map(function(t){var n=e.__modules[t];return e.options.wasm&&e.has_wasm()&&n.wasm_fn?e.__wasm[t]?null:WebAssembly.compile(e.__base64decode(n.wasm_src)).then(function(n){e.__wasm[t]=n}):null})).then(function(){return e}),this.__init_promise},s.prototype.__base64decode=i,s.prototype.__reallocate=function(e){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(e/65536)}),this.__memory;var t=this.__memory.buffer.byteLength;return t<e&&this.__memory.grow(Math.ceil((e-t)/65536)),this.__memory},s.prototype.__instance=function(e,t,n){if(t&&this.__reallocate(t),this.__wasm[e]||(this.__wasm[e]=new WebAssembly.Module(this.__base64decode(this.__modules[e].wasm_src))),!this.__cache[e]){var i={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[e]=new WebAssembly.Instance(this.__wasm[e],{env:r(i,n||{})})}return this.__cache[e]},s.prototype.__align=function(e,t){var n=e%(t=t||8);return e+(n?t-n:0)},t.exports=s},{"./lib/base64decode":17,"./lib/wa_detect":23,"object-assign":24}],17:[function(e,t,n){t.exports=function(e){for(var t=e.replace(/[\r\n=]/g,""),n=t.length,r=new Uint8Array(3*n>>2),i=0,o=0,a=0;a<n;a++)a%4==0&&a&&(r[o++]=i>>16&255,r[o++]=i>>8&255,r[o++]=255&i),i=i<<6|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(a));var s=n%4*6;return 0===s?(r[o++]=i>>16&255,r[o++]=i>>8&255,r[o++]=255&i):18===s?(r[o++]=i>>10&255,r[o++]=i>>2&255):12===s&&(r[o++]=i>>4&255),r}},{}],18:[function(e,t,n){t.exports=function(e,t,n){for(var r,i,o,a=t*n,s=new Uint16Array(a),u=0;u<a;u++)o=e[4*u+2],s[u]=257*(((r=e[4*u])>=(i=e[4*u+1])&&r>=o?r:i>=o&&i>=r?i:o)+(r<=i&&r<=o?r:i<=o&&i<=r?i:o))>>1;return s}},{}],19:[function(e,t,n){t.exports={name:"unsharp_mask",fn:e("./unsharp_mask"),wasm_fn:e("./unsharp_mask_wasm"),wasm_src:e("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":20,"./unsharp_mask_wasm":21,"./unsharp_mask_wasm_base64":22}],20:[function(e,t,n){var r=e("glur/mono16"),i=e("./hsl_l16");t.exports=function(e,t,n,o,a,s){var u,c,h,l,f,d,p,g,b,m,A,v,y;if(!(0===o||a<.5)){a>2&&(a=2);var w=i(e,t,n),_=new Uint16Array(w);r(_,t,n,a);for(var I=o/100*4096+.5|0,E=257*s|0,C=t*n,x=0;x<C;x++)v=2*(w[x]-_[x]),Math.abs(v)>=E&&(h=e[2+(y=4*x)],d=257*((g=(u=e[y])>=(c=e[y+1])&&u>=h?u:c>=u&&c>=h?c:h)+(p=u<=c&&u<=h?u:c<=u&&c<=h?c:h))>>1,p===g?l=f=0:(f=d<=32767?4095*(g-p)/(g+p)|0:4095*(g-p)/(510-g-p)|0,l=u===g?65535*(c-h)/(6*(g-p))|0:c===g?21845+(65535*(h-u)/(6*(g-p))|0):43690+(65535*(u-c)/(6*(g-p))|0)),(d+=I*v+2048>>12)>65535?d=65535:d<0&&(d=0),0===f?u=c=h=d>>8:(b=2*d-(m=d<=32767?d*(4096+f)+2048>>12:d+((65535-d)*f+2048>>12))>>8,m>>=8,u=(A=l+21845&65535)>=43690?b:A>=32767?b+(6*(m-b)*(43690-A)+32768>>16):A>=10922?m:b+(6*(m-b)*A+32768>>16),c=(A=65535&l)>=43690?b:A>=32767?b+(6*(m-b)*(43690-A)+32768>>16):A>=10922?m:b+(6*(m-b)*A+32768>>16),h=(A=l-21845&65535)>=43690?b:A>=32767?b+(6*(m-b)*(43690-A)+32768>>16):A>=10922?m:b+(6*(m-b)*A+32768>>16)),e[y]=u,e[y+1]=c,e[y+2]=h)}}},{"./hsl_l16":18,"glur/mono16":14}],21:[function(e,t,n){t.exports=function(e,t,n,r,i,o){if(!(0===r||i<.5)){i>2&&(i=2);var a=t*n,s=4*a,u=2*a,c=2*a,h=4*Math.max(t,n),l=s,f=l+u,d=f+c,p=d+c,g=p+h,b=this.__instance("unsharp_mask",s+u+2*c+h+32,{exp:Math.exp}),m=new Uint32Array(e.buffer);new Uint32Array(this.__memory.buffer).set(m);var A=b.exports.hsl_l16||b.exports._hsl_l16;A(0,l,t,n),(A=b.exports.blurMono16||b.exports._blurMono16)(l,f,d,p,g,t,n,i),(A=b.exports.unsharp||b.exports._unsharp)(0,0,l,f,t,n,r,o),m.set(new Uint32Array(this.__memory.buffer,0,a))}}},{}],22:[function(e,t,n){t.exports="AGFzbQEAAAABMQZgAXwBfGACfX8AYAZ/f39/f38AYAh/f39/f39/fQBgBH9/f38AYAh/f39/f39/fwACGQIDZW52A2V4cAAAA2VudgZtZW1vcnkCAAEDBgUBAgMEBQQEAXAAAAdMBRZfX2J1aWxkX2dhdXNzaWFuX2NvZWZzAAEOX19nYXVzczE2X2xpbmUAAgpibHVyTW9ubzE2AAMHaHNsX2wxNgAEB3Vuc2hhcnAABQkBAAqJEAXZAQEGfAJAIAFE24a6Q4Ia+z8gALujIgOaEAAiBCAEoCIGtjgCECABIANEAAAAAAAAAMCiEAAiBbaMOAIUIAFEAAAAAAAA8D8gBKEiAiACoiAEIAMgA6CiRAAAAAAAAPA/oCAFoaMiArY4AgAgASAEIANEAAAAAAAA8L+gIAKioiIHtjgCBCABIAQgA0QAAAAAAADwP6AgAqKiIgO2OAIIIAEgBSACoiIEtow4AgwgASACIAegIAVEAAAAAAAA8D8gBqGgIgKjtjgCGCABIAMgBKEgAqO2OAIcCwu3AwMDfwR9CHwCQCADKgIUIQkgAyoCECEKIAMqAgwhCyADKgIIIQwCQCAEQX9qIgdBAEgiCA0AIAIgAC8BALgiDSADKgIYu6IiDiAJuyIQoiAOIAq7IhGiIA0gAyoCBLsiEqIgAyoCALsiEyANoqCgoCIPtjgCACACQQRqIQIgAEECaiEAIAdFDQAgBCEGA0AgAiAOIBCiIA8iDiARoiANIBKiIBMgAC8BALgiDaKgoKAiD7Y4AgAgAkEEaiECIABBAmohACAGQX9qIgZBAUoNAAsLAkAgCA0AIAEgByAFbEEBdGogAEF+ai8BACIIuCINIAu7IhGiIA0gDLsiEqKgIA0gAyoCHLuiIg4gCrsiE6KgIA4gCbsiFKKgIg8gAkF8aioCALugqzsBACAHRQ0AIAJBeGohAiAAQXxqIQBBACAFQQF0ayEHIAEgBSAEQQF0QXxqbGohBgNAIAghAyAALwEAIQggBiANIBGiIAO4Ig0gEqKgIA8iECAToqAgDiAUoqAiDyACKgIAu6CrOwEAIAYgB2ohBiAAQX5qIQAgAkF8aiECIBAhDiAEQX9qIgRBAUoNAAsLCwvfAgIDfwZ8AkAgB0MAAAAAWw0AIARE24a6Q4Ia+z8gB0MAAAA/l7ujIgyaEAAiDSANoCIPtjgCECAEIAxEAAAAAAAAAMCiEAAiDraMOAIUIAREAAAAAAAA8D8gDaEiCyALoiANIAwgDKCiRAAAAAAAAPA/oCAOoaMiC7Y4AgAgBCANIAxEAAAAAAAA8L+gIAuioiIQtjgCBCAEIA0gDEQAAAAAAADwP6AgC6KiIgy2OAIIIAQgDiALoiINtow4AgwgBCALIBCgIA5EAAAAAAAA8D8gD6GgIgujtjgCGCAEIAwgDaEgC6O2OAIcIAYEQCAFQQF0IQogBiEJIAIhCANAIAAgCCADIAQgBSAGEAIgACAKaiEAIAhBAmohCCAJQX9qIgkNAAsLIAVFDQAgBkEBdCEIIAUhAANAIAIgASADIAQgBiAFEAIgAiAIaiECIAFBAmohASAAQX9qIgANAAsLC7wBAQV/IAMgAmwiAwRAQQAgA2shBgNAIAAoAgAiBEEIdiIHQf8BcSECAn8gBEH/AXEiAyAEQRB2IgRB/wFxIgVPBEAgAyIIIAMgAk8NARoLIAQgBCAHIAIgA0kbIAIgBUkbQf8BcQshCAJAIAMgAk0EQCADIAVNDQELIAQgByAEIAMgAk8bIAIgBUsbQf8BcSEDCyAAQQRqIQAgASADIAhqQYECbEEBdjsBACABQQJqIQEgBkEBaiIGDQALCwvTBgEKfwJAIAazQwAAgEWUQwAAyEKVu0QAAAAAAADgP6CqIQ0gBSAEbCILBEAgB0GBAmwhDgNAQQAgAi8BACADLwEAayIGQQF0IgdrIAcgBkEASBsgDk8EQCAAQQJqLQAAIQUCfyAALQAAIgYgAEEBai0AACIESSIJRQRAIAYiCCAGIAVPDQEaCyAFIAUgBCAEIAVJGyAGIARLGwshCAJ/IAYgBE0EQCAGIgogBiAFTQ0BGgsgBSAFIAQgBCAFSxsgCRsLIgogCGoiD0GBAmwiEEEBdiERQQAhDAJ/QQAiCSAIIApGDQAaIAggCmsiCUH/H2wgD0H+AyAIayAKayAQQYCABEkbbSEMIAYgCEYEQCAEIAVrQf//A2wgCUEGbG0MAQsgBSAGayAGIARrIAQgCEYiBhtB//8DbCAJQQZsbUHVqgFBqtUCIAYbagshCSARIAcgDWxBgBBqQQx1aiIGQQAgBkEAShsiBkH//wMgBkH//wNIGyEGAkACfwJAIAxB//8DcSIFBEAgBkH//wFKDQEgBUGAIGogBmxBgBBqQQx2DAILIAZBCHYiBiEFIAYhBAwCCyAFIAZB//8Dc2xBgBBqQQx2IAZqCyIFQQh2IQcgBkEBdCAFa0EIdiIGIQQCQCAJQdWqAWpB//8DcSIFQanVAksNACAFQf//AU8EQEGq1QIgBWsgByAGa2xBBmxBgIACakEQdiAGaiEEDAELIAchBCAFQanVAEsNACAFIAcgBmtsQQZsQYCAAmpBEHYgBmohBAsCfyAGIgUgCUH//wNxIghBqdUCSw0AGkGq1QIgCGsgByAGa2xBBmxBgIACakEQdiAGaiAIQf//AU8NABogByIFIAhBqdUASw0AGiAIIAcgBmtsQQZsQYCAAmpBEHYgBmoLIQUgCUGr1QJqQf//A3EiCEGp1QJLDQAgCEH//wFPBEBBqtUCIAhrIAcgBmtsQQZsQYCAAmpBEHYgBmohBgwBCyAIQanVAEsEQCAHIQYMAQsgCCAHIAZrbEEGbEGAgAJqQRB2IAZqIQYLIAEgBDoAACABQQFqIAU6AAAgAUECaiAGOgAACyADQQJqIQMgAkECaiECIABBBGohACABQQRqIQEgC0F/aiILDQALCwsL"},{}],23:[function(e,t,n){var r;t.exports=function(){if(void 0!==r)return r;if(r=!1,"undefined"==typeof WebAssembly)return r;try{var e=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),t=new WebAssembly.Module(e);return 0!==new WebAssembly.Instance(t,{}).exports.test(4)&&(r=!0),r}catch(n){}return r}},{}],24:[function(e,t,n){var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,t){for(var n,s,u=a(e),c=1;c<arguments.length;c++){for(var h in n=Object(arguments[c]))i.call(n,h)&&(u[h]=n[h]);if(r){s=r(n);for(var l=0;l<s.length;l++)o.call(n,s[l])&&(u[s[l]]=n[s[l]])}}return u}},{}],25:[function(e,t,n){var r=arguments[3],i=arguments[4],o=arguments[5],a=JSON.stringify;t.exports=function(e,t){for(var n,s=Object.keys(o),u=0,c=s.length;u<c;u++){var h=o[f=s[u]].exports;if(h===e||h&&h.default===e){n=f;break}}if(!n){n=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var l={};for(u=0,c=s.length;u<c;u++){var f;l[f=s[u]]=f}i[n]=["function(require,module,exports){"+e+"(self); }",l]}var d=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[n]=n,i[d]=["function(require,module,exports){var f = require("+a(n)+");(f.default ? f.default : f)(self);}",p];var g={};!function e(t){for(var n in g[t]=!0,i[t][1]){var r=i[t][1][n];g[r]||e(r)}}(d);var b="("+r+")({"+Object.keys(g).map(function(e){return a(e)+":["+i[e][0]+","+a(i[e][1])+"]"}).join(",")+"},{},["+a(d)+"])",m=window.URL||window.webkitURL||window.mozURL||window.msURL,A=new Blob([b],{type:"text/javascript"});if(t&&t.bare)return A;var v=m.createObjectURL(A),y=new Worker(v);return y.objectURL=v,y}},{}],"/index.js":[function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=e("object-assign"),o=e("webworkify"),a=e("./lib/mathlib"),s=e("./lib/pool"),u=e("./lib/utils"),c=e("./lib/worker"),h=e("./lib/stepper"),l=e("./lib/tiler"),f={},d=!1;try{"undefined"!=typeof navigator&&navigator.userAgent&&(d=navigator.userAgent.indexOf("Safari")>=0)}catch(w){}var p=1;"undefined"!=typeof navigator&&(p=Math.min(navigator.hardwareConcurrency||1,4));var g,b,m={tile:1024,concurrency:p,features:["js","wasm","ww"],idle:2e3,createCanvas:function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}},A={quality:3,alpha:!1,unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0};function v(){return{value:o(c),destroy:function(){if(this.value.terminate(),"undefined"!=typeof window){var e=window.URL||window.webkitURL||window.mozURL||window.msURL;e&&e.revokeObjectURL&&this.value.objectURL&&e.revokeObjectURL(this.value.objectURL)}}}}function y(e){if(!(this instanceof y))return new y(e);this.options=i({},m,e||{});var t="lk_".concat(this.options.concurrency);this.__limit=f[t]||u.limiter(this.options.concurrency),f[t]||(f[t]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}y.prototype.init=function(){var t=this;if(this.__initPromise)return this.__initPromise;if(!1!==g&&!0!==g&&(g=!1,"undefined"!=typeof ImageData&&"undefined"!=typeof Uint8ClampedArray))try{new ImageData(new Uint8ClampedArray(400),10,10),g=!0}catch(h){}!1!==b&&!0!==b&&(b=!1,"undefined"!=typeof ImageBitmap&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?b=!0:this.debug("ImageBitmap does not support .close(), disabled")));var n=this.options.features.slice();if(n.indexOf("all")>=0&&(n=["cib","wasm","js","ww"]),this.__requested_features=n,this.__mathlib=new a(n),n.indexOf("ww")>=0&&"undefined"!=typeof window&&"Worker"in window)try{e("webworkify")(function(){}).terminate(),this.features.ww=!0;var r="wp_".concat(JSON.stringify(this.options));f[r]?this.__workersPool=f[r]:(this.__workersPool=new s(v,this.options.idle),f[r]=this.__workersPool)}catch(h){}var o,c=this.__mathlib.init().then(function(e){i(t.features,e.features)});return o=b?u.cib_support(this.options.createCanvas).then(function(e){t.features.cib&&n.indexOf("cib")<0?t.debug("createImageBitmap() resize supported, but disabled by config"):n.indexOf("cib")>=0&&(t.features.cib=e)}):Promise.resolve(!1),this.__initPromise=Promise.all([c,o]).then(function(){return t}),this.__initPromise},y.prototype.resize=function(e,t,n){var o=this;this.debug("Start resize...");var a=i({},A);if(isNaN(n)?n&&(a=i(a,n)):a=i(a,{quality:n}),a.toWidth=t.width,a.toHeight=t.height,a.width=e.naturalWidth||e.width,a.height=e.naturalHeight||e.height,0===t.width||0===t.height)return Promise.reject(new Error("Invalid output size: ".concat(t.width,"x").concat(t.height)));a.unsharpRadius>2&&(a.unsharpRadius=2);var s=!1,c=null;a.cancelToken&&(c=a.cancelToken.then(function(e){throw s=!0,e},function(e){throw s=!0,e}));var f=Math.ceil(Math.max(3,2.5*a.unsharpRadius|0));return this.init().then(function(){if(s)return c;if(o.features.cib){var n=t.getContext("2d",{alpha:Boolean(a.alpha)});return o.debug("Resize via createImageBitmap()"),createImageBitmap(e,{resizeWidth:a.toWidth,resizeHeight:a.toHeight,resizeQuality:u.cib_quality_name(a.quality)}).then(function(e){if(s)return c;if(!a.unsharpAmount)return n.drawImage(e,0,0),e.close(),n=null,o.debug("Finished!"),t;o.debug("Unsharp result");var r=o.options.createCanvas(a.toWidth,a.toHeight),i=r.getContext("2d",{alpha:Boolean(a.alpha)});i.drawImage(e,0,0),e.close();var u=i.getImageData(0,0,a.toWidth,a.toHeight);return o.__mathlib.unsharp_mask(u.data,a.toWidth,a.toHeight,a.unsharpAmount,a.unsharpRadius,a.unsharpThreshold),n.putImageData(u,0,0),r.width=r.height=0,u=i=r=n=null,o.debug("Finished!"),t})}var p={};return function e(t,n,a,h){if(s)return c;var m,A,v=(2,function(e){if(Array.isArray(e))return e}(A=t.shift())||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),2!==n.length);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(A)||function(e,t){if(e){if("string"==typeof e)return r(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,2):void 0}}(A)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),y=v[0],w=v[1],_=0===t.length;return h=i({},h,{toWidth:y,toHeight:w,quality:_?h.quality:Math.min(1,h.quality)}),_||(m=o.options.createCanvas(y,w)),function(e,t,n){var r,i,a,h=!1;return Promise.resolve().then(function(){if(a=t.getContext("2d",{alpha:Boolean(n.alpha)}),u.isCanvas(e))return r=e.getContext("2d",{alpha:Boolean(n.alpha)}),null;if(u.isImageBitmap(e))return i=e,h=!0,null;if(u.isImage(e))return b?(o.debug("Decode image via createImageBitmap"),createImageBitmap(e).then(function(e){i=e}).catch(function(e){return null})):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')}).then(function(){if(s)return c;o.debug("Calculate tiles");var b=l({width:n.width,height:n.height,srcTileSize:o.options.tile,toWidth:n.toWidth,toHeight:n.toHeight,destTileBorder:f}).map(function(t){return function(t){return o.__limit(function(){if(s)return c;var h;if(u.isCanvas(e))o.debug("Get tile pixel data"),h=r.getImageData(t.x,t.y,t.width,t.height);else{o.debug("Draw tile imageBitmap/image to temporary canvas");var l=o.options.createCanvas(t.width,t.height),f=l.getContext("2d",{alpha:Boolean(n.alpha)});f.globalCompositeOperation="copy",f.drawImage(i||e,t.x,t.y,t.width,t.height,0,0,t.width,t.height),o.debug("Get tile pixel data"),h=f.getImageData(0,0,t.width,t.height),l.width=l.height=0,f=l=null}var b={src:h.data,width:t.width,height:t.height,toWidth:t.toWidth,toHeight:t.toHeight,scaleX:t.scaleX,scaleY:t.scaleY,offsetX:t.offsetX,offsetY:t.offsetY,quality:n.quality,alpha:n.alpha,unsharpAmount:n.unsharpAmount,unsharpRadius:n.unsharpRadius,unsharpThreshold:n.unsharpThreshold};return o.debug("Invoke resize math"),Promise.resolve().then(function(){return function(e){return Promise.resolve().then(function(){return o.features.ww?new Promise(function(t,n){var r=o.__workersPool.acquire();c&&c.catch(function(e){return n(e)}),r.value.onmessage=function(e){r.release(),e.data.err?n(e.data.err):t(e.data.result)},r.value.postMessage({opts:e,features:o.__requested_features,preload:{wasm_nodule:o.__mathlib.__}},[e.src.buffer])}):o.__mathlib.resizeAndUnsharp(e,p)})}(b)}).then(function(e){if(s)return c;var n;if(h=null,o.debug("Convert raw rgba tile result to ImageData"),g)n=new ImageData(new Uint8ClampedArray(e),t.toWidth,t.toHeight);else if((n=a.createImageData(t.toWidth,t.toHeight)).data.set)n.data.set(e);else for(var r=n.data.length-1;r>=0;r--)n.data[r]=e[r];return o.debug("Draw tile"),d?a.putImageData(n,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth+1e-5,t.toInnerHeight+1e-5):a.putImageData(n,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth,t.toInnerHeight),null})})}(t)});function m(){i&&(h||i.close(),i=null)}return o.debug("Process tiles"),Promise.all(b).then(function(){return o.debug("Finished!"),m(),t},function(e){throw m(),e})})}(n,_?a:m,h).then(function(){return _?a:(h.width=y,h.height=w,e(t,m,a,h))}).then(function(e){return m&&(m.width=m.height=0),e})}(h(a.width,a.height,a.toWidth,a.toHeight,o.options.tile,f),e,t,a)})},y.prototype.resizeBuffer=function(e){var t=this,n=i({},A,e);return this.init().then(function(){return t.__mathlib.resizeAndUnsharp(n)})},y.prototype.toBlob=function(e,t,n){return t=t||"image/png",new Promise(function(r){if(e.toBlob)e.toBlob(function(e){return r(e)},t,n);else if(e.convertToBlob)r(e.convertToBlob({type:t,quality:n}));else{for(var i=atob(e.toDataURL(t,n).split(",")[1]),o=i.length,a=new Uint8Array(o),s=0;s<o;s++)a[s]=i.charCodeAt(s);r(new Blob([a],{type:t}))}})},y.prototype.debug=function(){},t.exports=y},{"./lib/mathlib":1,"./lib/pool":9,"./lib/stepper":10,"./lib/tiler":11,"./lib/utils":12,"./lib/worker":13,"object-assign":24,webworkify:25}]},{},[])("/index.js")}),O=E(function(e){function t(e,t){var n=new Error(e);return n.code=t,n}function n(e){for(var t=e.toString(16).toUpperCase(),n=2-t.length;n>0;n--)t="0"+t;return"0x"+t}function r(e){try{return decodeURIComponent(escape(e))}catch(t){return e}}function i(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)}function o(e,n,r){this.input=e.subarray(n,r),this.start=n;var i=String.fromCharCode.apply(null,this.input.subarray(0,4));if("II*\0"!==i&&"MM\0*"!==i)throw t("invalid TIFF signature","EBADDATA");this.big_endian="M"===i[0]}o.prototype.each=function(e){this.aborted=!1;var t=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:t}];this.ifds_to_read.length>0&&!this.aborted;){var n=this.ifds_to_read.shift();n.offset&&this.scan_ifd(n.id,n.offset,e)}},o.prototype.filter=function(e){var n={ifd0:{id:0,entries:[]}};this.each(function(t){(!1!==e(t)||t.is_subifd_link)&&(t.is_subifd_link&&1!==t.count&&4!==t.format||(n["ifd"+t.ifd]||(n["ifd"+t.ifd]={id:t.ifd,entries:[]}),n["ifd"+t.ifd].entries.push(t)))}),delete n.ifd1;var r=8;Object.keys(n).forEach(function(e){r+=2,n[e].entries.forEach(function(e){r+=12+(e.data_length>4?2*Math.ceil(e.data_length/2):0)}),r+=4}),this.output=new Uint8Array(r),this.output[0]=this.output[1]=(this.big_endian?"M":"I").charCodeAt(0),this.write_uint16(2,42);var i=8,o=this;if(this.write_uint32(4,i),Object.keys(n).forEach(function(e){n[e].written_offset=i;var t=i,r=t+2+12*n[e].entries.length+4;i=r,o.write_uint16(t,n[e].entries.length),n[e].entries.sort(function(e,t){return e.tag-t.tag}).forEach(function(e,r){var a=t+2+12*r;o.write_uint16(a,e.tag),o.write_uint16(a+2,e.format),o.write_uint32(a+4,e.count),e.is_subifd_link?n["ifd"+e.tag]&&(n["ifd"+e.tag].link_offset=a+8):e.data_length<=4?o.output.set(o.input.subarray(e.data_offset-o.start,e.data_offset-o.start+4),a+8):(o.write_uint32(a+8,i),o.output.set(o.input.subarray(e.data_offset-o.start,e.data_offset-o.start+e.data_length),i),i+=2*Math.ceil(e.data_length/2))});var a=n["ifd"+(n[e].id+1)];a&&(a.link_offset=r-4)}),Object.keys(n).forEach(function(e){n[e].written_offset&&n[e].link_offset&&o.write_uint32(n[e].link_offset,n[e].written_offset)}),this.output.length!==i)throw t("internal error: incorrect buffer size allocated");return this.output},o.prototype.read_uint16=function(e){var n=this.input;if(e+2>n.length)throw t("unexpected EOF","EBADDATA");return this.big_endian?256*n[e]+n[e+1]:n[e]+256*n[e+1]},o.prototype.read_uint32=function(e){var n=this.input;if(e+4>n.length)throw t("unexpected EOF","EBADDATA");return this.big_endian?16777216*n[e]+65536*n[e+1]+256*n[e+2]+n[e+3]:n[e]+256*n[e+1]+65536*n[e+2]+16777216*n[e+3]},o.prototype.write_uint16=function(e,t){var n=this.output;this.big_endian?(n[e]=t>>>8&255,n[e+1]=255&t):(n[e]=255&t,n[e+1]=t>>>8&255)},o.prototype.write_uint32=function(e,t){var n=this.output;this.big_endian?(n[e]=t>>>24&255,n[e+1]=t>>>16&255,n[e+2]=t>>>8&255,n[e+3]=255&t):(n[e]=255&t,n[e+1]=t>>>8&255,n[e+2]=t>>>16&255,n[e+3]=t>>>24&255)},o.prototype.is_subifd_link=function(e,t){return 0===e&&34665===t||0===e&&34853===t||34665===e&&40965===t},o.prototype.exif_format_length=function(e){switch(e){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},o.prototype.exif_format_read=function(e,t){var n;switch(e){case 1:case 2:return this.input[t];case 6:return(n=this.input[t])|33554430*(128&n);case 3:return this.read_uint16(t);case 8:return(n=this.read_uint16(t))|131070*(32768&n);case 4:return this.read_uint32(t);case 9:return 0|this.read_uint32(t);case 5:case 10:case 11:case 12:case 7:default:return null}},o.prototype.scan_ifd=function(e,n,i){var o=this.read_uint16(n);n+=2;for(var a=0;a<o;a++){var s=this.read_uint16(n),u=this.read_uint16(n+2),c=this.read_uint32(n+4),h=this.exif_format_length(u),l=c*h,f=l<=4?n+8:this.read_uint32(n+8),d=!1;if(f+l>this.input.length)throw t("unexpected EOF","EBADDATA");for(var p=[],g=f,b=0;b<c;b++,g+=h){var m=this.exif_format_read(u,g);if(null===m){p=null;break}p.push(m)}if(Array.isArray(p)&&2===u){try{p=r(String.fromCharCode.apply(null,p))}catch(A){p=null}p&&"\0"===p[p.length-1]&&(p=p.slice(0,-1))}if(this.is_subifd_link(e,s)&&Array.isArray(p)&&Number.isInteger(p[0])&&p[0]>0&&(this.ifds_to_read.push({id:s,offset:p[0]}),d=!0),!1===i({is_big_endian:this.big_endian,ifd:e,tag:s,format:u,count:c,entry_offset:n+this.start,data_length:l,data_offset:f+this.start,value:p,is_subifd_link:d}))return void(this.aborted=!0);n+=12}0===e&&this.ifds_to_read.push({id:1,offset:this.read_uint32(n)})},e.exports.is_jpeg=function(e){return e.length>=4&&255===e[0]&&216===e[1]&&255===e[2]},e.exports.jpeg_segments_each=function(r,o){if(!i(r))throw t("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if("function"!=typeof o)throw t("Invalid argument (on_segment), Function expected","EINVAL");if(!e.exports.is_jpeg(r))throw t("Unknown file format","ENOTJPEG");for(var a=0,s=r.length,u=!1;;){var c,h;if(a+1>=s)throw t("Unexpected EOF","EBADDATA");var l=r[a],f=r[a+1];if(255===l&&255===f)c=255,h=1;else if(255===l&&0!==f){if(h=2,208<=(c=f)&&c<=217||1===c);else{if(a+3>=s)throw t("Unexpected EOF","EBADDATA");if((h+=256*r[a+2]+r[a+3])<2)throw t("Invalid segment length","EBADDATA");if(a+h-1>=s)throw t("Unexpected EOF","EBADDATA")}u&&(c>=208&&c<=215||(u=!1)),218===c&&(u=!0)}else{if(!u)throw t("Unexpected byte at segment start: "+n(l)+" (offset "+n(a)+")","EBADDATA");for(var d=a+1;;d++){if(d>=s)throw t("Unexpected EOF","EBADDATA");if(255===r[d]){if(d+1>=s)throw t("Unexpected EOF","EBADDATA");if(0!==r[d+1]){c=0,h=d-a;break}}}}if(!1===o({code:c,offset:a,length:h}))break;if(217===c)break;a+=h}},e.exports.jpeg_segments_filter=function(n,r){if(!i(n))throw t("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if("function"!=typeof r)throw t("Invalid argument (on_segment), Function expected","EINVAL");var o=[],a=0;e.exports.jpeg_segments_each(n,function(e){var t=r(e);if(i(t))o.push({data:t}),a+=t.length;else if(Array.isArray(t))t.filter(i).forEach(function(e){o.push({data:e}),a+=e.length});else if(!1!==t){var n={start:e.offset,end:e.offset+e.length};o.length>0&&o[o.length-1].end===n.start?o[o.length-1].end=n.end:o.push(n),a+=e.length}});var s=new Uint8Array(a),u=0;return o.forEach(function(e){var t=e.data||n.subarray(e.start,e.end);s.set(t,u),u+=t.length}),s},e.exports.jpeg_exif_tags_each=function(n,r){if(!i(n))throw t("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if("function"!=typeof r)throw t("Invalid argument (on_exif_entry), Function expected","EINVAL");e.exports.jpeg_segments_each(n,function(e){return 218!==e.code&&(225===e.code&&e.length>=10&&69===n[e.offset+4]&&120===n[e.offset+5]&&105===n[e.offset+6]&&102===n[e.offset+7]&&0===n[e.offset+8]&&0===n[e.offset+9]?(new o(n,e.offset+10,e.offset+e.length).each(r),!1):void 0)})},e.exports.jpeg_exif_tags_filter=function(n,r){if(!i(n))throw t("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if("function"!=typeof r)throw t("Invalid argument (on_exif_entry), Function expected","EINVAL");var a=!1;return e.exports.jpeg_segments_filter(n,function(e){if(!a&&(218===e.code&&(a=!0),225===e.code&&e.length>=10&&69===n[e.offset+4]&&120===n[e.offset+5]&&105===n[e.offset+6]&&102===n[e.offset+7]&&0===n[e.offset+8]&&0===n[e.offset+9])){var t=new o(n,e.offset+10,e.offset+e.length).filter(r);if(!t)return!1;var i=new Uint8Array(10);return i.set(n.slice(e.offset,e.offset+10)),i[2]=t.length+8>>>8&255,i[3]=t.length+8&255,a=!0,[i,t]}})},e.exports.jpeg_add_comment=function(t,n){var r=!1,i=0;return e.exports.jpeg_segments_filter(t,function(e){if(!(1==++i&&216===e.code||2===i&&224===e.code||r)){n=function(e){try{return unescape(encodeURIComponent(e))}catch(t){return e}}(n);var o=new Uint8Array(5+n.length),a=0;return o[a++]=255,o[a++]=254,o[a++]=n.length+3>>>8&255,o[a++]=n.length+3&255,n.split("").forEach(function(e){o[a++]=255&e.charCodeAt(0)}),o[a++]=0,r=!0,[o,t.subarray(e.offset,e.offset+e.length)]}})}});function k(e){return this._getUint8Array(e.blob).then(function(t){if(e.is_jpeg=O.is_jpeg(t),!e.is_jpeg)return Promise.resolve(e);e.orig_blob=e.blob;try{var n,r;if(O.jpeg_exif_tags_each(t,function(t){if(0===t.ifd&&274===t.tag&&Array.isArray(t.value))return e.orientation=t.value[0]||1,n=t.big_endian,r=t.data_offset,!1}),r){var i=n?new Uint8Array([0,1]):new Uint8Array([1,0]);e.blob=new Blob([t.slice(0,r),i,t.slice(r+2)],{type:"image/jpeg"})}}catch(o){}return e})}function B(e){if(!e.is_jpeg)return Promise.resolve(e);var t,n=e.orientation-1;if(!n)return Promise.resolve(e);var r=(t=4&n?this.pica.options.createCanvas(e.out_canvas.height,e.out_canvas.width):this.pica.options.createCanvas(e.out_canvas.width,e.out_canvas.height)).getContext("2d");return r.save(),1&n&&r.transform(-1,0,0,1,t.width,0),2&n&&r.transform(-1,0,0,-1,t.width,t.height),4&n&&r.transform(0,1,1,0,0,0),r.drawImage(e.out_canvas,0,0),r.restore(),e.out_canvas.width=e.out_canvas.height=0,e.out_canvas=t,Promise.resolve(e)}function j(e){return e.is_jpeg?Promise.all([this._getUint8Array(e.blob),this._getUint8Array(e.out_blob)]).then(function(t){var n=t[0];if(O.is_jpeg(t[1]))return Promise.resolve(e);var r=[];return O.jpeg_segments_each(n,function(e){if(218===e.code)return!1;r.push(e)}),r=r.filter(function(e){if(226===e.code){var t=n.slice(e.offset+4,e.offset+11);if("ICC_PROFILE"===String.fromCharCode.apply(t))return!1}return e.code>=224&&e.code<240||254===e.code}).map(function(e){return n.slice(e.offset,e.offset+e.length)}),e.blob=new Blob([n.slice(0,20)].concat(r).concat([n.slice(20)]),{type:"image/jpeg"}),e}):Promise.resolve(e)}var P=function(e){e.before("_blob_to_image",k),e.after("_transform",B),e.after("_create_blob",j)};function T(e){if(!(this instanceof T))return new T(e);this.pica=(e=e||{}).pica||x({}),this.initialized=!1,this.utils=I}T.prototype.use=function(e){var t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this},T.prototype.init=function(){this.use(P)},T.prototype.toBlob=function(e,t){var n={blob:e,opts:I.assign({max:1/0},t)};return this.initialized||(this.init(),this.initialized=!0),Promise.resolve(n).then(this._blob_to_image).then(this._calculate_size).then(this._transform).then(this._cleanup).then(this._create_blob).then(function(e){return e.out_canvas.width=e.out_canvas.height=0,e.out_blob})},T.prototype.toCanvas=function(e,t){var n={blob:e,opts:I.assign({max:1/0},t)};return this.initialized||(this.init(),this.initialized=!0),Promise.resolve(n).then(this._blob_to_image).then(this._calculate_size).then(this._transform).then(this._cleanup).then(function(e){return e.out_canvas})},T.prototype.before=function(e,t){if(!this[e])throw new Error('Method "'+e+'" does not exist');if("function"!=typeof t)throw new Error('Invalid argument "fn", function expected');var n=this[e],r=this;return this[e]=function(e){return t.call(r,e).then(function(e){return n.call(r,e)})},this},T.prototype.after=function(e,t){if(!this[e])throw new Error('Method "'+e+'" does not exist');if("function"!=typeof t)throw new Error('Invalid argument "fn", function expected');var n=this[e],r=this;return this[e]=function(e){return n.call(r,e).then(function(e){return t.call(r,e)})},this},T.prototype._blob_to_image=function(e){var t=window.URL||window.webkitURL||window.mozURL||window.msURL;return e.image=document.createElement("img"),e.image_url=t.createObjectURL(e.blob),e.image.src=e.image_url,new Promise(function(t,n){e.image.onerror=function(){n(new Error("ImageBlobReduce: failed to create Image() from blob"))},e.image.onload=function(){t(e)}})},T.prototype._calculate_size=function(e){var t=e.opts.max/Math.max(e.image.width,e.image.height);return t>1&&(t=1),e.transform_width=Math.max(Math.round(e.image.width*t),1),e.transform_height=Math.max(Math.round(e.image.height*t),1),e.scale_factor=t,Promise.resolve(e)},T.prototype._transform=function(e){e.out_canvas=this.pica.options.createCanvas(e.transform_width,e.transform_height),e.transform_width=null,e.transform_height=null;var t={alpha:"image/png"===e.blob.type};return this.utils.assign(t,this.utils.pick_pica_resize_options(e.opts)),this.pica.resize(e.image,e.out_canvas,t).then(function(){return e})},T.prototype._cleanup=function(e){e.image.src="",e.image=null;var t=window.URL||window.webkitURL||window.mozURL||window.msURL;return t.revokeObjectURL&&t.revokeObjectURL(e.image_url),e.image_url=null,Promise.resolve(e)},T.prototype._create_blob=function(e){return this.pica.toBlob(e.out_canvas,e.blob.type).then(function(t){return e.out_blob=t,e})},T.prototype._getUint8Array=function(e){return e.arrayBuffer?e.arrayBuffer().then(function(e){return new Uint8Array(e)}):new Promise(function(t,n){var r=new FileReader;r.readAsArrayBuffer(e),r.onload=function(){t(new Uint8Array(r.result))},r.onerror=function(){n(new Error("ImageBlobReduce: failed to load data from input blob")),r.abort()},r.onabort=function(){n(new Error("ImageBlobReduce: failed to load data from input blob (aborted)"))}})},T.pica=x;var Q,L,M=new T,R={version:0,type:"object",properties:{id:{type:"string",primary:!0},timestamp:{type:"number"},geolocationPosition:{type:"object",properties:{latitude:{type:"number"},longitude:{type:"number"}}}},indexes:["timestamp"],required:["timestamp"],attachments:{encrypted:!1}},U=((Q=function(){function e(t){var n=this;f(this,e),this.document=t,this.id=this.document.id,this.mimeType=this.getAttachment(e.PHOTO_ATTACHMENT_ID).type,this.timestamp=this.document.timestamp,this.geolocationPosition=this.document.geolocationPosition,this.photoUrl$=Object(a.a)(function(){return n.getAttachment(e.PHOTO_ATTACHMENT_ID).getData()}).pipe(Object(g.a)(function(e){return URL.createObjectURL(e)}),Object(d.a)({bufferSize:1,refCount:!0})),this.thumbnailUrl$=Object(a.a)(function(){return Object(y.a)(n.document.getAttachment(e.THUMBNAIL_ATTACHMENT_ID))}).pipe(Object(h.a)(function(t){return Object(m.a)(n,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=2;break}return n.abrupt("return",t.getData());case 2:return n.t0=function(e){var t=e.image,n=e.maxSize;return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M.toBlob(t,{max:n}));case 1:case"end":return e.stop()}},e)}))},n.next=5,this.getAttachment(e.PHOTO_ATTACHMENT_ID).getData();case 5:return n.t1=n.sent,n.t2={image:n.t1,maxSize:300},n.next=9,(0,n.t0)(n.t2);case 9:return r=n.sent,n.next=12,this.document.putAttachment({id:e.THUMBNAIL_ATTACHMENT_ID,data:r,type:this.mimeType},!0);case 12:return n.abrupt("return",r);case 13:case"end":return n.stop()}},n,this)}))}),Object(g.a)(function(e){return URL.createObjectURL(e)}),Object(d.a)({bufferSize:1,refCount:!0}))}return p(e,[{key:"getAttachment",value:function(e){var t=this.document.getAttachment(e);if(t)return t;throw new w("Cannot get the attachment with ID: ".concat(e))}}]),e}()).PHOTO_ATTACHMENT_ID="original",Q.THUMBNAIL_ATTACHMENT_ID="thumbnail",Q),S=o("fXoL"),D=o("aNgo"),H=((L=function(){function e(t){f(this,e),this.database=t,this.collection$=this.database.main$.pipe(Object(h.a)(function(e){return e.addCollections((r={schema:R},(n=z)in(t={})?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t));var t,n,r}),Object(l.a)(z),Object(d.a)({bufferSize:1,refCount:!0})),this.all$=this.collection$.pipe(Object(h.a)(function(e){return e.find().sort({timestamp:"desc"}).$}),Object(g.a)(function(e){return e.map(function(e){return new U(e)})}))}return p(e,[{key:"add$",value:function(e){var t=this;return Object(a.a)(function(){return Object(s.a)([t.collection$.pipe(Object(b.a)()),A(e),v()])}).pipe(Object(h.a)(function(e){var t=u(e,3),n=t[0],r=t[1],i=t[2];return n.insert({id:r,timestamp:Date.now(),geolocationPosition:{latitude:null==i?void 0:i.coords.latitude,longitude:null==i?void 0:i.coords.longitude}})}),Object(h.a)(function(t){return t.putAttachment({id:U.PHOTO_ATTACHMENT_ID,data:e,type:e.type},!0)}),Object(g.a)(function(e){return e.doc}))}},{key:"remove$",value:function(e){return this.collection$.pipe(Object(h.a)(function(t){return t.bulkRemove([e])}))}}]),e}()).\u0275fac=function(e){return new(e||L)(S.Tb(D.a))},L.\u0275prov=S.Gb({token:L,factory:L.\u0275fac,providedIn:"root"}),L),z="junctures"},kiQV:function(e){e.exports=JSON.parse('{"a":"0.0.1"}')}}])}();