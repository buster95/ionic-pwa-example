{"version":3,"sources":["webpack:///src/app/utils/geolocation.ts","webpack:///src/app/shared/image/image.component.html","webpack:///src/app/shared/image/image.component.ts","webpack:///node_modules/ngx-ionic-image-viewer/__ivy_ngcc__/fesm2015/ngx-ionic-image-viewer.js","webpack:///src/app/utils/crypto.ts","webpack:///src/app/features/home/home.page.html","webpack:///src/app/features/home/home.page.ts","webpack:///node_modules/@ngrx/component/__ivy_ngcc__/fesm2015/ngrx-component.js","webpack:///node_modules/image-blob-reduce/dist/image-blob-reduce.esm.mjs","webpack:///src/app/shared/moment/moment-repository.service.ts","webpack:///src/app/shared/shared.module.ts","webpack:///src/app/utils/encoding.ts","webpack:///src/app/features/home/home-routing.module.ts","webpack:///src/app/utils/thumbnail.ts","webpack:///src/app/features/home/camera/camera.component.html","webpack:///src/app/features/home/camera/camera.component.ts","webpack:///src/app/features/home/home.module.ts","webpack:///src/app/features/home/settings/settings.component.html","webpack:///src/app/features/home/settings/settings.component.ts","webpack:///src/app/features/home/moment-thumbnail/moment-thumbnail.component.ts","webpack:///src/app/features/home/moment-thumbnail/moment-thumbnail.component.html","webpack:///src/app/utils/errors.ts","webpack:///node_modules/@angular/common/__ivy_ngcc__/fesm2015/http.js","webpack:///src/app/shared/moment/moment.ts"],"names":["getCurrentPosition","Promise","resolve","reject","navigator","geolocation","success","error","enableHighAccuracy","timeout","maximumAge","getCurrentPositionOrUndefined","undefined","ImageComponent","_src$","src$","pipe","TINIEST_GIF","isImageError","value","next","event","imgElement","target","fadeInAnimation","addElement","duration","iterations","fromTo","play","_c0","_c1","a0","_c2","NgxIonicImageViewerService","ɵfac","NgxIonicImageViewerService_Factory","t","ɵprov","token","factory","providedIn","ngInjectableDef","ViewerModalComponent","modalController","alt","scheme","slideOptions","srcFallback","srcHighRes","swipeToClose","text","title","titleSize","defaultSlideOptions","centeredSlides","passiveListeners","zoom","enabled","options","swipeState","phase","direction","swipeType","startX","startY","distance","distanceX","distanceY","threshold","restraint","allowedTime","elapsedTime","startTime","Object","assign","src","setStyle","setScheme","initSwipeToClose","slides","getSwiper","swiper","appendSlide","el","document","querySelector","style","setProperty","classList","contains","isActive","addEventListener","swipeStart","swipeMove","swipeEnd","getTop","then","modal","onWillDismiss","removeEventListener","type","changedTouches","pageX","pageY","Date","getTime","Math","abs","preventDefault","closeModal","dismiss","ViewerModalComponent_Factory","ɵcmp","selectors","viewQuery","ViewerModalComponent_Query","rf","ctx","_t","first","inputs","decls","vars","consts","template","ViewerModalComponent_Template","ViewerModalComponent_Template_ion_button_click_3_listener","length","directives","styles","NgxIonicImageViewerComponent","create","component","componentProps","cssClass","Array","keyboardClose","showBackdrop","present","NgxIonicImageViewerComponent_Factory","NgxIonicImageViewerComponent_Template","NgxIonicImageViewerComponent_Template_img_click_0_listener","viewImage","NgxIonicImageViewerComponent_Template_img_error_0_listener","NgxIonicImageViewerDirective","renderer","nativeElement","setAttribute","hasAttribute","NgxIonicImageViewerDirective_Factory","ɵdir","hostBindings","NgxIonicImageViewerDirective_HostBindings","NgxIonicImageViewerDirective_click_HostBindingHandler","onClick","NgxIonicImageViewerDirective_error_HostBindingHandler","$event","onError","NgxIonicImageViewerModule","ɵmod","ɵinj","NgxIonicImageViewerModule_Factory","imports","ngJitMode","declarations","exports","sha256WithBlob","blob","crypto","subtle","arrayBuffer","digest","digested","HomePage","popoverController","momentRepository","moments$","all$","_ionContent$","ionContent$","_scrollEvent$","scrollEvent$","noFooterBorder$","ionContent","detectBottom","getScrollElement","scrollElement","scrollTop","scrollHeight","clientHeight","settingsPopover","cameraModal","_","item","id","onScroll","presentCamera","presentSettings","CdAware","createCdAware","cfg","potentialObservablesSubject","observablesFromTemplate$","rendering$","observable$","updateViewContextObserver","render","ob$","resetContextObserver","e","nextPotentialObservable","subscribe","hasZone","z","RenderConfig","createRender","config","ngZone","cdRef","markForCheck","detectChanges","PushPipe","renderedValue","cdAware","subscription","potentialObservable","unsubscribe","PushPipe_Factory","ɵpipe","name","pure","LetViewContext","LetDirective","templateRef","viewContainerRef","ViewContext","$implicit","ngrxLet","$error","$complete","embeddedView","createEmbeddedView","complete","clear","dir","LetDirective_Factory","DECLARATIONS","EXPORTS","ReactiveComponentModule","ReactiveComponentModule_Factory","to","from","s","arguments","key","prototype","hasOwnProperty","call","pick","props","forEach","pick_pica_resize_options","pick_1","pick_pica_resize_options_1","utils","createCommonjsModule","fn","module","commonjsRequire","Error","pica","f","r","n","o","i","c","u","a","code","p","_dereq_","inherits","Multimath","mm_unsharp_mask","mm_resize","MathLib","requested_features","__requested_features","features","js","indexOf","wasm","has_wasm","use","resizeAndUnsharp","cache","result","resize","unsharpAmount","unsharp_mask","toWidth","toHeight","unsharpRadius","unsharpThreshold","clampTo8","convolveHorizontally","dest","srcW","srcH","destW","filters","g","b","filterPtr","filterShift","filterSize","srcPtr","srcY","destX","filterVal","srcOffset","destOffset","convolveVertically","wasm_fn","wasm_src","createFilters","resetAlpha","dst","width","height","ptr","len","destH","scaleX","scaleY","offsetX","offsetY","Uint8Array","quality","alpha","filtersX","filtersY","tmp","FILTER_INFO","FIXED_FRAC_BITS","toFixedPoint","num","round","resizeFilterGen","srcSize","destSize","scale","offset","filterFunction","filter","scaleInverted","scaleClamped","min","srcWindow","win","destPixel","srcPixel","srcFirst","srcLast","filterElementSize","floatFilter","fxpFilter","total","pxl","idx","floatVal","filterTotal","leftNotEmpty","rightNotEmpty","maxFilterElementSize","floor","packedFilter","Int16Array","packedFilterPtr","slowCopy","subarray","set","max","ceil","Float32Array","x","xpi","PI","sin","cos","asUint8Array","buffer","byteLength","IS_LE","Uint32Array","__","copyInt16asLE","target_offset","data","resize_wasm","src_offset","tmp_offset","__align","filtersX_offset","filtersY_offset","alloc_bytes","instance","__instance","mem","__memory","mem32","src32","convolveHV","_convolveHV","dest32","GC_INTERVAL","Pool","idle","available","acquired","lastId","timeoutId","acquire","_this","resource","pop","release","_this2","lastUsed","now","push","setTimeout","gc","_this3","destroy","MIN_INNER_TILE_SIZE","createStages","fromWidth","fromHeight","srcTileSize","destTileBorder","minScale","stageCount","log","pow","PIXEL_EPSILON","pixelFloor","nearest","pixelCeil","createRegions","innerTileWidth","innerTileHeight","y","innerX","innerY","toTileWidth","toTileHeight","tiles","tile","toX","toY","toInnerX","toInnerY","toInnerWidth","toInnerHeight","objClass","obj","toString","isCanvas","element","cname","isImage","isImageBitmap","limiter","concurrency","active","queue","roll","shift","limit","err","cib_quality_name","cib_support","createCanvas","createImageBitmap","resizeWidth","resizeHeight","resizeQuality","bitmap","status","close","mathLib","onmessage","ev","opts","postMessage","a1","a2","a3","b1","b2","left_corner","right_corner","gaussCoef","sigma","exp","g1","g2","k","convolveMono16","out","line","coeff","prev_src","curr_src","curr_out","prev_out","prev_prev_out","src_index","out_index","line_index","j","coeff_a0","coeff_a1","coeff_b1","coeff_b2","blurMono16","radius","Uint16Array","tmp_line","ctor","superCtor","super_","constructor","enumerable","writable","configurable","TempCtor","base64decode","hasWebAssembly","DEFAULT_OPTIONS","MultiMath","__cache","__init_promise","__modules","modules","__wasm","__isLE","init","self","all","keys","map","WebAssembly","compile","__base64decode","m","__reallocate","mem_grow_to","bytes","Memory","initial","mem_size","grow","memsize","env_extra","Module","env_base","memoryBase","memory","tableBase","table","Table","Instance","env","align","number","base","reminder","BASE64_MAP","str","input","replace","bits","charAt","tailbits","hsl_l16_js","img","size","glur_mono16","hsl_l16","unsharp","amount","h","l","m1","m2","hShifted","diff","iTimes4","lightness","blured","amountFp","thresholdFp","pixels","img_bytes_cnt","hsl_bytes_cnt","blur_bytes_cnt","blur_line_byte_cnt","blur_coeffs_byte_cnt","img_offset","hsl_offset","blur_offset","blur_tmp_offset","blur_line_offset","blur_coeffs_offset","img32","_hsl_l16","_blurMono16","_unsharp","wa","bin","test","getOwnPropertySymbols","propIsEnumerable","propertyIsEnumerable","toObject","val","TypeError","shouldUseNative","test1","String","getOwnPropertyNames","test2","fromCharCode","order2","join","test3","split","letter","source","symbols","bundleFn","sources","stringify","JSON","wkey","cacheKeys","random","wcache","skey","scache","workerSources","resolveSources","depPath","depKey","URL","window","webkitURL","mozURL","msURL","Blob","bare","workerUrl","createObjectURL","worker","Worker","objectURL","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","minLen","_arrayLikeToArray","slice","arr2","Symbol","iterator","_arr","_n","_d","_e","_i","_s","done","isArray","webworkify","singletones","NEED_SAFARI_FIX","userAgent","hardwareConcurrency","DEFAULT_PICA_OPTS","tmpCanvas","createElement","DEFAULT_RESIZE_OPTS","CAN_NEW_IMAGE_DATA","CAN_CREATE_IMAGE_BITMAP","workerFabric","terminate","url","revokeObjectURL","Pica","limiter_key","concat","__limit","cib","ww","__workersPool","__mathlib","__initPromise","ImageData","Uint8ClampedArray","ImageBitmap","debug","wkr","wpool_key","initMath","mathlib","checkCibResize","isNaN","naturalWidth","naturalHeight","canceled","cancelToken","DEST_TILE_BORDER","toCtx","getContext","Boolean","imageBitmap","drawImage","tmpCtx","iData","getImageData","putImageData","invokeResize","w","preload","wasm_nodule","tileAndResize","srcCtx","srcImageBitmap","isImageBitmapReused","processTile","srcImageData","globalCompositeOperation","toImageData","createImageData","regions","jobs","cleanup","processStages","stages","_stages$shift","_stages$shift2","isLastStage","res","resizeBuffer","toBlob","canvas","mimeType","convertToBlob","asString","atob","toDataURL","asBuffer","charCodeAt","image_traverse","message","to_hex","toUpperCase","utf8_encode","unescape","encodeURIComponent","utf8_decode","decodeURIComponent","escape","is_uint8array","ExifParser","jpeg_bin","exif_start","exif_end","start","sig","apply","big_endian","each","on_entry","aborted","read_uint32","ifds_to_read","scan_ifd","ifds","ifd0","entries","entry","is_subifd_link","count","format","ifd","ifd1","ifd_no","data_length","output","write_uint16","write_uint32","written_offset","ifd_start","ifd_end","sort","tag","entry_offset","link_offset","data_offset","next_ifd","read_uint16","d","exif_format_length","exif_format_read","v","entry_count","comp_length","comp_offset","Number","isInteger","is_big_endian","is_jpeg","jpeg_segments_each","on_segment","inside_scan","segment_code","segment_length","byte1","byte2","pos","jpeg_segments_filter","ranges","out_length","segment","new_segment","new_range","end","range","jpeg_exif_tags_each","on_exif_entry","jpeg_exif_tags_filter","stop_search","new_exif","header","jpeg_add_comment","comment","comment_inserted","segment_count","csegment","jpeg_patch_exif","_getUint8Array","orig_blob","exif_is_big_endian","orientation_offset","orientation","orientation_patch","jpeg_rotate_canvas","out_canvas","save","transform","restore","jpeg_attach_orig_segments","out_blob","data_out","segments","hdr","assign$1","reducer","before","after","jpeg_patch_exif_1","jpeg_rotate_canvas_1","jpeg_attach_orig_segments_1","assign_1","jpeg_plugins","ImageBlobReduce","initialized","plugin","args","Infinity","_blob_to_image","_calculate_size","_transform","_cleanup","_create_blob","_env","toCanvas","method_name","old_fn","image","image_url","onerror","onload","scale_factor","transform_width","transform_height","pica_opts","buf","fr","FileReader","readAsArrayBuffer","abort","onabort","imageBlobReduce","MomentRepository","database","collection$","main$","addCollections","COLLECTION_NAME","schema","bufferSize","refCount","find","timestamp","$","documents","photo","collection","geolocationPosition","insert","latitude","coords","longitude","putAttachment","PHOTO_ATTACHMENT_ID","attachment","doc","bulkRemove","SharedModule","arrayBufferToHex","padStart","routes","path","loadChildren","PhotoPageModule","HomePageRoutingModule","forChild","makeThumbnail","maxSize","CameraComponent","alertController","_videoElement$","videoElement$","mediaStream$","mediaDevices","getUserMedia","video","facingMode","presentErrorDialog","imageCapture$","mediaStream","ImageCapture","getVideoTracks","_capturedImageUrl$","revokePreviousImageUrl$","previous","capturedImageUrl$","cameraPreview$","videoElement","srcObject","imageCapture","takePhoto","imageBlob","add$","console","buttons","alert","getTracks","track","stop","capture","HomePageModule","SettingsComponent","settingsService","themes","THEMES","theme$","version","setTheme$","detail","MomentThumbnailComponent","_moment$","moment$","DataNotFoundError","HttpHandler","HttpBackend","HttpHeaders","headers","normalizedNames","Map","lazyUpdate","lazyInit","index","toLowerCase","trim","maybeSetNormalizedName","has","get","values","clone","op","lcName","copyFrom","update","applyUpdate","other","toDelete","existing","HttpUrlEncodingCodec","standardEncoding","paramParser","rawParams","codec","params","param","eqIdx","decodeKey","decodeValue","list","HttpParams","updates","cloneFrom","encoder","fromString","fromObject","_value","eKey","encodeKey","encodeValue","splice","mightHaveBody","method","isArrayBuffer","ArrayBuffer","isBlob","isFormData","FormData","HttpRequest","third","fourth","body","reportProgress","withCredentials","responseType","urlWithParams","qIdx","sep","setHeaders","reduce","setParams","HttpEventType","HttpResponseBase","defaultStatus","defaultStatusText","statusText","ok","HttpHeaderResponse","ResponseHeader","HttpResponse","Response","HttpErrorResponse","addBody","observe","HttpClient","handler","req","events$","handle","res$","request","callbackParam","append","HttpClient_Factory","HttpInterceptorHandler","interceptor","intercept","HTTP_INTERCEPTORS","NoopInterceptor","NoopInterceptor_Factory","nextRequestId","JSONP_ERR_NO_CALLBACK","JSONP_ERR_WRONG_METHOD","JSONP_ERR_WRONG_RESPONSE_TYPE","JsonpCallbackContext","JsonpClientBackend","callbackMap","resolvedPromise","observer","callback","nextCallback","node","finished","cancelled","parentNode","removeChild","onLoad","appendChild","Sent","JsonpClientBackend_Factory","JsonpInterceptor","jsonp","JsonpInterceptor_Factory","XSSI_PREFIX","getResponseUrl","xhr","responseURL","getAllResponseHeaders","getResponseHeader","XhrFactory","BrowserXhr","XMLHttpRequest","BrowserXhr_Factory","HttpXhrBackend","xhrFactory","build","open","setRequestHeader","detectedType","detectContentTypeHeader","reqBody","serializeBody","headerResponse","partialFromXhr","response","responseText","originalBody","parse","sentHeaders","onDownProgress","progressEvent","DownloadProgress","loaded","lengthComputable","partialText","onUpProgress","progress","UploadProgress","upload","send","readyState","DONE","HttpXhrBackend_Factory","XSRF_COOKIE_NAME","XSRF_HEADER_NAME","HttpXsrfTokenExtractor","HttpXsrfCookieExtractor","platform","cookieName","lastCookieString","lastToken","parseCount","cookieString","cookie","HttpXsrfCookieExtractor_Factory","HttpXsrfInterceptor","tokenService","headerName","lcUrl","startsWith","getToken","HttpXsrfInterceptor_Factory","HttpInterceptingHandler","backend","injector","chain","interceptors","reduceRight","HttpInterceptingHandler_Factory","interceptingHandler","jsonpCallbackContext","HttpClientXsrfModule","ngModule","providers","provide","useClass","useValue","HttpClientXsrfModule_Factory","useExisting","multi","HttpClientModule","HttpClientModule_Factory","withOptions","HttpClientJsonpModule","HttpClientJsonpModule_Factory","useFactory","properties","primary","required","indexes","attachments","encrypted","Moment","getAttachment","photoUrl$","getData","thumbnailUrl$","THUMBNAIL_ATTACHMENT_ID","thumbnail"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,eAAeA,kBAAf,GAAoC;;;;;;mDAC3B,IAAIC,OAAJ,CAAiC,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC3DC,6BAAS,CAACC,WAAV,CAAsBL,kBAAtB,CACE,UAAAM,OAAO;AAAA,6BAAIJ,OAAO,CAACI,OAAD,CAAX;AAAA,qBADT,EAEE,UAAAC,KAAK;AAAA,6BAAIJ,MAAM,CAACI,KAAD,CAAV;AAAA,qBAFP,EAGE;AAAEC,wCAAkB,EAAE,IAAtB;AAA4BC,6BAAO,EAAE,KAArC;AAA4CC,gCAAU,EAAE;AAAxD,qBAHF;AAKD,mBANM,C;;;;;;;;;AAOR;;AAEM,eAAeC,6BAAf,GAA+C;;;;;;;;AAE3C,yBAAMX,kBAAkB,EAAxB;;;;;;;;oDAEAY,S;;;;;;;;;AAEV;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChBD;;;;;;;;AAMA;;AAEE;AAAA;;AAAA;;AAAA;AAAA,aAAuC,UAAvC,EAAuC;AAAA;;AAAA;;AAAA;AAAA,WAAvC;;;;AAGD;;;;;;AADC;;;;;;AAEF;;;;;;ACDO;AAAA,YAAMC,cAAN;AALP;AAAA;;AAAA;;AAMmB,iBAAAC,KAAA,GAAQ,IAAI,oDAAJ,CAAwCF,SAAxC,CAAR;AAER,iBAAAG,IAAA,GAAO,KAAKD,KAAL,CAAWE,IAAX,CACd,iEAAUC,WAAV,CADc,EAEd,2EAFc,EAGd,6EAHc,EAId,2DAAI;AAAA,qBAAO,MAAI,CAACC,YAAL,GAAoB,KAA3B;AAAA,aAAJ,CAJc,CAAP;AAYT,iBAAAA,YAAA,GAAe,KAAf;AAeD;;AA9BM;AAAA;AAAA,iBAUL,aACQC,KADR,EACuB;AACrB,mBAAKL,KAAL,CAAWM,IAAX,CAAgBD,KAAhB;AACD;AAbI;AAAA;AAAA,mBAiBC,uBAAcE,KAAd,EAA4B;;;;;;;AAC1BC,kC,GAAaD,KAAK,CAACE,M;AACnBC,uC,GAAkB,yEACrBC,UADqB,CACVH,UADU,EAErBI,QAFqB,CAEZ,GAFY,EAGrBC,UAHqB,CAGV,CAHU,EAIrBC,MAJqB,CAId,SAJc,EAIH,GAJG,EAIE,GAJF,C;0DAKjBJ,eAAe,CAACK,IAAhB,E;;;;;;;;;AACR;AAzBI;AAAA;AAAA,mBA2BL,wBAAe;AACb,mBAAKX,YAAL,GAAoB,IAApB;AACD;AA7BI;;AAAA;AAAA;;;2BAAML,c;AAAc,S;;;gBAAdA,c;AAAc,oC;AAAA;AAAA;AAAA,W;AAAA,iC;AAAA,kB;AAAA,iB;AAAA,uR;AAAA;AAAA;;;ADX3B;;AAMA;;AAMA;;;;AAXG;;AAMA;;AAAA;;AAKU;;AAAA;;;;;;;;OCDN;;AAgCP,UAAMI,WAAW,GACf,4EADF;;;;;;;;;;;;;;;;AC3CA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAKA;;;;;;;AASA,UAAMa,GAAG,GAAG,CAAC,WAAD,CAAZ;;AACA,UAAMC,GAAG,GAAG,SAANA,GAAM,CAAUC,EAAV,EAAc;AAAE,eAAO;AAAE,sBAAYA;AAAd,SAAP;AAA4B,OAAxD;;AACA,UAAMC,GAAG,GAAG,SAANA,GAAM,CAAUD,EAAV,EAAc;AAAE,eAAO;AAAE,qBAAWA;AAAb,SAAP;AAA2B,OAAvD;;;YACME,0B,GACF,sCAAc;AAAA;AAAG,S;;AAErBA,kCAA0B,CAACC,IAA3B,GAAkC,SAASC,kCAAT,CAA4CC,CAA5C,EAA+C;AAAE,iBAAO,KAAKA,CAAC,IAAIH,0BAAV,GAAP;AAAiD,SAApI;;AACAA,kCAA0B,CAACI,KAA3B,GAAmC,iEAA0B;AAAEC,eAAK,EAAEL,0BAAT;AAAqCM,iBAAO,EAAEN,0BAA0B,CAACC,IAAzE;AAA+EM,oBAAU,EAAE;AAA3F,SAA1B,CAAnC;AAGA;;AAAmBP,kCAA0B,CAACQ,eAA3B,GAA6C,yEAAmB;AAAEF,iBAAO,EAAE,SAASJ,kCAAT,GAA8C;AAAE,mBAAO,IAAIF,0BAAJ,EAAP;AAA0C,WAArG;AAAuGK,eAAK,EAAEL,0BAA9G;AAA0IO,oBAAU,EAAE;AAAtJ,SAAnB,CAA7C;;;;;YAabE,oB;AACF;;;AAGA,wCAAYC,eAAZ,EAA6B;AAAA;;AACzB,iBAAKA,eAAL,GAAuBA,eAAvB,CADyB,CAEzB;;AACA,iBAAKC,GAAL,GAAW,EAAX;AACA,iBAAKC,MAAL,GAAc,MAAd;AACA,iBAAKC,YAAL,GAAoB,EAApB;AACA,iBAAKC,WAAL,GAAmB,EAAnB;AACA,iBAAKC,UAAL,GAAkB,EAAlB;AACA,iBAAKC,YAAL,GAAoB,IAApB;AACA,iBAAKC,IAAL,GAAY,EAAZ;AACA,iBAAKC,KAAL,GAAa,EAAb;AACA,iBAAKC,SAAL,GAAiB,EAAjB,CAXyB,CAYzB;;AACA,iBAAKC,mBAAL,GAA2B;AACvBC,4BAAc,EAAE,IADO;AAEvBC,8BAAgB,EAAE,KAFK;AAGvBC,kBAAI,EAAE;AACFC,uBAAO,EAAE;AADP;AAHiB,aAA3B;AAOA,iBAAKC,OAAL,GAAe,EAAf;AACA,iBAAKC,UAAL,GAAkB;AACdC,mBAAK,EAAE,MADO;AAEdC,uBAAS,EAAE,MAFG;AAGdC,uBAAS,EAAE,MAHG;AAIdC,oBAAM,EAAE,CAJM;AAKdC,oBAAM,EAAE,CALM;AAMdC,sBAAQ,EAAE,CANI;AAOdC,uBAAS,EAAE,CAPG;AAQdC,uBAAS,EAAE,CARG;AASdC,uBAAS,EAAE,GATG;AAUd;AACAC,uBAAS,EAAE,GAXG;AAYd;AACAC,yBAAW,EAAE,GAbC;AAcd;AACAC,yBAAW,EAAE,CAfC;AAgBdC,uBAAS,EAAE;AAhBG,aAAlB;AAkBH;AACD;;;;;;;mBAGA,oBAAW;AACP,qBAAO,wDAAU,IAAV,EAAgB,KAAK,CAArB,EAAwB,KAAK,CAA7B,uCAAgC;AAAA;AAAA;AAAA;AAAA;AAAA;AACnC,6BAAKd,OAAL,GAAee,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,KAAKrB,mBAAvB,EAA4C,KAAKP,YAAjD,CAAf;AACA,6BAAK6B,GAAL,GAAW,KAAK3B,UAAL,IAAmB,KAAK2B,GAAnC;AACA,6BAAKC,QAAL;AACA,6BAAKC,SAAL,CAAe,KAAKhC,MAApB;AACA,6BAAKiC,gBAAL,CAAsB,KAAK7B,YAA3B;AACA;;;;;;;AANmC;AAYpB,+BAAM,KAAK8B,MAAL,CAAYC,SAAZ,EAAN;;AAZoB;AAY7BC,8BAZ6B;AAanCA,8BAAM,CAACC,WAAP,iCAA2C,KAAKtC,GAAhD,sBAA6D,KAAK+B,GAAlE,oCAA6F,KAAK5B,WAAlG;;AAbmC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAhC,EAAP;AAeH;AACD;;;;;;mBAGA,oBAAW;AACP;AACA,kBAAMoC,EAAE,GAAGC,QAAQ,CAACC,aAAT,CAAuB,iBAAvB,CAAX;AACAF,gBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,UAArB,EAAiC,MAAjC;AACAJ,gBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,SAArB,EAAgC,MAAhC;AACAJ,gBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,iBAArB,EAAwC,GAAxC;AACH;AACD;;;;;;;mBAIA,mBAAU1C,MAAV,EAAkB;AACd,kBAAIA,MAAM,KAAK,MAAf,EAAuB;AACnB;AACH;AACD;;;AACA,kBAAMsC,EAAE,GAAGC,QAAQ,CAACC,aAAT,CAAuB,iBAAvB,CAAX;;AACA,kBAAI,KAAKxC,MAAL,KAAgB,OAApB,EAA6B;AACzBsC,kBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,wBAArB,EAA+C,SAA/C;AACAJ,kBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,4BAArB,EAAmD,eAAnD;AACAJ,kBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,kBAArB,EAAyC,MAAzC;AACAJ,kBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,sBAArB,EAA6C,OAA7C;AACH;;AACD,kBAAI,KAAK1C,MAAL,KAAgB,MAApB,EAA4B;AACxB,oBAAIsC,EAAE,CAACK,SAAH,CAAaC,QAAb,CAAsB,KAAtB,CAAJ,EAAkC;AAC9BN,oBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,wBAArB,EAA+C,SAA/C;AACAJ,oBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,4BAArB,EAAmD,SAAnD;AACH,iBAHD,MAIK;AACDJ,oBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,wBAArB,EAA+C,SAA/C;AACAJ,oBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,4BAArB,EAAmD,UAAnD;AACH;;AACDJ,kBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,kBAArB,EAAyC,SAAzC;AACAJ,kBAAE,CAACG,KAAH,CAASC,WAAT,CAAqB,sBAArB,EAA6C,aAA7C;AACH;AACJ;AACD;;;;;;;;mBAKA,4BAAkC;AAAA;;AAAA,kBAAjBG,QAAiB,uEAAN,IAAM;;AAC9B,kBAAI,CAACA,QAAL,EAAe;AACX;AACH;AACD;;;AACA,kBAAMP,EAAE,GAAGC,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAX;AACAF,gBAAE,CAACQ,gBAAH,CAAoB,WAApB;AAAkC;;;;AAIlC,wBAACvE,KAAD;AAAA,uBAAW,MAAI,CAACwE,UAAL,CAAgBxE,KAAhB,CAAX;AAAA,eAJA,EAIoC,IAJpC;AAKA+D,gBAAE,CAACQ,gBAAH,CAAoB,WAApB;AAAkC;;;;AAIlC,wBAACvE,KAAD;AAAA,uBAAW,MAAI,CAACyE,SAAL,CAAezE,KAAf,CAAX;AAAA,eAJA,EAImC,IAJnC;AAKA+D,gBAAE,CAACQ,gBAAH,CAAoB,SAApB;AAAgC;;;;AAIhC,wBAACvE,KAAD;AAAA,uBAAW,MAAI,CAAC0E,QAAL,CAAc1E,KAAd,CAAX;AAAA,eAJA,EAIkC,IAJlC;AAKA+D,gBAAE,CAACQ,gBAAH,CAAoB,YAApB;AAAmC;;;;AAInC,wBAACvE,KAAD;AAAA,uBAAW,MAAI,CAACwE,UAAL,CAAgBxE,KAAhB,CAAX;AAAA,eAJA,EAIoC,IAJpC;AAKA+D,gBAAE,CAACQ,gBAAH,CAAoB,WAApB;AAAkC;;;;AAIlC,wBAACvE,KAAD;AAAA,uBAAW,MAAI,CAACyE,SAAL,CAAezE,KAAf,CAAX;AAAA,eAJA,EAImC,IAJnC;AAKA+D,gBAAE,CAACQ,gBAAH,CAAoB,UAApB;AAAiC;;;;AAIjC,wBAACvE,KAAD;AAAA,uBAAW,MAAI,CAAC0E,QAAL,CAAc1E,KAAd,CAAX;AAAA,eAJA,EAIkC,IAJlC;AAKA,mBAAKuB,eAAL,CAAqBoD,MAArB,GAA8BC,IAA9B;AAAoC;;;;AAIpC,wBAACC,KAAD,EAAW;AACPA,qBAAK,CAACC,aAAN,GAAsBF,IAAtB;AAA4B;;;AAG5B,4BAAM;AACFZ,0BAAQ,CAACe,mBAAT,CAA6B,WAA7B,EAA0C,MAAI,CAACP,UAA/C,EAA2D,IAA3D;AACAR,0BAAQ,CAACe,mBAAT,CAA6B,WAA7B,EAA0C,MAAI,CAACN,SAA/C,EAA0D,IAA1D;AACAT,0BAAQ,CAACe,mBAAT,CAA6B,SAA7B,EAAwC,MAAI,CAACN,SAA7C,EAAwD,IAAxD;AACAT,0BAAQ,CAACe,mBAAT,CAA6B,YAA7B,EAA2C,MAAI,CAACP,UAAhD,EAA4D,IAA5D;AACAR,0BAAQ,CAACe,mBAAT,CAA6B,WAA7B,EAA0C,MAAI,CAACN,SAA/C,EAA0D,IAA1D;AACAT,0BAAQ,CAACe,mBAAT,CAA6B,UAA7B,EAAyC,MAAI,CAACN,SAA9C,EAAyD,IAAzD;AACH,iBAVD;AAWH,eAhBD;AAiBH;AACD;;;;;;;mBAIA,oBAAWzE,KAAX,EAAkB;AAAA,yBACWA,KAAK,CAACgF,IAAN,KAAe,YAAf,GAA8BhF,KAAK,CAACiF,cAAN,CAAqB,CAArB,CAA9B,GAAwDjF,KADnE;AAAA,kBACNkF,KADM,QACNA,KADM;AAAA,kBACCC,KADD,QACCA,KADD;;AAEd,mBAAK5C,UAAL,GAAkBc,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,KAAKf,UAAvB,EAAmC;AAAEC,qBAAK,EAAE,OAAT;AAAkBC,yBAAS,EAAE,MAA7B;AAAqCI,wBAAQ,EAAE,CAA/C;AAAkDF,sBAAM,EAAEuC,KAA1D;AAAiEtC,sBAAM,EAAEuC,KAAzE;AAAgF/B,yBAAS,EAAE,IAAIgC,IAAJ,GAAWC,OAAX;AAA3F,eAAnC,CAAlB;AACH;AACD;;;;;;;mBAIA,mBAAUrF,KAAV,EAAiB;AACb,kBAAI,KAAKuC,UAAL,CAAgBC,KAAhB,KAA0B,MAA9B,EAAsC;AAClC;AACH;;AAHY,0BAIYxC,KAAK,CAACgF,IAAN,KAAe,WAAf,GAA6BhF,KAAK,CAACiF,cAAN,CAAqB,CAArB,CAA7B,GAAuDjF,KAJnE;AAAA,kBAILkF,KAJK,SAILA,KAJK;AAAA,kBAIEC,KAJF,SAIEA,KAJF,EAKb;;AACA;;;AACA,kBAAMrC,SAAS,GAAGoC,KAAK,GAAG,KAAK3C,UAAL,CAAgBI,MAA1C,CAPa,CAQb;;AACA;;AACA,kBAAMI,SAAS,GAAGoC,KAAK,GAAG,KAAK5C,UAAL,CAAgBK,MAA1C;AACA;;AACA,kBAAIH,SAAJ;AACA;;AACA,kBAAII,QAAJ;;AACA,kBAAIyC,IAAI,CAACC,GAAL,CAASzC,SAAT,IAAsBwC,IAAI,CAACC,GAAL,CAASxC,SAAT,CAA1B,EAA+C;AAC3C;AACAN,yBAAS,GAAGK,SAAS,GAAG,CAAZ,GAAgB,MAAhB,GAAyB,OAArC;AACAD,wBAAQ,GAAGC,SAAX;AACH,eAJD,MAKK;AACD;AACAL,yBAAS,GAAGM,SAAS,GAAG,CAAZ,GAAgB,IAAhB,GAAuB,MAAnC;AACAF,wBAAQ,GAAGE,SAAX;AACH;;AACD,mBAAKR,UAAL,GAAkBc,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,KAAKf,UAAvB,EAAmC;AAAEC,qBAAK,EAAE,MAAT;AAAiBC,yBAAS,EAATA,SAAjB;AACjDI,wBAAQ,EAARA,QADiD;AAEjDC,yBAAS,EAATA,SAFiD;AAGjDC,yBAAS,EAATA;AAHiD,eAAnC,CAAlB;AAIA/C,mBAAK,CAACwF,cAAN;AACH;AACD;;;;;;;mBAIA,kBAASxF,KAAT,EAAgB;AACZ,kBAAI,KAAKuC,UAAL,CAAgBC,KAAhB,KAA0B,MAA9B,EAAsC;AAClC;AACH;;AAHW,qCAI8E,KAAKD,UAJnF;AAAA,kBAIJW,WAJI,oBAIJA,WAJI;AAAA,kBAIST,SAJT,oBAISA,SAJT;AAAA,kBAIoBQ,SAJpB,oBAIoBA,SAJpB;AAAA,kBAI+BG,SAJ/B,oBAI+BA,SAJ/B;AAAA,kBAI0CJ,SAJ1C,oBAI0CA,SAJ1C;AAAA,kBAIqDF,SAJrD,oBAIqDA,SAJrD;AAAA,kBAIgEC,SAJhE,oBAIgEA,SAJhE;AAKZ;;AACA,kBAAIL,SAAJ;AACA;;AACA,kBAAMS,WAAW,GAAG,IAAIiC,IAAJ,GAAWC,OAAX,KAAuBjC,SAA3C;;AACA,kBAAID,WAAW,IAAID,WAAnB,EAAgC;AAC5B;AACA,oBAAIoC,IAAI,CAACC,GAAL,CAASzC,SAAT,KAAuBE,SAAvB,IAAoCsC,IAAI,CAACC,GAAL,CAASxC,SAAT,KAAuBE,SAA/D,EAA0E;AACtE;AACAP,2BAAS,GAAGD,SAAZ,CAFsE,CAE/C;AAC1B,iBAHD,MAIK,IAAI6C,IAAI,CAACC,GAAL,CAASxC,SAAT,KAAuBC,SAAvB,IAAoCsC,IAAI,CAACC,GAAL,CAASzC,SAAT,KAAuBG,SAA/D,EAA0E;AAC3E;AACAP,2BAAS,GAAGD,SAAZ,CAF2E,CAEpD;AAC1B;AACJ;;AACD,mBAAKF,UAAL,GAAkBc,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,KAAKf,UAAvB,EAAmC;AAAEC,qBAAK,EAAE,KAAT;AAAgBE,yBAAS,EAATA;AAAhB,eAAnC,CAAlB;;AACA,kBAAIA,SAAS,KAAK,MAAlB,EAA0B;AACtB,uBAAO,KAAK+C,UAAL,EAAP;AACH;AACJ;AACD;;;;;;mBAGA,sBAAa;AACT,mBAAKlE,eAAL,CAAqBmE,OAArB;AACH;;;;;;AAELpE,4BAAoB,CAACR,IAArB,GAA4B,SAAS6E,4BAAT,CAAsC3E,CAAtC,EAAyC;AAAE,iBAAO,KAAKA,CAAC,IAAIM,oBAAV,EAAgC,gEAAyB,8DAAzB,CAAhC,CAAP;AAA2F,SAAlK;;AACAA,4BAAoB,CAACsE,IAArB,GAA4B,gEAAyB;AAAEZ,cAAI,EAAE1D,oBAAR;AAA8BuE,mBAAS,EAAE,CAAC,CAAC,kBAAD,CAAD,CAAzC;AAAiEC,mBAAS,EAAE,SAASC,0BAAT,CAAoCC,EAApC,EAAwCC,GAAxC,EAA6C;AAAE,gBAAID,EAAE,GAAG,CAAT,EAAY;AACpL,wEAAmBvF,GAAnB,EAAwB,CAAxB;AACH;;AAAC,gBAAIuF,EAAE,GAAG,CAAT,EAAY;AACV,kBAAIE,EAAJ;;AACA,2EAAsBA,EAAE,GAAG,2DAA3B,MAAqDD,GAAG,CAACtC,MAAJ,GAAauC,EAAE,CAACC,KAArE;AACH;AAAE,WAL8C;AAK5CC,gBAAM,EAAE;AAAE5E,eAAG,EAAE,KAAP;AAAcC,kBAAM,EAAE,QAAtB;AAAgCC,wBAAY,EAAE,cAA9C;AAA8DC,uBAAW,EAAE,aAA3E;AAA0FC,sBAAU,EAAE,YAAtG;AAAoHC,wBAAY,EAAE,cAAlI;AAAkJC,gBAAI,EAAE,MAAxJ;AAAgKC,iBAAK,EAAE,OAAvK;AAAgLC,qBAAS,EAAE,WAA3L;AAAwMuB,eAAG,EAAE;AAA7M,WALoC;AAKkL8C,eAAK,EAAE,EALzL;AAK6LC,cAAI,EAAE,EALnM;AAKuMC,gBAAM,EAAE,CAAC,CAAC,CAAD,EAAI,SAAJ,CAAD,EAAiB,CAAC,MAAD,EAAS,SAAT,CAAjB,EAAsC,CAAC,CAAD,EAAI,OAAJ,CAAtC,EAAoD,CAAC,MAAD,EAAS,WAAT,EAAsB,MAAtB,EAA8B,OAA9B,CAApD,EAA4F,CAAC,CAAD,EAAI,MAAJ,CAA5F,EAAyG,CAAC,CAAD,EAAI,iBAAJ,CAAzG,EAAiI,CAAC,CAAD,EAAI,SAAJ,CAAjI,EAAiJ,CAAC,WAAD,EAAc,EAAd,CAAjJ,EAAoK,CAAC,CAAD,EAAI,iBAAJ,CAApK,CAL/M;AAK4YC,kBAAQ,EAAE,SAASC,6BAAT,CAAuCT,EAAvC,EAA2CC,GAA3C,EAAgD;AAAE,gBAAID,EAAE,GAAG,CAAT,EAAY;AACjgB,2EAAsB,CAAtB,EAAyB,YAAzB,EAAuC,CAAvC;;AACA,2EAAsB,CAAtB,EAAyB,aAAzB;;AACA,2EAAsB,CAAtB,EAAyB,aAAzB,EAAwC,CAAxC;;AACA,2EAAsB,CAAtB,EAAyB,YAAzB,EAAuC,CAAvC;;AACA,uEAAkB,OAAlB,EAA2B,SAASU,yDAAT,GAAqE;AAAE,uBAAOT,GAAG,CAACR,UAAJ,EAAP;AAA0B,eAA5H;;AACA,sEAAiB,CAAjB,EAAoB,UAApB,EAAgC,CAAhC;;AACA;;AACA;;AACA,2EAAsB,CAAtB,EAAyB,WAAzB,EAAsC,CAAtC;;AACA,mEAAc,CAAd;;AACA;;AACA;;AACA;;AACA,2EAAsB,CAAtB,EAAyB,aAAzB,EAAwC,CAAxC;;AACA,sEAAiB,CAAjB,EAAoB,YAApB,EAAkC,CAAlC,EAAqC,CAArC;;AACA;;AACA,2EAAsB,EAAtB,EAA0B,YAA1B,EAAwC,CAAxC;;AACA,2EAAsB,EAAtB,EAA0B,aAA1B,EAAyC,CAAzC;;AACA,2EAAsB,EAAtB,EAA0B,UAA1B;;AACA,mEAAc,EAAd;;AACA;;AACA;;AACA;AACH;;AAAC,gBAAIO,EAAE,GAAG,CAAT,EAAY;AACV,uEAAkB,SAAlB,EAA6B,8DAAuB,CAAvB,EAA0BtF,GAA1B,EAA+BuF,GAAG,CAAClE,KAAJ,CAAU4E,MAAV,IAAoB,CAAnD,CAA7B;;AACA,sEAAiB,CAAjB;;AACA,uEAAkB,MAAlB,EAA0BV,GAAG,CAACjE,SAA9B;;AACA,sEAAiB,CAAjB;;AACA,8EAAyBiE,GAAG,CAAClE,KAA7B;;AACA,sEAAiB,CAAjB;;AACA,uEAAkB,iBAAlB,EAAqC,KAArC;;AACA,sEAAiB,CAAjB;;AACA,uEAAkB,SAAlB,EAA6BkE,GAAG,CAAC3D,OAAjC;;AACA,sEAAiB,CAAjB;;AACA,uEAAkB,SAAlB,EAA6B,8DAAuB,CAAvB,EAA0B1B,GAA1B,EAA+BqF,GAAG,CAACnE,IAAJ,CAAS6E,MAAT,IAAmB,CAAlD,CAA7B;;AACA,sEAAiB,CAAjB;;AACA,8EAAyBV,GAAG,CAACnE,IAA7B;AACH;AAAE,WA3C8C;AA2C5C8E,oBAAU,EAAE,CAAC,wDAAD,EAAmB,uDAAnB,EAAmC,yDAAnC,EAAsD,yDAAtD,EAAyE,wDAAzE,EAA2F,sDAA3F,EAA2G,uDAA3G,EAA4H,yDAA5H,EAA+I,wDAA/I,EAAiK,wDAAjK,EAAmL,sDAAnL,CA3CgC;AA2CoKC,gBAAM,EAAE,CAAC,0tBAAD;AA3C5K,SAAzB,CAA5B;;;;AA4FA,UAAI,KAAJ,EAAW,CAkCV;;;YAOKC,4B;AACF;;;AAGA,gDAAYvF,eAAZ,EAA6B;AAAA;;AACzB,iBAAKA,eAAL,GAAuBA,eAAvB;AACH;AACD;;;;;;;;;;;;;;;;mBAYA,mBAAUgC,GAAV,EAAkJ;AAAA,kBAAnI5B,WAAmI,uEAArH,EAAqH;AAAA,kBAAjHC,UAAiH,uEAApG,EAAoG;AAAA,kBAAhGG,KAAgG,uEAAxF,EAAwF;AAAA,kBAApFC,SAAoF,uEAAxE,EAAwE;AAAA,kBAApEF,IAAoE,uEAA7D,EAA6D;AAAA,kBAAzDL,MAAyD,uEAAhD,MAAgD;AAAA,kBAAxCC,YAAwC,uEAAzB,EAAyB;AAAA,kBAArBG,YAAqB,uEAAN,IAAM;AAC9I,qBAAO,wDAAU,IAAV,EAAgB,KAAK,CAArB,EAAwB,KAAK,CAA7B,uCAAgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAErB,+BAAM,KAAKN,eAAL,CAAqBwF,MAArB,CAA4B;AAC5CC,mCAAS,EAAE1F,oBADiC;AAE5C2F,wCAAc,EAAE;AACZ1D,+BAAG,EAAHA,GADY;AAEZ5B,uCAAW,EAAXA,WAFY;AAGZC,sCAAU,EAAVA,UAHY;AAIZG,iCAAK,EAALA,KAJY;AAKZC,qCAAS,EAATA,SALY;AAMZF,gCAAI,EAAJA,IANY;AAOZL,kCAAM,EAANA,MAPY;AAQZC,wCAAY,EAAZA,YARY;AASZG,wCAAY,EAAZA;AATY,2BAF4B;AAa5CqF,kCAAQ,EAAE,KAAKA,QAAL,YAAyBC,KAAzB,IAAkC,gBAAlC,4BAAuD,KAAKD,QAA5D,KAAwE,CAAC,gBAAD,EAAmB,KAAKA,QAAxB,CAbtC;AAc5CE,uCAAa,EAAE,IAd6B;AAe5CC,sCAAY,EAAE;AAf8B,yBAA5B,CAAN;;AAFqB;AAE7BxC,6BAF6B;AAAA;AAmB5B,+BAAMA,KAAK,CAACyC,OAAN,EAAN;;AAnB4B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAhC,EAAP;AAqBH;AACD;;;;;;mBAGA,oBAAW,CAAG;;;;;;AAElBR,oCAA4B,CAAChG,IAA7B,GAAoC,SAASyG,oCAAT,CAA8CvG,CAA9C,EAAiD;AAAE,iBAAO,KAAKA,CAAC,IAAI8F,4BAAV,EAAwC,gEAAyB,8DAAzB,CAAxC,CAAP;AAAmG,SAA1L;;AACAA,oCAA4B,CAAClB,IAA7B,GAAoC,gEAAyB;AAAEZ,cAAI,EAAE8B,4BAAR;AAAsCjB,mBAAS,EAAE,CAAC,CAAC,gBAAD,CAAD,CAAjD;AAAuEO,gBAAM,EAAE;AAAE5E,eAAG,EAAE,KAAP;AAAc0F,oBAAQ,EAAE,UAAxB;AAAoCzF,kBAAM,EAAE,QAA5C;AAAsDC,wBAAY,EAAE,cAApE;AAAoF6B,eAAG,EAAE,KAAzF;AAAgG5B,uBAAW,EAAE,aAA7G;AAA4HC,sBAAU,EAAE,YAAxI;AAAsJC,wBAAY,EAAE,cAApK;AAAoLC,gBAAI,EAAE,MAA1L;AAAkMC,iBAAK,EAAE,OAAzM;AAAkNC,qBAAS,EAAE;AAA7N,WAA/E;AAA2TqE,eAAK,EAAE,CAAlU;AAAqUC,cAAI,EAAE,CAA3U;AAA8UC,gBAAM,EAAE,CAAC,CAAC,CAAD,EAAI,KAAJ,EAAW,KAAX,EAAkB,OAAlB,EAA2B,OAA3B,CAAD,CAAtV;AAA6XC,kBAAQ,EAAE,SAASgB,qCAAT,CAA+CxB,EAA/C,EAAmDC,GAAnD,EAAwD;AAAE,gBAAID,EAAE,GAAG,CAAT,EAAY;AAClgB,2EAAsB,CAAtB,EAAyB,KAAzB,EAAgC,CAAhC;;AACA,uEAAkB,OAAlB,EAA2B,SAASyB,0DAAT,GAAsE;AAAE,uBAAOxB,GAAG,CAACyB,SAAJ,CAAczB,GAAG,CAAC1C,GAAlB,EAAuB0C,GAAG,CAACtE,WAA3B,EAAwCsE,GAAG,CAACrE,UAA5C,EAAwDqE,GAAG,CAAClE,KAA5D,EAAmEkE,GAAG,CAACjE,SAAvE,EAAkFiE,GAAG,CAACnE,IAAtF,EAA4FmE,GAAG,CAACxE,MAAhG,EAAwGwE,GAAG,CAACvE,YAA5G,EAA0HuE,GAAG,CAACpE,YAA9H,CAAP;AAAqJ,eAAxP,EAA0P,OAA1P,EAAmQ,SAAS8F,0DAAT,GAAsE;AAAE,uBAAO1B,GAAG,CAAC1C,GAAJ,GAAU0C,GAAG,CAACtE,WAArB;AAAmC,eAA9W;;AACA;AACH;;AAAC,gBAAIqE,EAAE,GAAG,CAAT,EAAY;AACV,uEAAkB,KAAlB,EAAyBC,GAAG,CAACzE,GAA7B,EAAkC,KAAlC,EAAyCyE,GAAG,CAAC1C,GAA7C,EAAkD,2DAAlD;AACH;AAAE,WANsD;AAMpDsD,gBAAM,EAAE,CAAC,sDAAD;AAN4C,SAAzB,CAApC;;;;AA2DA,UAAI,KAAJ,EAAW,CAyBV;;;YAOKe,4B;AACF;;;;;AAKA,gDAAY7D,EAAZ,EAAgB8D,QAAhB,EAA0BtG,eAA1B,EAA2C;AAAA;;AACvC,iBAAKwC,EAAL,GAAUA,EAAV;AACA,iBAAK8D,QAAL,GAAgBA,QAAhB;AACA,iBAAKtG,eAAL,GAAuBA,eAAvB;AACH;AACD;;;;;;;mBAGA,mBAAU;AACN,mBAAKmG,SAAL,CAAe,KAAKnE,GAApB,EAAyB,KAAK5B,WAA9B,EAA2C,KAAKC,UAAhD,EAA4D,KAAKG,KAAjE,EAAwE,KAAKC,SAA7E,EAAwF,KAAKF,IAA7F,EAAmG,KAAKL,MAAxG,EAAgH,KAAKC,YAArH,EAAmI,KAAKG,YAAxI;AACH;AACD;;;;;;;mBAIA,iBAAQ3C,KAAR,EAAe;AACX,kBAAI,KAAKqE,GAAL,KAAa,KAAKQ,EAAL,CAAQ+D,aAAR,CAAsBvE,GAAvC,EAA4C;AACxC,qBAAKA,GAAL,GAAW,KAAKQ,EAAL,CAAQ+D,aAAR,CAAsBvE,GAAjC;AACH;;AACD,kBAAI,KAAK5B,WAAT,EAAsB;AAClB,qBAAKkG,QAAL,CAAcE,YAAd,CAA2B,KAAKhE,EAAL,CAAQ+D,aAAnC,EAAkD,KAAlD,EAAyD,KAAKnG,WAA9D;AACH;AACJ;AACD;;;;;;mBAGA,oBAAW;AACP,kBAAI,CAAC,KAAKoC,EAAL,CAAQ+D,aAAR,CAAsBE,YAAtB,CAAmC,KAAnC,CAAL,EAAgD;AAC5C,qBAAKH,QAAL,CAAcE,YAAd,CAA2B,KAAKhE,EAAL,CAAQ+D,aAAnC,EAAkD,KAAlD,EAAyD,KAAKvE,GAA9D;AACH;AACJ;AACD;;;;;;;;;;;;;;;mBAYA,mBAAUA,GAAV,EAAkJ;AAAA,kBAAnI5B,WAAmI,uEAArH,EAAqH;AAAA,kBAAjHC,UAAiH,uEAApG,EAAoG;AAAA,kBAAhGG,KAAgG,uEAAxF,EAAwF;AAAA,kBAApFC,SAAoF,uEAAxE,EAAwE;AAAA,kBAApEF,IAAoE,uEAA7D,EAA6D;AAAA,kBAAzDL,MAAyD,uEAAhD,MAAgD;AAAA,kBAAxCC,YAAwC,uEAAzB,EAAyB;AAAA,kBAArBG,YAAqB,uEAAN,IAAM;AAC9I,qBAAO,wDAAU,IAAV,EAAgB,KAAK,CAArB,EAAwB,KAAK,CAA7B,uCAAgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAErB,+BAAM,KAAKN,eAAL,CAAqBwF,MAArB,CAA4B;AAC5CC,mCAAS,EAAE1F,oBADiC;AAE5C2F,wCAAc,EAAE;AACZ1D,+BAAG,EAAHA,GADY;AAEZ5B,uCAAW,EAAXA,WAFY;AAGZC,sCAAU,EAAVA,UAHY;AAIZG,iCAAK,EAALA,KAJY;AAKZC,qCAAS,EAATA,SALY;AAMZF,gCAAI,EAAJA,IANY;AAOZL,kCAAM,EAANA,MAPY;AAQZC,wCAAY,EAAZA,YARY;AASZG,wCAAY,EAAZA;AATY,2BAF4B;AAa5CqF,kCAAQ,EAAE,KAAKA,QAAL,YAAyBC,KAAzB,IAAkC,gBAAlC,4BAAuD,KAAKD,QAA5D,KAAwE,CAAC,gBAAD,EAAmB,KAAKA,QAAxB,CAbtC;AAc5CE,uCAAa,EAAE,IAd6B;AAe5CC,sCAAY,EAAE;AAf8B,yBAA5B,CAAN;;AAFqB;AAE7BxC,6BAF6B;AAAA;AAmB5B,+BAAMA,KAAK,CAACyC,OAAN,EAAN;;AAnB4B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAhC,EAAP;AAqBH;;;;;;AAELM,oCAA4B,CAAC9G,IAA7B,GAAoC,SAASmH,oCAAT,CAA8CjH,CAA9C,EAAiD;AAAE,iBAAO,KAAKA,CAAC,IAAI4G,4BAAV,EAAwC,gEAAyB,wDAAzB,CAAxC,EAAqF,gEAAyB,uDAAzB,CAArF,EAAiI,gEAAyB,8DAAzB,CAAjI,CAAP;AAA4L,SAAnR;;AACAA,oCAA4B,CAACM,IAA7B,GAAoC,gEAAyB;AAAElD,cAAI,EAAE4C,4BAAR;AAAsC/B,mBAAS,EAAE,CAAC,CAAC,EAAD,EAAK,cAAL,EAAqB,EAArB,CAAD,CAAjD;AAA6EsC,sBAAY,EAAE,SAASC,yCAAT,CAAmDpC,EAAnD,EAAuDC,GAAvD,EAA4D;AAAE,gBAAID,EAAE,GAAG,CAAT,EAAY;AAC1N,uEAAkB,OAAlB,EAA2B,SAASqC,qDAAT,GAAiE;AAAE,uBAAOpC,GAAG,CAACqC,OAAJ,EAAP;AAAuB,eAArH,EAAuH,OAAvH,EAAgI,SAASC,qDAAT,CAA+DC,MAA/D,EAAuE;AAAE,uBAAOvC,GAAG,CAACwC,OAAJ,CAAYD,MAAZ,CAAP;AAA6B,eAAtO;AACH;AAAE,WAFsD;AAEpDpC,gBAAM,EAAE;AAAE7C,eAAG,EAAE,KAAP;AAAc2D,oBAAQ,EAAE,UAAxB;AAAoCzF,kBAAM,EAAE,QAA5C;AAAsDC,wBAAY,EAAE,cAApE;AAAoFC,uBAAW,EAAE,aAAjG;AAAgHC,sBAAU,EAAE,YAA5H;AAA0IC,wBAAY,EAAE,cAAxJ;AAAwKC,gBAAI,EAAE,MAA9K;AAAsLC,iBAAK,EAAE,OAA7L;AAAsMC,qBAAS,EAAE;AAAjN;AAF4C,SAAzB,CAApC;;;;AAgEA,UAAI,KAAJ,EAAW,CAiCV;;;YAOK0G,yB;;;;AAENA,iCAAyB,CAACC,IAA1B,GAAiC,+DAAwB;AAAE3D,cAAI,EAAE0D;AAAR,SAAxB,CAAjC;AACAA,iCAAyB,CAACE,IAA1B,GAAiC,+DAAwB;AAAEzH,iBAAO,EAAE,SAAS0H,iCAAT,CAA2C7H,CAA3C,EAA8C;AAAE,mBAAO,KAAKA,CAAC,IAAI0H,yBAAV,GAAP;AAAgD,WAA3G;AAA6GI,iBAAO,EAAE,CAAC,CAAC,4DAAD,EAAe,0DAAf,CAAD;AAAtH,SAAxB,CAAjC;;;;AACA,OAAC,YAAY;AAAE,SAAC,OAAOC,SAAP,KAAqB,WAArB,IAAoCA,SAArC,KAAmD,iEAA0BL,yBAA1B,EAAqD;AAAEM,sBAAY,EAAE,wBAAY;AAAE,mBAAO,CAAClC,4BAAD,EAA+Bc,4BAA/B,EAA6DtG,oBAA7D,CAAP;AAA4F,WAA1H;AAA4HwH,iBAAO,EAAE,mBAAY;AAAE,mBAAO,CAAC,4DAAD,EAAe,0DAAf,CAAP;AAAqC,WAAxL;AAA0LG,iBAAO,EAAE,mBAAY;AAAE,mBAAO,CAACnC,4BAAD,EAA+Bc,4BAA/B,EAA6DtG,oBAA7D,CAAP;AAA4F;AAA7S,SAArD,CAAnD;AAA2Z,OAA1a;AAWA;;;;;;AAMA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5uBO,eAAe4H,cAAf,CAA8BC,IAA9B,EAA0C;;;;;;;iCACxBC,MAAM,CAACC,M;;AAE5B,yBAAMF,IAAI,CAACG,WAAL,EAAN;;;;;AAFe,sCAAoBC,MAApB,oBACf,SADe;;;AAAXC,0B;oDAIC,mEAAiBA,QAAjB,C;;;;;;;;;AACR;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLK;;AAQE;;AACF;;;;;;AADwB;;AAAA;;;;ACGvB;AAAA,YAAMC,QAAN;AA4BL,4BACmBC,iBADnB,EAEmBnI,eAFnB,EAGmBoI,gBAHnB,EAGqD;AAAA;;AAAA;;AAFlC,iBAAAD,iBAAA,GAAAA,iBAAA;AACA,iBAAAnI,eAAA,GAAAA,eAAA;AACA,iBAAAoI,gBAAA,GAAAA,gBAAA;AA9BV,iBAAAC,QAAA,GAAW,KAAKD,gBAAL,CAAsBE,IAAjC;AAEQ,iBAAAC,YAAA,GAAe,IAAI,oDAAJ,CAC9BvK,SAD8B,CAAf;AAIA,iBAAAwK,WAAA,GAAc,KAAKD,YAAL,CAAkBnK,IAAlB,CAC7B,2EAD6B,EAE7B,6EAF6B,CAAd;AAUA,iBAAAqK,aAAA,GAAgB,IAAI,4CAAJ,EAAhB;AAEA,iBAAAC,YAAA,GAAe,KAAKD,aAAL,CAAmBrK,IAAnB,CAC9B,6EAD8B,CAAf;AAIR,iBAAAuK,eAAA,GAAkB,2DAAc,CACvC,KAAKH,WADkC,EAEvC,KAAKE,YAFkC,CAAd,EAGxBtK,IAHwB,CAGnB,iEAAU;AAAA;AAAA,kBAAEwK,UAAF;;AAAA,qBAAkB,MAAI,CAACC,YAAL,CAAkBD,UAAlB,CAAlB;AAAA,aAAV,CAHmB,CAAlB;AASL;;AAhCC;AAAA;AAAA,iBAYL,aACerK,KADf,EACkC;AAChC,mBAAKgK,YAAL,CAAkB/J,IAAlB,CAAuBD,KAAvB;AACD;AAfI;AAAA;AAAA,mBAkCL,kBAASE,KAAT,EAAuB;AACrB,mBAAKgK,aAAL,CAAmBjK,IAAnB,CAAwBC,KAAxB;AACD;AApCI;AAAA;AAAA,mBAsCS,sBAAamK,UAAb,EAAqC;;;;;;;;AAC3B,+BAAMA,UAAU,CAACE,gBAAX,EAAN;;;AAAhBC,qC;0DAEJA,aAAa,CAACC,SAAd,KACAD,aAAa,CAACE,YAAd,GAA6BF,aAAa,CAACG,Y;;;;;;;;;AAE9C;AA5CI;AAAA;AAAA,mBA8CC,yBAAgBzK,KAAhB,EAA8B;;;;;;;;AACV,+BAAM,KAAK0J,iBAAL,CAAuB3C,MAAvB,CAA8B;AAC1DC,mCAAS,EAAE,8EAD+C;AAE1DhH,+BAAK,EAALA;AAF0D,yBAA9B,CAAN;;;AAAlB0K,uC;;AAIC,+BAAMA,eAAe,CAACpD,OAAhB,EAAN;;;;;;;;;;;;AACR;AApDI;AAAA;AAAA,mBAsDC,yBAAgB;;;;;;;;AACA,+BAAM,KAAK/F,eAAL,CAAqBwF,MAArB,CAA4B;AACpDC,mCAAS,EAAE;AADyC,yBAA5B,CAAN;;;AAAd2D,mC;;AAGC,+BAAMA,WAAW,CAACrD,OAAZ,EAAN;;;;;;;;;;;;AACR;AA3DI;AAAA;AAAA,mBA6DL,qBAAYsD,CAAZ,EAAuBC,IAAvB,EAAqC;AACnC,qBAAOA,IAAI,CAACC,EAAZ;AACD;AA/DI;;AAAA;AAAA;;;2BAAMrB,Q,EAAQ,iI,EAAA,+H,EAAA,0J;AAAA,S;;;gBAARA,Q;AAAQ,mC;AAAA;AAAA;wEAYR,yD,EAAU,C;;;;;;;;;;;;;;AD1BvB;;AAA0B;AAAA,uBAAa,IAAAsB,QAAA,QAAb;AAA6B,eAA7B;;AACxB;;AACE;;AACE;;;;AAUF;;AACF;;AACA;;AACE;;AAAgB;AAAA,uBAAS,IAAAC,aAAA,EAAT;AAAwB,eAAxB;;AACd;;AACF;;AACF;;AACF;;AACA;;;;AACE;;AACE;;AACE;;AAAY;AAAA,uBAAS,IAAAC,eAAA,QAAT;AAAgC,eAAhC;;AACV;;AACF;;AACF;;AACF;;AACF;;;;AAxB2B;;AAAA,iKAAwB,cAAxB,EAAwB,eAAxB;;AAgBf;;AAAA;;;;;;;;OCPL;;;;;;;;;;;;;;;;;ACdP;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAIA;;;;;;AAKA;;;;;;AAKA,eAASC,OAAT,GAAmB,CAAG;;AACtB,UAAI,KAAJ,EAAW,CAGV;AACD;;;;;;;;;;;;;;AAYA,eAASC,aAAT,CAAuBC,GAAvB,EAA4B;AACxB;AACA,YAAMC,2BAA2B,GAAG,IAAI,4CAAJ,EAApC;AACA;;AACA,YAAMC,wBAAwB,GAAGD,2BAA2B,CAAC1L,IAA5B,CAAiC,6EAAjC,CAAjC;AACA;;AACA,YAAM4L,UAAU,GAAGD,wBAAwB,CAAC3L,IAAzB,EACnB;AACA;AAAW;;;;AAIX,kBAAC6L,WAAD,EAAiB;AACb;AACA;AACA;AACA,cAAIA,WAAW,IAAI,IAAnB,EAAyB;AACrB;AACAJ,eAAG,CAACK,yBAAJ,CAA8B1L,IAA9B;AAAoC;AAAkByL,uBAAtD,EAFqB,CAGrB;;AACAJ,eAAG,CAACM,MAAJ,GAJqB,CAKrB;;AACA,mBAAO,0CAAP;AACH;AACD;;;AACA,cAAMC,GAAG,GAAG,0DAAaH,WAAb;AACJ;AAAkBA,qBADd,GAEN,kDAAKA,WAAL,CAFN,CAba,CAgBb;AACA;;AACAJ,aAAG,CAACQ,oBAAJ,CAAyB7L,IAAzB;AACAqL,aAAG,CAACM,MAAJ;AACA,iBAAO;AAAE;AAAkBC,eAApB,CAA2BhM,IAA3B,CAAgC,6EAAhC,EAAwD,2DAAIyL,GAAG,CAACK,yBAAR,CAAxD,EAA4F;AAAK;;;AAGxG;AAAA,qBAAML,GAAG,CAACM,MAAJ,EAAN;AAAA,aAHmG,CAA5F,EAGe;AAAY;;;;AAIlC,sBAACG,CAAD,EAAO;AACH,qBAAO,0CAAP;AACH,aANqB,CAHf;AAAP;AAUH,SAlCD,CAFmB,CAAnB;AAqCA;AAAQ;AAAkB;AACtB;;;;AAIAC,mCALsB,mCAKEhM,KALF,EAKS;AAC3BuL,yCAA2B,CAACtL,IAA5B,CAAiCD,KAAjC;AACH,aAPqB;;AAQtB;;;AAGAiM,qBAXsB,uBAWV;AACR,qBAAOR,UAAU,CAACQ,SAAX,EAAP;AACH;AAbqB;AAA1B;AAeH;AAED;;;;;;AAKA;;;;;;;;;;;;;;;;;AAeA,eAASC,OAAT,CAAiBC,CAAjB,EAAoB;AAChB,eAAOA,CAAC,YAAY,oDAApB;AACH;AAED;;;;;;AAKA;;;;;AAGA,eAASC,YAAT,GAAwB,CAAG;;AAC3B,UAAI,KAAJ,EAAW,CAKV;AACD;;;;;;;AAKA,eAASC,YAAT,CAAsBC,MAAtB,EAA8B;AAC1B;;;AAGA,iBAASV,MAAT,GAAkB;AACd,cAAIM,OAAO,CAACI,MAAM,CAACC,MAAR,CAAX,EAA4B;AACxBD,kBAAM,CAACE,KAAP,CAAaC,YAAb;AACH,WAFD,MAGK;AACDH,kBAAM,CAACE,KAAP,CAAaE,aAAb;AACH;AACJ;;AACD,eAAOd,MAAP;AACH;;;YAmDKe,Q;AACF;;;;AAIA,4BAAYH,KAAZ,EAAmBD,MAAnB,EAA2B;AAAA;;AAAA;;AACvB,iBAAKT,oBAAL,GAA4B;AACxB7L,kBAAI;AAAG;;;AAGP;AAAA,uBAAO,MAAI,CAAC2M,aAAL,GAAqBnN,SAA5B;AAAA;AAJwB,aAA5B;AAMA,iBAAKkM,yBAAL,GAAiC;AAC7B1L,kBAAI;AAAG;;;;AAIP,4BAACD,KAAD;AAAA,uBAAY,MAAI,CAAC4M,aAAL,GAAqB5M,KAAjC;AAAA;AAL6B,aAAjC;AAOA,iBAAK6M,OAAL,GAAexB,aAAa,CAAC;AACzBO,oBAAM,EAAES,YAAY,CAAC;AAAEG,qBAAK,EAALA,KAAF;AAASD,sBAAM,EAANA;AAAT,eAAD,CADK;AAEzBZ,uCAAyB,EAAE,KAAKA,yBAFP;AAGzBG,kCAAoB,EAAE,KAAKA;AAHF,aAAD,CAA5B;AAKA,iBAAKgB,YAAL,GAAoB,KAAKD,OAAL,CAAaZ,SAAb,EAApB;AACH;AACD;;;;;;;;;mBAKA,mBAAUc,mBAAV,EAA+B;AAC3B,mBAAKF,OAAL,CAAab,uBAAb,CAAqCe,mBAArC;AACA;AAAQ;AAAkB,qBAAKH;AAA/B;AACH;AACD;;;;;;mBAGA,uBAAc;AACV,mBAAKE,YAAL,CAAkBE,WAAlB;AACH;;;;;;AAELL,gBAAQ,CAAC3L,IAAT,GAAgB,SAASiM,gBAAT,CAA0B/L,CAA1B,EAA6B;AAAE,iBAAO,KAAKA,CAAC,IAAIyL,QAAV,EAAoB,6EAApB,EAA4D,gEAAyB,oDAAzB,CAA5D,CAAP;AAA8G,SAA7J;;AACAA,gBAAQ,CAACO,KAAT,GAAiB,2DAAoB;AAAEC,cAAI,EAAE,UAAR;AAAoBjI,cAAI,EAAEyH,QAA1B;AAAoCS,cAAI,EAAE;AAA1C,SAApB,CAAjB;;;;AAUA,UAAI,KAAJ,EAAW,CA0BV;AAED;;;;;;AAKA;;;;;;AAIA,eAASC,cAAT,GAA0B,CAAG;;AAC7B,UAAI,KAAJ,EAAW,CASV;;;YAoEKC,Y;AACF;;;;;;AAMA,gCAAYd,KAAZ,EAAmBD,MAAnB,EAA2BgB,WAA3B,EAAwCC,gBAAxC,EAA0D;AAAA;;AAAA;;AACtD,iBAAKD,WAAL,GAAmBA,WAAnB;AACA,iBAAKC,gBAAL,GAAwBA,gBAAxB;AACA,iBAAKC,WAAL,GAAmB;AACfC,uBAAS,EAAEjO,SADI;AAEfkO,qBAAO,EAAElO,SAFM;AAGfmO,oBAAM,EAAE,KAHO;AAIfC,uBAAS,EAAE;AAJI,aAAnB;AAMA,iBAAK/B,oBAAL,GAA4B;AACxB7L,kBAAI;AAAG;;;AAGP,8BAAM;AACF;AACA,oBAAI,MAAI,CAAC6N,YAAT,EAAuB;AACnB,wBAAI,CAACL,WAAL,CAAiBC,SAAjB,GAA6BjO,SAA7B;AACA,wBAAI,CAACgO,WAAL,CAAiBE,OAAjB,GAA2BlO,SAA3B;AACA,wBAAI,CAACgO,WAAL,CAAiBG,MAAjB,GAA0B,KAA1B;AACA,wBAAI,CAACH,WAAL,CAAiBI,SAAjB,GAA6B,KAA7B;AACH;AACJ;AAZuB,aAA5B;AAcA,iBAAKlC,yBAAL,GAAiC;AAC7B1L,kBAAI;AAAG;;;;AAIP,4BAACD,KAAD,EAAW;AACP;AACA,oBAAI,CAAC,MAAI,CAAC8N,YAAV,EAAwB;AACpB,wBAAI,CAACC,kBAAL;AACH;;AACD,sBAAI,CAACN,WAAL,CAAiBC,SAAjB,GAA6B1N,KAA7B;AACA,sBAAI,CAACyN,WAAL,CAAiBE,OAAjB,GAA2B3N,KAA3B;AACH,eAZ4B;AAa7BZ,mBAAK;AAAG;;;;AAIR,6BAACA,MAAD,EAAW;AACP;AACA,oBAAI,CAAC,MAAI,CAAC0O,YAAV,EAAwB;AACpB,wBAAI,CAACC,kBAAL;AACH;;AACD,sBAAI,CAACN,WAAL,CAAiBG,MAAjB,GAA0B,IAA1B;AACH,eAvB4B;AAwB7BI,sBAAQ;AAAG;;;AAGX,kCAAM;AACF;AACA,oBAAI,CAAC,MAAI,CAACF,YAAV,EAAwB;AACpB,wBAAI,CAACC,kBAAL;AACH;;AACD,sBAAI,CAACN,WAAL,CAAiBI,SAAjB,GAA6B,IAA7B;AACH;AAjC4B,aAAjC;AAmCA,iBAAKhB,OAAL,GAAexB,aAAa,CAAC;AACzBO,oBAAM,EAAES,YAAY,CAAC;AAAEG,qBAAK,EAALA,KAAF;AAASD,sBAAM,EAANA;AAAT,eAAD,CADK;AAEzBT,kCAAoB,EAAE,KAAKA,oBAFF;AAGzBH,uCAAyB,EAAE,KAAKA;AAHP,aAAD,CAA5B;AAKA,iBAAKmB,YAAL,GAAoB,KAAKD,OAAL,CAAaZ,SAAb,EAApB;AACH;AACD;;;;;;;;;;;AASA;;;;AAIA,yBAAYc,mBAAZ,EAAiC;AAC7B,mBAAKF,OAAL,CAAab,uBAAb,CAAqCe,mBAArC;AACH;AACD;;;;;;mBAGA,8BAAqB;AACjB,mBAAKe,YAAL,GAAoB,KAAKN,gBAAL,CAAsBO,kBAAtB,CAAyC,KAAKR,WAA9C,EAA2D,KAAKE,WAAhE,CAApB;AACH;AACD;;;;;;mBAGA,uBAAc;AACV,mBAAKX,YAAL,CAAkBE,WAAlB;AACA,mBAAKQ,gBAAL,CAAsBS,KAAtB;AACH;;;mBAtBD,gCAA8BC,GAA9B,EAAmC/H,GAAnC,EAAwC;AACpC,qBAAO,IAAP;AACH;;;;;;AAsBLmH,oBAAY,CAACtM,IAAb,GAAoB,SAASmN,oBAAT,CAA8BjN,CAA9B,EAAiC;AAAE,iBAAO,KAAKA,CAAC,IAAIoM,YAAV,EAAwB,gEAAyB,+DAAzB,CAAxB,EAA4E,gEAAyB,oDAAzB,CAA5E,EAAqH,gEAAyB,yDAAzB,CAArH,EAAmK,gEAAyB,8DAAzB,CAAnK,CAAP;AAA+N,SAAtR;;AACAA,oBAAY,CAAClF,IAAb,GAAoB,gEAAyB;AAAElD,cAAI,EAAEoI,YAAR;AAAsBvH,mBAAS,EAAE,CAAC,CAAC,EAAD,EAAK,SAAL,EAAgB,EAAhB,CAAD,CAAjC;AAAwDO,gBAAM,EAAE;AAAEqH,mBAAO,EAAE;AAAX;AAAhE,SAAzB,CAApB;;;;AAiBA,UAAI,KAAJ,EAAW,CA2CV;AAED;;;;;;AAKA;;;AACA,UAAMS,YAAY,GAAG,CAACd,YAAD,EAAeX,QAAf,CAArB;AACA;;AACA,UAAM0B,OAAO,GAAG,CAACD,YAAD,CAAhB;;;YACME,uB;;;;AAENA,+BAAuB,CAACzF,IAAxB,GAA+B,+DAAwB;AAAE3D,cAAI,EAAEoJ;AAAR,SAAxB,CAA/B;AACAA,+BAAuB,CAACxF,IAAxB,GAA+B,+DAAwB;AAAEzH,iBAAO,EAAE,SAASkN,+BAAT,CAAyCrN,CAAzC,EAA4C;AAAE,mBAAO,KAAKA,CAAC,IAAIoN,uBAAV,GAAP;AAA8C;AAAvG,SAAxB,CAA/B;;;;AACA,OAAC,YAAY;AAAE,SAAC,OAAOrF,SAAP,KAAqB,WAArB,IAAoCA,SAArC,KAAmD,iEAA0BqF,uBAA1B,EAAmD;AAAEpF,sBAAY,EAAE,CAACoE,YAAD,EAAeX,QAAf,CAAhB;AAA0CxD,iBAAO,EAAE,CAACmE,YAAD,EAAeX,QAAf;AAAnD,SAAnD,CAAnD;AAAuL,OAAtM;AASA;;;;;;AAMA;;;;;;AAMA;;;;;;AAMA;;;;;;;;;;;;;;;;;;;;;;;AC3jBA;;;AACA,UAAInJ,MAAM,GAAG,SAASA,MAAT,CAAgBgL,EAAhB,EAAoB;AAC/B,YAAIC,IAAJ;;AAEA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAAC9H,MAA9B,EAAsC6H,CAAC,EAAvC,EAA2C;AACzCD,cAAI,GAAGlL,MAAM,CAACoL,SAAS,CAACD,CAAD,CAAV,CAAb;;AAEA,eAAK,IAAIE,GAAT,IAAgBH,IAAhB,EAAsB;AACpB,gBAAIlL,MAAM,CAACsL,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCN,IAArC,EAA2CG,GAA3C,CAAJ,EAAqDJ,EAAE,CAACI,GAAD,CAAF,GAAUH,IAAI,CAACG,GAAD,CAAd;AACtD;AACF;;AAED,eAAOJ,EAAP;AACD,OAZD;;AAeA,eAASQ,IAAT,CAAcP,IAAd,EAAoBQ,KAApB,EAA2B;AACzB,YAAIT,EAAE,GAAG,EAAT;AAEAS,aAAK,CAACC,OAAN,CAAc,UAAUN,GAAV,EAAe;AAC3B,cAAIrL,MAAM,CAACsL,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCN,IAArC,EAA2CG,GAA3C,CAAJ,EAAqDJ,EAAE,CAACI,GAAD,CAAF,GAAUH,IAAI,CAACG,GAAD,CAAd;AACtD,SAFD;AAIA,eAAOJ,EAAP;AACD;;AAGD,eAASW,wBAAT,CAAkCV,IAAlC,EAAwC;AACtC,eAAOO,IAAI,CAACP,IAAD,EAAO,CAChB,OADgB,EAEhB,eAFgB,EAGhB,eAHgB,EAIhB,kBAJgB,EAKhB,aALgB,CAAP,CAAX;AAOD;;AAGD,UAAIW,MAAM,GAAGJ,IAAb;AACA,UAAIK,0BAA0B,GAAGF,wBAAjC;AAEA,UAAIG,KAAK,GAAG;AACX9L,cAAM,EAAEA,MADG;AAEXwL,YAAI,EAAEI,MAFK;AAGXD,gCAAwB,EAAEE;AAHf,OAAZ;;AAMA,eAASE,oBAAT,CAA8BC,EAA9B,EAAkC;AAChC,YAAIC,MAAM,GAAG;AAAEtG,iBAAO,EAAE;AAAX,SAAb;AACD,eAAOqG,EAAE,CAACC,MAAD,EAASA,MAAM,CAACtG,OAAhB,CAAF,EAA4BsG,MAAM,CAACtG,OAA1C;AACA;;AAED,eAASuG,eAAT,CAA0BtP,MAA1B,EAAkC;AACjC,cAAM,IAAIuP,KAAJ,CAAU,oCAAoCvP,MAApC,GAA6C,yIAAvD,CAAN;AACA;AAED;;AAEA;AACA;;AAEA;;;AAEA,UAAIwP,IAAI,GAAGL,oBAAoB,CAAC,UAAUE,MAAV,EAAkBtG,OAAlB,EAA2B;AAC3D,SAAC,UAAS0G,CAAT,EAAW;AAAC;AAACJ,kBAAM,CAACtG,OAAP,GAAe0G,CAAC,EAAhB;AAAoB;AAAC,SAAnC,EAAqC,YAAU;AAAC,iBAAQ,YAAU;AAAC,qBAASC,CAAT,CAAW/D,CAAX,EAAagE,CAAb,EAAe7O,CAAf,EAAiB;AAAC,uBAAS8O,CAAT,CAAWC,CAAX,EAAaJ,CAAb,EAAe;AAAC,oBAAG,CAACE,CAAC,CAACE,CAAD,CAAL,EAAS;AAAC,sBAAG,CAAClE,CAAC,CAACkE,CAAD,CAAL,EAAS;AAAC,wBAAIC,CAAC,GAAC,cAAY,OAAOR,eAAnB,IAAoCA,eAA1C;AAA0D,wBAAG,CAACG,CAAD,IAAIK,CAAP,EAAS,OAAOA,CAAC,CAACD,CAAD,EAAG,CAAC,CAAJ,CAAR;AAAe,wBAAGE,CAAH,EAAK,OAAOA,CAAC,CAACF,CAAD,EAAG,CAAC,CAAJ,CAAR;AAAe,wBAAIG,CAAC,GAAC,IAAIT,KAAJ,CAAU,yBAAuBM,CAAvB,GAAyB,GAAnC,CAAN;AAA8C,0BAAMG,CAAC,CAACC,IAAF,GAAO,kBAAP,EAA0BD,CAAhC;AAAkC;;AAAA,sBAAIE,CAAC,GAACP,CAAC,CAACE,CAAD,CAAD,GAAK;AAAC9G,2BAAO,EAAC;AAAT,mBAAX;AAAwB4C,mBAAC,CAACkE,CAAD,CAAD,CAAK,CAAL,EAAQlB,IAAR,CAAauB,CAAC,CAACnH,OAAf,EAAuB,UAAS2G,CAAT,EAAW;AAAC,wBAAIC,CAAC,GAAChE,CAAC,CAACkE,CAAD,CAAD,CAAK,CAAL,EAAQH,CAAR,CAAN;AAAiB,2BAAOE,CAAC,CAACD,CAAC,IAAED,CAAJ,CAAR;AAAe,mBAAnE,EAAoEQ,CAApE,EAAsEA,CAAC,CAACnH,OAAxE,EAAgF2G,CAAhF,EAAkF/D,CAAlF,EAAoFgE,CAApF,EAAsF7O,CAAtF;AAA0F;;AAAA,uBAAO6O,CAAC,CAACE,CAAD,CAAD,CAAK9G,OAAZ;AAAoB;;AAAA,mBAAI,IAAIgH,CAAC,GAAC,cAAY,OAAOT,eAAnB,IAAoCA,eAA1C,EAA0DO,CAAC,GAAC,CAAhE,EAAkEA,CAAC,GAAC/O,CAAC,CAAC2F,MAAtE,EAA6EoJ,CAAC,EAA9E;AAAiFD,iBAAC,CAAC9O,CAAC,CAAC+O,CAAD,CAAF,CAAD;AAAjF;;AAAyF,qBAAOD,CAAP;AAAS;;AAAA,mBAAOF,CAAP;AAAS,WAAze,GAA6e;AAAC,eAAE,CAAC,UAASS,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAExkB,kBAAIqH,QAAQ,GAAGD,OAAO,CAAC,UAAD,CAAtB;;AAEA,kBAAIE,SAAS,GAAGF,OAAO,CAAC,WAAD,CAAvB;;AAEA,kBAAIG,eAAe,GAAGH,OAAO,CAAC,4BAAD,CAA7B;;AAEA,kBAAII,SAAS,GAAGJ,OAAO,CAAC,aAAD,CAAvB;;AAEA,uBAASK,OAAT,CAAiBC,kBAAjB,EAAqC;AACnC,oBAAIC,oBAAoB,GAAGD,kBAAkB,IAAI,EAAjD;;AAEA,oBAAIE,QAAQ,GAAG;AACbC,oBAAE,EAAEF,oBAAoB,CAACG,OAArB,CAA6B,IAA7B,KAAsC,CAD7B;AAEbC,sBAAI,EAAEJ,oBAAoB,CAACG,OAArB,CAA6B,MAA7B,KAAwC;AAFjC,iBAAf;AAIAR,yBAAS,CAAC1B,IAAV,CAAe,IAAf,EAAqBgC,QAArB;AACA,qBAAKA,QAAL,GAAgB;AACdC,oBAAE,EAAED,QAAQ,CAACC,EADC;AAEdE,sBAAI,EAAEH,QAAQ,CAACG,IAAT,IAAiB,KAAKC,QAAL;AAFT,iBAAhB;AAIA,qBAAKC,GAAL,CAASV,eAAT;AACA,qBAAKU,GAAL,CAAST,SAAT;AACD;;AAEDH,sBAAQ,CAACI,OAAD,EAAUH,SAAV,CAAR;;AAEAG,qBAAO,CAAC/B,SAAR,CAAkBwC,gBAAlB,GAAqC,SAASA,gBAAT,CAA0B7O,OAA1B,EAAmC8O,KAAnC,EAA0C;AAC7E,oBAAIC,MAAM,GAAG,KAAKC,MAAL,CAAYhP,OAAZ,EAAqB8O,KAArB,CAAb;;AAEA,oBAAI9O,OAAO,CAACiP,aAAZ,EAA2B;AACzB,uBAAKC,YAAL,CAAkBH,MAAlB,EAA0B/O,OAAO,CAACmP,OAAlC,EAA2CnP,OAAO,CAACoP,QAAnD,EAA6DpP,OAAO,CAACiP,aAArE,EAAoFjP,OAAO,CAACqP,aAA5F,EAA2GrP,OAAO,CAACsP,gBAAnH;AACD;;AAED,uBAAOP,MAAP;AACD,eARD;;AAUA9B,oBAAM,CAACtG,OAAP,GAAiByH,OAAjB;AAEC,aAxCsiB,EAwCriB;AAAC,6BAAc,CAAf;AAAiB,0BAAW,EAA5B;AAA+B,2BAAY,EAA3C;AAA8C,4CAA6B;AAA3E,aAxCqiB,CAAH;AAwCld,eAAE,CAAC,UAASL,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AACrH;AAEA,uBAAS4I,QAAT,CAAkB9B,CAAlB,EAAqB;AACnB,uBAAOA,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAYA,CAAC,GAAG,GAAJ,GAAU,GAAV,GAAgBA,CAAnC;AACD,eALoH,CAKnH;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,uBAAS+B,oBAAT,CAA8BvO,GAA9B,EAAmCwO,IAAnC,EAAyCC,IAAzC,EAA+CC,IAA/C,EAAqDC,KAArD,EAA4DC,OAA5D,EAAqE;AACnE,oBAAIvC,CAAJ,EAAOwC,CAAP,EAAUC,CAAV,EAAanC,CAAb;AACA,oBAAIoC,SAAJ,EAAeC,WAAf,EAA4BC,UAA5B;AACA,oBAAIC,MAAJ,EAAYC,IAAZ,EAAkBC,KAAlB,EAAyBC,SAAzB;AACA,oBAAIC,SAAS,GAAG,CAAhB;AAAA,oBACIC,UAAU,GAAG,CADjB,CAJmE,CAK/C;;AAEpB,qBAAKJ,IAAI,GAAG,CAAZ,EAAeA,IAAI,GAAGT,IAAtB,EAA4BS,IAAI,EAAhC,EAAoC;AAClCJ,2BAAS,GAAG,CAAZ,CADkC,CACnB;;AAEf,uBAAKK,KAAK,GAAG,CAAb,EAAgBA,KAAK,GAAGT,KAAxB,EAA+BS,KAAK,EAApC,EAAwC;AACtC;AACAJ,+BAAW,GAAGJ,OAAO,CAACG,SAAS,EAAV,CAArB;AACAE,8BAAU,GAAGL,OAAO,CAACG,SAAS,EAAV,CAApB;AACAG,0BAAM,GAAGI,SAAS,GAAGN,WAAW,GAAG,CAA1B,GAA8B,CAAvC;AACA3C,qBAAC,GAAGwC,CAAC,GAAGC,CAAC,GAAGnC,CAAC,GAAG,CAAhB,CALsC,CAKnB;;AAEnB,2BAAOsC,UAAU,GAAG,CAApB,EAAuBA,UAAU,EAAjC,EAAqC;AACnCI,+BAAS,GAAGT,OAAO,CAACG,SAAS,EAAV,CAAnB,CADmC,CACD;AAClC;;AAEApC,uBAAC,GAAGA,CAAC,GAAG0C,SAAS,GAAGrP,GAAG,CAACkP,MAAM,GAAG,CAAV,CAAnB,GAAkC,CAAtC;AACAJ,uBAAC,GAAGA,CAAC,GAAGO,SAAS,GAAGrP,GAAG,CAACkP,MAAM,GAAG,CAAV,CAAnB,GAAkC,CAAtC;AACAL,uBAAC,GAAGA,CAAC,GAAGQ,SAAS,GAAGrP,GAAG,CAACkP,MAAM,GAAG,CAAV,CAAnB,GAAkC,CAAtC;AACA7C,uBAAC,GAAGA,CAAC,GAAGgD,SAAS,GAAGrP,GAAG,CAACkP,MAAD,CAAnB,GAA8B,CAAlC;AACAA,4BAAM,GAAGA,MAAM,GAAG,CAAT,GAAa,CAAtB;AACD,qBAhBqC,CAgBpC;AACF;AACA;AACA;AACA;AACA;AACA;;;AAGAV,wBAAI,CAACe,UAAU,GAAG,CAAd,CAAJ,GAAuBjB,QAAQ,CAAC3B,CAAC,IAAI,KAAK,EAAT,CAAD,IAAiB;AACjD;AAD+B,qBAA/B;AAGA6B,wBAAI,CAACe,UAAU,GAAG,CAAd,CAAJ,GAAuBjB,QAAQ,CAACQ,CAAC,IAAI,KAAK,EAAT,CAAD,IAAiB;AACjD;AAD+B,qBAA/B;AAGAN,wBAAI,CAACe,UAAU,GAAG,CAAd,CAAJ,GAAuBjB,QAAQ,CAACO,CAAC,IAAI,KAAK,EAAT,CAAD,IAAiB;AACjD;AAD+B,qBAA/B;AAGAL,wBAAI,CAACe,UAAD,CAAJ,GAAmBjB,QAAQ,CAACjC,CAAC,IAAI,KAAK,EAAT,CAAD,IAAiB;AAC7C;AAD2B,qBAA3B;AAGAkD,8BAAU,GAAGA,UAAU,GAAGb,IAAI,GAAG,CAApB,GAAwB,CAArC;AACD;;AAEDa,4BAAU,GAAG,CAACJ,IAAI,GAAG,CAAR,IAAa,CAAb,GAAiB,CAA9B;AACAG,2BAAS,GAAG,CAACH,IAAI,GAAG,CAAR,IAAaV,IAAb,GAAoB,CAApB,GAAwB,CAApC;AACD;AACF,eArEoH,CAqEnH;AACF;AACA;;;AAGA,uBAASe,kBAAT,CAA4BxP,GAA5B,EAAiCwO,IAAjC,EAAuCC,IAAvC,EAA6CC,IAA7C,EAAmDC,KAAnD,EAA0DC,OAA1D,EAAmE;AACjE,oBAAIvC,CAAJ,EAAOwC,CAAP,EAAUC,CAAV,EAAanC,CAAb;AACA,oBAAIoC,SAAJ,EAAeC,WAAf,EAA4BC,UAA5B;AACA,oBAAIC,MAAJ,EAAYC,IAAZ,EAAkBC,KAAlB,EAAyBC,SAAzB;AACA,oBAAIC,SAAS,GAAG,CAAhB;AAAA,oBACIC,UAAU,GAAG,CADjB,CAJiE,CAK7C;;AAEpB,qBAAKJ,IAAI,GAAG,CAAZ,EAAeA,IAAI,GAAGT,IAAtB,EAA4BS,IAAI,EAAhC,EAAoC;AAClCJ,2BAAS,GAAG,CAAZ,CADkC,CACnB;;AAEf,uBAAKK,KAAK,GAAG,CAAb,EAAgBA,KAAK,GAAGT,KAAxB,EAA+BS,KAAK,EAApC,EAAwC;AACtC;AACAJ,+BAAW,GAAGJ,OAAO,CAACG,SAAS,EAAV,CAArB;AACAE,8BAAU,GAAGL,OAAO,CAACG,SAAS,EAAV,CAApB;AACAG,0BAAM,GAAGI,SAAS,GAAGN,WAAW,GAAG,CAA1B,GAA8B,CAAvC;AACA3C,qBAAC,GAAGwC,CAAC,GAAGC,CAAC,GAAGnC,CAAC,GAAG,CAAhB,CALsC,CAKnB;;AAEnB,2BAAOsC,UAAU,GAAG,CAApB,EAAuBA,UAAU,EAAjC,EAAqC;AACnCI,+BAAS,GAAGT,OAAO,CAACG,SAAS,EAAV,CAAnB,CADmC,CACD;AAClC;;AAEApC,uBAAC,GAAGA,CAAC,GAAG0C,SAAS,GAAGrP,GAAG,CAACkP,MAAM,GAAG,CAAV,CAAnB,GAAkC,CAAtC;AACAJ,uBAAC,GAAGA,CAAC,GAAGO,SAAS,GAAGrP,GAAG,CAACkP,MAAM,GAAG,CAAV,CAAnB,GAAkC,CAAtC;AACAL,uBAAC,GAAGA,CAAC,GAAGQ,SAAS,GAAGrP,GAAG,CAACkP,MAAM,GAAG,CAAV,CAAnB,GAAkC,CAAtC;AACA7C,uBAAC,GAAGA,CAAC,GAAGgD,SAAS,GAAGrP,GAAG,CAACkP,MAAD,CAAnB,GAA8B,CAAlC;AACAA,4BAAM,GAAGA,MAAM,GAAG,CAAT,GAAa,CAAtB;AACD,qBAhBqC,CAgBpC;AACF;AACA;AACA;AACA;AACA;AACA;;;AAGAV,wBAAI,CAACe,UAAU,GAAG,CAAd,CAAJ,GAAuBjB,QAAQ,CAAC3B,CAAC,IAAI,KAAK,EAAT,CAAD,IAAiB;AACjD;AAD+B,qBAA/B;AAGA6B,wBAAI,CAACe,UAAU,GAAG,CAAd,CAAJ,GAAuBjB,QAAQ,CAACQ,CAAC,IAAI,KAAK,EAAT,CAAD,IAAiB;AACjD;AAD+B,qBAA/B;AAGAN,wBAAI,CAACe,UAAU,GAAG,CAAd,CAAJ,GAAuBjB,QAAQ,CAACO,CAAC,IAAI,KAAK,EAAT,CAAD,IAAiB;AACjD;AAD+B,qBAA/B;AAGAL,wBAAI,CAACe,UAAD,CAAJ,GAAmBjB,QAAQ,CAACjC,CAAC,IAAI,KAAK,EAAT,CAAD,IAAiB;AAC7C;AAD2B,qBAA3B;AAGAkD,8BAAU,GAAGA,UAAU,GAAGb,IAAI,GAAG,CAApB,GAAwB,CAArC;AACD;;AAEDa,4BAAU,GAAG,CAACJ,IAAI,GAAG,CAAR,IAAa,CAAb,GAAiB,CAA9B;AACAG,2BAAS,GAAG,CAACH,IAAI,GAAG,CAAR,IAAaV,IAAb,GAAoB,CAApB,GAAwB,CAApC;AACD;AACF;;AAEDzC,oBAAM,CAACtG,OAAP,GAAiB;AACf6I,oCAAoB,EAAEA,oBADP;AAEfiB,kCAAkB,EAAEA;AAFL,eAAjB;AAKC,aAtImF,EAsIlF,EAtIkF,CAxCgd;AA8K9hB,eAAE,CAAC,UAAS1C,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AACzC;AAEAsG,oBAAM,CAACtG,OAAP,GAAiB,swBAAjB;AAEC,aALO,EAKN,EALM,CA9K4hB;AAmL9hB,eAAE,CAAC,UAASoH,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAEzCsG,oBAAM,CAACtG,OAAP,GAAiB;AACfgE,oBAAI,EAAE,QADS;AAEfqC,kBAAE,EAAEe,OAAO,CAAC,UAAD,CAFI;AAGf2C,uBAAO,EAAE3C,OAAO,CAAC,eAAD,CAHD;AAIf4C,wBAAQ,EAAE5C,OAAO,CAAC,wBAAD;AAJF,eAAjB;AAOC,aATO,EASN;AAAC,wCAAyB,CAA1B;AAA4B,0BAAW,CAAvC;AAAyC,+BAAgB;AAAzD,aATM,CAnL4hB;AA4Lre,eAAE,CAAC,UAASA,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAElG,kBAAIiK,aAAa,GAAG7C,OAAO,CAAC,qBAAD,CAA3B;;AAEA,kBAAIyB,oBAAoB,GAAGzB,OAAO,CAAC,YAAD,CAAP,CAAsByB,oBAAjD;;AAEA,kBAAIiB,kBAAkB,GAAG1C,OAAO,CAAC,YAAD,CAAP,CAAsB0C,kBAA/C;;AAEA,uBAASI,UAAT,CAAoBC,GAApB,EAAyBC,KAAzB,EAAgCC,MAAhC,EAAwC;AACtC,oBAAIC,GAAG,GAAG,CAAV;AAAA,oBACIC,GAAG,GAAGH,KAAK,GAAGC,MAAR,GAAiB,CAAjB,GAAqB,CAD/B;;AAGA,uBAAOC,GAAG,GAAGC,GAAb,EAAkB;AAChBJ,qBAAG,CAACG,GAAD,CAAH,GAAW,IAAX;AACAA,qBAAG,GAAGA,GAAG,GAAG,CAAN,GAAU,CAAhB;AACD;AACF;;AAEDhE,oBAAM,CAACtG,OAAP,GAAiB,SAASqI,MAAT,CAAgBhP,OAAhB,EAAyB;AACxC,oBAAIiB,GAAG,GAAGjB,OAAO,CAACiB,GAAlB;AACA,oBAAIyO,IAAI,GAAG1P,OAAO,CAAC+Q,KAAnB;AACA,oBAAIpB,IAAI,GAAG3P,OAAO,CAACgR,MAAnB;AACA,oBAAIpB,KAAK,GAAG5P,OAAO,CAACmP,OAApB;AACA,oBAAIgC,KAAK,GAAGnR,OAAO,CAACoP,QAApB;AACA,oBAAIgC,MAAM,GAAGpR,OAAO,CAACoR,MAAR,IAAkBpR,OAAO,CAACmP,OAAR,GAAkBnP,OAAO,CAAC+Q,KAAzD;AACA,oBAAIM,MAAM,GAAGrR,OAAO,CAACqR,MAAR,IAAkBrR,OAAO,CAACoP,QAAR,GAAmBpP,OAAO,CAACgR,MAA1D;AACA,oBAAIM,OAAO,GAAGtR,OAAO,CAACsR,OAAR,IAAmB,CAAjC;AACA,oBAAIC,OAAO,GAAGvR,OAAO,CAACuR,OAAR,IAAmB,CAAjC;AACA,oBAAI9B,IAAI,GAAGzP,OAAO,CAACyP,IAAR,IAAgB,IAAI+B,UAAJ,CAAe5B,KAAK,GAAGuB,KAAR,GAAgB,CAA/B,CAA3B;AACA,oBAAIM,OAAO,GAAG,OAAOzR,OAAO,CAACyR,OAAf,KAA2B,WAA3B,GAAyC,CAAzC,GAA6CzR,OAAO,CAACyR,OAAnE;AACA,oBAAIC,KAAK,GAAG1R,OAAO,CAAC0R,KAAR,IAAiB,KAA7B;AACA,oBAAIC,QAAQ,GAAGf,aAAa,CAACa,OAAD,EAAU/B,IAAV,EAAgBE,KAAhB,EAAuBwB,MAAvB,EAA+BE,OAA/B,CAA5B;AAAA,oBACIM,QAAQ,GAAGhB,aAAa,CAACa,OAAD,EAAU9B,IAAV,EAAgBwB,KAAhB,EAAuBE,MAAvB,EAA+BE,OAA/B,CAD5B;AAEA,oBAAIM,GAAG,GAAG,IAAIL,UAAJ,CAAe5B,KAAK,GAAGD,IAAR,GAAe,CAA9B,CAAV,CAfwC,CAeI;AAC5C;AACA;;AAEAH,oCAAoB,CAACvO,GAAD,EAAM4Q,GAAN,EAAWnC,IAAX,EAAiBC,IAAjB,EAAuBC,KAAvB,EAA8B+B,QAA9B,CAApB;AACAlB,kCAAkB,CAACoB,GAAD,EAAMpC,IAAN,EAAYE,IAAZ,EAAkBC,KAAlB,EAAyBuB,KAAzB,EAAgCS,QAAhC,CAAlB,CApBwC,CAoBqB;AAC7D;AACA;;AAEA,oBAAI,CAACF,KAAL,EAAYb,UAAU,CAACpB,IAAD,EAAOG,KAAP,EAAcuB,KAAd,CAAV;AACZ,uBAAO1B,IAAP;AACD,eA1BD;AA4BC,aA9CgE,EA8C/D;AAAC,4BAAa,CAAd;AAAgB,qCAAsB;AAAtC,aA9C+D,CA5Lme;AA0Oxf,eAAE,CAAC,UAAS1B,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAE/E,kBAAImL,WAAW,GAAG/D,OAAO,CAAC,sBAAD,CAAzB,CAF+E,CAE5B;;;AAGnD,kBAAIgE,eAAe,GAAG,EAAtB;;AAEA,uBAASC,YAAT,CAAsBC,GAAtB,EAA2B;AACzB,uBAAOjP,IAAI,CAACkP,KAAL,CAAWD,GAAG,IAAI,CAAC,KAAKF,eAAN,IAAyB,CAA7B,CAAd,CAAP;AACD;;AAED9E,oBAAM,CAACtG,OAAP,GAAiB,SAASwL,eAAT,CAAyBV,OAAzB,EAAkCW,OAAlC,EAA2CC,QAA3C,EAAqDC,KAArD,EAA4DC,MAA5D,EAAoE;AACnF,oBAAIC,cAAc,GAAGV,WAAW,CAACL,OAAD,CAAX,CAAqBgB,MAA1C;AACA,oBAAIC,aAAa,GAAG,MAAMJ,KAA1B;AACA,oBAAIK,YAAY,GAAG3P,IAAI,CAAC4P,GAAL,CAAS,GAAT,EAAcN,KAAd,CAAnB,CAHmF,CAG1C;AACzC;;AAEA,oBAAIO,SAAS,GAAGf,WAAW,CAACL,OAAD,CAAX,CAAqBqB,GAArB,GAA2BH,YAA3C;AACA,oBAAII,SAAJ,EAAeC,QAAf,EAAyBC,QAAzB,EAAmCC,OAAnC,EAA4CC,iBAA5C,EAA+DC,WAA/D,EAA4EC,SAA5E,EAAuFC,KAAvF,EAA8FC,GAA9F,EAAmGC,GAAnG,EAAwGC,QAAxG,EAAkHC,WAAlH,EAA+HpD,SAA/H;AACA,oBAAIqD,YAAJ,EAAkBC,aAAlB,EAAiC3D,WAAjC,EAA8CC,UAA9C;AACA,oBAAI2D,oBAAoB,GAAG7Q,IAAI,CAAC8Q,KAAL,CAAW,CAACjB,SAAS,GAAG,CAAb,IAAkB,CAA7B,CAA3B;AACA,oBAAIkB,YAAY,GAAG,IAAIC,UAAJ,CAAe,CAACH,oBAAoB,GAAG,CAAxB,IAA6BxB,QAA5C,CAAnB;AACA,oBAAI4B,eAAe,GAAG,CAAtB;AACA,oBAAIC,QAAQ,GAAG,CAACH,YAAY,CAACI,QAAd,IAA0B,CAACJ,YAAY,CAACK,GAAvD,CAZmF,CAYvB;;AAE5D,qBAAKrB,SAAS,GAAG,CAAjB,EAAoBA,SAAS,GAAGV,QAAhC,EAA0CU,SAAS,EAAnD,EAAuD;AACrD;AACAC,0BAAQ,GAAG,CAACD,SAAS,GAAG,GAAb,IAAoBL,aAApB,GAAoCH,MAA/C;AACAU,0BAAQ,GAAGjQ,IAAI,CAACqR,GAAL,CAAS,CAAT,EAAYrR,IAAI,CAAC8Q,KAAL,CAAWd,QAAQ,GAAGH,SAAtB,CAAZ,CAAX;AACAK,yBAAO,GAAGlQ,IAAI,CAAC4P,GAAL,CAASR,OAAO,GAAG,CAAnB,EAAsBpP,IAAI,CAACsR,IAAL,CAAUtB,QAAQ,GAAGH,SAArB,CAAtB,CAAV;AACAM,mCAAiB,GAAGD,OAAO,GAAGD,QAAV,GAAqB,CAAzC;AACAG,6BAAW,GAAG,IAAImB,YAAJ,CAAiBpB,iBAAjB,CAAd;AACAE,2BAAS,GAAG,IAAIW,UAAJ,CAAeb,iBAAf,CAAZ;AACAG,uBAAK,GAAG,GAAR,CARqD,CAQxC;;AAEb,uBAAKC,GAAG,GAAGN,QAAN,EAAgBO,GAAG,GAAG,CAA3B,EAA8BD,GAAG,IAAIL,OAArC,EAA8CK,GAAG,IAAIC,GAAG,EAAxD,EAA4D;AAC1DC,4BAAQ,GAAGjB,cAAc,CAAC,CAACe,GAAG,GAAG,GAAN,GAAYP,QAAb,IAAyBL,YAA1B,CAAzB;AACAW,yBAAK,IAAIG,QAAT;AACAL,+BAAW,CAACI,GAAD,CAAX,GAAmBC,QAAnB;AACD,mBAdoD,CAcnD;;;AAGFC,6BAAW,GAAG,CAAd;;AAEA,uBAAKF,GAAG,GAAG,CAAX,EAAcA,GAAG,GAAGJ,WAAW,CAAC/O,MAAhC,EAAwCmP,GAAG,EAA3C,EAA+C;AAC7ClD,6BAAS,GAAG8C,WAAW,CAACI,GAAD,CAAX,GAAmBF,KAA/B;AACAI,+BAAW,IAAIpD,SAAf;AACA+C,6BAAS,CAACG,GAAD,CAAT,GAAiBxB,YAAY,CAAC1B,SAAD,CAA7B;AACD,mBAvBoD,CAuBnD;;;AAGF+C,2BAAS,CAAChB,QAAQ,IAAI,CAAb,CAAT,IAA4BL,YAAY,CAAC,MAAM0B,WAAP,CAAxC,CA1BqD,CA0BQ;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAC,8BAAY,GAAG,CAAf;;AAEA,yBAAOA,YAAY,GAAGN,SAAS,CAAChP,MAAzB,IAAmCgP,SAAS,CAACM,YAAD,CAAT,KAA4B,CAAtE,EAAyE;AACvEA,gCAAY;AACb;;AAED,sBAAIA,YAAY,GAAGN,SAAS,CAAChP,MAA7B,EAAqC;AACnCuP,iCAAa,GAAGP,SAAS,CAAChP,MAAV,GAAmB,CAAnC;;AAEA,2BAAOuP,aAAa,GAAG,CAAhB,IAAqBP,SAAS,CAACO,aAAD,CAAT,KAA6B,CAAzD,EAA4D;AAC1DA,mCAAa;AACd;;AAED3D,+BAAW,GAAGgD,QAAQ,GAAGU,YAAzB;AACAzD,8BAAU,GAAG0D,aAAa,GAAGD,YAAhB,GAA+B,CAA5C;AACAI,gCAAY,CAACE,eAAe,EAAhB,CAAZ,GAAkChE,WAAlC,CATmC,CASY;;AAE/C8D,gCAAY,CAACE,eAAe,EAAhB,CAAZ,GAAkC/D,UAAlC,CAXmC,CAWW;;AAE9C,wBAAI,CAACgE,QAAL,EAAe;AACbH,kCAAY,CAACK,GAAb,CAAiBf,SAAS,CAACc,QAAV,CAAmBR,YAAnB,EAAiCC,aAAa,GAAG,CAAjD,CAAjB,EAAsEK,eAAtE;AACAA,qCAAe,IAAI/D,UAAnB;AACD,qBAHD,MAGO;AACL;AACA,2BAAKsD,GAAG,GAAGG,YAAX,EAAyBH,GAAG,IAAII,aAAhC,EAA+CJ,GAAG,EAAlD,EAAsD;AACpDO,oCAAY,CAACE,eAAe,EAAhB,CAAZ,GAAkCZ,SAAS,CAACG,GAAD,CAA3C;AACD;AACF;AACF,mBAtBD,MAsBO;AACL;AACAO,gCAAY,CAACE,eAAe,EAAhB,CAAZ,GAAkC,CAAlC,CAFK,CAEgC;;AAErCF,gCAAY,CAACE,eAAe,EAAhB,CAAZ,GAAkC,CAAlC,CAJK,CAIgC;AACtC;AACF;;AAED,uBAAOF,YAAP;AACD,eAtFD;AAwFC,aAnG6C,EAmG5C;AAAC,sCAAuB;AAAxB,aAnG4C,CA1Osf;AA6UtgB,eAAE,CAAC,UAAShG,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAEjEsG,oBAAM,CAACtG,OAAP,GAAiB,CAAC;AAChB;AACAmM,mBAAG,EAAE,GAFW;AAGhBL,sBAAM,EAAE,SAASA,MAAT,CAAgB+B,CAAhB,EAAmB;AACzB,yBAAOA,CAAC,IAAI,CAAC,GAAN,IAAaA,CAAC,GAAG,GAAjB,GAAuB,GAAvB,GAA6B,GAApC;AACD;AALe,eAAD,EAMd;AACD;AACA1B,mBAAG,EAAE,GAFJ;AAGDL,sBAAM,EAAE,SAASA,MAAT,CAAgB+B,CAAhB,EAAmB;AACzB,sBAAIA,CAAC,IAAI,CAAC,GAAN,IAAaA,CAAC,IAAI,GAAtB,EAA2B;AACzB,2BAAO,GAAP;AACD;;AAED,sBAAIA,CAAC,GAAG,CAAC,cAAL,IAAuBA,CAAC,GAAG,cAA/B,EAA+C;AAC7C,2BAAO,GAAP;AACD;;AAED,sBAAIC,GAAG,GAAGD,CAAC,GAAGxR,IAAI,CAAC0R,EAAnB;AACA,yBAAO1R,IAAI,CAAC2R,GAAL,CAASF,GAAT,IAAgBA,GAAhB,IAAuB,OAAO,OAAOzR,IAAI,CAAC4R,GAAL,CAASH,GAAG,GAAG,GAAf,CAArC,CAAP;AACD;AAdA,eANc,EAqBd;AACD;AACA3B,mBAAG,EAAE,GAFJ;AAGDL,sBAAM,EAAE,SAASA,MAAT,CAAgB+B,CAAhB,EAAmB;AACzB,sBAAIA,CAAC,IAAI,CAAC,GAAN,IAAaA,CAAC,IAAI,GAAtB,EAA2B;AACzB,2BAAO,GAAP;AACD;;AAED,sBAAIA,CAAC,GAAG,CAAC,cAAL,IAAuBA,CAAC,GAAG,cAA/B,EAA+C;AAC7C,2BAAO,GAAP;AACD;;AAED,sBAAIC,GAAG,GAAGD,CAAC,GAAGxR,IAAI,CAAC0R,EAAnB;AACA,yBAAO1R,IAAI,CAAC2R,GAAL,CAASF,GAAT,IAAgBA,GAAhB,GAAsBzR,IAAI,CAAC2R,GAAL,CAASF,GAAG,GAAG,GAAf,CAAtB,IAA6CA,GAAG,GAAG,GAAnD,CAAP;AACD;AAdA,eArBc,EAoCd;AACD;AACA3B,mBAAG,EAAE,GAFJ;AAGDL,sBAAM,EAAE,SAASA,MAAT,CAAgB+B,CAAhB,EAAmB;AACzB,sBAAIA,CAAC,IAAI,CAAC,GAAN,IAAaA,CAAC,IAAI,GAAtB,EAA2B;AACzB,2BAAO,GAAP;AACD;;AAED,sBAAIA,CAAC,GAAG,CAAC,cAAL,IAAuBA,CAAC,GAAG,cAA/B,EAA+C;AAC7C,2BAAO,GAAP;AACD;;AAED,sBAAIC,GAAG,GAAGD,CAAC,GAAGxR,IAAI,CAAC0R,EAAnB;AACA,yBAAO1R,IAAI,CAAC2R,GAAL,CAASF,GAAT,IAAgBA,GAAhB,GAAsBzR,IAAI,CAAC2R,GAAL,CAASF,GAAG,GAAG,GAAf,CAAtB,IAA6CA,GAAG,GAAG,GAAnD,CAAP;AACD;AAdA,eApCc,CAAjB;AAqDC,aAvD+B,EAuD9B,EAvD8B,CA7UogB;AAoY9hB,eAAE,CAAC,UAAS1G,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAEzC,kBAAIiK,aAAa,GAAG7C,OAAO,CAAC,qBAAD,CAA3B;;AAEA,uBAAS8C,UAAT,CAAoBC,GAApB,EAAyBC,KAAzB,EAAgCC,MAAhC,EAAwC;AACtC,oBAAIC,GAAG,GAAG,CAAV;AAAA,oBACIC,GAAG,GAAGH,KAAK,GAAGC,MAAR,GAAiB,CAAjB,GAAqB,CAD/B;;AAGA,uBAAOC,GAAG,GAAGC,GAAb,EAAkB;AAChBJ,qBAAG,CAACG,GAAD,CAAH,GAAW,IAAX;AACAA,qBAAG,GAAGA,GAAG,GAAG,CAAN,GAAU,CAAhB;AACD;AACF;;AAED,uBAAS4D,YAAT,CAAsB5T,GAAtB,EAA2B;AACzB,uBAAO,IAAIuQ,UAAJ,CAAevQ,GAAG,CAAC6T,MAAnB,EAA2B,CAA3B,EAA8B7T,GAAG,CAAC8T,UAAlC,CAAP;AACD;;AAED,kBAAIC,KAAK,GAAG,IAAZ,CAlByC,CAkBvB;;AAElB,kBAAI;AACFA,qBAAK,GAAG,IAAIC,WAAJ,CAAgB,IAAIzD,UAAJ,CAAe,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAf,EAA6BsD,MAA7C,EAAqD,CAArD,MAA4D,CAApE;AACD,eAFD,CAEE,OAAOI,EAAP,EAAW,CAAE;;AAEf,uBAASC,aAAT,CAAuBlU,GAAvB,EAA4BrD,MAA5B,EAAoCwX,aAApC,EAAmD;AACjD,oBAAIJ,KAAJ,EAAW;AACTpX,wBAAM,CAACwW,GAAP,CAAWS,YAAY,CAAC5T,GAAD,CAAvB,EAA8BmU,aAA9B;AACA;AACD;;AAED,qBAAK,IAAInE,GAAG,GAAGmE,aAAV,EAAyB3H,CAAC,GAAG,CAAlC,EAAqCA,CAAC,GAAGxM,GAAG,CAACoD,MAA7C,EAAqDoJ,CAAC,EAAtD,EAA0D;AACxD,sBAAI4H,IAAI,GAAGpU,GAAG,CAACwM,CAAD,CAAd;AACA7P,wBAAM,CAACqT,GAAG,EAAJ,CAAN,GAAgBoE,IAAI,GAAG,IAAvB;AACAzX,wBAAM,CAACqT,GAAG,EAAJ,CAAN,GAAgBoE,IAAI,IAAI,CAAR,GAAY,IAA5B;AACD;AACF;;AAEDpI,oBAAM,CAACtG,OAAP,GAAiB,SAAS2O,WAAT,CAAqBtV,OAArB,EAA8B;AAC7C,oBAAIiB,GAAG,GAAGjB,OAAO,CAACiB,GAAlB;AACA,oBAAIyO,IAAI,GAAG1P,OAAO,CAAC+Q,KAAnB;AACA,oBAAIpB,IAAI,GAAG3P,OAAO,CAACgR,MAAnB;AACA,oBAAIpB,KAAK,GAAG5P,OAAO,CAACmP,OAApB;AACA,oBAAIgC,KAAK,GAAGnR,OAAO,CAACoP,QAApB;AACA,oBAAIgC,MAAM,GAAGpR,OAAO,CAACoR,MAAR,IAAkBpR,OAAO,CAACmP,OAAR,GAAkBnP,OAAO,CAAC+Q,KAAzD;AACA,oBAAIM,MAAM,GAAGrR,OAAO,CAACqR,MAAR,IAAkBrR,OAAO,CAACoP,QAAR,GAAmBpP,OAAO,CAACgR,MAA1D;AACA,oBAAIM,OAAO,GAAGtR,OAAO,CAACsR,OAAR,IAAmB,GAAjC;AACA,oBAAIC,OAAO,GAAGvR,OAAO,CAACuR,OAAR,IAAmB,GAAjC;AACA,oBAAI9B,IAAI,GAAGzP,OAAO,CAACyP,IAAR,IAAgB,IAAI+B,UAAJ,CAAe5B,KAAK,GAAGuB,KAAR,GAAgB,CAA/B,CAA3B;AACA,oBAAIM,OAAO,GAAG,OAAOzR,OAAO,CAACyR,OAAf,KAA2B,WAA3B,GAAyC,CAAzC,GAA6CzR,OAAO,CAACyR,OAAnE;AACA,oBAAIC,KAAK,GAAG1R,OAAO,CAAC0R,KAAR,IAAiB,KAA7B;AACA,oBAAIC,QAAQ,GAAGf,aAAa,CAACa,OAAD,EAAU/B,IAAV,EAAgBE,KAAhB,EAAuBwB,MAAvB,EAA+BE,OAA/B,CAA5B;AAAA,oBACIM,QAAQ,GAAGhB,aAAa,CAACa,OAAD,EAAU9B,IAAV,EAAgBwB,KAAhB,EAAuBE,MAAvB,EAA+BE,OAA/B,CAD5B,CAb6C,CAcwB;;AAErE,oBAAIgE,UAAU,GAAG,CAAjB,CAhB6C,CAgBzB;;AAEpB,oBAAIC,UAAU,GAAG,KAAKC,OAAL,CAAaF,UAAU,GAAGvS,IAAI,CAACqR,GAAL,CAASpT,GAAG,CAAC8T,UAAb,EAAyBtF,IAAI,CAACsF,UAA9B,CAA1B,CAAjB;;AAEA,oBAAIW,eAAe,GAAG,KAAKD,OAAL,CAAaD,UAAU,GAAG7F,IAAI,GAAGC,KAAP,GAAe,CAAzC,CAAtB;;AAEA,oBAAI+F,eAAe,GAAG,KAAKF,OAAL,CAAaC,eAAe,GAAG/D,QAAQ,CAACoD,UAAxC,CAAtB;;AAEA,oBAAIa,WAAW,GAAGD,eAAe,GAAG/D,QAAQ,CAACmD,UAA7C;;AAEA,oBAAIc,QAAQ,GAAG,KAAKC,UAAL,CAAgB,QAAhB,EAA0BF,WAA1B,CAAf,CA1B6C,CA0BU;AACvD;AACA;;;AAGA,oBAAIG,GAAG,GAAG,IAAIvE,UAAJ,CAAe,KAAKwE,QAAL,CAAclB,MAA7B,CAAV;AACA,oBAAImB,KAAK,GAAG,IAAIhB,WAAJ,CAAgB,KAAKe,QAAL,CAAclB,MAA9B,CAAZ,CAhC6C,CAgCM;;AAEnD,oBAAIoB,KAAK,GAAG,IAAIjB,WAAJ,CAAgBhU,GAAG,CAAC6T,MAApB,CAAZ;AACAmB,qBAAK,CAAC7B,GAAN,CAAU8B,KAAV,EAnC6C,CAmC3B;AAClB;;AAEAf,6BAAa,CAACxD,QAAD,EAAWoE,GAAX,EAAgBL,eAAhB,CAAb;AACAP,6BAAa,CAACvD,QAAD,EAAWmE,GAAX,EAAgBJ,eAAhB,CAAb,CAvC6C,CAuCE;AAC/C;AACA;;AAEA,oBAAI3I,EAAE,GAAG6I,QAAQ,CAAClP,OAAT,CAAiBwP,UAAjB,IAA+BN,QAAQ,CAAClP,OAAT,CAAiByP,WAAzD;AACApJ,kBAAE,CAAC0I,eAAD,EAAkBC,eAAlB,EAAmCH,UAAnC,EAA+C9F,IAA/C,EAAqDC,IAArD,EAA2DC,KAA3D,EAAkEuB,KAAlE,CAAF,CA5C6C,CA4C+B;AAC5E;AACA;AACA;;AAEA,oBAAIkF,MAAM,GAAG,IAAIpB,WAAJ,CAAgBxF,IAAI,CAACqF,MAArB,CAAb;AACAuB,sBAAM,CAACjC,GAAP,CAAW,IAAIa,WAAJ,CAAgB,KAAKe,QAAL,CAAclB,MAA9B,EAAsC,CAAtC,EAAyC3D,KAAK,GAAGvB,KAAjD,CAAX,EAlD6C,CAkDwB;AACrE;AACA;;AAEA,oBAAI,CAAC8B,KAAL,EAAYb,UAAU,CAACpB,IAAD,EAAOG,KAAP,EAAcuB,KAAd,CAAV;AACZ,uBAAO1B,IAAP;AACD,eAxDD;AA0DC,aA/FO,EA+FN;AAAC,qCAAsB;AAAvB,aA/FM,CApY4hB;AAmevgB,eAAE,CAAC,UAAS1B,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAEhE,kBAAI2P,WAAW,GAAG,GAAlB;;AAEA,uBAASC,IAAT,CAAc9R,MAAd,EAAsB+R,IAAtB,EAA4B;AAC1B,qBAAK/R,MAAL,GAAcA,MAAd;AACA,qBAAKgS,SAAL,GAAiB,EAAjB;AACA,qBAAKC,QAAL,GAAgB,EAAhB;AACA,qBAAKC,MAAL,GAAc,CAAd;AACA,qBAAKC,SAAL,GAAiB,CAAjB;AACA,qBAAKJ,IAAL,GAAYA,IAAI,IAAI,IAApB;AACD;;AAEDD,kBAAI,CAAClK,SAAL,CAAewK,OAAf,GAAyB,YAAY;AACnC,oBAAIC,KAAK,GAAG,IAAZ;;AAEA,oBAAIC,QAAJ;;AAEA,oBAAI,KAAKN,SAAL,CAAepS,MAAf,KAA0B,CAA9B,EAAiC;AAC/B0S,0BAAQ,GAAG,KAAKN,SAAL,CAAeO,GAAf,EAAX;AACD,iBAFD,MAEO;AACLD,0BAAQ,GAAG,KAAKtS,MAAL,EAAX;AACAsS,0BAAQ,CAACvO,EAAT,GAAc,KAAKmO,MAAL,EAAd;;AAEAI,0BAAQ,CAACE,OAAT,GAAmB,YAAY;AAC7B,2BAAOH,KAAK,CAACG,OAAN,CAAcF,QAAd,CAAP;AACD,mBAFD;AAGD;;AAED,qBAAKL,QAAL,CAAcK,QAAQ,CAACvO,EAAvB,IAA6BuO,QAA7B;AACA,uBAAOA,QAAP;AACD,eAlBD;;AAoBAR,kBAAI,CAAClK,SAAL,CAAe4K,OAAf,GAAyB,UAAUF,QAAV,EAAoB;AAC3C,oBAAIG,MAAM,GAAG,IAAb;;AAEA,uBAAO,KAAKR,QAAL,CAAcK,QAAQ,CAACvO,EAAvB,CAAP;AACAuO,wBAAQ,CAACI,QAAT,GAAoBrU,IAAI,CAACsU,GAAL,EAApB;AACA,qBAAKX,SAAL,CAAeY,IAAf,CAAoBN,QAApB;;AAEA,oBAAI,KAAKH,SAAL,KAAmB,CAAvB,EAA0B;AACxB,uBAAKA,SAAL,GAAiBU,UAAU,CAAC,YAAY;AACtC,2BAAOJ,MAAM,CAACK,EAAP,EAAP;AACD,mBAF0B,EAExBjB,WAFwB,CAA3B;AAGD;AACF,eAZD;;AAcAC,kBAAI,CAAClK,SAAL,CAAekL,EAAf,GAAoB,YAAY;AAC9B,oBAAIC,MAAM,GAAG,IAAb;;AAEA,oBAAIJ,GAAG,GAAGtU,IAAI,CAACsU,GAAL,EAAV;AACA,qBAAKX,SAAL,GAAiB,KAAKA,SAAL,CAAehE,MAAf,CAAsB,UAAUsE,QAAV,EAAoB;AACzD,sBAAIK,GAAG,GAAGL,QAAQ,CAACI,QAAf,GAA0BK,MAAM,CAAChB,IAArC,EAA2C;AACzCO,4BAAQ,CAACU,OAAT;AACA,2BAAO,KAAP;AACD;;AAED,yBAAO,IAAP;AACD,iBAPgB,CAAjB;;AASA,oBAAI,KAAKhB,SAAL,CAAepS,MAAf,KAA0B,CAA9B,EAAiC;AAC/B,uBAAKuS,SAAL,GAAiBU,UAAU,CAAC,YAAY;AACtC,2BAAOE,MAAM,CAACD,EAAP,EAAP;AACD,mBAF0B,EAExBjB,WAFwB,CAA3B;AAGD,iBAJD,MAIO;AACL,uBAAKM,SAAL,GAAiB,CAAjB;AACD;AACF,eApBD;;AAsBA3J,oBAAM,CAACtG,OAAP,GAAiB4P,IAAjB;AAEC,aAvE8B,EAuE7B,EAvE6B,CAneqgB;AA0iB9hB,gBAAG,CAAC,UAASxI,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAC1C;AAEA,kBAAI+Q,mBAAmB,GAAG,CAA1B;;AAEAzK,oBAAM,CAACtG,OAAP,GAAiB,SAASgR,YAAT,CAAsBC,SAAtB,EAAiCC,UAAjC,EAA6C1I,OAA7C,EAAsDC,QAAtD,EAAgE0I,WAAhE,EAA6EC,cAA7E,EAA6F;AAC5G,oBAAI3G,MAAM,GAAGjC,OAAO,GAAGyI,SAAvB;AACA,oBAAIvG,MAAM,GAAGjC,QAAQ,GAAGyI,UAAxB,CAF4G,CAExE;AACpC;;AAEA,oBAAIG,QAAQ,GAAG,CAAC,IAAID,cAAJ,GAAqBL,mBAArB,GAA2C,CAA5C,IAAiDI,WAAhE,CAL4G,CAK/B;AAC7E;;AAEA,oBAAIE,QAAQ,GAAG,GAAf,EAAoB,OAAO,CAAC,CAAC7I,OAAD,EAAUC,QAAV,CAAD,CAAP;AACpB,oBAAI6I,UAAU,GAAGjV,IAAI,CAACsR,IAAL,CAAUtR,IAAI,CAACkV,GAAL,CAASlV,IAAI,CAAC4P,GAAL,CAASxB,MAAT,EAAiBC,MAAjB,CAAT,IAAqCrO,IAAI,CAACkV,GAAL,CAASF,QAAT,CAA/C,CAAjB,CAT4G,CASvB;AACrF;;AAEA,oBAAIC,UAAU,IAAI,CAAlB,EAAqB,OAAO,CAAC,CAAC9I,OAAD,EAAUC,QAAV,CAAD,CAAP;AACrB,oBAAIL,MAAM,GAAG,EAAb;;AAEA,qBAAK,IAAItB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwK,UAApB,EAAgCxK,CAAC,EAAjC,EAAqC;AACnC,sBAAIsD,KAAK,GAAG/N,IAAI,CAACkP,KAAL,CAAWlP,IAAI,CAACmV,GAAL,CAASnV,IAAI,CAACmV,GAAL,CAASP,SAAT,EAAoBK,UAAU,GAAGxK,CAAb,GAAiB,CAArC,IAA0CzK,IAAI,CAACmV,GAAL,CAAShJ,OAAT,EAAkB1B,CAAC,GAAG,CAAtB,CAAnD,EAA6E,IAAIwK,UAAjF,CAAX,CAAZ;AACA,sBAAIjH,MAAM,GAAGhO,IAAI,CAACkP,KAAL,CAAWlP,IAAI,CAACmV,GAAL,CAASnV,IAAI,CAACmV,GAAL,CAASN,UAAT,EAAqBI,UAAU,GAAGxK,CAAb,GAAiB,CAAtC,IAA2CzK,IAAI,CAACmV,GAAL,CAAS/I,QAAT,EAAmB3B,CAAC,GAAG,CAAvB,CAApD,EAA+E,IAAIwK,UAAnF,CAAX,CAAb;AACAlJ,wBAAM,CAACsI,IAAP,CAAY,CAACtG,KAAD,EAAQC,MAAR,CAAZ;AACD;;AAED,uBAAOjC,MAAP;AACD,eAtBD;AAwBC,aA7BQ,EA6BP,EA7BO,CA1iB2hB;AAukB9hB,gBAAG,CAAC,UAAShB,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,kBAAIyR,aAAa,GAAG,IAApB;;AAEA,uBAASC,UAAT,CAAoB7D,CAApB,EAAuB;AACrB,oBAAI8D,OAAO,GAAGtV,IAAI,CAACkP,KAAL,CAAWsC,CAAX,CAAd;;AAEA,oBAAIxR,IAAI,CAACC,GAAL,CAASuR,CAAC,GAAG8D,OAAb,IAAwBF,aAA5B,EAA2C;AACzC,yBAAOE,OAAP;AACD;;AAED,uBAAOtV,IAAI,CAAC8Q,KAAL,CAAWU,CAAX,CAAP;AACD;;AAED,uBAAS+D,SAAT,CAAmB/D,CAAnB,EAAsB;AACpB,oBAAI8D,OAAO,GAAGtV,IAAI,CAACkP,KAAL,CAAWsC,CAAX,CAAd;;AAEA,oBAAIxR,IAAI,CAACC,GAAL,CAASuR,CAAC,GAAG8D,OAAb,IAAwBF,aAA5B,EAA2C;AACzC,yBAAOE,OAAP;AACD;;AAED,uBAAOtV,IAAI,CAACsR,IAAL,CAAUE,CAAV,CAAP;AACD;;AAEDvH,oBAAM,CAACtG,OAAP,GAAiB,SAAS6R,aAAT,CAAuBxY,OAAvB,EAAgC;AAC/C,oBAAIoR,MAAM,GAAGpR,OAAO,CAACmP,OAAR,GAAkBnP,OAAO,CAAC+Q,KAAvC;AACA,oBAAIM,MAAM,GAAGrR,OAAO,CAACoP,QAAR,GAAmBpP,OAAO,CAACgR,MAAxC;AACA,oBAAIyH,cAAc,GAAGJ,UAAU,CAACrY,OAAO,CAAC8X,WAAR,GAAsB1G,MAAvB,CAAV,GAA2C,IAAIpR,OAAO,CAAC+X,cAA5E;AACA,oBAAIW,eAAe,GAAGL,UAAU,CAACrY,OAAO,CAAC8X,WAAR,GAAsBzG,MAAvB,CAAV,GAA2C,IAAIrR,OAAO,CAAC+X,cAA7E,CAJ+C,CAI8C;;AAE7F,oBAAIU,cAAc,GAAG,CAAjB,IAAsBC,eAAe,GAAG,CAA5C,EAA+C;AAC7C,wBAAM,IAAIvL,KAAJ,CAAU,gEAAV,CAAN;AACD;;AAED,oBAAIqH,CAAJ,EAAOmE,CAAP;AACA,oBAAIC,MAAJ,EAAYC,MAAZ,EAAoBC,WAApB,EAAiCC,YAAjC;AACA,oBAAIC,KAAK,GAAG,EAAZ;AACA,oBAAIC,IAAJ,CAb+C,CAarC;AACV;;AAEA,qBAAKJ,MAAM,GAAG,CAAd,EAAiBA,MAAM,GAAG7Y,OAAO,CAACoP,QAAlC,EAA4CyJ,MAAM,IAAIH,eAAtD,EAAuE;AACrE,uBAAKE,MAAM,GAAG,CAAd,EAAiBA,MAAM,GAAG5Y,OAAO,CAACmP,OAAlC,EAA2CyJ,MAAM,IAAIH,cAArD,EAAqE;AACnEjE,qBAAC,GAAGoE,MAAM,GAAG5Y,OAAO,CAAC+X,cAArB;;AAEA,wBAAIvD,CAAC,GAAG,CAAR,EAAW;AACTA,uBAAC,GAAG,CAAJ;AACD;;AAEDsE,+BAAW,GAAGF,MAAM,GAAGH,cAAT,GAA0BzY,OAAO,CAAC+X,cAAlC,GAAmDvD,CAAjE;;AAEA,wBAAIA,CAAC,GAAGsE,WAAJ,IAAmB9Y,OAAO,CAACmP,OAA/B,EAAwC;AACtC2J,iCAAW,GAAG9Y,OAAO,CAACmP,OAAR,GAAkBqF,CAAhC;AACD;;AAEDmE,qBAAC,GAAGE,MAAM,GAAG7Y,OAAO,CAAC+X,cAArB;;AAEA,wBAAIY,CAAC,GAAG,CAAR,EAAW;AACTA,uBAAC,GAAG,CAAJ;AACD;;AAEDI,gCAAY,GAAGF,MAAM,GAAGH,eAAT,GAA2B1Y,OAAO,CAAC+X,cAAnC,GAAoDY,CAAnE;;AAEA,wBAAIA,CAAC,GAAGI,YAAJ,IAAoB/Y,OAAO,CAACoP,QAAhC,EAA0C;AACxC2J,kCAAY,GAAG/Y,OAAO,CAACoP,QAAR,GAAmBuJ,CAAlC;AACD;;AAEDM,wBAAI,GAAG;AACLC,yBAAG,EAAE1E,CADA;AAEL2E,yBAAG,EAAER,CAFA;AAGLxJ,6BAAO,EAAE2J,WAHJ;AAIL1J,8BAAQ,EAAE2J,YAJL;AAKLK,8BAAQ,EAAER,MALL;AAMLS,8BAAQ,EAAER,MANL;AAOLS,kCAAY,EAAEb,cAPT;AAQLc,mCAAa,EAAEb,eARV;AASLpH,6BAAO,EAAEkD,CAAC,GAAGpD,MAAJ,GAAaiH,UAAU,CAAC7D,CAAC,GAAGpD,MAAL,CAT3B;AAULG,6BAAO,EAAEoH,CAAC,GAAGtH,MAAJ,GAAagH,UAAU,CAACM,CAAC,GAAGtH,MAAL,CAV3B;AAWLD,4BAAM,EAAEA,MAXH;AAYLC,4BAAM,EAAEA,MAZH;AAaLmD,uBAAC,EAAE6D,UAAU,CAAC7D,CAAC,GAAGpD,MAAL,CAbR;AAcLuH,uBAAC,EAAEN,UAAU,CAACM,CAAC,GAAGtH,MAAL,CAdR;AAeLN,2BAAK,EAAEwH,SAAS,CAACO,WAAW,GAAG1H,MAAf,CAfX;AAgBLJ,4BAAM,EAAEuH,SAAS,CAACQ,YAAY,GAAG1H,MAAhB;AAhBZ,qBAAP;AAkBA2H,yBAAK,CAAC3B,IAAN,CAAW4B,IAAX;AACD;AACF;;AAED,uBAAOD,KAAP;AACD,eAjED;AAmEC,aAlGQ,EAkGP,EAlGO,CAvkB2hB;AAyqB9hB,gBAAG,CAAC,UAASjL,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAE1C,uBAAS6S,QAAT,CAAkBC,GAAlB,EAAuB;AACrB,uBAAO1Y,MAAM,CAACsL,SAAP,CAAiBqN,QAAjB,CAA0BnN,IAA1B,CAA+BkN,GAA/B,CAAP;AACD;;AAEDxM,oBAAM,CAACtG,OAAP,CAAegT,QAAf,GAA0B,SAASA,QAAT,CAAkBC,OAAlB,EAA2B;AACnD,oBAAIC,KAAK,GAAGL,QAAQ,CAACI,OAAD,CAApB;AACA,uBAAOC,KAAK,KAAK;AACjB;AADO,mBAEJA,KAAK,KAAK,0BAFN,IAEoCA,KAAK,KAAK;AACrD;AAHA;AAKD,eAPD;;AASA5M,oBAAM,CAACtG,OAAP,CAAemT,OAAf,GAAyB,SAASA,OAAT,CAAiBF,OAAjB,EAA0B;AACjD,uBAAOJ,QAAQ,CAACI,OAAD,CAAR,KAAsB,2BAA7B;AACD,eAFD;;AAIA3M,oBAAM,CAACtG,OAAP,CAAeoT,aAAf,GAA+B,SAASA,aAAT,CAAuBH,OAAvB,EAAgC;AAC7D,uBAAOJ,QAAQ,CAACI,OAAD,CAAR,KAAsB,sBAA7B;AACD,eAFD;;AAIA3M,oBAAM,CAACtG,OAAP,CAAeqT,OAAf,GAAyB,SAASA,OAAT,CAAiBC,WAAjB,EAA8B;AACrD,oBAAIC,MAAM,GAAG,CAAb;AAAA,oBACIC,KAAK,GAAG,EADZ;;AAGA,yBAASC,IAAT,GAAgB;AACd,sBAAIF,MAAM,GAAGD,WAAT,IAAwBE,KAAK,CAAC9V,MAAlC,EAA0C;AACxC6V,0BAAM;AACNC,yBAAK,CAACE,KAAN;AACD;AACF;;AAED,uBAAO,SAASC,KAAT,CAAetN,EAAf,EAAmB;AACxB,yBAAO,IAAI1Q,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC5C2d,yBAAK,CAAC9C,IAAN,CAAW,YAAY;AACrBrK,wBAAE,GAAG1K,IAAL,CAAU,UAAUyM,MAAV,EAAkB;AAC1BxS,+BAAO,CAACwS,MAAD,CAAP;AACAmL,8BAAM;AACNE,4BAAI;AACL,uBAJD,EAIG,UAAUG,GAAV,EAAe;AAChB/d,8BAAM,CAAC+d,GAAD,CAAN;AACAL,8BAAM;AACNE,4BAAI;AACL,uBARD;AASD,qBAVD;AAWAA,wBAAI;AACL,mBAbM,CAAP;AAcD,iBAfD;AAgBD,eA3BD;;AA6BAnN,oBAAM,CAACtG,OAAP,CAAe6T,gBAAf,GAAkC,SAASA,gBAAT,CAA0BvI,GAA1B,EAA+B;AAC/D,wBAAQA,GAAR;AACE,uBAAK,CAAL;AACE,2BAAO,WAAP;;AAEF,uBAAK,CAAL;AACE,2BAAO,KAAP;;AAEF,uBAAK,CAAL;AACE,2BAAO,QAAP;AARJ;;AAWA,uBAAO,MAAP;AACD,eAbD;;AAeAhF,oBAAM,CAACtG,OAAP,CAAe8T,WAAf,GAA6B,SAASA,WAAT,CAAqBC,YAArB,EAAmC;AAC9D,uBAAOpe,OAAO,CAACC,OAAR,GAAkB+F,IAAlB,CAAuB,YAAY;AACxC,sBAAI,OAAOqY,iBAAP,KAA6B,WAAjC,EAA8C;AAC5C,2BAAO,KAAP;AACD;;AAED,sBAAIjN,CAAC,GAAGgN,YAAY,CAAC,GAAD,EAAM,GAAN,CAApB;AACA,yBAAOC,iBAAiB,CAACjN,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,GAAV,EAAe,GAAf,EAAoB;AAC1CkN,+BAAW,EAAE,EAD6B;AAE1CC,gCAAY,EAAE,EAF4B;AAG1CC,iCAAa,EAAE;AAH2B,mBAApB,CAAjB,CAIJxY,IAJI,CAIC,UAAUyY,MAAV,EAAkB;AACxB,wBAAIC,MAAM,GAAGD,MAAM,CAAChK,KAAP,KAAiB,EAA9B,CADwB,CACU;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEAgK,0BAAM,CAACE,KAAP;AACAvN,qBAAC,GAAG,IAAJ;AACA,2BAAOsN,MAAP;AACD,mBAhBM,CAAP;AAiBD,iBAvBM,EAuBJ,OAvBI,EAuBK,YAAY;AACtB,yBAAO,KAAP;AACD,iBAzBM,CAAP;AA0BD,eA3BD;AA6BC,aAhGQ,EAgGP,EAhGO,CAzqB2hB;AAywB9hB,gBAAG,CAAC,UAASjN,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAE1CsG,oBAAM,CAACtG,OAAP,GAAiB,YAAY;AAC3B,oBAAIyH,OAAO,GAAGL,OAAO,CAAC,WAAD,CAArB;;AAEA,oBAAImN,OAAJ;AACA;;AAEAC,yBAAS,GAAG,SAASA,SAAT,CAAmBC,EAAnB,EAAuB;AACjC,sBAAIC,IAAI,GAAGD,EAAE,CAAC/F,IAAH,CAAQgG,IAAnB;AACA,sBAAI,CAACH,OAAL,EAAcA,OAAO,GAAG,IAAI9M,OAAJ,CAAYgN,EAAE,CAAC/F,IAAH,CAAQ9G,QAApB,CAAV,CAFmB,CAEsB;AACvD;;AAEA,sBAAIQ,MAAM,GAAGmM,OAAO,CAACrM,gBAAR,CAAyBwM,IAAzB,CAAb;AACAC,6BAAW,CAAC;AACVvM,0BAAM,EAAEA;AADE,mBAAD,EAER,CAACA,MAAM,CAAC+F,MAAR,CAFQ,CAAX;AAGD,iBATD;AAUD,eAhBD;AAkBC,aApBQ,EAoBP;AAAC,2BAAY;AAAb,aApBO,CAzwB2hB;AA6xBjhB,gBAAG,CAAC,UAAS/G,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AACvD;AACA;AACA;AACA;AAEA,kBAAItI,EAAJ,EAAQkd,EAAR,EAAYC,EAAZ,EAAgBC,EAAhB,EAAoBC,EAApB,EAAwBC,EAAxB,EAA4BC,WAA5B,EAAyCC,YAAzC;;AAEA,uBAASC,SAAT,CAAmBC,KAAnB,EAA0B;AACxB,oBAAIA,KAAK,GAAG,GAAZ,EAAiB;AACfA,uBAAK,GAAG,GAAR;AACD;;AAED,oBAAInO,CAAC,GAAG5K,IAAI,CAACgZ,GAAL,CAAS,QAAQ,KAAjB,IAA0BD,KAAlC;AAAA,oBACIE,EAAE,GAAGjZ,IAAI,CAACgZ,GAAL,CAAS,CAACpO,CAAV,CADT;AAAA,oBAEIsO,EAAE,GAAGlZ,IAAI,CAACgZ,GAAL,CAAS,CAAC,CAAD,GAAKpO,CAAd,CAFT;AAAA,oBAGIuO,CAAC,GAAG,CAAC,IAAIF,EAAL,KAAY,IAAIA,EAAhB,KAAuB,IAAI,IAAIrO,CAAJ,GAAQqO,EAAZ,GAAiBC,EAAxC,CAHR;AAKA7d,kBAAE,GAAG8d,CAAL;AACAZ,kBAAE,GAAGY,CAAC,IAAIvO,CAAC,GAAG,CAAR,CAAD,GAAcqO,EAAnB;AACAT,kBAAE,GAAGW,CAAC,IAAIvO,CAAC,GAAG,CAAR,CAAD,GAAcqO,EAAnB;AACAR,kBAAE,GAAG,CAACU,CAAD,GAAKD,EAAV;AACAR,kBAAE,GAAG,IAAIO,EAAT;AACAN,kBAAE,GAAG,CAACO,EAAN;AACAN,2BAAW,GAAG,CAACvd,EAAE,GAAGkd,EAAN,KAAa,IAAIG,EAAJ,GAASC,EAAtB,CAAd;AACAE,4BAAY,GAAG,CAACL,EAAE,GAAGC,EAAN,KAAa,IAAIC,EAAJ,GAASC,EAAtB,CAAf,CAjBwB,CAmBxB;;AACA,uBAAO,IAAIpH,YAAJ,CAAiB,CAAElW,EAAF,EAAMkd,EAAN,EAAUC,EAAV,EAAcC,EAAd,EAAkBC,EAAlB,EAAsBC,EAAtB,EAA0BC,WAA1B,EAAuCC,YAAvC,CAAjB,CAAP;AACD;;AAED,uBAASO,cAAT,CAAwBnb,GAAxB,EAA6Bob,GAA7B,EAAkCC,IAAlC,EAAwCC,KAAxC,EAA+CxL,KAA/C,EAAsDC,MAAtD,EAA8D;AAC5D;AAEA,oBAAIwL,QAAJ,EAAcC,QAAd,EAAwBC,QAAxB,EAAkCC,QAAlC,EAA4CC,aAA5C;AACA,oBAAIC,SAAJ,EAAeC,SAAf,EAA0BC,UAA1B;AACA,oBAAItP,CAAJ,EAAOuP,CAAP;AACA,oBAAIC,QAAJ,EAAcC,QAAd,EAAwBC,QAAxB,EAAkCC,QAAlC;;AAEA,qBAAK3P,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGuD,MAAhB,EAAwBvD,CAAC,EAAzB,EAA6B;AAC3BoP,2BAAS,GAAGpP,CAAC,GAAGsD,KAAhB;AACA+L,2BAAS,GAAGrP,CAAZ;AACAsP,4BAAU,GAAG,CAAb,CAH2B,CAK3B;;AACAP,0BAAQ,GAAGvb,GAAG,CAAC4b,SAAD,CAAd;AACAD,+BAAa,GAAGJ,QAAQ,GAAGD,KAAK,CAAC,CAAD,CAAhC;AACAI,0BAAQ,GAAGC,aAAX;AAEAK,0BAAQ,GAAGV,KAAK,CAAC,CAAD,CAAhB;AACAW,0BAAQ,GAAGX,KAAK,CAAC,CAAD,CAAhB;AACAY,0BAAQ,GAAGZ,KAAK,CAAC,CAAD,CAAhB;AACAa,0BAAQ,GAAGb,KAAK,CAAC,CAAD,CAAhB;;AAEA,uBAAKS,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGjM,KAAhB,EAAuBiM,CAAC,EAAxB,EAA4B;AAC1BP,4BAAQ,GAAGxb,GAAG,CAAC4b,SAAD,CAAd;AAEAH,4BAAQ,GAAGD,QAAQ,GAAGQ,QAAX,GACAT,QAAQ,GAAGU,QADX,GAEAP,QAAQ,GAAGQ,QAFX,GAGAP,aAAa,GAAGQ,QAH3B;AAKAR,iCAAa,GAAGD,QAAhB;AACAA,4BAAQ,GAAGD,QAAX;AACAF,4BAAQ,GAAGC,QAAX;AAEAH,wBAAI,CAACS,UAAD,CAAJ,GAAmBJ,QAAnB;AACAI,8BAAU;AACVF,6BAAS;AACV;;AAEDA,2BAAS;AACTE,4BAAU;AACVD,2BAAS,IAAI9L,MAAM,IAAID,KAAK,GAAG,CAAZ,CAAnB,CAlC2B,CAoC3B;;AACAyL,0BAAQ,GAAGvb,GAAG,CAAC4b,SAAD,CAAd;AACAD,+BAAa,GAAGJ,QAAQ,GAAGD,KAAK,CAAC,CAAD,CAAhC;AACAI,0BAAQ,GAAGC,aAAX;AACAH,0BAAQ,GAAGD,QAAX;AAEAS,0BAAQ,GAAGV,KAAK,CAAC,CAAD,CAAhB;AACAW,0BAAQ,GAAGX,KAAK,CAAC,CAAD,CAAhB;;AAEA,uBAAKS,CAAC,GAAGjM,KAAK,GAAG,CAAjB,EAAoBiM,CAAC,IAAI,CAAzB,EAA4BA,CAAC,EAA7B,EAAiC;AAC/BN,4BAAQ,GAAGD,QAAQ,GAAGQ,QAAX,GACAT,QAAQ,GAAGU,QADX,GAEAP,QAAQ,GAAGQ,QAFX,GAGAP,aAAa,GAAGQ,QAH3B;AAKAR,iCAAa,GAAGD,QAAhB;AACAA,4BAAQ,GAAGD,QAAX;AAEAF,4BAAQ,GAAGC,QAAX;AACAA,4BAAQ,GAAGxb,GAAG,CAAC4b,SAAD,CAAd;AAEAR,uBAAG,CAACS,SAAD,CAAH,GAAiBR,IAAI,CAACS,UAAD,CAAJ,GAAmBJ,QAApC;AAEAE,6BAAS;AACTE,8BAAU;AACVD,6BAAS,IAAI9L,MAAb;AACD;AACF;AACF;;AAGD,uBAASqM,UAAT,CAAoBpc,GAApB,EAAyB8P,KAAzB,EAAgCC,MAAhC,EAAwCsM,MAAxC,EAAgD;AAC9C;AACA,oBAAI,CAACA,MAAL,EAAa;AAAE;AAAS;;AAExB,oBAAIjB,GAAG,GAAQ,IAAIkB,WAAJ,CAAgBtc,GAAG,CAACoD,MAApB,CAAf;AAAA,oBACImZ,QAAQ,GAAG,IAAIjJ,YAAJ,CAAiBvR,IAAI,CAACqR,GAAL,CAAStD,KAAT,EAAgBC,MAAhB,CAAjB,CADf;AAGA,oBAAIuL,KAAK,GAAGT,SAAS,CAACwB,MAAD,CAArB;AAEAlB,8BAAc,CAACnb,GAAD,EAAMob,GAAN,EAAWmB,QAAX,EAAqBjB,KAArB,EAA4BxL,KAA5B,EAAmCC,MAAnC,CAAd;AACAoL,8BAAc,CAACC,GAAD,EAAMpb,GAAN,EAAWuc,QAAX,EAAqBjB,KAArB,EAA4BvL,MAA5B,EAAoCD,KAApC,CAAd;AACD;;AAED9D,oBAAM,CAACtG,OAAP,GAAiB0W,UAAjB;AAEC,aAzHqB,EAyHpB,EAzHoB,CA7xB8gB;AAs5B9hB,gBAAG,CAAC,UAAStP,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAC1C,kBAAI,OAAO5F,MAAM,CAAC0D,MAAd,KAAyB,UAA7B,EAAyC;AACvC;AACAwI,sBAAM,CAACtG,OAAP,GAAiB,SAASqH,QAAT,CAAkByP,IAAlB,EAAwBC,SAAxB,EAAmC;AAClD,sBAAIA,SAAJ,EAAe;AACbD,wBAAI,CAACE,MAAL,GAAcD,SAAd;AACAD,wBAAI,CAACpR,SAAL,GAAiBtL,MAAM,CAAC0D,MAAP,CAAciZ,SAAS,CAACrR,SAAxB,EAAmC;AAClDuR,iCAAW,EAAE;AACXpgB,6BAAK,EAAEigB,IADI;AAEXI,kCAAU,EAAE,KAFD;AAGXC,gCAAQ,EAAE,IAHC;AAIXC,oCAAY,EAAE;AAJH;AADqC,qBAAnC,CAAjB;AAQD;AACF,iBAZD;AAaD,eAfD,MAeO;AACL;AACA9Q,sBAAM,CAACtG,OAAP,GAAiB,SAASqH,QAAT,CAAkByP,IAAlB,EAAwBC,SAAxB,EAAmC;AAClD,sBAAIA,SAAJ,EAAe;AACbD,wBAAI,CAACE,MAAL,GAAcD,SAAd;;AACA,wBAAIM,QAAQ,GAAG,SAAXA,QAAW,GAAY,CAAE,CAA7B;;AACAA,4BAAQ,CAAC3R,SAAT,GAAqBqR,SAAS,CAACrR,SAA/B;AACAoR,wBAAI,CAACpR,SAAL,GAAiB,IAAI2R,QAAJ,EAAjB;AACAP,wBAAI,CAACpR,SAAL,CAAeuR,WAAf,GAA6BH,IAA7B;AACD;AACF,iBARD;AASD;AAEA,aA7BQ,EA6BP,EA7BO,CAt5B2hB;AAm7B9hB,gBAAG,CAAC,UAAS1P,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAG1C,kBAAI3F,MAAM,GAAW+M,OAAO,CAAC,eAAD,CAA5B;;AACA,kBAAIkQ,YAAY,GAAKlQ,OAAO,CAAC,oBAAD,CAA5B;;AACA,kBAAImQ,cAAc,GAAGnQ,OAAO,CAAC,iBAAD,CAA5B;;AAGA,kBAAIoQ,eAAe,GAAG;AACpB3P,kBAAE,EAAE,IADgB;AAEpBE,oBAAI,EAAE;AAFc,eAAtB;;AAMA,uBAAS0P,SAAT,CAAmBpe,OAAnB,EAA4B;AAC1B,oBAAI,EAAE,gBAAgBoe,SAAlB,CAAJ,EAAkC,OAAO,IAAIA,SAAJ,CAAcpe,OAAd,CAAP;AAElC,oBAAIqb,IAAI,GAAGra,MAAM,CAAC,EAAD,EAAKmd,eAAL,EAAsBne,OAAO,IAAI,EAAjC,CAAjB;AAEA,qBAAKA,OAAL,GAAuBqb,IAAvB;AAEA,qBAAKgD,OAAL,GAAuB,EAAvB;AAEA,qBAAKC,cAAL,GAAuB,IAAvB;AACA,qBAAKC,SAAL,GAAuBlD,IAAI,CAACmD,OAAL,IAAgB,EAAvC;AACA,qBAAKxI,QAAL,GAAuB,IAAvB;AACA,qBAAKyI,MAAL,GAAuB,EAAvB;AAEA,qBAAKC,MAAL,GAAgB,IAAIzJ,WAAJ,CAAiB,IAAIzD,UAAJ,CAAe,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,CAAf,CAAD,CAAiCsD,MAAjD,CAAD,CAA2D,CAA3D,MAAkE,CAAjF;;AAEA,oBAAI,CAAC,KAAK9U,OAAL,CAAawO,EAAd,IAAoB,CAAC,KAAKxO,OAAL,CAAa0O,IAAtC,EAA4C;AAC1C,wBAAM,IAAIvB,KAAJ,CAAU,oDAAV,CAAN;AACD;AACF;;AAGDiR,uBAAS,CAAC/R,SAAV,CAAoBsC,QAApB,GAA+BuP,cAA/B;;AAGAE,uBAAS,CAAC/R,SAAV,CAAoBuC,GAApB,GAA0B,UAAU3B,MAAV,EAAkB;AAC1C,qBAAKsR,SAAL,CAAetR,MAAM,CAACtC,IAAtB,IAA8BsC,MAA9B,CAD0C,CAG1C;;AACA,oBAAI,KAAKjN,OAAL,CAAa0O,IAAb,IAAqB,KAAKC,QAAL,EAArB,IAAwC1B,MAAM,CAACyD,OAAnD,EAA4D;AAC1D,uBAAKzD,MAAM,CAACtC,IAAZ,IAAoBsC,MAAM,CAACyD,OAA3B;AACD,iBAFD,MAEO;AACL,uBAAKzD,MAAM,CAACtC,IAAZ,IAAoBsC,MAAM,CAACD,EAA3B;AACD;;AAED,uBAAO,IAAP;AACD,eAXD;;AAcAoR,uBAAS,CAAC/R,SAAV,CAAoBsS,IAApB,GAA2B,YAAY;AACrC,oBAAI,KAAKL,cAAT,EAAyB,OAAO,KAAKA,cAAZ;;AAEzB,oBAAI,CAAC,KAAKte,OAAL,CAAawO,EAAd,IAAoB,KAAKxO,OAAL,CAAa0O,IAAjC,IAAyC,CAAC,KAAKC,QAAL,EAA9C,EAA+D;AAC7D,yBAAOrS,OAAO,CAACE,MAAR,CAAe,IAAI2Q,KAAJ,CAAU,2DAAV,CAAf,CAAP;AACD;;AAED,oBAAIyR,IAAI,GAAG,IAAX;AAEA,qBAAKN,cAAL,GAAsBhiB,OAAO,CAACuiB,GAAR,CAAY9d,MAAM,CAAC+d,IAAP,CAAYF,IAAI,CAACL,SAAjB,EAA4BQ,GAA5B,CAAgC,UAAUpU,IAAV,EAAgB;AAChF,sBAAIsC,MAAM,GAAG2R,IAAI,CAACL,SAAL,CAAe5T,IAAf,CAAb;AAEA,sBAAI,CAACiU,IAAI,CAAC5e,OAAL,CAAa0O,IAAd,IAAsB,CAACkQ,IAAI,CAACjQ,QAAL,EAAvB,IAA0C,CAAC1B,MAAM,CAACyD,OAAtD,EAA+D,OAAO,IAAP,CAHiB,CAKhF;;AACA,sBAAIkO,IAAI,CAACH,MAAL,CAAY9T,IAAZ,CAAJ,EAAuB,OAAO,IAAP,CANyD,CAQhF;;AACA,yBAAOqU,WAAW,CAACC,OAAZ,CAAoBL,IAAI,CAACM,cAAL,CAAoBjS,MAAM,CAAC0D,QAA3B,CAApB,EACJrO,IADI,CACC,UAAU6c,CAAV,EAAa;AAAEP,wBAAI,CAACH,MAAL,CAAY9T,IAAZ,IAAoBwU,CAApB;AAAwB,mBADxC,CAAP;AAED,iBAXiC,CAAZ,EAYnB7c,IAZmB,CAYd,YAAY;AAAE,yBAAOsc,IAAP;AAAc,iBAZd,CAAtB;AAcA,uBAAO,KAAKN,cAAZ;AACD,eAxBD,CArD0C,CAgF1C;AACA;AAGA;AACA;AACA;;;AACAF,uBAAS,CAAC/R,SAAV,CAAoB6S,cAApB,GAAqCjB,YAArC,CAvF0C,CA0F1C;AACA;AACA;AACA;;AACAG,uBAAS,CAAC/R,SAAV,CAAoB+S,YAApB,GAAmC,SAASC,WAAT,CAAqBC,KAArB,EAA4B;AAC7D,oBAAI,CAAC,KAAKtJ,QAAV,EAAoB;AAClB,uBAAKA,QAAL,GAAgB,IAAIgJ,WAAW,CAACO,MAAhB,CAAuB;AACrCC,2BAAO,EAAExc,IAAI,CAACsR,IAAL,CAAUgL,KAAK,IAAI,KAAK,IAAT,CAAf;AAD4B,mBAAvB,CAAhB;AAGA,yBAAO,KAAKtJ,QAAZ;AACD;;AAED,oBAAIyJ,QAAQ,GAAG,KAAKzJ,QAAL,CAAclB,MAAd,CAAqBC,UAApC;;AAEA,oBAAI0K,QAAQ,GAAGH,KAAf,EAAsB;AACpB,uBAAKtJ,QAAL,CAAc0J,IAAd,CAAmB1c,IAAI,CAACsR,IAAL,CAAU,CAACgL,KAAK,GAAGG,QAAT,KAAsB,KAAK,IAA3B,CAAV,CAAnB;AACD;;AAED,uBAAO,KAAKzJ,QAAZ;AACD,eAfD,CA9F0C,CAgH1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAoI,uBAAS,CAAC/R,SAAV,CAAoByJ,UAApB,GAAiC,SAASD,QAAT,CAAkBlL,IAAlB,EAAwBgV,OAAxB,EAAiCC,SAAjC,EAA4C;AAC3E,oBAAID,OAAJ,EAAa,KAAKP,YAAL,CAAkBO,OAAlB,EAD8D,CAG3E;;AACA,oBAAI,CAAC,KAAKlB,MAAL,CAAY9T,IAAZ,CAAL,EAAwB;AACtB,sBAAIsC,MAAM,GAAG,KAAKsR,SAAL,CAAe5T,IAAf,CAAb;AACA,uBAAK8T,MAAL,CAAY9T,IAAZ,IAAoB,IAAIqU,WAAW,CAACa,MAAhB,CAAuB,KAAKX,cAAL,CAAoBjS,MAAM,CAAC0D,QAA3B,CAAvB,CAApB;AACD;;AAED,oBAAI,CAAC,KAAK0N,OAAL,CAAa1T,IAAb,CAAL,EAAyB;AACvB,sBAAImV,QAAQ,GAAG;AACbC,8BAAU,EAAE,CADC;AAEbC,0BAAM,EAAE,KAAKhK,QAFA;AAGbiK,6BAAS,EAAE,CAHE;AAIbC,yBAAK,EAAE,IAAIlB,WAAW,CAACmB,KAAhB,CAAsB;AAAEX,6BAAO,EAAE,CAAX;AAAc5F,6BAAO,EAAE;AAAvB,qBAAtB;AAJM,mBAAf;AAOA,uBAAKyE,OAAL,CAAa1T,IAAb,IAAqB,IAAIqU,WAAW,CAACoB,QAAhB,CAAyB,KAAK3B,MAAL,CAAY9T,IAAZ,CAAzB,EAA4C;AAC/D0V,uBAAG,EAAErf,MAAM,CAAC8e,QAAD,EAAWF,SAAS,IAAI,EAAxB;AADoD,mBAA5C,CAArB;AAGD;;AAED,uBAAO,KAAKvB,OAAL,CAAa1T,IAAb,CAAP;AACD,eAvBD,CAxH0C,CAkJ1C;AACA;AACA;;;AACAyT,uBAAS,CAAC/R,SAAV,CAAoBoJ,OAApB,GAA8B,SAAS6K,KAAT,CAAeC,MAAf,EAAuBC,IAAvB,EAA6B;AACzDA,oBAAI,GAAGA,IAAI,IAAI,CAAf;AACA,oBAAIC,QAAQ,GAAGF,MAAM,GAAGC,IAAxB;AACA,uBAAOD,MAAM,IAAIE,QAAQ,GAAGD,IAAI,GAAGC,QAAV,GAAqB,CAAjC,CAAb;AACD,eAJD;;AAOAxT,oBAAM,CAACtG,OAAP,GAAiByX,SAAjB;AAEC,aA9JQ,EA8JP;AAAC,oCAAqB,EAAtB;AAAyB,iCAAkB,EAA3C;AAA8C,+BAAgB;AAA9D,aA9JO,CAn7B2hB;AAilC/d,gBAAG,CAAC,UAASrQ,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAGzG,kBAAI+Z,UAAU,GAAG,kEAAjB;;AAGAzT,oBAAM,CAACtG,OAAP,GAAiB,SAASsX,YAAT,CAAsB0C,GAAtB,EAA2B;AAC1C,oBAAIC,KAAK,GAAGD,GAAG,CAACE,OAAJ,CAAY,UAAZ,EAAwB,EAAxB,CAAZ;AAAA,oBAAyC;AACrCxM,mBAAG,GAAKuM,KAAK,CAACvc,MADlB;AAGA,oBAAIgY,GAAG,GAAG,IAAI7K,UAAJ,CAAgB6C,GAAG,GAAG,CAAP,IAAa,CAA5B,CAAV,CAJ0C,CAM1C;;AAEA,oBAAIyM,IAAI,GAAG,CAAX;AACA,oBAAI7P,GAAG,GAAI,CAAX;;AAEA,qBAAK,IAAIuC,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAGa,GAAxB,EAA6Bb,GAAG,EAAhC,EAAoC;AAClC,sBAAKA,GAAG,GAAG,CAAN,KAAY,CAAb,IAAmBA,GAAvB,EAA4B;AAC1B6I,uBAAG,CAACpL,GAAG,EAAJ,CAAH,GAAc6P,IAAI,IAAI,EAAT,GAAe,IAA5B;AACAzE,uBAAG,CAACpL,GAAG,EAAJ,CAAH,GAAc6P,IAAI,IAAI,CAAT,GAAc,IAA3B;AACAzE,uBAAG,CAACpL,GAAG,EAAJ,CAAH,GAAa6P,IAAI,GAAG,IAApB;AACD;;AAEDA,sBAAI,GAAIA,IAAI,IAAI,CAAT,GAAcJ,UAAU,CAACjS,OAAX,CAAmBmS,KAAK,CAACG,MAAN,CAAavN,GAAb,CAAnB,CAArB;AACD,iBAnByC,CAqB1C;;;AAEA,oBAAIwN,QAAQ,GAAI3M,GAAG,GAAG,CAAP,GAAY,CAA3B;;AAEA,oBAAI2M,QAAQ,KAAK,CAAjB,EAAoB;AAClB3E,qBAAG,CAACpL,GAAG,EAAJ,CAAH,GAAc6P,IAAI,IAAI,EAAT,GAAe,IAA5B;AACAzE,qBAAG,CAACpL,GAAG,EAAJ,CAAH,GAAc6P,IAAI,IAAI,CAAT,GAAc,IAA3B;AACAzE,qBAAG,CAACpL,GAAG,EAAJ,CAAH,GAAa6P,IAAI,GAAG,IAApB;AACD,iBAJD,MAIO,IAAIE,QAAQ,KAAK,EAAjB,EAAqB;AAC1B3E,qBAAG,CAACpL,GAAG,EAAJ,CAAH,GAAc6P,IAAI,IAAI,EAAT,GAAe,IAA5B;AACAzE,qBAAG,CAACpL,GAAG,EAAJ,CAAH,GAAc6P,IAAI,IAAI,CAAT,GAAc,IAA3B;AACD,iBAHM,MAGA,IAAIE,QAAQ,KAAK,EAAjB,EAAqB;AAC1B3E,qBAAG,CAACpL,GAAG,EAAJ,CAAH,GAAc6P,IAAI,IAAI,CAAT,GAAc,IAA3B;AACD;;AAED,uBAAOzE,GAAP;AACD,eArCD;AAuCC,aA7CuE,EA6CtE,EA7CsE,CAjlC4d;AA8nC9hB,gBAAG,CAAC,UAAStO,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAG1CsG,oBAAM,CAACtG,OAAP,GAAiB,SAASsa,UAAT,CAAoBC,GAApB,EAAyBnQ,KAAzB,EAAgCC,MAAhC,EAAwC;AACvD,oBAAImQ,IAAI,GAAGpQ,KAAK,GAAGC,MAAnB;AACA,oBAAIqL,GAAG,GAAG,IAAIkB,WAAJ,CAAgB4D,IAAhB,CAAV;AACA,oBAAI7T,CAAJ,EAAOwC,CAAP,EAAUC,CAAV,EAAa6C,GAAb,EAAkByB,GAAlB;;AACA,qBAAK,IAAI5G,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0T,IAApB,EAA0B1T,CAAC,EAA3B,EAA+B;AAC7BH,mBAAC,GAAG4T,GAAG,CAAC,IAAIzT,CAAL,CAAP;AACAqC,mBAAC,GAAGoR,GAAG,CAAC,IAAIzT,CAAJ,GAAQ,CAAT,CAAP;AACAsC,mBAAC,GAAGmR,GAAG,CAAC,IAAIzT,CAAJ,GAAQ,CAAT,CAAP;AACA4G,qBAAG,GAAI/G,CAAC,IAAIwC,CAAL,IAAUxC,CAAC,IAAIyC,CAAhB,GAAqBzC,CAArB,GAA0BwC,CAAC,IAAIC,CAAL,IAAUD,CAAC,IAAIxC,CAAhB,GAAqBwC,CAArB,GAAyBC,CAAxD;AACA6C,qBAAG,GAAItF,CAAC,IAAIwC,CAAL,IAAUxC,CAAC,IAAIyC,CAAhB,GAAqBzC,CAArB,GAA0BwC,CAAC,IAAIC,CAAL,IAAUD,CAAC,IAAIxC,CAAhB,GAAqBwC,CAArB,GAAyBC,CAAxD;AACAsM,qBAAG,CAAC5O,CAAD,CAAH,GAAS,CAAC4G,GAAG,GAAGzB,GAAP,IAAc,GAAd,IAAqB,CAA9B;AACD;;AACD,uBAAOyJ,GAAP;AACD,eAbD;AAeC,aAlBQ,EAkBP,EAlBO,CA9nC2hB;AAgpC9hB,gBAAG,CAAC,UAAStO,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAE1CsG,oBAAM,CAACtG,OAAP,GAAiB;AACfgE,oBAAI,EAAM,cADK;AAEfqC,kBAAE,EAAQe,OAAO,CAAC,gBAAD,CAFF;AAGf2C,uBAAO,EAAG3C,OAAO,CAAC,qBAAD,CAHF;AAIf4C,wBAAQ,EAAE5C,OAAO,CAAC,4BAAD;AAJF,eAAjB;AAOC,aATQ,EASP;AAAC,gCAAiB,EAAlB;AAAqB,qCAAsB,EAA3C;AAA8C,4CAA6B;AAA3E,aATO,CAhpC2hB;AAypCld,gBAAG,CAAC,UAASA,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAGtH,kBAAIya,WAAW,GAAGrT,OAAO,CAAC,aAAD,CAAzB;;AACA,kBAAIsT,OAAO,GAAOtT,OAAO,CAAC,WAAD,CAAzB;;AAGAd,oBAAM,CAACtG,OAAP,GAAiB,SAAS2a,OAAT,CAAiBJ,GAAjB,EAAsBnQ,KAAtB,EAA6BC,MAA7B,EAAqCuQ,MAArC,EAA6CjE,MAA7C,EAAqD5c,SAArD,EAAgE;AAC/E,oBAAI4M,CAAJ,EAAOwC,CAAP,EAAUC,CAAV;AACA,oBAAIyR,CAAJ,EAAOtV,CAAP,EAAUuV,CAAV;AACA,oBAAI7O,GAAJ,EAASyB,GAAT;AACA,oBAAIqN,EAAJ,EAAQC,EAAR,EAAYC,QAAZ;AACA,oBAAIC,IAAJ,EAAUC,OAAV;;AAEA,oBAAIP,MAAM,KAAK,CAAX,IAAgBjE,MAAM,GAAG,GAA7B,EAAkC;AAChC;AACD;;AACD,oBAAIA,MAAM,GAAG,GAAb,EAAkB;AAChBA,wBAAM,GAAG,GAAT;AACD;;AAED,oBAAIyE,SAAS,GAAGV,OAAO,CAACH,GAAD,EAAMnQ,KAAN,EAAaC,MAAb,CAAvB;AAEA,oBAAIgR,MAAM,GAAG,IAAIzE,WAAJ,CAAgBwE,SAAhB,CAAb,CAhB+E,CAgBtC;;AAEzCX,2BAAW,CAACY,MAAD,EAASjR,KAAT,EAAgBC,MAAhB,EAAwBsM,MAAxB,CAAX;AAEA,oBAAI2E,QAAQ,GAAIV,MAAM,GAAG,GAAT,GAAe,MAAf,GAAwB,GAAzB,GAA8B,CAA7C;AACA,oBAAIW,WAAW,GAAIxhB,SAAS,GAAG,GAAb,GAAkB,CAApC;AAEA,oBAAIygB,IAAI,GAAGpQ,KAAK,GAAGC,MAAnB;AAEA;;AACA,qBAAK,IAAIvD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0T,IAApB,EAA0B1T,CAAC,EAA3B,EAA+B;AAC7BoU,sBAAI,GAAG,KAAKE,SAAS,CAACtU,CAAD,CAAT,GAAeuU,MAAM,CAACvU,CAAD,CAA1B,CAAP;;AAEA,sBAAIzK,IAAI,CAACC,GAAL,CAAS4e,IAAT,KAAkBK,WAAtB,EAAmC;AACjCJ,2BAAO,GAAGrU,CAAC,GAAG,CAAd;AACAH,qBAAC,GAAG4T,GAAG,CAACY,OAAD,CAAP;AACAhS,qBAAC,GAAGoR,GAAG,CAACY,OAAO,GAAG,CAAX,CAAP;AACA/R,qBAAC,GAAGmR,GAAG,CAACY,OAAO,GAAG,CAAX,CAAP,CAJiC,CAMjC;AACA;AACA;AACA;AACA;;AACAzN,uBAAG,GAAI/G,CAAC,IAAIwC,CAAL,IAAUxC,CAAC,IAAIyC,CAAhB,GAAqBzC,CAArB,GAA0BwC,CAAC,IAAIxC,CAAL,IAAUwC,CAAC,IAAIC,CAAhB,GAAqBD,CAArB,GAAyBC,CAAxD,CAXiC,CAW0B;;AAC3D6C,uBAAG,GAAItF,CAAC,IAAIwC,CAAL,IAAUxC,CAAC,IAAIyC,CAAhB,GAAqBzC,CAArB,GAA0BwC,CAAC,IAAIxC,CAAL,IAAUwC,CAAC,IAAIC,CAAhB,GAAqBD,CAArB,GAAyBC,CAAxD;AACA0R,qBAAC,GAAG,CAACpN,GAAG,GAAGzB,GAAP,IAAc,GAAd,IAAqB,CAAzB,CAbiC,CAaL;;AAE5B,wBAAIA,GAAG,KAAKyB,GAAZ,EAAiB;AACfmN,uBAAC,GAAGtV,CAAC,GAAG,CAAR;AACD,qBAFD,MAEO;AACLA,uBAAC,GAAIuV,CAAC,IAAI,MAAN,GACA,CAACpN,GAAG,GAAGzB,GAAP,IAAc,KAAf,IAAyByB,GAAG,GAAGzB,GAA/B,CAAD,GAAsC,CADpC,GAEA,CAACyB,GAAG,GAAGzB,GAAP,IAAc,KAAf,IAAyB,IAAI,IAAJ,GAAWyB,GAAX,GAAiBzB,GAA1C,CAAD,GAAiD,CAFnD,CADK,CAGiD;AACtD;;AACA4O,uBAAC,GAAIlU,CAAC,KAAK+G,GAAP,GAAgB,CAACvE,CAAC,GAAGC,CAAL,IAAU,MAAX,IAAsB,KAAKsE,GAAG,GAAGzB,GAAX,CAAtB,CAAD,GAAyC,CAAvD,GACC9C,CAAC,KAAKuE,GAAP,GAAc,UAAY,CAACtE,CAAC,GAAGzC,CAAL,IAAU,MAAX,IAAsB,KAAK+G,GAAG,GAAGzB,GAAX,CAAtB,CAAD,GAAyC,CAAnD,CAAd,CAAoE;AAApE,wBACA,UAAY,CAACtF,CAAC,GAAGwC,CAAL,IAAU,MAAX,IAAsB,KAAKuE,GAAG,GAAGzB,GAAX,CAAtB,CAAD,GAAyC,CAAnD,CAFJ,CALK,CAOsD;AAC5D,qBAzBgC,CA2BjC;;;AACA6O,qBAAC,IAAKQ,QAAQ,GAAGJ,IAAX,GAAkB,KAAnB,IAA6B,EAAlC;;AACA,wBAAIJ,CAAC,GAAG,MAAR,EAAgB;AACdA,uBAAC,GAAG,MAAJ;AACD,qBAFD,MAEO,IAAIA,CAAC,GAAG,CAAR,EAAW;AAChBA,uBAAC,GAAG,CAAJ;AACD,qBAjCgC,CAmCjC;AACA;;;AACA,wBAAIvV,CAAC,KAAK,CAAV,EAAa;AACXoB,uBAAC,GAAGwC,CAAC,GAAGC,CAAC,GAAG0R,CAAC,IAAI,CAAjB;AACD,qBAFD,MAEO;AACLE,wBAAE,GAAIF,CAAC,IAAI,MAAN,GAAiBA,CAAC,IAAI,SAASvV,CAAb,CAAD,GAAmB,KAApB,IAA8B,EAA9C,GACHuV,CAAC,IAAM,CAAC,SAASA,CAAV,IAAevV,CAAf,GAAmB,KAApB,IAA+B,EAApC,CADH;AAEAwV,wBAAE,GAAG,IAAID,CAAJ,GAAQE,EAAR,IAAc,CAAnB;AACAA,wBAAE,KAAK,CAAP,CAJK,CAKL;AACA;;AACAC,8BAAQ,GAAIJ,CAAC,GAAG,MAAL,GAAe,MAA1B,CAPK,CAO6B;;AAClClU,uBAAC,GAAIsU,QAAQ,IAAI,MAAb,GAAuBF,EAAvB,CAA0B;AAA1B,wBACCE,QAAQ,IAAI,MAAb,GAAwBF,EAAE,IAAI,CAACC,EAAE,GAAGD,EAAN,IAAY,CAAZ,IAAiB,SAASE,QAA1B,IAAsC,MAAtC,IAAgD,EAApD,CAA1B,GACCA,QAAQ,IAAI,MAAb,GAAuBD,EAAvB,CAA0B;AAA1B,wBACAD,EAAE,IAAI,CAACC,EAAE,GAAGD,EAAN,IAAY,CAAZ,GAAgBE,QAAhB,GAA2B,MAA3B,IAAqC,EAAzC,CAHN,CARK,CAYL;;AACAA,8BAAQ,GAAGJ,CAAC,GAAG,MAAf;AACA1R,uBAAC,GAAI8R,QAAQ,IAAI,MAAb,GAAuBF,EAAvB,CAA0B;AAA1B,wBACCE,QAAQ,IAAI,MAAb,GAAwBF,EAAE,IAAI,CAACC,EAAE,GAAGD,EAAN,IAAY,CAAZ,IAAiB,SAASE,QAA1B,IAAsC,MAAtC,IAAgD,EAApD,CAA1B,GACCA,QAAQ,IAAI,MAAb,GAAuBD,EAAvB,CAA0B;AAA1B,wBACAD,EAAE,IAAI,CAACC,EAAE,GAAGD,EAAN,IAAY,CAAZ,GAAgBE,QAAhB,GAA2B,MAA3B,IAAqC,EAAzC,CAHN,CAdK,CAkBL;;AACAA,8BAAQ,GAAIJ,CAAC,GAAG,MAAL,GAAe,MAA1B;AACAzR,uBAAC,GAAI6R,QAAQ,IAAI,MAAb,GAAuBF,EAAvB,CAA0B;AAA1B,wBACCE,QAAQ,IAAI,MAAb,GAAwBF,EAAE,IAAI,CAACC,EAAE,GAAGD,EAAN,IAAY,CAAZ,IAAiB,SAASE,QAA1B,IAAsC,MAAtC,IAAgD,EAApD,CAA1B,GACCA,QAAQ,IAAI,MAAb,GAAuBD,EAAvB,CAA0B;AAA1B,wBACAD,EAAE,IAAI,CAACC,EAAE,GAAGD,EAAN,IAAY,CAAZ,GAAgBE,QAAhB,GAA2B,MAA3B,IAAqC,EAAzC,CAHN;AAID;;AAEDV,uBAAG,CAACY,OAAD,CAAH,GAAexU,CAAf;AACA4T,uBAAG,CAACY,OAAO,GAAG,CAAX,CAAH,GAAmBhS,CAAnB;AACAoR,uBAAG,CAACY,OAAO,GAAG,CAAX,CAAH,GAAmB/R,CAAnB;AACD;AACF;AACF,eAnGD;AAqGC,aA5GoF,EA4GnF;AAAC,2BAAY,EAAb;AAAgB,6BAAc;AAA9B,aA5GmF,CAzpC+c;AAqwC/f,gBAAG,CAAC,UAAShC,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAGzEsG,oBAAM,CAACtG,OAAP,GAAiB,SAAS2a,OAAT,CAAiBJ,GAAjB,EAAsBnQ,KAAtB,EAA6BC,MAA7B,EAAqCuQ,MAArC,EAA6CjE,MAA7C,EAAqD5c,SAArD,EAAgE;AAC/E,oBAAI6gB,MAAM,KAAK,CAAX,IAAgBjE,MAAM,GAAG,GAA7B,EAAkC;AAChC;AACD;;AAED,oBAAIA,MAAM,GAAG,GAAb,EAAkB;AAChBA,wBAAM,GAAG,GAAT;AACD;;AAED,oBAAI6E,MAAM,GAAGpR,KAAK,GAAGC,MAArB;AAEA,oBAAIoR,aAAa,GAAUD,MAAM,GAAG,CAApC;AACA,oBAAIE,aAAa,GAAUF,MAAM,GAAG,CAApC;AACA,oBAAIG,cAAc,GAASH,MAAM,GAAG,CAApC;AACA,oBAAII,kBAAkB,GAAKvf,IAAI,CAACqR,GAAL,CAAStD,KAAT,EAAgBC,MAAhB,IAA0B,CAArD,CAd+E,CAcvB;;AACxD,oBAAIwR,oBAAoB,GAAG,IAAI,CAA/B,CAf+E,CAe7C;;AAElC,oBAAIC,UAAU,GAAW,CAAzB;AACA,oBAAIC,UAAU,GAAWN,aAAzB;AACA,oBAAIO,WAAW,GAAUD,UAAU,GAAGL,aAAtC;AACA,oBAAIO,eAAe,GAAMD,WAAW,GAAGL,cAAvC;AACA,oBAAIO,gBAAgB,GAAKD,eAAe,GAAGN,cAA3C;AACA,oBAAIQ,kBAAkB,GAAGD,gBAAgB,GAAGN,kBAA5C;;AAEA,oBAAI1M,QAAQ,GAAG,KAAKC,UAAL,CACb,cADa,EAEbsM,aAAa,GAAGC,aAAhB,GAAgCC,cAAc,GAAG,CAAjD,GAAqDC,kBAArD,GAA0EC,oBAF7D,EAGb;AAAExG,qBAAG,EAAEhZ,IAAI,CAACgZ;AAAZ,iBAHa,CAAf,CAxB+E,CA8B/E;;;AACA,oBAAI+G,KAAK,GAAG,IAAI9N,WAAJ,CAAgBiM,GAAG,CAACpM,MAApB,CAAZ;AACA,oBAAImB,KAAK,GAAG,IAAIhB,WAAJ,CAAgB,KAAKe,QAAL,CAAclB,MAA9B,CAAZ;AACAmB,qBAAK,CAAC7B,GAAN,CAAU2O,KAAV,EAjC+E,CAmC/E;;AACA,oBAAI/V,EAAE,GAAG6I,QAAQ,CAAClP,OAAT,CAAiB0a,OAAjB,IAA4BxL,QAAQ,CAAClP,OAAT,CAAiBqc,QAAtD;AACAhW,kBAAE,CAACyV,UAAD,EAAaC,UAAb,EAAyB3R,KAAzB,EAAgCC,MAAhC,CAAF,CArC+E,CAuC/E;;AACAhE,kBAAE,GAAG6I,QAAQ,CAAClP,OAAT,CAAiB0W,UAAjB,IAA+BxH,QAAQ,CAAClP,OAAT,CAAiBsc,WAArD;AACAjW,kBAAE,CAAC0V,UAAD,EAAaC,WAAb,EAA0BC,eAA1B,EACAC,gBADA,EACkBC,kBADlB,EACsC/R,KADtC,EAC6CC,MAD7C,EACqDsM,MADrD,CAAF,CAzC+E,CA4C/E;;AACAtQ,kBAAE,GAAG6I,QAAQ,CAAClP,OAAT,CAAiB2a,OAAjB,IAA4BzL,QAAQ,CAAClP,OAAT,CAAiBuc,QAAlD;AACAlW,kBAAE,CAACyV,UAAD,EAAaA,UAAb,EAAyBC,UAAzB,EACAC,WADA,EACa5R,KADb,EACoBC,MADpB,EAC4BuQ,MAD5B,EACoC7gB,SADpC,CAAF,CA9C+E,CAiD/E;;AACAqiB,qBAAK,CAAC3O,GAAN,CAAU,IAAIa,WAAJ,CAAgB,KAAKe,QAAL,CAAclB,MAA9B,EAAsC,CAAtC,EAAyCqN,MAAzC,CAAV;AACD,eAnDD;AAqDC,aAxDuC,EAwDtC,EAxDsC,CArwC4f;AA6zC9hB,gBAAG,CAAC,UAASpU,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAE1C;AACAsG,oBAAM,CAACtG,OAAP,GAAiB,86FAAjB;AAEC,aALQ,EAKP,EALO,CA7zC2hB;AAk0C9hB,gBAAG,CAAC,UAASoH,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAG1C,kBAAIwc,EAAJ;;AAGAlW,oBAAM,CAACtG,OAAP,GAAiB,SAASuX,cAAT,GAA0B;AACzC;AACA,oBAAI,OAAOiF,EAAP,KAAc,WAAlB,EAA+B,OAAOA,EAAP;AAE/BA,kBAAE,GAAG,KAAL;AAEA,oBAAI,OAAOnE,WAAP,KAAuB,WAA3B,EAAwC,OAAOmE,EAAP,CANC,CAQzC;;AACA,oBAAI;AACF;AACA;;AAEA;AACA,sBAAIC,GAAG,GAAQ,IAAI5R,UAAJ,CAAe,CAAE,CAAF,EAAI,EAAJ,EAAO,GAAP,EAAW,GAAX,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,EAA7B,EAAgC,CAAhC,EAAkC,GAAlC,EAAsC,CAAtC,EAAwC,GAAxC,EAA4C,CAA5C,EAA8C,CAA9C,EAAgD,CAAhD,EAAkD,CAAlD,EAAoD,CAApD,EAAsD,CAAtD,EAAwD,CAAxD,EAA0D,CAA1D,EAA4D,CAA5D,EAA8D,CAA9D,EAAgE,CAAhE,EAAkE,CAAlE,EAAoE,CAApE,EAAsE,GAAtE,EAA0E,GAA1E,EAA8E,GAA9E,EAAkF,GAAlF,EAAsF,CAAtF,EAAwF,CAAxF,EAA0F,EAA1F,EAA6F,EAA7F,EAAgG,CAAhG,EAAkG,EAAlG,EAAqG,CAArG,EAAuG,EAAvG,EAA0G,CAA1G,EAA4G,EAA5G,EAA+G,CAA/G,EAAiH,EAAjH,EAAoH,CAApH,EAAsH,CAAtH,EAAwH,EAAxH,EAA2H,CAA3H,EAA6H,EAA7H,EAAgI,CAAhI,EAAkI,CAAlI,EAAoI,EAApI,CAAf,CAAf;AACA,sBAAIvE,MAAM,GAAK,IAAI+R,WAAW,CAACa,MAAhB,CAAuBuD,GAAvB,CAAf;AACA,sBAAIvN,QAAQ,GAAG,IAAImJ,WAAW,CAACoB,QAAhB,CAAyBnT,MAAzB,EAAiC,EAAjC,CAAf,CAPE,CASF;AACA;;AACA,sBAAI4I,QAAQ,CAAClP,OAAT,CAAiB0c,IAAjB,CAAsB,CAAtB,MAA6B,CAAjC,EAAoCF,EAAE,GAAG,IAAL;AAEpC,yBAAOA,EAAP;AACD,iBAdD,CAcE,OAAOjO,EAAP,EAAW,CAAE;;AAEf,uBAAOiO,EAAP;AACD,eA1BD;AA4BC,aAlCQ,EAkCP,EAlCO,CAl0C2hB;AAo2C9hB,gBAAG,CAAC,UAASpV,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAC1C;AACA,kBAAI2c,qBAAqB,GAAGviB,MAAM,CAACuiB,qBAAnC;AACA,kBAAIhX,cAAc,GAAGvL,MAAM,CAACsL,SAAP,CAAiBC,cAAtC;AACA,kBAAIiX,gBAAgB,GAAGxiB,MAAM,CAACsL,SAAP,CAAiBmX,oBAAxC;;AAEA,uBAASC,QAAT,CAAkBC,GAAlB,EAAuB;AACtB,oBAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,KAAKzmB,SAA5B,EAAuC;AACtC,wBAAM,IAAI0mB,SAAJ,CAAc,uDAAd,CAAN;AACA;;AAED,uBAAO5iB,MAAM,CAAC2iB,GAAD,CAAb;AACA;;AAED,uBAASE,eAAT,GAA2B;AAC1B,oBAAI;AACH,sBAAI,CAAC7iB,MAAM,CAACC,MAAZ,EAAoB;AACnB,2BAAO,KAAP;AACA,mBAHE,CAKH;AAEA;;;AACA,sBAAI6iB,KAAK,GAAG,IAAIC,MAAJ,CAAW,KAAX,CAAZ,CARG,CAQ6B;;AAChCD,uBAAK,CAAC,CAAD,CAAL,GAAW,IAAX;;AACA,sBAAI9iB,MAAM,CAACgjB,mBAAP,CAA2BF,KAA3B,EAAkC,CAAlC,MAAyC,GAA7C,EAAkD;AACjD,2BAAO,KAAP;AACA,mBAZE,CAcH;;;AACA,sBAAIG,KAAK,GAAG,EAAZ;;AACA,uBAAK,IAAIvW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AAC5BuW,yBAAK,CAAC,MAAMF,MAAM,CAACG,YAAP,CAAoBxW,CAApB,CAAP,CAAL,GAAsCA,CAAtC;AACA;;AACD,sBAAIyW,MAAM,GAAGnjB,MAAM,CAACgjB,mBAAP,CAA2BC,KAA3B,EAAkCjF,GAAlC,CAAsC,UAAUxR,CAAV,EAAa;AAC/D,2BAAOyW,KAAK,CAACzW,CAAD,CAAZ;AACA,mBAFY,CAAb;;AAGA,sBAAI2W,MAAM,CAACC,IAAP,CAAY,EAAZ,MAAoB,YAAxB,EAAsC;AACrC,2BAAO,KAAP;AACA,mBAxBE,CA0BH;;;AACA,sBAAIC,KAAK,GAAG,EAAZ;AACA,yCAAuBC,KAAvB,CAA6B,EAA7B,EAAiC3X,OAAjC,CAAyC,UAAU4X,MAAV,EAAkB;AAC1DF,yBAAK,CAACE,MAAD,CAAL,GAAgBA,MAAhB;AACA,mBAFD;;AAGA,sBAAIvjB,MAAM,CAAC+d,IAAP,CAAY/d,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBojB,KAAlB,CAAZ,EAAsCD,IAAtC,CAA2C,EAA3C,MACF,sBADF,EAC0B;AACzB,2BAAO,KAAP;AACA;;AAED,yBAAO,IAAP;AACA,iBArCD,CAqCE,OAAO5J,GAAP,EAAY;AACb;AACA,yBAAO,KAAP;AACA;AACD;;AAEDtN,oBAAM,CAACtG,OAAP,GAAiBid,eAAe,KAAK7iB,MAAM,CAACC,MAAZ,GAAqB,UAAUpD,MAAV,EAAkB2mB,MAAlB,EAA0B;AAC9E,oBAAItY,IAAJ;AACA,oBAAID,EAAE,GAAGyX,QAAQ,CAAC7lB,MAAD,CAAjB;AACA,oBAAI4mB,OAAJ;;AAEA,qBAAK,IAAItY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAAC9H,MAA9B,EAAsC6H,CAAC,EAAvC,EAA2C;AAC1CD,sBAAI,GAAGlL,MAAM,CAACoL,SAAS,CAACD,CAAD,CAAV,CAAb;;AAEA,uBAAK,IAAIE,GAAT,IAAgBH,IAAhB,EAAsB;AACrB,wBAAIK,cAAc,CAACC,IAAf,CAAoBN,IAApB,EAA0BG,GAA1B,CAAJ,EAAoC;AACnCJ,wBAAE,CAACI,GAAD,CAAF,GAAUH,IAAI,CAACG,GAAD,CAAd;AACA;AACD;;AAED,sBAAIkX,qBAAJ,EAA2B;AAC1BkB,2BAAO,GAAGlB,qBAAqB,CAACrX,IAAD,CAA/B;;AACA,yBAAK,IAAIwB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+W,OAAO,CAACngB,MAA5B,EAAoCoJ,CAAC,EAArC,EAAyC;AACxC,0BAAI8V,gBAAgB,CAAChX,IAAjB,CAAsBN,IAAtB,EAA4BuY,OAAO,CAAC/W,CAAD,CAAnC,CAAJ,EAA6C;AAC5CzB,0BAAE,CAACwY,OAAO,CAAC/W,CAAD,CAAR,CAAF,GAAiBxB,IAAI,CAACuY,OAAO,CAAC/W,CAAD,CAAR,CAArB;AACA;AACD;AACD;AACD;;AAED,uBAAOzB,EAAP;AACA,eAzBD;AA2BC,aArFQ,EAqFP,EArFO,CAp2C2hB;AAy7C9hB,gBAAG,CAAC,UAAS+B,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAC1C,kBAAI8d,QAAQ,GAAGtY,SAAS,CAAC,CAAD,CAAxB;AACA,kBAAIuY,OAAO,GAAGvY,SAAS,CAAC,CAAD,CAAvB;AACA,kBAAI2C,KAAK,GAAG3C,SAAS,CAAC,CAAD,CAArB;AAEA,kBAAIwY,SAAS,GAAGC,IAAI,CAACD,SAArB;;AAEA1X,oBAAM,CAACtG,OAAP,GAAiB,UAAUqG,EAAV,EAAchN,OAAd,EAAuB;AACpC,oBAAI6kB,IAAJ;AACA,oBAAIC,SAAS,GAAG/jB,MAAM,CAAC+d,IAAP,CAAYhQ,KAAZ,CAAhB;;AAEA,qBAAK,IAAIrB,CAAC,GAAG,CAAR,EAAWgU,CAAC,GAAGqD,SAAS,CAACzgB,MAA9B,EAAsCoJ,CAAC,GAAGgU,CAA1C,EAA6ChU,CAAC,EAA9C,EAAkD;AAC9C,sBAAIrB,GAAG,GAAG0Y,SAAS,CAACrX,CAAD,CAAnB;AACA,sBAAIuO,GAAG,GAAGlN,KAAK,CAAC1C,GAAD,CAAL,CAAWzF,OAArB,CAF8C,CAG9C;AACA;AACA;AACA;;AACA,sBAAIqV,GAAG,KAAKhP,EAAR,IAAcgP,GAAG,IAAIA,GAAG,WAAH,KAAgBhP,EAAzC,EAA6C;AACzC6X,wBAAI,GAAGzY,GAAP;AACA;AACH;AACJ;;AAED,oBAAI,CAACyY,IAAL,EAAW;AACPA,sBAAI,GAAG7hB,IAAI,CAAC8Q,KAAL,CAAW9Q,IAAI,CAACmV,GAAL,CAAS,EAAT,EAAa,CAAb,IAAkBnV,IAAI,CAAC+hB,MAAL,EAA7B,EAA4CrL,QAA5C,CAAqD,EAArD,CAAP;AACA,sBAAIsL,MAAM,GAAG,EAAb;;AACA,uBAAK,IAAIvX,CAAC,GAAG,CAAR,EAAWgU,CAAC,GAAGqD,SAAS,CAACzgB,MAA9B,EAAsCoJ,CAAC,GAAGgU,CAA1C,EAA6ChU,CAAC,EAA9C,EAAkD;AAC9C,wBAAIrB,GAAG,GAAG0Y,SAAS,CAACrX,CAAD,CAAnB;AACAuX,0BAAM,CAAC5Y,GAAD,CAAN,GAAcA,GAAd;AACH;;AACDsY,yBAAO,CAACG,IAAD,CAAP,GAAgB,CACZ,sCAAsC7X,EAAtC,GAA2C,WAD/B,EAEZgY,MAFY,CAAhB;AAIH;;AACD,oBAAIC,IAAI,GAAGjiB,IAAI,CAAC8Q,KAAL,CAAW9Q,IAAI,CAACmV,GAAL,CAAS,EAAT,EAAa,CAAb,IAAkBnV,IAAI,CAAC+hB,MAAL,EAA7B,EAA4CrL,QAA5C,CAAqD,EAArD,CAAX;AAEA,oBAAIwL,MAAM,GAAG,EAAb;AAAiBA,sBAAM,CAACL,IAAD,CAAN,GAAeA,IAAf;AACjBH,uBAAO,CAACO,IAAD,CAAP,GAAgB,CACZ,sCACI;AACA,kCAFJ,GAEyBN,SAAS,CAACE,IAAD,CAFlC,GAE2C,IAF3C,GAGI,oCAHJ,GAIA,GALY,EAMZK,MANY,CAAhB;AASA,oBAAIC,aAAa,GAAG,EAApB;AACAC,8BAAc,CAACH,IAAD,CAAd;;AAEA,yBAASG,cAAT,CAAwBhZ,GAAxB,EAA6B;AACzB+Y,+BAAa,CAAC/Y,GAAD,CAAb,GAAqB,IAArB;;AAEA,uBAAK,IAAIiZ,OAAT,IAAoBX,OAAO,CAACtY,GAAD,CAAP,CAAa,CAAb,CAApB,EAAqC;AACjC,wBAAIkZ,MAAM,GAAGZ,OAAO,CAACtY,GAAD,CAAP,CAAa,CAAb,EAAgBiZ,OAAhB,CAAb;;AACA,wBAAI,CAACF,aAAa,CAACG,MAAD,CAAlB,EAA4B;AACxBF,oCAAc,CAACE,MAAD,CAAd;AACH;AACJ;AACJ;;AAED,oBAAIrkB,GAAG,GAAG,MAAMwjB,QAAN,GAAiB,KAAjB,GACJ1jB,MAAM,CAAC+d,IAAP,CAAYqG,aAAZ,EAA2BpG,GAA3B,CAA+B,UAAU3S,GAAV,EAAe;AAC5C,yBAAOuY,SAAS,CAACvY,GAAD,CAAT,GAAiB,IAAjB,GACDsY,OAAO,CAACtY,GAAD,CAAP,CAAa,CAAb,CADC,GAED,GAFC,GAEKuY,SAAS,CAACD,OAAO,CAACtY,GAAD,CAAP,CAAa,CAAb,CAAD,CAFd,GAEkC,GAFzC;AAIH,iBALC,EAKC+X,IALD,CAKM,GALN,CADI,GAOJ,QAPI,GAOOQ,SAAS,CAACM,IAAD,CAPhB,GAOyB,IAPnC;AAUA,oBAAIM,GAAG,GAAGC,MAAM,CAACD,GAAP,IAAcC,MAAM,CAACC,SAArB,IAAkCD,MAAM,CAACE,MAAzC,IAAmDF,MAAM,CAACG,KAApE;AAEA,oBAAI9e,IAAI,GAAG,IAAI+e,IAAJ,CAAS,CAAC3kB,GAAD,CAAT,EAAgB;AAAEyB,sBAAI,EAAE;AAAR,iBAAhB,CAAX;;AACA,oBAAI1C,OAAO,IAAIA,OAAO,CAAC6lB,IAAvB,EAA6B;AAAE,yBAAOhf,IAAP;AAAc;;AAC7C,oBAAIif,SAAS,GAAGP,GAAG,CAACQ,eAAJ,CAAoBlf,IAApB,CAAhB;AACA,oBAAImf,MAAM,GAAG,IAAIC,MAAJ,CAAWH,SAAX,CAAb;AACAE,sBAAM,CAACE,SAAP,GAAmBJ,SAAnB;AACA,uBAAOE,MAAP;AACH,eAzED;AA2EC,aAlFQ,EAkFP,EAlFO,CAz7C2hB;AA2gD9hB,yBAAY,CAAC,UAASjY,OAAT,EAAiBd,MAAjB,EAAwBtG,OAAxB,EAAgC;AAEnD,uBAASwf,cAAT,CAAwBC,GAAxB,EAA6B3Y,CAA7B,EAAgC;AAAE,uBAAO4Y,eAAe,CAACD,GAAD,CAAf,IAAwBE,qBAAqB,CAACF,GAAD,EAAM3Y,CAAN,CAA7C,IAAyD8Y,2BAA2B,CAACH,GAAD,EAAM3Y,CAAN,CAApF,IAAgG+Y,gBAAgB,EAAvH;AAA4H;;AAE9J,uBAASA,gBAAT,GAA4B;AAAE,sBAAM,IAAI7C,SAAJ,CAAc,2IAAd,CAAN;AAAmK;;AAEjM,uBAAS4C,2BAAT,CAAqC/Y,CAArC,EAAwCiZ,MAAxC,EAAgD;AAAE,oBAAI,CAACjZ,CAAL,EAAQ;AAAQ,oBAAI,OAAOA,CAAP,KAAa,QAAjB,EAA2B,OAAOkZ,iBAAiB,CAAClZ,CAAD,EAAIiZ,MAAJ,CAAxB;AAAqC,oBAAIlZ,CAAC,GAAGxM,MAAM,CAACsL,SAAP,CAAiBqN,QAAjB,CAA0BnN,IAA1B,CAA+BiB,CAA/B,EAAkCmZ,KAAlC,CAAwC,CAAxC,EAA2C,CAAC,CAA5C,CAAR;AAAwD,oBAAIpZ,CAAC,KAAK,QAAN,IAAkBC,CAAC,CAACoQ,WAAxB,EAAqCrQ,CAAC,GAAGC,CAAC,CAACoQ,WAAF,CAAcjT,IAAlB;AAAwB,oBAAI4C,CAAC,KAAK,KAAN,IAAeA,CAAC,KAAK,KAAzB,EAAgC,OAAO1I,KAAK,CAACoH,IAAN,CAAWuB,CAAX,CAAP;AAAsB,oBAAID,CAAC,KAAK,WAAN,IAAqB,2CAA2C8V,IAA3C,CAAgD9V,CAAhD,CAAzB,EAA6E,OAAOmZ,iBAAiB,CAAClZ,CAAD,EAAIiZ,MAAJ,CAAxB;AAAsC;;AAEha,uBAASC,iBAAT,CAA2BN,GAA3B,EAAgClV,GAAhC,EAAqC;AAAE,oBAAIA,GAAG,IAAI,IAAP,IAAeA,GAAG,GAAGkV,GAAG,CAAC/hB,MAA7B,EAAqC6M,GAAG,GAAGkV,GAAG,CAAC/hB,MAAV;;AAAkB,qBAAK,IAAIoJ,CAAC,GAAG,CAAR,EAAWmZ,IAAI,GAAG,IAAI/hB,KAAJ,CAAUqM,GAAV,CAAvB,EAAuCzD,CAAC,GAAGyD,GAA3C,EAAgDzD,CAAC,EAAjD,EAAqD;AAAEmZ,sBAAI,CAACnZ,CAAD,CAAJ,GAAU2Y,GAAG,CAAC3Y,CAAD,CAAb;AAAmB;;AAAC,uBAAOmZ,IAAP;AAAc;;AAEvL,uBAASN,qBAAT,CAA+BF,GAA/B,EAAoC3Y,CAApC,EAAuC;AAAE,oBAAI,OAAOoZ,MAAP,KAAkB,WAAlB,IAAiC,EAAEA,MAAM,CAACC,QAAP,IAAmB/lB,MAAM,CAACqlB,GAAD,CAA3B,CAArC,EAAwE;AAAQ,oBAAIW,IAAI,GAAG,EAAX;AAAe,oBAAIC,EAAE,GAAG,IAAT;AAAe,oBAAIC,EAAE,GAAG,KAAT;AAAgB,oBAAIC,EAAE,GAAGjqB,SAAT;;AAAoB,oBAAI;AAAE,uBAAK,IAAIkqB,EAAE,GAAGf,GAAG,CAACS,MAAM,CAACC,QAAR,CAAH,EAAT,EAAiCM,EAAtC,EAA0C,EAAEJ,EAAE,GAAG,CAACI,EAAE,GAAGD,EAAE,CAAC1pB,IAAH,EAAN,EAAiB4pB,IAAxB,CAA1C,EAAyEL,EAAE,GAAG,IAA9E,EAAoF;AAAED,wBAAI,CAAC1P,IAAL,CAAU+P,EAAE,CAAC5pB,KAAb;;AAAqB,wBAAIiQ,CAAC,IAAIsZ,IAAI,CAAC1iB,MAAL,KAAgBoJ,CAAzB,EAA4B;AAAQ;AAAE,iBAAvJ,CAAwJ,OAAO8M,GAAP,EAAY;AAAE0M,oBAAE,GAAG,IAAL;AAAWC,oBAAE,GAAG3M,GAAL;AAAW,iBAA5L,SAAqM;AAAE,sBAAI;AAAE,wBAAI,CAACyM,EAAD,IAAOG,EAAE,CAAC,QAAD,CAAF,IAAgB,IAA3B,EAAiCA,EAAE,CAAC,QAAD,CAAF;AAAiB,mBAAxD,SAAiE;AAAE,wBAAIF,EAAJ,EAAQ,MAAMC,EAAN;AAAW;AAAE;;AAAC,uBAAOH,IAAP;AAAc;;AAEze,uBAASV,eAAT,CAAyBD,GAAzB,EAA8B;AAAE,oBAAIvhB,KAAK,CAACyiB,OAAN,CAAclB,GAAd,CAAJ,EAAwB,OAAOA,GAAP;AAAa;;AAErE,kBAAIplB,MAAM,GAAG+M,OAAO,CAAC,eAAD,CAApB;;AAEA,kBAAIwZ,UAAU,GAAGxZ,OAAO,CAAC,YAAD,CAAxB;;AAEA,kBAAIK,OAAO,GAAGL,OAAO,CAAC,eAAD,CAArB;;AAEA,kBAAIwI,IAAI,GAAGxI,OAAO,CAAC,YAAD,CAAlB;;AAEA,kBAAIjB,KAAK,GAAGiB,OAAO,CAAC,aAAD,CAAnB;;AAEA,kBAAIiY,MAAM,GAAGjY,OAAO,CAAC,cAAD,CAApB;;AAEA,kBAAI4J,YAAY,GAAG5J,OAAO,CAAC,eAAD,CAA1B;;AAEA,kBAAIyK,aAAa,GAAGzK,OAAO,CAAC,aAAD,CAA3B,CA5BmD,CA4BP;AAC5C;;;AAGA,kBAAIyZ,WAAW,GAAG,EAAlB;AACA,kBAAIC,eAAe,GAAG,KAAtB;;AAEA,kBAAI;AACF,oBAAI,OAAOhrB,SAAP,KAAqB,WAArB,IAAoCA,SAAS,CAACirB,SAAlD,EAA6D;AAC3DD,iCAAe,GAAGhrB,SAAS,CAACirB,SAAV,CAAoBjZ,OAApB,CAA4B,QAA5B,KAAyC,CAA3D;AACD;AACF,eAJD,CAIE,OAAOlF,CAAP,EAAU,CAAE;;AAEd,kBAAI0Q,WAAW,GAAG,CAAlB;;AAEA,kBAAI,OAAOxd,SAAP,KAAqB,WAAzB,EAAsC;AACpCwd,2BAAW,GAAGjX,IAAI,CAAC4P,GAAL,CAASnW,SAAS,CAACkrB,mBAAV,IAAiC,CAA1C,EAA6C,CAA7C,CAAd;AACD;;AAED,kBAAIC,iBAAiB,GAAG;AACtB3O,oBAAI,EAAE,IADgB;AAEtBgB,2BAAW,EAAEA,WAFS;AAGtB1L,wBAAQ,EAAE,CAAC,IAAD,EAAO,MAAP,EAAe,IAAf,CAHY;AAItBiI,oBAAI,EAAE,IAJgB;AAKtBkE,4BAAY,EAAE,SAASA,YAAT,CAAsB3J,KAAtB,EAA6BC,MAA7B,EAAqC;AACjD,sBAAI6W,SAAS,GAAGnmB,QAAQ,CAAComB,aAAT,CAAuB,QAAvB,CAAhB;AACAD,2BAAS,CAAC9W,KAAV,GAAkBA,KAAlB;AACA8W,2BAAS,CAAC7W,MAAV,GAAmBA,MAAnB;AACA,yBAAO6W,SAAP;AACD;AAVqB,eAAxB;AAYA,kBAAIE,mBAAmB,GAAG;AACxBtW,uBAAO,EAAE,CADe;AAExBC,qBAAK,EAAE,KAFiB;AAGxBzC,6BAAa,EAAE,CAHS;AAIxBI,6BAAa,EAAE,GAJS;AAKxBC,gCAAgB,EAAE;AALM,eAA1B;AAOA,kBAAI0Y,kBAAJ;AACA,kBAAIC,uBAAJ;;AAEA,uBAASC,YAAT,GAAwB;AACtB,uBAAO;AACL1qB,uBAAK,EAAE+pB,UAAU,CAACvB,MAAD,CADZ;AAELvO,yBAAO,EAAE,SAASA,OAAT,GAAmB;AAC1B,yBAAKja,KAAL,CAAW2qB,SAAX;;AAEA,wBAAI,OAAO3C,MAAP,KAAkB,WAAtB,EAAmC;AACjC,0BAAI4C,GAAG,GAAG5C,MAAM,CAACD,GAAP,IAAcC,MAAM,CAACC,SAArB,IAAkCD,MAAM,CAACE,MAAzC,IAAmDF,MAAM,CAACG,KAApE;;AAEA,0BAAIyC,GAAG,IAAIA,GAAG,CAACC,eAAX,IAA8B,KAAK7qB,KAAL,CAAW0oB,SAA7C,EAAwD;AACtDkC,2BAAG,CAACC,eAAJ,CAAoB,KAAK7qB,KAAL,CAAW0oB,SAA/B;AACD;AACF;AACF;AAZI,iBAAP;AAcD,eApFkD,CAoFjD;AACF;;;AAGA,uBAASoC,IAAT,CAActoB,OAAd,EAAuB;AACrB,oBAAI,EAAE,gBAAgBsoB,IAAlB,CAAJ,EAA6B,OAAO,IAAIA,IAAJ,CAAStoB,OAAT,CAAP;AAC7B,qBAAKA,OAAL,GAAegB,MAAM,CAAC,EAAD,EAAK4mB,iBAAL,EAAwB5nB,OAAO,IAAI,EAAnC,CAArB;AACA,oBAAIuoB,WAAW,GAAG,MAAMC,MAAN,CAAa,KAAKxoB,OAAL,CAAaia,WAA1B,CAAlB,CAHqB,CAGqC;AAC1D;;AAEA,qBAAKwO,OAAL,GAAejB,WAAW,CAACe,WAAD,CAAX,IAA4Bzb,KAAK,CAACkN,OAAN,CAAc,KAAKha,OAAL,CAAaia,WAA3B,CAA3C;AACA,oBAAI,CAACuN,WAAW,CAACe,WAAD,CAAhB,EAA+Bf,WAAW,CAACe,WAAD,CAAX,GAA2B,KAAKE,OAAhC,CAPV,CAOmD;;AAExE,qBAAKla,QAAL,GAAgB;AACdC,oBAAE,EAAE,KADU;AAEd;AACAE,sBAAI,EAAE,KAHQ;AAId;AACAga,qBAAG,EAAE,KALS;AAMd;AACAC,oBAAE,EAAE,KAPU,CAOJ;;AAPI,iBAAhB;AAUA,qBAAKC,aAAL,GAAqB,IAArB,CAnBqB,CAmBM;;AAE3B,qBAAKta,oBAAL,GAA4B,EAA5B;AACA,qBAAKua,SAAL,GAAiB,IAAjB;AACD;;AAEDP,kBAAI,CAACjc,SAAL,CAAesS,IAAf,GAAsB,YAAY;AAChC,oBAAI7H,KAAK,GAAG,IAAZ;;AAEA,oBAAI,KAAKgS,aAAT,EAAwB,OAAO,KAAKA,aAAZ,CAHQ,CAGmB;;AAEnD,oBAAId,kBAAkB,KAAK,KAAvB,IAAgCA,kBAAkB,KAAK,IAA3D,EAAiE;AAC/DA,oCAAkB,GAAG,KAArB;;AAEA,sBAAI,OAAOe,SAAP,KAAqB,WAArB,IAAoC,OAAOC,iBAAP,KAA6B,WAArE,EAAkF;AAChF,wBAAI;AACF;AACA,0BAAID,SAAJ,CAAc,IAAIC,iBAAJ,CAAsB,GAAtB,CAAd,EAA0C,EAA1C,EAA8C,EAA9C;AACAhB,wCAAkB,GAAG,IAArB;AACD,qBAJD,CAIE,OAAO9S,EAAP,EAAW,CAAE;AAChB;AACF,iBAf+B,CAe9B;AACF;AACA;AACA;AACA;AACA;AACA;;;AAGA,oBAAI+S,uBAAuB,KAAK,KAA5B,IAAqCA,uBAAuB,KAAK,IAArE,EAA2E;AACzEA,yCAAuB,GAAG,KAA1B;;AAEA,sBAAI,OAAOgB,WAAP,KAAuB,WAA3B,EAAwC;AACtC,wBAAIA,WAAW,CAAC5c,SAAZ,IAAyB4c,WAAW,CAAC5c,SAAZ,CAAsB4O,KAAnD,EAA0D;AACxDgN,6CAAuB,GAAG,IAA1B;AACD,qBAFD,MAEO;AACL,2BAAKiB,KAAL,CAAW,iDAAX;AACD;AACF;AACF;;AAED,oBAAI3a,QAAQ,GAAG,KAAKvO,OAAL,CAAauO,QAAb,CAAsBoY,KAAtB,EAAf;;AAEA,oBAAIpY,QAAQ,CAACE,OAAT,CAAiB,KAAjB,KAA2B,CAA/B,EAAkC;AAChCF,0BAAQ,GAAG,CAAC,KAAD,EAAQ,MAAR,EAAgB,IAAhB,EAAsB,IAAtB,CAAX;AACD;;AAED,qBAAKD,oBAAL,GAA4BC,QAA5B;AACA,qBAAKsa,SAAL,GAAiB,IAAIza,OAAJ,CAAYG,QAAZ,CAAjB,CA3CgC,CA2CQ;;AAExC,oBAAIA,QAAQ,CAACE,OAAT,CAAiB,IAAjB,KAA0B,CAA9B,EAAiC;AAC/B,sBAAI,OAAO+W,MAAP,KAAkB,WAAlB,IAAiC,YAAYA,MAAjD,EAAyD;AACvD;AACA;AACA,wBAAI;AACF,0BAAI2D,GAAG,GAAGpb,OAAO,CAAC,YAAD,CAAP,CAAsB,YAAY,CAAE,CAApC,CAAV;;AAEAob,yBAAG,CAAChB,SAAJ;AACA,2BAAK5Z,QAAL,CAAcoa,EAAd,GAAmB,IAAnB,CAJE,CAIuB;;AAEzB,0BAAIS,SAAS,GAAG,MAAMZ,MAAN,CAAa5D,IAAI,CAACD,SAAL,CAAe,KAAK3kB,OAApB,CAAb,CAAhB;;AAEA,0BAAIwnB,WAAW,CAAC4B,SAAD,CAAf,EAA4B;AAC1B,6BAAKR,aAAL,GAAqBpB,WAAW,CAAC4B,SAAD,CAAhC;AACD,uBAFD,MAEO;AACL,6BAAKR,aAAL,GAAqB,IAAIrS,IAAJ,CAAS2R,YAAT,EAAuB,KAAKloB,OAAL,CAAawW,IAApC,CAArB;AACAgR,mCAAW,CAAC4B,SAAD,CAAX,GAAyB,KAAKR,aAA9B;AACD;AACF,qBAdD,CAcE,OAAO1T,EAAP,EAAW,CAAE;AAChB;AACF;;AAED,oBAAImU,QAAQ,GAAG,KAAKR,SAAL,CAAelK,IAAf,GAAsBrc,IAAtB,CAA2B,UAAUgnB,OAAV,EAAmB;AAC3D;AACAtoB,wBAAM,CAAC8V,KAAK,CAACvI,QAAP,EAAiB+a,OAAO,CAAC/a,QAAzB,CAAN;AACD,iBAHc,CAAf;;AAKA,oBAAIgb,cAAJ;;AAEA,oBAAI,CAACtB,uBAAL,EAA8B;AAC5BsB,gCAAc,GAAGjtB,OAAO,CAACC,OAAR,CAAgB,KAAhB,CAAjB;AACD,iBAFD,MAEO;AACLgtB,gCAAc,GAAGzc,KAAK,CAAC2N,WAAN,CAAkB,KAAKza,OAAL,CAAa0a,YAA/B,EAA6CpY,IAA7C,CAAkD,UAAU0Y,MAAV,EAAkB;AACnF,wBAAIlE,KAAK,CAACvI,QAAN,CAAema,GAAf,IAAsBna,QAAQ,CAACE,OAAT,CAAiB,KAAjB,IAA0B,CAApD,EAAuD;AACrDqI,2BAAK,CAACoS,KAAN,CAAY,8DAAZ;;AAEA;AACD;;AAED,wBAAI3a,QAAQ,CAACE,OAAT,CAAiB,KAAjB,KAA2B,CAA/B,EAAkCqI,KAAK,CAACvI,QAAN,CAAema,GAAf,GAAqB1N,MAArB;AACnC,mBARgB,CAAjB;AASD,iBAtF+B,CAsF9B;;;AAGF,qBAAK8N,aAAL,GAAqBxsB,OAAO,CAACuiB,GAAR,CAAY,CAACwK,QAAD,EAAWE,cAAX,CAAZ,EAAwCjnB,IAAxC,CAA6C,YAAY;AAC5E,yBAAOwU,KAAP;AACD,iBAFoB,CAArB;AAGA,uBAAO,KAAKgS,aAAZ;AACD,eA7FD;;AA+FAR,kBAAI,CAACjc,SAAL,CAAe2C,MAAf,GAAwB,UAAU/C,IAAV,EAAgBD,EAAhB,EAAoBhM,OAApB,EAA6B;AACnD,oBAAIkX,MAAM,GAAG,IAAb;;AAEA,qBAAKgS,KAAL,CAAW,iBAAX;AACA,oBAAI7N,IAAI,GAAGra,MAAM,CAAC,EAAD,EAAK+mB,mBAAL,CAAjB;;AAEA,oBAAI,CAACyB,KAAK,CAACxpB,OAAD,CAAV,EAAqB;AACnBqb,sBAAI,GAAGra,MAAM,CAACqa,IAAD,EAAO;AAClB5J,2BAAO,EAAEzR;AADS,mBAAP,CAAb;AAGD,iBAJD,MAIO,IAAIA,OAAJ,EAAa;AAClBqb,sBAAI,GAAGra,MAAM,CAACqa,IAAD,EAAOrb,OAAP,CAAb;AACD;;AAEDqb,oBAAI,CAAClM,OAAL,GAAenD,EAAE,CAAC+E,KAAlB;AACAsK,oBAAI,CAACjM,QAAL,GAAgBpD,EAAE,CAACgF,MAAnB;AACAqK,oBAAI,CAACtK,KAAL,GAAa9E,IAAI,CAACwd,YAAL,IAAqBxd,IAAI,CAAC8E,KAAvC;AACAsK,oBAAI,CAACrK,MAAL,GAAc/E,IAAI,CAACyd,aAAL,IAAsBzd,IAAI,CAAC+E,MAAzC,CAjBmD,CAiBF;;AAEjD,oBAAIhF,EAAE,CAAC+E,KAAH,KAAa,CAAb,IAAkB/E,EAAE,CAACgF,MAAH,KAAc,CAApC,EAAuC;AACrC,yBAAO1U,OAAO,CAACE,MAAR,CAAe,IAAI2Q,KAAJ,CAAU,wBAAwBqb,MAAxB,CAA+Bxc,EAAE,CAAC+E,KAAlC,EAAyC,GAAzC,EAA8CyX,MAA9C,CAAqDxc,EAAE,CAACgF,MAAxD,CAAV,CAAf,CAAP;AACD;;AAED,oBAAIqK,IAAI,CAAChM,aAAL,GAAqB,CAAzB,EAA4BgM,IAAI,CAAChM,aAAL,GAAqB,CAArB;AAC5B,oBAAIsa,QAAQ,GAAG,KAAf;AACA,oBAAIC,WAAW,GAAG,IAAlB;;AAEA,oBAAIvO,IAAI,CAACuO,WAAT,EAAsB;AACpB;AACAA,6BAAW,GAAGvO,IAAI,CAACuO,WAAL,CAAiBtnB,IAAjB,CAAsB,UAAU+S,IAAV,EAAgB;AAClDsU,4BAAQ,GAAG,IAAX;AACA,0BAAMtU,IAAN;AACD,mBAHa,EAGX,UAAUkF,GAAV,EAAe;AAChBoP,4BAAQ,GAAG,IAAX;AACA,0BAAMpP,GAAN;AACD,mBANa,CAAd;AAOD;;AAED,oBAAIsP,gBAAgB,GAAG,CAAvB,CAtCmD,CAsCzB;;AAE1B,oBAAI9R,cAAc,GAAG/U,IAAI,CAACsR,IAAL,CAAUtR,IAAI,CAACqR,GAAL,CAASwV,gBAAT,EAA2B,MAAMxO,IAAI,CAAChM,aAAX,GAA2B,CAAtD,CAAV,CAArB;AACA,uBAAO,KAAKsP,IAAL,GAAYrc,IAAZ,CAAiB,YAAY;AAClC,sBAAIqnB,QAAJ,EAAc,OAAOC,WAAP,CADoB,CACA;;AAElC,sBAAI1S,MAAM,CAAC3I,QAAP,CAAgBma,GAApB,EAAyB;AACvB,wBAAIoB,KAAK,GAAG9d,EAAE,CAAC+d,UAAH,CAAc,IAAd,EAAoB;AAC9BrY,2BAAK,EAAEsY,OAAO,CAAC3O,IAAI,CAAC3J,KAAN;AADgB,qBAApB,CAAZ;;AAIAwF,0BAAM,CAACgS,KAAP,CAAa,gCAAb;;AAEA,2BAAOvO,iBAAiB,CAAC1O,IAAD,EAAO;AAC7B2O,iCAAW,EAAES,IAAI,CAAClM,OADW;AAE7B0L,kCAAY,EAAEQ,IAAI,CAACjM,QAFU;AAG7B0L,mCAAa,EAAEhO,KAAK,CAAC0N,gBAAN,CAAuBa,IAAI,CAAC5J,OAA5B;AAHc,qBAAP,CAAjB,CAIJnP,IAJI,CAIC,UAAU2nB,WAAV,EAAuB;AAC7B,0BAAIN,QAAJ,EAAc,OAAOC,WAAP,CADe,CACK;;AAElC,0BAAI,CAACvO,IAAI,CAACpM,aAAV,EAAyB;AACvB6a,6BAAK,CAACI,SAAN,CAAgBD,WAAhB,EAA6B,CAA7B,EAAgC,CAAhC;AACAA,mCAAW,CAAChP,KAAZ;AACA6O,6BAAK,GAAG,IAAR;;AAEA5S,8BAAM,CAACgS,KAAP,CAAa,WAAb;;AAEA,+BAAOld,EAAP;AACD;;AAEDkL,4BAAM,CAACgS,KAAP,CAAa,gBAAb;;AAEA,0BAAIrB,SAAS,GAAG3Q,MAAM,CAAClX,OAAP,CAAe0a,YAAf,CAA4BW,IAAI,CAAClM,OAAjC,EAA0CkM,IAAI,CAACjM,QAA/C,CAAhB;;AAEA,0BAAI+a,MAAM,GAAGtC,SAAS,CAACkC,UAAV,CAAqB,IAArB,EAA2B;AACtCrY,6BAAK,EAAEsY,OAAO,CAAC3O,IAAI,CAAC3J,KAAN;AADwB,uBAA3B,CAAb;AAGAyY,4BAAM,CAACD,SAAP,CAAiBD,WAAjB,EAA8B,CAA9B,EAAiC,CAAjC;AACAA,iCAAW,CAAChP,KAAZ;AACA,0BAAImP,KAAK,GAAGD,MAAM,CAACE,YAAP,CAAoB,CAApB,EAAuB,CAAvB,EAA0BhP,IAAI,CAAClM,OAA/B,EAAwCkM,IAAI,CAACjM,QAA7C,CAAZ;;AAEA8H,4BAAM,CAAC2R,SAAP,CAAiB3Z,YAAjB,CAA8Bkb,KAAK,CAAC/U,IAApC,EAA0CgG,IAAI,CAAClM,OAA/C,EAAwDkM,IAAI,CAACjM,QAA7D,EAAuEiM,IAAI,CAACpM,aAA5E,EAA2FoM,IAAI,CAAChM,aAAhG,EAA+GgM,IAAI,CAAC/L,gBAApH;;AAEAwa,2BAAK,CAACQ,YAAN,CAAmBF,KAAnB,EAA0B,CAA1B,EAA6B,CAA7B,EA1B6B,CA0BI;AACjC;;AAEAvC,+BAAS,CAAC9W,KAAV,GAAkB8W,SAAS,CAAC7W,MAAV,GAAmB,CAArC;AACAoZ,2BAAK,GAAGD,MAAM,GAAGtC,SAAS,GAAGiC,KAAK,GAAG,IAArC;;AAEA5S,4BAAM,CAACgS,KAAP,CAAa,WAAb;;AAEA,6BAAOld,EAAP;AACD,qBAvCM,CAAP;AAwCD,mBAlDiC,CAkDhC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,sBAAI8C,KAAK,GAAG,EAAZ,CA5DkC,CA4DlB;;AAEhB,sBAAIyb,YAAY,GAAG,SAASA,YAAT,CAAsBlP,IAAtB,EAA4B;AAC7C,2BAAO/e,OAAO,CAACC,OAAR,GAAkB+F,IAAlB,CAAuB,YAAY;AACxC,0BAAI,CAAC4U,MAAM,CAAC3I,QAAP,CAAgBoa,EAArB,EAAyB,OAAOzR,MAAM,CAAC2R,SAAP,CAAiBha,gBAAjB,CAAkCwM,IAAlC,EAAwCvM,KAAxC,CAAP;AACzB,6BAAO,IAAIxS,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC5C,4BAAIguB,CAAC,GAAGtT,MAAM,CAAC0R,aAAP,CAAqB/R,OAArB,EAAR;;AAEA,4BAAI+S,WAAJ,EAAiBA,WAAW,CAAC,OAAD,CAAX,CAAqB,UAAUrP,GAAV,EAAe;AACnD,iCAAO/d,MAAM,CAAC+d,GAAD,CAAb;AACD,yBAFgB;;AAIjBiQ,yBAAC,CAAChtB,KAAF,CAAQ2d,SAAR,GAAoB,UAAUC,EAAV,EAAc;AAChCoP,2BAAC,CAACvT,OAAF;AACA,8BAAImE,EAAE,CAAC/F,IAAH,CAAQkF,GAAZ,EAAiB/d,MAAM,CAAC4e,EAAE,CAAC/F,IAAH,CAAQkF,GAAT,CAAN,CAAjB,KAA0Che,OAAO,CAAC6e,EAAE,CAAC/F,IAAH,CAAQtG,MAAT,CAAP;AAC3C,yBAHD;;AAKAyb,yBAAC,CAAChtB,KAAF,CAAQ8d,WAAR,CAAoB;AAClBD,8BAAI,EAAEA,IADY;AAElB9M,kCAAQ,EAAE2I,MAAM,CAAC5I,oBAFC;AAGlBmc,iCAAO,EAAE;AACPC,uCAAW,EAAExT,MAAM,CAAC2R,SAAP,CAAiB3T;AADvB;AAHS,yBAApB,EAMG,CAACmG,IAAI,CAACpa,GAAL,CAAS6T,MAAV,CANH;AAOD,uBAnBM,CAAP;AAoBD,qBAtBM,CAAP;AAuBD,mBAxBD;;AA0BA,sBAAI6V,aAAa,GAAG,SAASA,aAAT,CAAuB1e,IAAvB,EAA6BD,EAA7B,EAAiCqP,IAAjC,EAAuC;AACzD,wBAAIuP,MAAJ;AACA,wBAAIC,cAAJ;AACA,wBAAIC,mBAAmB,GAAG,KAA1B;AACA,wBAAIhB,KAAJ;;AAEA,wBAAIiB,WAAW,GAAG,SAASA,WAAT,CAAqB9R,IAArB,EAA2B;AAC3C,6BAAO/B,MAAM,CAACuR,OAAP,CAAe,YAAY;AAChC,4BAAIkB,QAAJ,EAAc,OAAOC,WAAP;AACd,4BAAIoB,YAAJ,CAFgC,CAEd;;AAElB,4BAAIle,KAAK,CAAC6M,QAAN,CAAe1N,IAAf,CAAJ,EAA0B;AACxBiL,gCAAM,CAACgS,KAAP,CAAa,qBAAb,EADwB,CACa;;;AAGrC8B,sCAAY,GAAGJ,MAAM,CAACP,YAAP,CAAoBpR,IAAI,CAACzE,CAAzB,EAA4ByE,IAAI,CAACN,CAAjC,EAAoCM,IAAI,CAAClI,KAAzC,EAAgDkI,IAAI,CAACjI,MAArD,CAAf;AACD,yBALD,MAKO;AACL;AACA;AACA;AACA;AACA;AACAkG,gCAAM,CAACgS,KAAP,CAAa,iDAAb;;AAEA,8BAAIrB,SAAS,GAAG3Q,MAAM,CAAClX,OAAP,CAAe0a,YAAf,CAA4BzB,IAAI,CAAClI,KAAjC,EAAwCkI,IAAI,CAACjI,MAA7C,CAAhB;;AAEA,8BAAImZ,MAAM,GAAGtC,SAAS,CAACkC,UAAV,CAAqB,IAArB,EAA2B;AACtCrY,iCAAK,EAAEsY,OAAO,CAAC3O,IAAI,CAAC3J,KAAN;AADwB,2BAA3B,CAAb;AAGAyY,gCAAM,CAACc,wBAAP,GAAkC,MAAlC;AACAd,gCAAM,CAACD,SAAP,CAAiBW,cAAc,IAAI5e,IAAnC,EAAyCgN,IAAI,CAACzE,CAA9C,EAAiDyE,IAAI,CAACN,CAAtD,EAAyDM,IAAI,CAAClI,KAA9D,EAAqEkI,IAAI,CAACjI,MAA1E,EAAkF,CAAlF,EAAqF,CAArF,EAAwFiI,IAAI,CAAClI,KAA7F,EAAoGkI,IAAI,CAACjI,MAAzG;;AAEAkG,gCAAM,CAACgS,KAAP,CAAa,qBAAb;;AAEA8B,sCAAY,GAAGb,MAAM,CAACE,YAAP,CAAoB,CAApB,EAAuB,CAAvB,EAA0BpR,IAAI,CAAClI,KAA/B,EAAsCkI,IAAI,CAACjI,MAA3C,CAAf,CAlBK,CAkB8D;AACnE;;AAEA6W,mCAAS,CAAC9W,KAAV,GAAkB8W,SAAS,CAAC7W,MAAV,GAAmB,CAArC;AACAmZ,gCAAM,GAAGtC,SAAS,GAAG,IAArB;AACD;;AAED,4BAAIra,CAAC,GAAG;AACNvM,6BAAG,EAAE+pB,YAAY,CAAC3V,IADZ;AAENtE,+BAAK,EAAEkI,IAAI,CAAClI,KAFN;AAGNC,gCAAM,EAAEiI,IAAI,CAACjI,MAHP;AAIN7B,iCAAO,EAAE8J,IAAI,CAAC9J,OAJR;AAKNC,kCAAQ,EAAE6J,IAAI,CAAC7J,QALT;AAMNgC,gCAAM,EAAE6H,IAAI,CAAC7H,MANP;AAONC,gCAAM,EAAE4H,IAAI,CAAC5H,MAPP;AAQNC,iCAAO,EAAE2H,IAAI,CAAC3H,OARR;AASNC,iCAAO,EAAE0H,IAAI,CAAC1H,OATR;AAUNE,iCAAO,EAAE4J,IAAI,CAAC5J,OAVR;AAWNC,+BAAK,EAAE2J,IAAI,CAAC3J,KAXN;AAYNzC,uCAAa,EAAEoM,IAAI,CAACpM,aAZd;AAaNI,uCAAa,EAAEgM,IAAI,CAAChM,aAbd;AAcNC,0CAAgB,EAAE+L,IAAI,CAAC/L;AAdjB,yBAAR;;AAiBA4H,8BAAM,CAACgS,KAAP,CAAa,oBAAb;;AAEA,+BAAO5sB,OAAO,CAACC,OAAR,GAAkB+F,IAAlB,CAAuB,YAAY;AACxC,iCAAOioB,YAAY,CAAC/c,CAAD,CAAnB;AACD,yBAFM,EAEJlL,IAFI,CAEC,UAAUyM,MAAV,EAAkB;AACxB,8BAAI4a,QAAJ,EAAc,OAAOC,WAAP;AACdoB,sCAAY,GAAG,IAAf;AACA,8BAAIE,WAAJ;;AAEAhU,gCAAM,CAACgS,KAAP,CAAa,2CAAb;;AAEA,8BAAIlB,kBAAJ,EAAwB;AACtB;AACA;AACAkD,uCAAW,GAAG,IAAInC,SAAJ,CAAc,IAAIC,iBAAJ,CAAsBja,MAAtB,CAAd,EAA6CkK,IAAI,CAAC9J,OAAlD,EAA2D8J,IAAI,CAAC7J,QAAhE,CAAd;AACD,2BAJD,MAIO;AACL;AACA;AACA8b,uCAAW,GAAGpB,KAAK,CAACqB,eAAN,CAAsBlS,IAAI,CAAC9J,OAA3B,EAAoC8J,IAAI,CAAC7J,QAAzC,CAAd;;AAEA,gCAAI8b,WAAW,CAAC7V,IAAZ,CAAiBjB,GAArB,EAA0B;AACxB8W,yCAAW,CAAC7V,IAAZ,CAAiBjB,GAAjB,CAAqBrF,MAArB;AACD,6BAFD,MAEO;AACL;AACA,mCAAK,IAAItB,CAAC,GAAGyd,WAAW,CAAC7V,IAAZ,CAAiBhR,MAAjB,GAA0B,CAAvC,EAA0CoJ,CAAC,IAAI,CAA/C,EAAkDA,CAAC,EAAnD,EAAuD;AACrDyd,2CAAW,CAAC7V,IAAZ,CAAiB5H,CAAjB,IAAsBsB,MAAM,CAACtB,CAAD,CAA5B;AACD;AACF;AACF;;AAEDyJ,gCAAM,CAACgS,KAAP,CAAa,WAAb;;AAEA,8BAAIzB,eAAJ,EAAqB;AACnB;AACAqC,iCAAK,CAACQ,YAAN,CAAmBY,WAAnB,EAAgCjS,IAAI,CAACC,GAArC,EAA0CD,IAAI,CAACE,GAA/C,EAAoDF,IAAI,CAACG,QAAL,GAAgBH,IAAI,CAACC,GAAzE,EAA8ED,IAAI,CAACI,QAAL,GAAgBJ,IAAI,CAACE,GAAnG,EAAwGF,IAAI,CAACK,YAAL,GAAoB,IAA5H,EAAkIL,IAAI,CAACM,aAAL,GAAqB,IAAvJ;AACD,2BAHD,MAGO;AACLuQ,iCAAK,CAACQ,YAAN,CAAmBY,WAAnB,EAAgCjS,IAAI,CAACC,GAArC,EAA0CD,IAAI,CAACE,GAA/C,EAAoDF,IAAI,CAACG,QAAL,GAAgBH,IAAI,CAACC,GAAzE,EAA8ED,IAAI,CAACI,QAAL,GAAgBJ,IAAI,CAACE,GAAnG,EAAwGF,IAAI,CAACK,YAA7G,EAA2HL,IAAI,CAACM,aAAhI;AACD;;AAED,iCAAO,IAAP;AACD,yBAtCM,CAAP;AAuCD,uBA5FM,CAAP;AA6FD,qBA9FD,CANyD,CAoGtD;AACH;;;AAGA,2BAAOjd,OAAO,CAACC,OAAR,GAAkB+F,IAAlB,CAAuB,YAAY;AACxCwnB,2BAAK,GAAG9d,EAAE,CAAC+d,UAAH,CAAc,IAAd,EAAoB;AAC1BrY,6BAAK,EAAEsY,OAAO,CAAC3O,IAAI,CAAC3J,KAAN;AADY,uBAApB,CAAR;;AAIA,0BAAI5E,KAAK,CAAC6M,QAAN,CAAe1N,IAAf,CAAJ,EAA0B;AACxB2e,8BAAM,GAAG3e,IAAI,CAAC8d,UAAL,CAAgB,IAAhB,EAAsB;AAC7BrY,+BAAK,EAAEsY,OAAO,CAAC3O,IAAI,CAAC3J,KAAN;AADe,yBAAtB,CAAT;AAGA,+BAAO,IAAP;AACD;;AAED,0BAAI5E,KAAK,CAACiN,aAAN,CAAoB9N,IAApB,CAAJ,EAA+B;AAC7B4e,sCAAc,GAAG5e,IAAjB;AACA6e,2CAAmB,GAAG,IAAtB;AACA,+BAAO,IAAP;AACD;;AAED,0BAAIhe,KAAK,CAACgN,OAAN,CAAc7N,IAAd,CAAJ,EAAyB;AACvB;AACA,4BAAI,CAACgc,uBAAL,EAA8B,OAAO,IAAP;;AAE9B/Q,8BAAM,CAACgS,KAAP,CAAa,oCAAb;;AAEA,+BAAOvO,iBAAiB,CAAC1O,IAAD,CAAjB,CAAwB3J,IAAxB,CAA6B,UAAU2nB,WAAV,EAAuB;AACzDY,wCAAc,GAAGZ,WAAjB;AACD,yBAFM,EAEJ;AACH;;AAEA;AALO,yBAMN,OANM,EAMG,UAAU1gB,CAAV,EAAa;AACrB,iCAAO,IAAP;AACD,yBARM,CAAP;AASD;;AAED,4BAAM,IAAI4D,KAAJ,CAAU,sDAAV,CAAN;AACD,qBApCM,EAoCJ7K,IApCI,CAoCC,YAAY;AAClB,0BAAIqnB,QAAJ,EAAc,OAAOC,WAAP;;AAEd1S,4BAAM,CAACgS,KAAP,CAAa,iBAAb,EAHkB,CAGe;AACjC;AACA;AACA;;;AAGA,0BAAIkC,OAAO,GAAG5S,aAAa,CAAC;AAC1BzH,6BAAK,EAAEsK,IAAI,CAACtK,KADc;AAE1BC,8BAAM,EAAEqK,IAAI,CAACrK,MAFa;AAG1B8G,mCAAW,EAAEZ,MAAM,CAAClX,OAAP,CAAeiZ,IAHF;AAI1B9J,+BAAO,EAAEkM,IAAI,CAAClM,OAJY;AAK1BC,gCAAQ,EAAEiM,IAAI,CAACjM,QALW;AAM1B2I,sCAAc,EAAEA;AANU,uBAAD,CAA3B;AAQA,0BAAIsT,IAAI,GAAGD,OAAO,CAACrM,GAAR,CAAY,UAAU9F,IAAV,EAAgB;AACrC,+BAAO8R,WAAW,CAAC9R,IAAD,CAAlB;AACD,uBAFU,CAAX;;AAIA,+BAASqS,OAAT,GAAmB;AACjB,4BAAIT,cAAJ,EAAoB;AAClB,8BAAI,CAACC,mBAAL,EAA0BD,cAAc,CAAC5P,KAAf;AAC1B4P,wCAAc,GAAG,IAAjB;AACD;AACF;;AAED3T,4BAAM,CAACgS,KAAP,CAAa,eAAb;;AAEA,6BAAO5sB,OAAO,CAACuiB,GAAR,CAAYwM,IAAZ,EAAkB/oB,IAAlB,CAAuB,YAAY;AACxC4U,8BAAM,CAACgS,KAAP,CAAa,WAAb;;AAEAoC,+BAAO;AACP,+BAAOtf,EAAP;AACD,uBALM,EAKJ,UAAUuO,GAAV,EAAe;AAChB+Q,+BAAO;AACP,8BAAM/Q,GAAN;AACD,uBARM,CAAP;AASD,qBA3EM,CAAP;AA4ED,mBApLD;;AAsLA,sBAAIgR,aAAa,GAAG,SAASA,aAAT,CAAuBC,MAAvB,EAA+Bvf,IAA/B,EAAqCD,EAArC,EAAyCqP,IAAzC,EAA+C;AACjE,wBAAIsO,QAAJ,EAAc,OAAOC,WAAP;;AAEd,wBAAI6B,aAAa,GAAGD,MAAM,CAACnR,KAAP,EAApB;AAAA,wBACIqR,cAAc,GAAGvF,cAAc,CAACsF,aAAD,EAAgB,CAAhB,CADnC;AAAA,wBAEItc,OAAO,GAAGuc,cAAc,CAAC,CAAD,CAF5B;AAAA,wBAGItc,QAAQ,GAAGsc,cAAc,CAAC,CAAD,CAH7B;;AAKA,wBAAIC,WAAW,GAAGH,MAAM,CAACnnB,MAAP,KAAkB,CAApC;AACAgX,wBAAI,GAAGra,MAAM,CAAC,EAAD,EAAKqa,IAAL,EAAW;AACtBlM,6BAAO,EAAEA,OADa;AAEtBC,8BAAQ,EAAEA,QAFY;AAGtB;AACA;AACA;AACAqC,6BAAO,EAAEka,WAAW,GAAGtQ,IAAI,CAAC5J,OAAR,GAAkBzO,IAAI,CAAC4P,GAAL,CAAS,CAAT,EAAYyI,IAAI,CAAC5J,OAAjB;AANhB,qBAAX,CAAb;AAQA,wBAAIoW,SAAJ;;AAEA,wBAAI,CAAC8D,WAAL,EAAkB;AAChB;AACA9D,+BAAS,GAAG3Q,MAAM,CAAClX,OAAP,CAAe0a,YAAf,CAA4BvL,OAA5B,EAAqCC,QAArC,CAAZ;AACD;;AAED,2BAAOub,aAAa,CAAC1e,IAAD,EAAO0f,WAAW,GAAG3f,EAAH,GAAQ6b,SAA1B,EAAqCxM,IAArC,CAAb,CAAwD/Y,IAAxD,CAA6D,YAAY;AAC9E,0BAAIqpB,WAAJ,EAAiB,OAAO3f,EAAP;AACjBqP,0BAAI,CAACtK,KAAL,GAAa5B,OAAb;AACAkM,0BAAI,CAACrK,MAAL,GAAc5B,QAAd;AACA,6BAAOmc,aAAa,CAACC,MAAD,EAAS3D,SAAT,EAAoB7b,EAApB,EAAwBqP,IAAxB,CAApB;AACD,qBALM,EAKJ/Y,IALI,CAKC,UAAUspB,GAAV,EAAe;AACrB,0BAAI/D,SAAJ,EAAe;AACb;AACA;AACAA,iCAAS,CAAC9W,KAAV,GAAkB8W,SAAS,CAAC7W,MAAV,GAAmB,CAArC;AACD;;AAED,6BAAO4a,GAAP;AACD,qBAbM,CAAP;AAcD,mBAtCD;;AAwCA,sBAAIJ,MAAM,GAAG7T,YAAY,CAAC0D,IAAI,CAACtK,KAAN,EAAasK,IAAI,CAACrK,MAAlB,EAA0BqK,IAAI,CAAClM,OAA/B,EAAwCkM,IAAI,CAACjM,QAA7C,EAAuD8H,MAAM,CAAClX,OAAP,CAAeiZ,IAAtE,EAA4ElB,cAA5E,CAAzB;AACA,yBAAOwT,aAAa,CAACC,MAAD,EAASvf,IAAT,EAAeD,EAAf,EAAmBqP,IAAnB,CAApB;AACD,iBAxTM,CAAP;AAyTD,eAlWD,CAhNmD,CAkjBhD;AACH;;;AAGAiN,kBAAI,CAACjc,SAAL,CAAewf,YAAf,GAA8B,UAAU7rB,OAAV,EAAmB;AAC/C,oBAAIwX,MAAM,GAAG,IAAb;;AAEA,oBAAI6D,IAAI,GAAGra,MAAM,CAAC,EAAD,EAAK+mB,mBAAL,EAA0B/nB,OAA1B,CAAjB;AACA,uBAAO,KAAK2e,IAAL,GAAYrc,IAAZ,CAAiB,YAAY;AAClC,yBAAOkV,MAAM,CAACqR,SAAP,CAAiBha,gBAAjB,CAAkCwM,IAAlC,CAAP;AACD,iBAFM,CAAP;AAGD,eAPD;;AASAiN,kBAAI,CAACjc,SAAL,CAAeyf,MAAf,GAAwB,UAAUC,MAAV,EAAkBC,QAAlB,EAA4Bva,OAA5B,EAAqC;AAC3Dua,wBAAQ,GAAGA,QAAQ,IAAI,WAAvB;AACA,uBAAO,IAAI1vB,OAAJ,CAAY,UAAUC,OAAV,EAAmB;AACpC,sBAAIwvB,MAAM,CAACD,MAAX,EAAmB;AACjBC,0BAAM,CAACD,MAAP,CAAc,UAAUjlB,IAAV,EAAgB;AAC5B,6BAAOtK,OAAO,CAACsK,IAAD,CAAd;AACD,qBAFD,EAEGmlB,QAFH,EAEava,OAFb;AAGA;AACD;;AAED,sBAAIsa,MAAM,CAACE,aAAX,EAA0B;AACxB1vB,2BAAO,CAACwvB,MAAM,CAACE,aAAP,CAAqB;AAC3BvpB,0BAAI,EAAEspB,QADqB;AAE3Bva,6BAAO,EAAEA;AAFkB,qBAArB,CAAD,CAAP;AAIA;AACD,mBAdmC,CAclC;;;AAGF,sBAAIya,QAAQ,GAAGC,IAAI,CAACJ,MAAM,CAACK,SAAP,CAAiBJ,QAAjB,EAA2Bva,OAA3B,EAAoC4S,KAApC,CAA0C,GAA1C,EAA+C,CAA/C,CAAD,CAAnB;AACA,sBAAInT,GAAG,GAAGgb,QAAQ,CAAC7nB,MAAnB;AACA,sBAAIgoB,QAAQ,GAAG,IAAI7a,UAAJ,CAAeN,GAAf,CAAf;;AAEA,uBAAK,IAAIzD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyD,GAApB,EAAyBzD,CAAC,EAA1B,EAA8B;AAC5B4e,4BAAQ,CAAC5e,CAAD,CAAR,GAAcye,QAAQ,CAACI,UAAT,CAAoB7e,CAApB,CAAd;AACD;;AAEDlR,yBAAO,CAAC,IAAIqpB,IAAJ,CAAS,CAACyG,QAAD,CAAT,EAAqB;AAC3B3pB,wBAAI,EAAEspB;AADqB,mBAArB,CAAD,CAAP;AAGD,iBA5BM,CAAP;AA6BD,eA/BD;;AAiCA1D,kBAAI,CAACjc,SAAL,CAAe6c,KAAf,GAAuB,YAAY,CAAE,CAArC;;AAEAjc,oBAAM,CAACtG,OAAP,GAAiB2hB,IAAjB;AAEC,aApmBiB,EAomBhB;AAAC,+BAAgB,CAAjB;AAAmB,4BAAa,CAAhC;AAAkC,+BAAgB,EAAlD;AAAqD,6BAAc,EAAnE;AAAsE,6BAAc,EAApF;AAAuF,8BAAe,EAAtG;AAAyG,+BAAgB,EAAzH;AAA4H,4BAAa;AAAzI,aApmBgB;AA3gDkhB,WAA7e,EA+mE0F,EA/mE1F,EA+mE6F,EA/mE7F,EA+mEiG,WA/mEjG,CAAP;AAgnE/C,SAhnED;AAinEC,OAlnE8B,CAA/B;AAonEA,UAAIiE,cAAc,GAAGxf,oBAAoB,CAAC,UAAUE,MAAV,EAAkB;AAE5D;AACA;AACA;AACA,iBAASrQ,KAAT,CAAe4vB,OAAf,EAAwB3e,IAAxB,EAA8B;AAC5B,cAAI0M,GAAG,GAAG,IAAIpN,KAAJ,CAAUqf,OAAV,CAAV;AACAjS,aAAG,CAAC1M,IAAJ,GAAWA,IAAX;AACA,iBAAO0M,GAAP;AACD,SAT2D,CAY5D;AACA;;;AACA,iBAASkS,MAAT,CAAgBlM,MAAhB,EAAwB;AACtB,cAAIhT,CAAC,GAAGgT,MAAM,CAAC7G,QAAP,CAAgB,EAAhB,EAAoBgT,WAApB,EAAR;;AACA,eAAK,IAAIjf,CAAC,GAAG,IAAIF,CAAC,CAAClJ,MAAnB,EAA2BoJ,CAAC,GAAG,CAA/B,EAAkCA,CAAC,EAAnC;AAAuCF,aAAC,GAAG,MAAMA,CAAV;AAAvC;;AACA,iBAAO,OAAOA,CAAd;AACD;;AAGD,iBAASof,WAAT,CAAqBhM,GAArB,EAA0B;AACxB,cAAI;AACF,mBAAOiM,QAAQ,CAACC,kBAAkB,CAAClM,GAAD,CAAnB,CAAf;AACD,WAFD,CAEE,OAAOrY,CAAP,EAAU;AACV,mBAAOqY,GAAP;AACD;AACF;;AAGD,iBAASmM,WAAT,CAAqBnM,GAArB,EAA0B;AACxB,cAAI;AACF,mBAAOoM,kBAAkB,CAACC,MAAM,CAACrM,GAAD,CAAP,CAAzB;AACD,WAFD,CAEE,OAAOrY,CAAP,EAAU;AACV,mBAAOqY,GAAP;AACD;AACF,SApC2D,CAuC5D;AACA;;;AACA,iBAASsM,aAAT,CAAuB7J,GAAvB,EAA4B;AAC1B,iBAAOriB,MAAM,CAACsL,SAAP,CAAiBqN,QAAjB,CAA0BnN,IAA1B,CAA+B6W,GAA/B,MAAwC,qBAA/C;AACD,SA3C2D,CA8C5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,iBAAS8J,UAAT,CAAoBC,QAApB,EAA8BC,UAA9B,EAA0CC,QAA1C,EAAoD;AAClD;AACA,eAAKzM,KAAL,GAAkBuM,QAAQ,CAAChZ,QAAT,CAAkBiZ,UAAlB,EAA8BC,QAA9B,CAAlB,CAFkD,CAIlD;;AACA,eAAKC,KAAL,GAAkBF,UAAlB,CALkD,CAOlD;;AACA,cAAIG,GAAG,GAAGzJ,MAAM,CAACG,YAAP,CAAoBuJ,KAApB,CAA0B,IAA1B,EAAgC,KAAK5M,KAAL,CAAWzM,QAAX,CAAoB,CAApB,EAAuB,CAAvB,CAAhC,CAAV;;AAEA,cAAIoZ,GAAG,KAAK,UAAR,IAAsBA,GAAG,KAAK,UAAlC,EAA8C;AAC5C,kBAAM3wB,KAAK,CAAC,wBAAD,EAA2B,UAA3B,CAAX;AACD,WAZiD,CAclD;;;AACA,eAAK6wB,UAAL,GAAkBF,GAAG,CAAC,CAAD,CAAH,KAAW,GAA7B;AACD;;AAGDL,kBAAU,CAAC7gB,SAAX,CAAqBqhB,IAArB,GAA4B,UAAUC,QAAV,EAAoB;AAC9C;AACA,eAAKC,OAAL,GAAe,KAAf;AAEA,cAAIrb,MAAM,GAAG,KAAKsb,WAAL,CAAiB,CAAjB,CAAb;AAEA,eAAKC,YAAL,GAAoB,CAAE;AACpBtlB,cAAE,EAAM,CADY;AAEpB+J,kBAAM,EAAEA;AAFY,WAAF,CAApB;;AAKA,iBAAO,KAAKub,YAAL,CAAkBzpB,MAAlB,GAA2B,CAA3B,IAAgC,CAAC,KAAKupB,OAA7C,EAAsD;AACpD,gBAAIngB,CAAC,GAAG,KAAKqgB,YAAL,CAAkBzT,KAAlB,EAAR;AACA,gBAAI,CAAC5M,CAAC,CAAC8E,MAAP,EAAe;AACf,iBAAKwb,QAAL,CAActgB,CAAC,CAACjF,EAAhB,EAAoBiF,CAAC,CAAC8E,MAAtB,EAA8Bob,QAA9B;AACD;AACF,SAhBD;;AAmBAT,kBAAU,CAAC7gB,SAAX,CAAqBoG,MAArB,GAA8B,UAAUkb,QAAV,EAAoB;AAChD,cAAIK,IAAI,GAAG,EAAX,CADgD,CAGhD;;AACAA,cAAI,CAACC,IAAL,GAAY;AAAEzlB,cAAE,EAAE,CAAN;AAAS0lB,mBAAO,EAAE;AAAlB,WAAZ;AAEA,eAAKR,IAAL,CAAU,UAAUS,KAAV,EAAiB;AACzB,gBAAIR,QAAQ,CAACQ,KAAD,CAAR,KAAoB,KAApB,IAA6B,CAACA,KAAK,CAACC,cAAxC,EAAwD;AACxD,gBAAID,KAAK,CAACC,cAAN,IAAwBD,KAAK,CAACE,KAAN,KAAgB,CAAxC,IAA6CF,KAAK,CAACG,MAAN,KAAiB,CAAlE,EAAqE,OAF5C,CAEoD;;AAE7E,gBAAI,CAACN,IAAI,CAAC,QAAQG,KAAK,CAACI,GAAf,CAAT,EAA8B;AAC5BP,kBAAI,CAAC,QAAQG,KAAK,CAACI,GAAf,CAAJ,GAA0B;AAAE/lB,kBAAE,EAAE2lB,KAAK,CAACI,GAAZ;AAAiBL,uBAAO,EAAE;AAA1B,eAA1B;AACD;;AAEDF,gBAAI,CAAC,QAAQG,KAAK,CAACI,GAAf,CAAJ,CAAwBL,OAAxB,CAAgC7W,IAAhC,CAAqC8W,KAArC;AACD,WATD,EANgD,CAiBhD;;AACA,iBAAOH,IAAI,CAACQ,IAAZ,CAlBgD,CAoBhD;;AACA,cAAInqB,MAAM,GAAG,CAAb;AACAtD,gBAAM,CAAC+d,IAAP,CAAYkP,IAAZ,EAAkBthB,OAAlB,CAA0B,UAAU+hB,MAAV,EAAkB;AAC1CpqB,kBAAM,IAAI,CAAV;AAEA2pB,gBAAI,CAACS,MAAD,CAAJ,CAAaP,OAAb,CAAqBxhB,OAArB,CAA6B,UAAUyhB,KAAV,EAAiB;AAC5C9pB,oBAAM,IAAI,MAAM8pB,KAAK,CAACO,WAAN,GAAoB,CAApB,GAAwB1rB,IAAI,CAACsR,IAAL,CAAU6Z,KAAK,CAACO,WAAN,GAAoB,CAA9B,IAAmC,CAA3D,GAA+D,CAArE,CAAV;AACD,aAFD;AAIArqB,kBAAM,IAAI,CAAV;AACD,WARD;AAUA,eAAKsqB,MAAL,GAAc,IAAInd,UAAJ,CAAenN,MAAf,CAAd;AACA,eAAKsqB,MAAL,CAAY,CAAZ,IAAiB,KAAKA,MAAL,CAAY,CAAZ,IAAiB,CAAC,KAAKlB,UAAL,GAAkB,GAAlB,GAAwB,GAAzB,EAA8BnB,UAA9B,CAAyC,CAAzC,CAAlC;AACA,eAAKsC,YAAL,CAAkB,CAAlB,EAAqB,IAArB;AAEA,cAAIrc,MAAM,GAAG,CAAb;AACA,cAAIqM,IAAI,GAAG,IAAX;AACA,eAAKiQ,YAAL,CAAkB,CAAlB,EAAqBtc,MAArB;AAEAxR,gBAAM,CAAC+d,IAAP,CAAYkP,IAAZ,EAAkBthB,OAAlB,CAA0B,UAAU+hB,MAAV,EAAkB;AAC1CT,gBAAI,CAACS,MAAD,CAAJ,CAAaK,cAAb,GAA8Bvc,MAA9B;AAEA,gBAAIwc,SAAS,GAAGxc,MAAhB;AACA,gBAAIyc,OAAO,GAAKD,SAAS,GAAG,CAAZ,GAAgBf,IAAI,CAACS,MAAD,CAAJ,CAAaP,OAAb,CAAqB7pB,MAArB,GAA8B,EAA9C,GAAmD,CAAnE;AACAkO,kBAAM,GAAGyc,OAAT;AAEApQ,gBAAI,CAACgQ,YAAL,CAAkBG,SAAlB,EAA6Bf,IAAI,CAACS,MAAD,CAAJ,CAAaP,OAAb,CAAqB7pB,MAAlD;AAEA2pB,gBAAI,CAACS,MAAD,CAAJ,CAAaP,OAAb,CAAqBe,IAArB,CAA0B,UAAUrhB,CAAV,EAAamC,CAAb,EAAgB;AACxC;AACA,qBAAOnC,CAAC,CAACshB,GAAF,GAAQnf,CAAC,CAACmf,GAAjB;AACD,aAHD,EAGGxiB,OAHH,CAGW,UAAUyhB,KAAV,EAAiB3a,GAAjB,EAAsB;AAC/B,kBAAI2b,YAAY,GAAGJ,SAAS,GAAG,CAAZ,GAAgBvb,GAAG,GAAG,EAAzC;AAEAoL,kBAAI,CAACgQ,YAAL,CAAkBO,YAAlB,EAAgChB,KAAK,CAACe,GAAtC;AACAtQ,kBAAI,CAACgQ,YAAL,CAAkBO,YAAY,GAAG,CAAjC,EAAoChB,KAAK,CAACG,MAA1C;AACA1P,kBAAI,CAACiQ,YAAL,CAAkBM,YAAY,GAAG,CAAjC,EAAoChB,KAAK,CAACE,KAA1C;;AAEA,kBAAIF,KAAK,CAACC,cAAV,EAA0B;AACxB;AACA,oBAAIJ,IAAI,CAAC,QAAQG,KAAK,CAACe,GAAf,CAAR,EAA6BlB,IAAI,CAAC,QAAQG,KAAK,CAACe,GAAf,CAAJ,CAAwBE,WAAxB,GAAsCD,YAAY,GAAG,CAArD;AAC9B,eAHD,MAGO,IAAIhB,KAAK,CAACO,WAAN,IAAqB,CAAzB,EAA4B;AACjC9P,oBAAI,CAAC+P,MAAL,CAAYva,GAAZ,CACEwK,IAAI,CAACgC,KAAL,CAAWzM,QAAX,CAAoBga,KAAK,CAACkB,WAAN,GAAoBzQ,IAAI,CAAC0O,KAA7C,EAAoDa,KAAK,CAACkB,WAAN,GAAoBzQ,IAAI,CAAC0O,KAAzB,GAAiC,CAArF,CADF,EAEE6B,YAAY,GAAG,CAFjB;AAID,eALM,MAKA;AACLvQ,oBAAI,CAACiQ,YAAL,CAAkBM,YAAY,GAAG,CAAjC,EAAoC5c,MAApC;AACAqM,oBAAI,CAAC+P,MAAL,CAAYva,GAAZ,CACEwK,IAAI,CAACgC,KAAL,CAAWzM,QAAX,CAAoBga,KAAK,CAACkB,WAAN,GAAoBzQ,IAAI,CAAC0O,KAA7C,EAAoDa,KAAK,CAACkB,WAAN,GAAoBzQ,IAAI,CAAC0O,KAAzB,GAAiCa,KAAK,CAACO,WAA3F,CADF,EAEEnc,MAFF;AAIAA,sBAAM,IAAIvP,IAAI,CAACsR,IAAL,CAAU6Z,KAAK,CAACO,WAAN,GAAoB,CAA9B,IAAmC,CAA7C;AACD;AACF,aA1BD;AA4BA,gBAAIY,QAAQ,GAAGtB,IAAI,CAAC,SAASA,IAAI,CAACS,MAAD,CAAJ,CAAajmB,EAAb,GAAkB,CAA3B,CAAD,CAAnB;AACA,gBAAI8mB,QAAJ,EAAcA,QAAQ,CAACF,WAAT,GAAuBJ,OAAO,GAAG,CAAjC;AACf,WAvCD;AAyCAjuB,gBAAM,CAAC+d,IAAP,CAAYkP,IAAZ,EAAkBthB,OAAlB,CAA0B,UAAU+hB,MAAV,EAAkB;AAC1C,gBAAIT,IAAI,CAACS,MAAD,CAAJ,CAAaK,cAAb,IAA+Bd,IAAI,CAACS,MAAD,CAAJ,CAAaW,WAAhD,EAA6D;AAC3DxQ,kBAAI,CAACiQ,YAAL,CAAkBb,IAAI,CAACS,MAAD,CAAJ,CAAaW,WAA/B,EAA4CpB,IAAI,CAACS,MAAD,CAAJ,CAAaK,cAAzD;AACD;AACF,WAJD;AAMA,cAAI,KAAKH,MAAL,CAAYtqB,MAAZ,KAAuBkO,MAA3B,EAAmC,MAAM3V,KAAK,CAAC,iDAAD,CAAX;AAEnC,iBAAO,KAAK+xB,MAAZ;AACD,SA1FD;;AA6FAzB,kBAAU,CAAC7gB,SAAX,CAAqBkjB,WAArB,GAAmC,UAAUhd,MAAV,EAAkB;AACnD,cAAIid,CAAC,GAAG,KAAK5O,KAAb;AACA,cAAIrO,MAAM,GAAG,CAAT,GAAaid,CAAC,CAACnrB,MAAnB,EAA2B,MAAMzH,KAAK,CAAC,gBAAD,EAAmB,UAAnB,CAAX;AAE3B,iBAAO,KAAK6wB,UAAL,GACL+B,CAAC,CAACjd,MAAD,CAAD,GAAY,KAAZ,GAAoBid,CAAC,CAACjd,MAAM,GAAG,CAAV,CADhB,GAELid,CAAC,CAACjd,MAAD,CAAD,GAAYid,CAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAgB,KAF9B;AAGD,SAPD;;AAUA2a,kBAAU,CAAC7gB,SAAX,CAAqBwhB,WAArB,GAAmC,UAAUtb,MAAV,EAAkB;AACnD,cAAIid,CAAC,GAAG,KAAK5O,KAAb;AACA,cAAIrO,MAAM,GAAG,CAAT,GAAaid,CAAC,CAACnrB,MAAnB,EAA2B,MAAMzH,KAAK,CAAC,gBAAD,EAAmB,UAAnB,CAAX;AAE3B,iBAAO,KAAK6wB,UAAL,GACL+B,CAAC,CAACjd,MAAD,CAAD,GAAY,SAAZ,GAAwBid,CAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAgB,OAAxC,GAAkDid,CAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAgB,KAAlE,GAA0Eid,CAAC,CAACjd,MAAM,GAAG,CAAV,CADtE,GAELid,CAAC,CAACjd,MAAD,CAAD,GAAYid,CAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAgB,KAA5B,GAAoCid,CAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAgB,OAApD,GAA8Did,CAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAgB,SAFhF;AAGD,SAPD;;AAUA2a,kBAAU,CAAC7gB,SAAX,CAAqBuiB,YAArB,GAAoC,UAAUrc,MAAV,EAAkB/U,KAAlB,EAAyB;AAC3D,cAAIgyB,CAAC,GAAG,KAAKb,MAAb;;AAEA,cAAI,KAAKlB,UAAT,EAAqB;AACnB+B,aAAC,CAACjd,MAAD,CAAD,GAAiB/U,KAAK,KAAK,CAAX,GAAgB,IAAhC;AACAgyB,aAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAgB/U,KAAK,GAAG,IAAxB;AACD,WAHD,MAGO;AACLgyB,aAAC,CAACjd,MAAD,CAAD,GAAgB/U,KAAK,GAAG,IAAxB;AACAgyB,aAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAiB/U,KAAK,KAAK,CAAX,GAAgB,IAAhC;AACD;AACF,SAVD;;AAaA0vB,kBAAU,CAAC7gB,SAAX,CAAqBwiB,YAArB,GAAoC,UAAUtc,MAAV,EAAkB/U,KAAlB,EAAyB;AAC3D,cAAIgyB,CAAC,GAAG,KAAKb,MAAb;;AAEA,cAAI,KAAKlB,UAAT,EAAqB;AACnB+B,aAAC,CAACjd,MAAD,CAAD,GAAiB/U,KAAK,KAAK,EAAX,GAAiB,IAAjC;AACAgyB,aAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAiB/U,KAAK,KAAK,EAAX,GAAiB,IAAjC;AACAgyB,aAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAiB/U,KAAK,KAAK,CAAX,GAAgB,IAAhC;AACAgyB,aAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAgB/U,KAAK,GAAG,IAAxB;AACD,WALD,MAKO;AACLgyB,aAAC,CAACjd,MAAD,CAAD,GAAgB/U,KAAK,GAAG,IAAxB;AACAgyB,aAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAiB/U,KAAK,KAAK,CAAX,GAAgB,IAAhC;AACAgyB,aAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAiB/U,KAAK,KAAK,EAAX,GAAiB,IAAjC;AACAgyB,aAAC,CAACjd,MAAM,GAAG,CAAV,CAAD,GAAiB/U,KAAK,KAAK,EAAX,GAAiB,IAAjC;AACD;AACF,SAdD;;AAiBA0vB,kBAAU,CAAC7gB,SAAX,CAAqB+hB,cAArB,GAAsC,UAAUG,GAAV,EAAeW,GAAf,EAAoB;AACxD,iBAAQX,GAAG,KAAK,CAAR,IAAaW,GAAG,KAAK,MAAtB,IAAiC;AAChCX,aAAG,KAAK,CAAR,IAAaW,GAAG,KAAK,MADtB,IACiC;AAChCX,aAAG,KAAK,MAAR,IAAkBW,GAAG,KAAK,MAFlC,CADwD,CAGb;AAC5C,SAJD,CA5O4D,CAmP5D;AACA;;;AACAhC,kBAAU,CAAC7gB,SAAX,CAAqBojB,kBAArB,GAA0C,UAAUnB,MAAV,EAAkB;AAC1D,kBAAQA,MAAR;AACE,iBAAK,CAAL,CADF,CACU;;AACR,iBAAK,CAAL,CAFF,CAEU;;AACR,iBAAK,CAAL,CAHF,CAGU;;AACR,iBAAK,CAAL;AAAQ;AACN,qBAAO,CAAP;;AAEF,iBAAK,CAAL,CAPF,CAOU;;AACR,iBAAK,CAAL;AAAQ;AACN,qBAAO,CAAP;;AAEF,iBAAK,CAAL,CAXF,CAWW;;AACT,iBAAK,CAAL,CAZF,CAYW;;AACT,iBAAK,EAAL;AAAS;AACP,qBAAO,CAAP;;AAEF,iBAAK,CAAL,CAhBF,CAgBW;;AACT,iBAAK,EAAL,CAjBF,CAiBW;;AACT,iBAAK,EAAL;AAAS;AACP,qBAAO,CAAP;;AAEF;AACE;AACA,qBAAO,CAAP;AAvBJ;AAyBD,SA1BD,CArP4D,CAkR5D;AACA;;;AACApB,kBAAU,CAAC7gB,SAAX,CAAqBqjB,gBAArB,GAAwC,UAAUpB,MAAV,EAAkB/b,MAAlB,EAA0B;AAChE,cAAIod,CAAJ;;AAEA,kBAAQrB,MAAR;AACE,iBAAK,CAAL,CADF,CACU;;AACR,iBAAK,CAAL;AAAQ;AACNqB,eAAC,GAAG,KAAK/O,KAAL,CAAWrO,MAAX,CAAJ;AACA,qBAAOod,CAAP;;AAEF,iBAAK,CAAL;AAAQ;AACNA,eAAC,GAAG,KAAK/O,KAAL,CAAWrO,MAAX,CAAJ;AACA,qBAAOod,CAAC,GAAG,CAACA,CAAC,GAAG,IAAL,IAAa,SAAxB;;AAEF,iBAAK,CAAL;AAAQ;AACNA,eAAC,GAAG,KAAKJ,WAAL,CAAiBhd,MAAjB,CAAJ;AACA,qBAAOod,CAAP;;AAEF,iBAAK,CAAL;AAAQ;AACNA,eAAC,GAAG,KAAKJ,WAAL,CAAiBhd,MAAjB,CAAJ;AACA,qBAAOod,CAAC,GAAG,CAACA,CAAC,GAAG,MAAL,IAAe,OAA1B;;AAEF,iBAAK,CAAL;AAAQ;AACNA,eAAC,GAAG,KAAK9B,WAAL,CAAiBtb,MAAjB,CAAJ;AACA,qBAAOod,CAAP;;AAEF,iBAAK,CAAL;AAAQ;AACNA,eAAC,GAAG,KAAK9B,WAAL,CAAiBtb,MAAjB,CAAJ;AACA,qBAAOod,CAAC,GAAG,CAAX;;AAEF,iBAAK,CAAL,CA1BF,CA0BW;;AACT,iBAAK,EAAL,CA3BF,CA2BW;;AACT,iBAAK,EAAL,CA5BF,CA4BW;;AACT,iBAAK,EAAL;AAAS;AACP,qBAAO,IAAP;AAAa;;AAEf,iBAAK,CAAL;AAAQ;AACN,qBAAO,IAAP;AAAa;;AAEf;AACE;AACA,qBAAO,IAAP;AArCJ;AAuCD,SA1CD;;AA6CAzC,kBAAU,CAAC7gB,SAAX,CAAqB0hB,QAArB,GAAgC,UAAUU,MAAV,EAAkBlc,MAAlB,EAA0Bob,QAA1B,EAAoC;AAClE,cAAIiC,WAAW,GAAG,KAAKL,WAAL,CAAiBhd,MAAjB,CAAlB;AAEAA,gBAAM,IAAI,CAAV;;AAEA,eAAK,IAAI9E,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmiB,WAApB,EAAiCniB,CAAC,EAAlC,EAAsC;AACpC,gBAAIyhB,GAAG,GAAM,KAAKK,WAAL,CAAiBhd,MAAjB,CAAb;AACA,gBAAI+b,MAAM,GAAG,KAAKiB,WAAL,CAAiBhd,MAAM,GAAG,CAA1B,CAAb;AACA,gBAAI8b,KAAK,GAAI,KAAKR,WAAL,CAAiBtb,MAAM,GAAG,CAA1B,CAAb;AAEA,gBAAIsd,WAAW,GAAM,KAAKJ,kBAAL,CAAwBnB,MAAxB,CAArB;AACA,gBAAII,WAAW,GAAML,KAAK,GAAGwB,WAA7B;AACA,gBAAIR,WAAW,GAAMX,WAAW,IAAI,CAAf,GAAmBnc,MAAM,GAAG,CAA5B,GAAgC,KAAKsb,WAAL,CAAiBtb,MAAM,GAAG,CAA1B,CAArD;AACA,gBAAI6b,cAAc,GAAG,KAArB;;AAEA,gBAAIiB,WAAW,GAAGX,WAAd,GAA4B,KAAK9N,KAAL,CAAWvc,MAA3C,EAAmD;AACjD,oBAAMzH,KAAK,CAAC,gBAAD,EAAmB,UAAnB,CAAX;AACD;;AAED,gBAAIY,KAAK,GAAG,EAAZ;AACA,gBAAIsyB,WAAW,GAAGT,WAAlB;;AAEA,iBAAK,IAAIrS,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqR,KAApB,EAA2BrR,CAAC,IAAI8S,WAAW,IAAID,WAA/C,EAA4D;AAC1D,kBAAItnB,IAAI,GAAG,KAAKmnB,gBAAL,CAAsBpB,MAAtB,EAA8BwB,WAA9B,CAAX;;AACA,kBAAIvnB,IAAI,KAAK,IAAb,EAAmB;AACjB/K,qBAAK,GAAG,IAAR;AACA;AACD;;AACDA,mBAAK,CAAC6Z,IAAN,CAAW9O,IAAX;AACD;;AAED,gBAAI1D,KAAK,CAACyiB,OAAN,CAAc9pB,KAAd,KAAwB8wB,MAAM,KAAK,CAAvC,EAA0C;AACxC,kBAAI;AACF9wB,qBAAK,GAAGsvB,WAAW,CAAChJ,MAAM,CAACG,YAAP,CAAoBuJ,KAApB,CAA0B,IAA1B,EAAgChwB,KAAhC,CAAD,CAAnB;AACD,eAFD,CAEE,OAAO8K,CAAP,EAAU;AACV9K,qBAAK,GAAG,IAAR;AACD;;AAED,kBAAIA,KAAK,IAAIA,KAAK,CAACA,KAAK,CAAC6G,MAAN,GAAe,CAAhB,CAAL,KAA4B,IAAzC,EAA+C7G,KAAK,GAAGA,KAAK,CAACmpB,KAAN,CAAY,CAAZ,EAAe,CAAC,CAAhB,CAAR;AAChD;;AAED,gBAAI,KAAKyH,cAAL,CAAoBK,MAApB,EAA4BS,GAA5B,CAAJ,EAAsC;AACpC,kBAAIrqB,KAAK,CAACyiB,OAAN,CAAc9pB,KAAd,KAAwBuyB,MAAM,CAACC,SAAP,CAAiBxyB,KAAK,CAAC,CAAD,CAAtB,CAAxB,IAAsDA,KAAK,CAAC,CAAD,CAAL,GAAW,CAArE,EAAwE;AACtE,qBAAKswB,YAAL,CAAkBzW,IAAlB,CAAuB;AACrB7O,oBAAE,EAAM0mB,GADa;AAErB3c,wBAAM,EAAE/U,KAAK,CAAC,CAAD;AAFQ,iBAAvB;AAIA4wB,8BAAc,GAAG,IAAjB;AACD;AACF;;AAED,gBAAID,KAAK,GAAG;AACV8B,2BAAa,EAAG,KAAKxC,UADX;AAEVc,iBAAG,EAAaE,MAFN;AAGVS,iBAAG,EAAaA,GAHN;AAIVZ,oBAAM,EAAUA,MAJN;AAKVD,mBAAK,EAAWA,KALN;AAMVc,0BAAY,EAAI5c,MAAM,GAAG,KAAK+a,KANpB;AAOVoB,yBAAW,EAAKA,WAPN;AAQVW,yBAAW,EAAKA,WAAW,GAAG,KAAK/B,KARzB;AASV9vB,mBAAK,EAAWA,KATN;AAUV4wB,4BAAc,EAAEA;AAVN,aAAZ;;AAaA,gBAAIT,QAAQ,CAACQ,KAAD,CAAR,KAAoB,KAAxB,EAA+B;AAC7B,mBAAKP,OAAL,GAAe,IAAf;AACA;AACD;;AAEDrb,kBAAM,IAAI,EAAV;AACD;;AAED,cAAIkc,MAAM,KAAK,CAAf,EAAkB;AAChB,iBAAKX,YAAL,CAAkBzW,IAAlB,CAAuB;AACrB7O,gBAAE,EAAM,CADa;AAErB+J,oBAAM,EAAE,KAAKsb,WAAL,CAAiBtb,MAAjB;AAFa,aAAvB;AAID;AACF,SA9ED,CAjU4D,CAkZ5D;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAtF,cAAM,CAACtG,OAAP,CAAeupB,OAAf,GAAyB,UAAU/C,QAAV,EAAoB;AAC3C,iBAAOA,QAAQ,CAAC9oB,MAAT,IAAmB,CAAnB,IAAwB8oB,QAAQ,CAAC,CAAD,CAAR,KAAgB,IAAxC,IAAgDA,QAAQ,CAAC,CAAD,CAAR,KAAgB,IAAhE,IAAwEA,QAAQ,CAAC,CAAD,CAAR,KAAgB,IAA/F;AACD,SAFD,CAzZ4D,CA8Z5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAlgB,cAAM,CAACtG,OAAP,CAAewpB,kBAAf,GAAoC,UAAUhD,QAAV,EAAoBiD,UAApB,EAAgC;AAClE,cAAI,CAACnD,aAAa,CAACE,QAAD,CAAlB,EAA8B;AAC5B,kBAAMvwB,KAAK,CAAC,kDAAD,EAAqD,QAArD,CAAX;AACD;;AAED,cAAI,OAAOwzB,UAAP,KAAsB,UAA1B,EAAsC;AACpC,kBAAMxzB,KAAK,CAAC,kDAAD,EAAqD,QAArD,CAAX;AACD;;AAED,cAAI,CAACqQ,MAAM,CAACtG,OAAP,CAAeupB,OAAf,CAAuB/C,QAAvB,CAAL,EAAuC;AACrC,kBAAMvwB,KAAK,CAAC,qBAAD,EAAwB,UAAxB,CAAX;AACD;;AAED,cAAI2V,MAAM,GAAG,CAAb;AAAA,cAAgBlO,MAAM,GAAG8oB,QAAQ,CAAC9oB,MAAlC;AAAA,cAA0CgsB,WAAW,GAAG,KAAxD;;AAEA,mBAAS;AACP,gBAAIC,YAAJ,EAAkBC,cAAlB;AAEA,gBAAIhe,MAAM,GAAG,CAAT,IAAclO,MAAlB,EAA0B,MAAMzH,KAAK,CAAC,gBAAD,EAAmB,UAAnB,CAAX;AAC1B,gBAAI4zB,KAAK,GAAGrD,QAAQ,CAAC5a,MAAD,CAApB;AACA,gBAAIke,KAAK,GAAGtD,QAAQ,CAAC5a,MAAM,GAAG,CAAV,CAApB;;AAEA,gBAAIie,KAAK,KAAK,IAAV,IAAkBC,KAAK,KAAK,IAAhC,EAAsC;AACpC;AACAH,0BAAY,GAAG,IAAf;AACAC,4BAAc,GAAG,CAAjB;AAED,aALD,MAKO,IAAIC,KAAK,KAAK,IAAV,IAAkBC,KAAK,KAAK,CAAhC,EAAmC;AACxC;AACAH,0BAAY,GAAGG,KAAf;AACAF,4BAAc,GAAG,CAAjB;AAEA,kBAAK,QAAQD,YAAR,IAAwBA,YAAY,IAAI,IAAzC,IAAkDA,YAAY,KAAK,IAAvE,EAA6E,CAA7E,KAAoF;AAClF,oBAAI/d,MAAM,GAAG,CAAT,IAAclO,MAAlB,EAA0B,MAAMzH,KAAK,CAAC,gBAAD,EAAmB,UAAnB,CAAX;AAC1B2zB,8BAAc,IAAIpD,QAAQ,CAAC5a,MAAM,GAAG,CAAV,CAAR,GAAuB,KAAvB,GAA+B4a,QAAQ,CAAC5a,MAAM,GAAG,CAAV,CAAzD;AACA,oBAAIge,cAAc,GAAG,CAArB,EAAwB,MAAM3zB,KAAK,CAAC,wBAAD,EAA2B,UAA3B,CAAX;AACxB,oBAAI2V,MAAM,GAAGge,cAAT,GAA0B,CAA1B,IAA+BlsB,MAAnC,EAA2C,MAAMzH,KAAK,CAAC,gBAAD,EAAmB,UAAnB,CAAX;AAC5C;;AAED,kBAAIyzB,WAAJ,EAAiB;AACf,oBAAIC,YAAY,IAAI,IAAhB,IAAwBA,YAAY,IAAI,IAA5C,EAAkD,CAAlD,KAAyD;AACvDD,6BAAW,GAAG,KAAd;AACD;AACF;;AAED,kBAAIC,YAAY,KAAK;AAAK;AAA1B,gBAAqCD,WAAW,GAAG,IAAd;AACtC,aAnBM,MAmBA,IAAIA,WAAJ,EAAiB;AACtB;AACA,mBAAK,IAAIK,GAAG,GAAGne,MAAM,GAAG,CAAxB,GAA6Bme,GAAG,EAAhC,EAAoC;AAClC;AACA,oBAAIA,GAAG,IAAIrsB,MAAX,EAAmB,MAAMzH,KAAK,CAAC,gBAAD,EAAmB,UAAnB,CAAX;;AACnB,oBAAIuwB,QAAQ,CAACuD,GAAD,CAAR,KAAkB,IAAtB,EAA4B;AAC1B,sBAAIA,GAAG,GAAG,CAAN,IAAWrsB,MAAf,EAAuB,MAAMzH,KAAK,CAAC,gBAAD,EAAmB,UAAnB,CAAX;;AACvB,sBAAIuwB,QAAQ,CAACuD,GAAG,GAAG,CAAP,CAAR,KAAsB,CAA1B,EAA6B;AAC3BJ,gCAAY,GAAG,CAAf;AACAC,kCAAc,GAAGG,GAAG,GAAGne,MAAvB;AACA;AACD;AACF;AACF;AACF,aAdM,MAcA;AACL,oBAAM3V,KAAK,CAAC,uCAAuC6vB,MAAM,CAAC+D,KAAD,CAA7C,GACV,WADU,GACI/D,MAAM,CAACla,MAAD,CADV,GACqB,GADtB,EAC2B,UAD3B,CAAX;AAED;;AAED,gBAAI6d,UAAU,CAAC;AAAEviB,kBAAI,EAAEyiB,YAAR;AAAsB/d,oBAAM,EAAEA,MAA9B;AAAsClO,oBAAM,EAAEksB;AAA9C,aAAD,CAAV,KAA+E,KAAnF,EAA0F;AAC1F,gBAAID,YAAY,KAAK;AAAK;AAA1B,cAAqC;AACrC/d,kBAAM,IAAIge,cAAV;AACD;AACF,SArED,CA7a4D,CAqf5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAtjB,cAAM,CAACtG,OAAP,CAAegqB,oBAAf,GAAsC,UAAUxD,QAAV,EAAoBiD,UAApB,EAAgC;AACpE,cAAI,CAACnD,aAAa,CAACE,QAAD,CAAlB,EAA8B;AAC5B,kBAAMvwB,KAAK,CAAC,kDAAD,EAAqD,QAArD,CAAX;AACD;;AAED,cAAI,OAAOwzB,UAAP,KAAsB,UAA1B,EAAsC;AACpC,kBAAMxzB,KAAK,CAAC,kDAAD,EAAqD,QAArD,CAAX;AACD;;AAED,cAAIg0B,MAAM,GAAG,EAAb;AACA,cAAIC,UAAU,GAAG,CAAjB;AAEA5jB,gBAAM,CAACtG,OAAP,CAAewpB,kBAAf,CAAkChD,QAAlC,EAA4C,UAAU2D,OAAV,EAAmB;AAC7D,gBAAIC,WAAW,GAAGX,UAAU,CAACU,OAAD,CAA5B;;AAEA,gBAAI7D,aAAa,CAAC8D,WAAD,CAAjB,EAAgC;AAC9BH,oBAAM,CAACvZ,IAAP,CAAY;AAAEhC,oBAAI,EAAE0b;AAAR,eAAZ;AACAF,wBAAU,IAAIE,WAAW,CAAC1sB,MAA1B;AACD,aAHD,MAGO,IAAIQ,KAAK,CAACyiB,OAAN,CAAcyJ,WAAd,CAAJ,EAAgC;AACrCA,yBAAW,CAACte,MAAZ,CAAmBwa,aAAnB,EAAkCvgB,OAAlC,CAA0C,UAAUR,CAAV,EAAa;AACrD0kB,sBAAM,CAACvZ,IAAP,CAAY;AAAEhC,sBAAI,EAAEnJ;AAAR,iBAAZ;AACA2kB,0BAAU,IAAI3kB,CAAC,CAAC7H,MAAhB;AACD,eAHD;AAID,aALM,MAKA,IAAI0sB,WAAW,KAAK,KAApB,EAA2B;AAChC,kBAAIC,SAAS,GAAG;AAAE1D,qBAAK,EAAEwD,OAAO,CAACve,MAAjB;AAAyB0e,mBAAG,EAAEH,OAAO,CAACve,MAAR,GAAiBue,OAAO,CAACzsB;AAAvD,eAAhB;;AAEA,kBAAIusB,MAAM,CAACvsB,MAAP,GAAgB,CAAhB,IAAqBusB,MAAM,CAACA,MAAM,CAACvsB,MAAP,GAAgB,CAAjB,CAAN,CAA0B4sB,GAA1B,KAAkCD,SAAS,CAAC1D,KAArE,EAA4E;AAC1EsD,sBAAM,CAACA,MAAM,CAACvsB,MAAP,GAAgB,CAAjB,CAAN,CAA0B4sB,GAA1B,GAAgCD,SAAS,CAACC,GAA1C;AACD,eAFD,MAEO;AACLL,sBAAM,CAACvZ,IAAP,CAAY2Z,SAAZ;AACD;;AAEDH,wBAAU,IAAIC,OAAO,CAACzsB,MAAtB;AACD;AACF,WAtBD;AAwBA,cAAI0K,MAAM,GAAG,IAAIyC,UAAJ,CAAeqf,UAAf,CAAb;AACA,cAAIte,MAAM,GAAG,CAAb;AAEAqe,gBAAM,CAAClkB,OAAP,CAAe,UAAUwkB,KAAV,EAAiB;AAC9B,gBAAI7b,IAAI,GAAG6b,KAAK,CAAC7b,IAAN,IAAc8X,QAAQ,CAAChZ,QAAT,CAAkB+c,KAAK,CAAC5D,KAAxB,EAA+B4D,KAAK,CAACD,GAArC,CAAzB;AACAliB,kBAAM,CAACqF,GAAP,CAAWiB,IAAX,EAAiB9C,MAAjB;AACAA,kBAAM,IAAI8C,IAAI,CAAChR,MAAf;AACD,WAJD;AAMA,iBAAO0K,MAAP;AACD,SA9CD,CAzgB4D,CA0jB5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA9B,cAAM,CAACtG,OAAP,CAAewqB,mBAAf,GAAqC,UAAUhE,QAAV,EAAoBiE,aAApB,EAAmC;AACtE,cAAI,CAACnE,aAAa,CAACE,QAAD,CAAlB,EAA8B;AAC5B,kBAAMvwB,KAAK,CAAC,kDAAD,EAAqD,QAArD,CAAX;AACD;;AAED,cAAI,OAAOw0B,aAAP,KAAyB,UAA7B,EAAyC;AACvC,kBAAMx0B,KAAK,CAAC,qDAAD,EAAwD,QAAxD,CAAX;AACD;AAED;;;AACAqQ,gBAAM,CAACtG,OAAP,CAAewpB,kBAAf,CAAkChD,QAAlC,EAA4C,UAAU2D,OAAV,EAAmB;AAC7D,gBAAIA,OAAO,CAACjjB,IAAR,KAAiB;AAAK;AAA1B,cAAqC,OAAO,KAAP,CADwB,CAG7D;;AACA,gBAAIijB,OAAO,CAACjjB,IAAR,KAAiB,IAAjB,IAAyBijB,OAAO,CAACzsB,MAAR,IAAkB,EAA3C,IACA8oB,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IADjC,IACyC4a,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IAD1E,IAEA4a,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IAFjC,IAEyC4a,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IAF1E,IAGA4a,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IAHjC,IAGyC4a,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IAH9E,EAGoF;AAElF,kBAAI2a,UAAJ,CAAeC,QAAf,EAAyB2D,OAAO,CAACve,MAAR,GAAiB,EAA1C,EAA8Cue,OAAO,CAACve,MAAR,GAAiBue,OAAO,CAACzsB,MAAvE,EAA+EqpB,IAA/E,CAAoF0D,aAApF;AACA,qBAAO,KAAP;AACD;AACF,WAZD;AAaD,SAvBD,CAllB4D,CA4mB5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAnkB,cAAM,CAACtG,OAAP,CAAe0qB,qBAAf,GAAuC,UAAUlE,QAAV,EAAoBiE,aAApB,EAAmC;AACxE,cAAI,CAACnE,aAAa,CAACE,QAAD,CAAlB,EAA8B;AAC5B,kBAAMvwB,KAAK,CAAC,kDAAD,EAAqD,QAArD,CAAX;AACD;;AAED,cAAI,OAAOw0B,aAAP,KAAyB,UAA7B,EAAyC;AACvC,kBAAMx0B,KAAK,CAAC,qDAAD,EAAwD,QAAxD,CAAX;AACD;;AAED,cAAI00B,WAAW,GAAG,KAAlB;AAEA,iBAAOrkB,MAAM,CAACtG,OAAP,CAAegqB,oBAAf,CAAoCxD,QAApC,EAA8C,UAAU2D,OAAV,EAAmB;AACtE,gBAAIQ,WAAJ,EAAiB;AACjB,gBAAIR,OAAO,CAACjjB,IAAR,KAAiB;AAAK;AAA1B,cAAqCyjB,WAAW,GAAG,IAAd,CAFiC,CAItE;;AACA,gBAAIR,OAAO,CAACjjB,IAAR,KAAiB,IAAjB,IAAyBijB,OAAO,CAACzsB,MAAR,IAAkB,EAA3C,IACA8oB,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IADjC,IACyC4a,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IAD1E,IAEA4a,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IAFjC,IAEyC4a,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IAF1E,IAGA4a,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IAHjC,IAGyC4a,QAAQ,CAAC2D,OAAO,CAACve,MAAR,GAAiB,CAAlB,CAAR,KAAiC,IAH9E,EAGoF;AAElF,kBAAIgf,QAAQ,GAAG,IAAIrE,UAAJ,CAAeC,QAAf,EAAyB2D,OAAO,CAACve,MAAR,GAAiB,EAA1C,EAA8Cue,OAAO,CAACve,MAAR,GAAiBue,OAAO,CAACzsB,MAAvE,EACZoO,MADY,CACL2e,aADK,CAAf;AAEA,kBAAI,CAACG,QAAL,EAAe,OAAO,KAAP;AAEf,kBAAIC,MAAM,GAAG,IAAIhgB,UAAJ,CAAe,EAAf,CAAb;AAEAggB,oBAAM,CAACpd,GAAP,CAAW+Y,QAAQ,CAACxG,KAAT,CAAemK,OAAO,CAACve,MAAvB,EAA+Bue,OAAO,CAACve,MAAR,GAAiB,EAAhD,CAAX;AACAif,oBAAM,CAAC,CAAD,CAAN,GAAcD,QAAQ,CAACltB,MAAT,GAAkB,CAAnB,KAA0B,CAA3B,GAAgC,IAA5C;AACAmtB,oBAAM,CAAC,CAAD,CAAN,GAAaD,QAAQ,CAACltB,MAAT,GAAkB,CAAnB,GAAwB,IAApC;AAEAitB,yBAAW,GAAG,IAAd;AACA,qBAAO,CAAEE,MAAF,EAAUD,QAAV,CAAP;AACD;AACF,WAvBM,CAAP;AAwBD,SAnCD,CA3oB4D,CAirB5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAtkB,cAAM,CAACtG,OAAP,CAAe8qB,gBAAf,GAAkC,UAAUtE,QAAV,EAAoBuE,OAApB,EAA6B;AAC7D,cAAIC,gBAAgB,GAAG,KAAvB;AAAA,cAA8BC,aAAa,GAAG,CAA9C;AAEA,iBAAO3kB,MAAM,CAACtG,OAAP,CAAegqB,oBAAf,CAAoCxD,QAApC,EAA8C,UAAU2D,OAAV,EAAmB;AACtEc,yBAAa;AACb,gBAAIA,aAAa,KAAK,CAAlB,IAAuBd,OAAO,CAACjjB,IAAR,KAAiB;AAAK;AAAjD,cAA6D;AAC7D,gBAAI+jB,aAAa,KAAK,CAAlB,IAAuBd,OAAO,CAACjjB,IAAR,KAAiB;AAAK;AAAjD,cAA6D;AAE7D,gBAAI8jB,gBAAJ,EAAsB;AACtBD,mBAAO,GAAG/E,WAAW,CAAC+E,OAAD,CAArB,CANsE,CAQtE;;AACA,gBAAIG,QAAQ,GAAG,IAAIrgB,UAAJ,CAAe,IAAIkgB,OAAO,CAACrtB,MAA3B,CAAf;AACA,gBAAIkO,MAAM,GAAG,CAAb;AAEAsf,oBAAQ,CAACtf,MAAM,EAAP,CAAR,GAAqB,IAArB;AACAsf,oBAAQ,CAACtf,MAAM,EAAP,CAAR,GAAqB,IAArB;AACAsf,oBAAQ,CAACtf,MAAM,EAAP,CAAR,GAAuBmf,OAAO,CAACrtB,MAAR,GAAiB,CAAlB,KAAyB,CAA1B,GAA+B,IAApD;AACAwtB,oBAAQ,CAACtf,MAAM,EAAP,CAAR,GAAsBmf,OAAO,CAACrtB,MAAR,GAAiB,CAAlB,GAAuB,IAA5C;AAEAqtB,mBAAO,CAACrN,KAAR,CAAc,EAAd,EAAkB3X,OAAlB,CAA0B,UAAUgB,CAAV,EAAa;AACrCmkB,sBAAQ,CAACtf,MAAM,EAAP,CAAR,GAAqB7E,CAAC,CAAC4e,UAAF,CAAa,CAAb,IAAkB,IAAvC;AACD,aAFD;AAIAuF,oBAAQ,CAACtf,MAAM,EAAP,CAAR,GAAqB,CAArB;AACAof,4BAAgB,GAAG,IAAnB;AAEA,mBAAO,CAAEE,QAAF,EAAY1E,QAAQ,CAAChZ,QAAT,CAAkB2c,OAAO,CAACve,MAA1B,EAAkCue,OAAO,CAACve,MAAR,GAAiBue,OAAO,CAACzsB,MAA3D,CAAZ,CAAP;AACD,WAzBM,CAAP;AA0BD,SA7BD;AA8BC,OA1tBwC,CAAzC;;AA4tBA,eAASytB,eAAT,CAAyBzR,GAAzB,EAA8B;AAC5B,eAAO,KAAK0R,cAAL,CAAoB1R,GAAG,CAACxZ,IAAxB,EAA8BvE,IAA9B,CAAmC,UAAU+S,IAAV,EAAgB;AACxDgL,aAAG,CAAC6P,OAAJ,GAAc3D,cAAc,CAAC2D,OAAf,CAAuB7a,IAAvB,CAAd;AAEA,cAAI,CAACgL,GAAG,CAAC6P,OAAT,EAAkB,OAAO5zB,OAAO,CAACC,OAAR,CAAgB8jB,GAAhB,CAAP;AAElBA,aAAG,CAAC2R,SAAJ,GAAgB3R,GAAG,CAACxZ,IAApB;;AAEA,cAAI;AACF,gBAAIorB,kBAAJ,EAAwBC,kBAAxB;AAEA;;AACA3F,0BAAc,CAAC4E,mBAAf,CAAmC9b,IAAnC,EAAyC,UAAU8Y,KAAV,EAAiB;AACxD,kBAAIA,KAAK,CAACI,GAAN,KAAc,CAAd,IAAmBJ,KAAK,CAACe,GAAN,KAAc,KAAjC,IAA0CrqB,KAAK,CAACyiB,OAAN,CAAc6G,KAAK,CAAC3wB,KAApB,CAA9C,EAA0E;AACxE6iB,mBAAG,CAAC8R,WAAJ,GAAqBhE,KAAK,CAAC3wB,KAAN,CAAY,CAAZ,KAAkB,CAAvC;AACAy0B,kCAAkB,GAAG9D,KAAK,CAACV,UAA3B;AACAyE,kCAAkB,GAAG/D,KAAK,CAACkB,WAA3B;AACA,uBAAO,KAAP;AACD;AACF,aAPD;;AASA,gBAAI6C,kBAAJ,EAAwB;AACtB,kBAAIE,iBAAiB,GAAGH,kBAAkB,GACxC,IAAIzgB,UAAJ,CAAe,CAAE,CAAF,EAAK,CAAL,CAAf,CADwC,GAExC,IAAIA,UAAJ,CAAe,CAAE,CAAF,EAAK,CAAL,CAAf,CAFF;AAIA6O,iBAAG,CAACxZ,IAAJ,GAAW,IAAI+e,IAAJ,CAAS,CAClBvQ,IAAI,CAACsR,KAAL,CAAW,CAAX,EAAcuL,kBAAd,CADkB,EAElBE,iBAFkB,EAGlB/c,IAAI,CAACsR,KAAL,CAAWuL,kBAAkB,GAAG,CAAhC,CAHkB,CAAT,EAIR;AAAExvB,oBAAI,EAAE;AAAR,eAJQ,CAAX;AAKD;AACF,WAxBD,CAwBE,OAAO4F,CAAP,EAAU,CAAE;;AAEd,iBAAO+X,GAAP;AACD,SAlCM,CAAP;AAmCD;;AAGD,eAASgS,kBAAT,CAA4BhS,GAA5B,EAAiC;AAC/B,YAAI,CAACA,GAAG,CAAC6P,OAAT,EAAkB,OAAO5zB,OAAO,CAACC,OAAR,CAAgB8jB,GAAhB,CAAP;AAElB,YAAI8R,WAAW,GAAG9R,GAAG,CAAC8R,WAAJ,GAAkB,CAApC;AACA,YAAI,CAACA,WAAL,EAAkB,OAAO71B,OAAO,CAACC,OAAR,CAAgB8jB,GAAhB,CAAP;AAElB,YAAI0L,MAAJ;;AAEA,YAAIoG,WAAW,GAAG,CAAlB,EAAqB;AACnBpG,gBAAM,GAAG,KAAK3e,IAAL,CAAUpN,OAAV,CAAkB0a,YAAlB,CAA+B2F,GAAG,CAACiS,UAAJ,CAAethB,MAA9C,EAAsDqP,GAAG,CAACiS,UAAJ,CAAevhB,KAArE,CAAT;AACD,SAFD,MAEO;AACLgb,gBAAM,GAAG,KAAK3e,IAAL,CAAUpN,OAAV,CAAkB0a,YAAlB,CAA+B2F,GAAG,CAACiS,UAAJ,CAAevhB,KAA9C,EAAqDsP,GAAG,CAACiS,UAAJ,CAAethB,MAApE,CAAT;AACD;;AAED,YAAIrN,GAAG,GAAGooB,MAAM,CAAChC,UAAP,CAAkB,IAAlB,CAAV;AAEApmB,WAAG,CAAC4uB,IAAJ;AAEA,YAAIJ,WAAW,GAAG,CAAlB,EAAqBxuB,GAAG,CAAC6uB,SAAJ,CAAc,CAAC,CAAf,EAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,EAA2BzG,MAAM,CAAChb,KAAlC,EAAyC,CAAzC;AACrB,YAAIohB,WAAW,GAAG,CAAlB,EAAqBxuB,GAAG,CAAC6uB,SAAJ,CAAc,CAAC,CAAf,EAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAC,CAAzB,EAA4BzG,MAAM,CAAChb,KAAnC,EAA0Cgb,MAAM,CAAC/a,MAAjD;AACrB,YAAImhB,WAAW,GAAG,CAAlB,EAAqBxuB,GAAG,CAAC6uB,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B;AAErB7uB,WAAG,CAACumB,SAAJ,CAAc7J,GAAG,CAACiS,UAAlB,EAA8B,CAA9B,EAAiC,CAAjC;AACA3uB,WAAG,CAAC8uB,OAAJ,GAvB+B,CAyB/B;AACA;;AACApS,WAAG,CAACiS,UAAJ,CAAevhB,KAAf,GAAuBsP,GAAG,CAACiS,UAAJ,CAAethB,MAAf,GAAwB,CAA/C;AAEAqP,WAAG,CAACiS,UAAJ,GAAiBvG,MAAjB;AAEA,eAAOzvB,OAAO,CAACC,OAAR,CAAgB8jB,GAAhB,CAAP;AACD;;AAGD,eAASqS,yBAAT,CAAmCrS,GAAnC,EAAwC;AACtC,YAAI,CAACA,GAAG,CAAC6P,OAAT,EAAkB,OAAO5zB,OAAO,CAACC,OAAR,CAAgB8jB,GAAhB,CAAP;AAElB,eAAO/jB,OAAO,CAACuiB,GAAR,CAAY,CACjB,KAAKkT,cAAL,CAAoB1R,GAAG,CAACxZ,IAAxB,CADiB,EAEjB,KAAKkrB,cAAL,CAAoB1R,GAAG,CAACsS,QAAxB,CAFiB,CAAZ,EAGJrwB,IAHI,CAGC,UAAUspB,GAAV,EAAe;AACrB,cAAIvW,IAAI,GAAGuW,GAAG,CAAC,CAAD,CAAd;AACA,cAAIgH,QAAQ,GAAGhH,GAAG,CAAC,CAAD,CAAlB;AAEA,cAAIW,cAAc,CAAC2D,OAAf,CAAuB0C,QAAvB,CAAJ,EAAsC,OAAOt2B,OAAO,CAACC,OAAR,CAAgB8jB,GAAhB,CAAP;AAEtC,cAAIwS,QAAQ,GAAG,EAAf;AAEAtG,wBAAc,CAAC4D,kBAAf,CAAkC9a,IAAlC,EAAwC,UAAUyb,OAAV,EAAmB;AACzD,gBAAIA,OAAO,CAACjjB,IAAR,KAAiB;AAAK;AAA1B,cAAqC,OAAO,KAAP;AACrCglB,oBAAQ,CAACxb,IAAT,CAAcyZ,OAAd;AACD,WAHD;AAKA+B,kBAAQ,GAAGA,QAAQ,CAChBpgB,MADQ,CACD,UAAUqe,OAAV,EAAmB;AACzB,gBAAIA,OAAO,CAACjjB,IAAR,KAAiB,IAArB,EAA2B;AACzB,kBAAIilB,GAAG,GAAGzd,IAAI,CAACsR,KAAL,CAAWmK,OAAO,CAACve,MAAR,GAAiB,CAA5B,EAA+Bue,OAAO,CAACve,MAAR,GAAiB,EAAhD,CAAV;;AACA,kBAAIuR,MAAM,CAACG,YAAP,CAAoBuJ,KAApB,CAA0BsF,GAA1B,MAAmC,aAAvC,EAAsD;AACpD,uBAAO,KAAP;AACD;AACF,aANwB,CAQzB;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,gBAAIhC,OAAO,CAACjjB,IAAR,IAAgB,IAAhB,IAAwBijB,OAAO,CAACjjB,IAAR,GAAe,IAA3C,EAAiD,OAAO,IAAP,CAfxB,CAiBzB;AACA;;AACA,gBAAIijB,OAAO,CAACjjB,IAAR,KAAiB,IAArB,EAA2B,OAAO,IAAP;AAE3B,mBAAO,KAAP;AACD,WAvBQ,EAwBRkR,GAxBQ,CAwBJ,UAAU+R,OAAV,EAAmB;AACtB,mBAAOzb,IAAI,CAACsR,KAAL,CAAWmK,OAAO,CAACve,MAAnB,EAA2Bue,OAAO,CAACve,MAAR,GAAiBue,OAAO,CAACzsB,MAApD,CAAP;AACD,WA1BQ,CAAX;AA4BAgc,aAAG,CAACxZ,IAAJ,GAAW,IAAI+e,IAAJ,CACT,CAAEvQ,IAAI,CAACsR,KAAL,CAAW,CAAX,EAAc,EAAd,CAAF,EAAsB6B,MAAtB,CAA6BqK,QAA7B,EAAuCrK,MAAvC,CAA8C,CAAEnT,IAAI,CAACsR,KAAL,CAAW,EAAX,CAAF,CAA9C,CADS,EAET;AAAEjkB,gBAAI,EAAE;AAAR,WAFS,CAAX;AAKA,iBAAO2d,GAAP;AACD,SAlDM,CAAP;AAmDD;;AAGD,eAAS0S,QAAT,CAAkBC,OAAlB,EAA2B;AACzBA,eAAO,CAACC,MAAR,CAAe,gBAAf,EAAiCnB,eAAjC;AACAkB,eAAO,CAACE,KAAR,CAAc,YAAd,EAAiCb,kBAAjC;AACAW,eAAO,CAACE,KAAR,CAAc,cAAd,EAAiCR,yBAAjC;AACD;;AAGD,UAAIS,iBAAiB,GAAGrB,eAAxB;AACA,UAAIsB,oBAAoB,GAAGf,kBAA3B;AACA,UAAIgB,2BAA2B,GAAGX,yBAAlC;AACA,UAAIY,QAAQ,GAAGP,QAAf;AAEA,UAAIQ,YAAY,GAAG;AAClBzB,uBAAe,EAAEqB,iBADC;AAElBd,0BAAkB,EAAEe,oBAFF;AAGlBV,iCAAyB,EAAEW,2BAHT;AAIlBryB,cAAM,EAAEsyB;AAJU,OAAnB;;AAOA,eAASE,eAAT,CAAyBxzB,OAAzB,EAAkC;AAChC,YAAI,EAAE,gBAAgBwzB,eAAlB,CAAJ,EAAwC,OAAO,IAAIA,eAAJ,CAAoBxzB,OAApB,CAAP;AAExCA,eAAO,GAAGA,OAAO,IAAI,EAArB;AAEA,aAAKoN,IAAL,GAAYpN,OAAO,CAACoN,IAAR,IAAgBA,IAAI,CAAC,EAAD,CAAhC;AACA,aAAKqmB,WAAL,GAAmB,KAAnB;AAEA,aAAK3mB,KAAL,GAAaA,KAAb;AACD;;AAGD0mB,qBAAe,CAACnnB,SAAhB,CAA0BuC,GAA1B,GAAgC,UAAU8kB;AAAO;AAAjB,QAAqC;AACnE,YAAIC,IAAI,GAAG,CAAE,IAAF,EAASnL,MAAT,CAAgB3jB,KAAK,CAACwH,SAAN,CAAgBsa,KAAhB,CAAsBpa,IAAtB,CAA2BJ,SAA3B,EAAsC,CAAtC,CAAhB,CAAX;AACAunB,cAAM,CAAClG,KAAP,CAAakG,MAAb,EAAqBC,IAArB;AACA,eAAO,IAAP;AACD,OAJD;;AAOAH,qBAAe,CAACnnB,SAAhB,CAA0BsS,IAA1B,GAAiC,YAAY;AAC3C,aAAK/P,GAAL,CAAS2kB,YAAY,CAACvyB,MAAtB;AACD,OAFD;;AAKAwyB,qBAAe,CAACnnB,SAAhB,CAA0Byf,MAA1B,GAAmC,UAAUjlB,IAAV,EAAgB7G,OAAhB,EAAyB;AAC1D,YAAIqb,IAAI,GAAGvO,KAAK,CAAC9L,MAAN,CAAa;AAAEqT,aAAG,EAAEuf;AAAP,SAAb,EAAgC5zB,OAAhC,CAAX;AACA,YAAIqgB,GAAG,GAAG;AACRxZ,cAAI,EAAEA,IADE;AAERwU,cAAI,EAAEA;AAFE,SAAV;;AAKA,YAAI,CAAC,KAAKoY,WAAV,EAAuB;AACrB,eAAK9U,IAAL;AACA,eAAK8U,WAAL,GAAmB,IAAnB;AACD;;AAED,eAAOn3B,OAAO,CAACC,OAAR,CAAgB8jB,GAAhB,EACJ/d,IADI,CACC,KAAKuxB,cADN,EAEJvxB,IAFI,CAEC,KAAKwxB,eAFN,EAGJxxB,IAHI,CAGC,KAAKyxB,UAHN,EAIJzxB,IAJI,CAIC,KAAK0xB,QAJN,EAKJ1xB,IALI,CAKC,KAAK2xB,YALN,EAMJ3xB,IANI,CAMC,UAAU4xB,IAAV,EAAgB;AACpB;AACA;AACAA,cAAI,CAAC5B,UAAL,CAAgBvhB,KAAhB,GAAwBmjB,IAAI,CAAC5B,UAAL,CAAgBthB,MAAhB,GAAyB,CAAjD;AAEA,iBAAOkjB,IAAI,CAACvB,QAAZ;AACD,SAZI,CAAP;AAaD,OAzBD;;AA4BAa,qBAAe,CAACnnB,SAAhB,CAA0B8nB,QAA1B,GAAqC,UAAUttB,IAAV,EAAgB7G,OAAhB,EAAyB;AAC5D,YAAIqb,IAAI,GAAGvO,KAAK,CAAC9L,MAAN,CAAa;AAAEqT,aAAG,EAAEuf;AAAP,SAAb,EAAgC5zB,OAAhC,CAAX;AACA,YAAIqgB,GAAG,GAAG;AACRxZ,cAAI,EAAEA,IADE;AAERwU,cAAI,EAAEA;AAFE,SAAV;;AAKA,YAAI,CAAC,KAAKoY,WAAV,EAAuB;AACrB,eAAK9U,IAAL;AACA,eAAK8U,WAAL,GAAmB,IAAnB;AACD;;AAED,eAAOn3B,OAAO,CAACC,OAAR,CAAgB8jB,GAAhB,EACJ/d,IADI,CACC,KAAKuxB,cADN,EAEJvxB,IAFI,CAEC,KAAKwxB,eAFN,EAGJxxB,IAHI,CAGC,KAAKyxB,UAHN,EAIJzxB,IAJI,CAIC,KAAK0xB,QAJN,EAKJ1xB,IALI,CAKC,UAAU4xB,IAAV,EAAgB;AAAE,iBAAOA,IAAI,CAAC5B,UAAZ;AAAyB,SAL5C,CAAP;AAMD,OAlBD;;AAqBAkB,qBAAe,CAACnnB,SAAhB,CAA0B4mB,MAA1B,GAAmC,UAAUmB,WAAV,EAAuBpnB,EAAvB,EAA2B;AAC5D,YAAI,CAAC,KAAKonB,WAAL,CAAL,EAAwB,MAAM,IAAIjnB,KAAJ,CAAU,aAAainB,WAAb,GAA2B,kBAArC,CAAN;AACxB,YAAI,OAAOpnB,EAAP,KAAc,UAAlB,EAA8B,MAAM,IAAIG,KAAJ,CAAU,0CAAV,CAAN;AAE9B,YAAIknB,MAAM,GAAG,KAAKD,WAAL,CAAb;AACA,YAAIxV,IAAI,GAAG,IAAX;;AAEA,aAAKwV,WAAL,IAAoB,UAAU/T,GAAV,EAAe;AACjC,iBAAOrT,EAAE,CAACT,IAAH,CAAQqS,IAAR,EAAcyB,GAAd,EAAmB/d,IAAnB,CAAwB,UAAU4xB,IAAV,EAAgB;AAC7C,mBAAOG,MAAM,CAAC9nB,IAAP,CAAYqS,IAAZ,EAAkBsV,IAAlB,CAAP;AACD,WAFM,CAAP;AAGD,SAJD;;AAMA,eAAO,IAAP;AACD,OAdD;;AAiBAV,qBAAe,CAACnnB,SAAhB,CAA0B6mB,KAA1B,GAAkC,UAAUkB,WAAV,EAAuBpnB,EAAvB,EAA2B;AAC3D,YAAI,CAAC,KAAKonB,WAAL,CAAL,EAAwB,MAAM,IAAIjnB,KAAJ,CAAU,aAAainB,WAAb,GAA2B,kBAArC,CAAN;AACxB,YAAI,OAAOpnB,EAAP,KAAc,UAAlB,EAA8B,MAAM,IAAIG,KAAJ,CAAU,0CAAV,CAAN;AAE9B,YAAIknB,MAAM,GAAG,KAAKD,WAAL,CAAb;AACA,YAAIxV,IAAI,GAAG,IAAX;;AAEA,aAAKwV,WAAL,IAAoB,UAAU/T,GAAV,EAAe;AACjC,iBAAOgU,MAAM,CAAC9nB,IAAP,CAAYqS,IAAZ,EAAkByB,GAAlB,EAAuB/d,IAAvB,CAA4B,UAAU4xB,IAAV,EAAgB;AACjD,mBAAOlnB,EAAE,CAACT,IAAH,CAAQqS,IAAR,EAAcsV,IAAd,CAAP;AACD,WAFM,CAAP;AAGD,SAJD;;AAMA,eAAO,IAAP;AACD,OAdD;;AAiBAV,qBAAe,CAACnnB,SAAhB,CAA0BwnB,cAA1B,GAA2C,UAAUxT,GAAV,EAAe;AACxD,YAAIkF,GAAG,GAAGC,MAAM,CAACD,GAAP,IAAcC,MAAM,CAACC,SAArB,IAAkCD,MAAM,CAACE,MAAzC,IAAmDF,MAAM,CAACG,KAApE;AAEAtF,WAAG,CAACiU,KAAJ,GAAY5yB,QAAQ,CAAComB,aAAT,CAAuB,KAAvB,CAAZ;AACAzH,WAAG,CAACkU,SAAJ,GAAgBhP,GAAG,CAACQ,eAAJ,CAAoB1F,GAAG,CAACxZ,IAAxB,CAAhB;AACAwZ,WAAG,CAACiU,KAAJ,CAAUrzB,GAAV,GAAgBof,GAAG,CAACkU,SAApB;AAEA,eAAO,IAAIj4B,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC5C6jB,aAAG,CAACiU,KAAJ,CAAUE,OAAV,GAAoB,YAAY;AAAEh4B,kBAAM,CAAC,IAAI2Q,KAAJ,CAAU,qDAAV,CAAD,CAAN;AAA2E,WAA7G;;AACAkT,aAAG,CAACiU,KAAJ,CAAUG,MAAV,GAAmB,YAAY;AAAEl4B,mBAAO,CAAC8jB,GAAD,CAAP;AAAe,WAAhD;AACD,SAHM,CAAP;AAID,OAXD;;AAcAmT,qBAAe,CAACnnB,SAAhB,CAA0BynB,eAA1B,GAA4C,UAAUzT,GAAV,EAAe;AACzD;AACA;AACA;AACA;AACA,YAAIqU,YAAY,GAAGrU,GAAG,CAAChF,IAAJ,CAAShH,GAAT,GAAerR,IAAI,CAACqR,GAAL,CAASgM,GAAG,CAACiU,KAAJ,CAAUvjB,KAAnB,EAA0BsP,GAAG,CAACiU,KAAJ,CAAUtjB,MAApC,CAAlC;AAEA,YAAI0jB,YAAY,GAAG,CAAnB,EAAsBA,YAAY,GAAG,CAAf;AAEtBrU,WAAG,CAACsU,eAAJ,GAAsB3xB,IAAI,CAACqR,GAAL,CAASrR,IAAI,CAACkP,KAAL,CAAWmO,GAAG,CAACiU,KAAJ,CAAUvjB,KAAV,GAAkB2jB,YAA7B,CAAT,EAAqD,CAArD,CAAtB;AACArU,WAAG,CAACuU,gBAAJ,GAAuB5xB,IAAI,CAACqR,GAAL,CAASrR,IAAI,CAACkP,KAAL,CAAWmO,GAAG,CAACiU,KAAJ,CAAUtjB,MAAV,GAAmB0jB,YAA9B,CAAT,EAAsD,CAAtD,CAAvB,CAVyD,CAYzD;;AACArU,WAAG,CAACqU,YAAJ,GAAmBA,YAAnB;AAEA,eAAOp4B,OAAO,CAACC,OAAR,CAAgB8jB,GAAhB,CAAP;AACD,OAhBD;;AAmBAmT,qBAAe,CAACnnB,SAAhB,CAA0B0nB,UAA1B,GAAuC,UAAU1T,GAAV,EAAe;AACpDA,WAAG,CAACiS,UAAJ,GAAiB,KAAKllB,IAAL,CAAUpN,OAAV,CAAkB0a,YAAlB,CAA+B2F,GAAG,CAACsU,eAAnC,EAAoDtU,GAAG,CAACuU,gBAAxD,CAAjB,CADoD,CAGpD;AACA;;AACAvU,WAAG,CAACsU,eAAJ,GAAsB,IAAtB;AACAtU,WAAG,CAACuU,gBAAJ,GAAuB,IAAvB,CANoD,CAQpD;;AACA,YAAIC,SAAS,GAAG;AAAEnjB,eAAK,EAAE2O,GAAG,CAACxZ,IAAJ,CAASnE,IAAT,KAAkB;AAA3B,SAAhB,CAToD,CAWpD;;AACA,aAAKoK,KAAL,CAAW9L,MAAX,CAAkB6zB,SAAlB,EAA6B,KAAK/nB,KAAL,CAAWH,wBAAX,CAAoC0T,GAAG,CAAChF,IAAxC,CAA7B;AAEA,eAAO,KAAKjO,IAAL,CACJ4B,MADI,CACGqR,GAAG,CAACiU,KADP,EACcjU,GAAG,CAACiS,UADlB,EAC8BuC,SAD9B,EAEJvyB,IAFI,CAEC,YAAY;AAAE,iBAAO+d,GAAP;AAAa,SAF5B,CAAP;AAGD,OAjBD;;AAoBAmT,qBAAe,CAACnnB,SAAhB,CAA0B2nB,QAA1B,GAAqC,UAAU3T,GAAV,EAAe;AAClDA,WAAG,CAACiU,KAAJ,CAAUrzB,GAAV,GAAgB,EAAhB;AACAof,WAAG,CAACiU,KAAJ,GAAY,IAAZ;AAEA,YAAI/O,GAAG,GAAGC,MAAM,CAACD,GAAP,IAAcC,MAAM,CAACC,SAArB,IAAkCD,MAAM,CAACE,MAAzC,IAAmDF,MAAM,CAACG,KAApE;AACA,YAAIJ,GAAG,CAAC8C,eAAR,EAAyB9C,GAAG,CAAC8C,eAAJ,CAAoBhI,GAAG,CAACkU,SAAxB;AAEzBlU,WAAG,CAACkU,SAAJ,GAAgB,IAAhB;AAEA,eAAOj4B,OAAO,CAACC,OAAR,CAAgB8jB,GAAhB,CAAP;AACD,OAVD;;AAaAmT,qBAAe,CAACnnB,SAAhB,CAA0B4nB,YAA1B,GAAyC,UAAU5T,GAAV,EAAe;AACtD,eAAO,KAAKjT,IAAL,CAAU0e,MAAV,CAAiBzL,GAAG,CAACiS,UAArB,EAAiCjS,GAAG,CAACxZ,IAAJ,CAASnE,IAA1C,EACJJ,IADI,CACC,UAAUuE,IAAV,EAAgB;AACpBwZ,aAAG,CAACsS,QAAJ,GAAe9rB,IAAf;AACA,iBAAOwZ,GAAP;AACD,SAJI,CAAP;AAKD,OAND;;AASAmT,qBAAe,CAACnnB,SAAhB,CAA0B0lB,cAA1B,GAA2C,UAAUlrB,IAAV,EAAgB;AACzD,YAAIA,IAAI,CAACG,WAAT,EAAsB;AACpB,iBAAOH,IAAI,CAACG,WAAL,GAAmB1E,IAAnB,CAAwB,UAAUwyB,GAAV,EAAe;AAC5C,mBAAO,IAAItjB,UAAJ,CAAesjB,GAAf,CAAP;AACD,WAFM,CAAP;AAGD;;AAED,eAAO,IAAIx4B,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC5C,cAAIu4B,EAAE,GAAG,IAAIC,UAAJ,EAAT;AAEAD,YAAE,CAACE,iBAAH,CAAqBpuB,IAArB;;AAEAkuB,YAAE,CAACN,MAAH,GAAY,YAAY;AAAEl4B,mBAAO,CAAC,IAAIiV,UAAJ,CAAeujB,EAAE,CAAChmB,MAAlB,CAAD,CAAP;AAAqC,WAA/D;;AACAgmB,YAAE,CAACP,OAAH,GAAa,YAAY;AACvBh4B,kBAAM,CAAC,IAAI2Q,KAAJ,CAAU,sDAAV,CAAD,CAAN;AACA4nB,cAAE,CAACG,KAAH;AACD,WAHD;;AAIAH,YAAE,CAACI,OAAH,GAAa,YAAY;AACvB34B,kBAAM,CAAC,IAAI2Q,KAAJ,CAAU,gEAAV,CAAD,CAAN;AACD,WAFD;AAGD,SAbM,CAAP;AAcD,OArBD;;AAwBAqmB,qBAAe,CAACpmB,IAAhB,GAAuBA,IAAvB;AAEA,UAAIgoB,eAAe,GAAG5B,eAAtB;AAEe;;AAAA,uCAAA4B,eAAA;;;;;;;;;;;;;;;;ACtvGf;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAUO;AAAA,YAAMC,gBAAN;AAkBL,oCAA6BC,QAA7B,EAAiD;AAAA;;AAApB,iBAAAA,QAAA,GAAAA,QAAA;AAjBZ,iBAAAC,WAAA,GAEb,KAAKD,QAAL,CAAcE,KAAd,CAAoBn4B,IAApB,CACF,iEAAU,UAAAi4B,QAAQ;AAAA,qBAChBA,QAAQ,CAACG,cAAT,qBACGC,eADH,EACqB;AAAEC,sBAAM,EAAN;AAAF,eADrB,EADgB;AAAA,aAAlB,CADE,EAMF,6DAAMD,eAAN,CANE,EAOF,mEAAY;AAAEE,wBAAU,EAAE,CAAd;AAAiBC,sBAAQ,EAAE;AAA3B,aAAZ,CAPE,CAFa;AAYR,iBAAAtuB,IAAA,GAAO,KAAKguB,WAAL,CAAiBl4B,IAAjB,CACd,iEAAU,UAAAqQ,CAAC;AAAA,qBAAIA,CAAC,CAACooB,IAAF,GAAS7G,IAAT,CAAc;AAAE8G,yBAAS,EAAE;AAAb,eAAd,EAAqCC,CAAzC;AAAA,aAAX,CADc,EAEd,2DAAI,UAAAC,SAAS;AAAA,qBAAIA,SAAS,CAAClX,GAAV,CAAc,UAAAyQ,CAAC;AAAA,uBAAI,IAAI,8CAAJ,CAAWA,CAAX,CAAJ;AAAA,eAAf,CAAJ;AAAA,aAAb,CAFc,CAAP;AAK0C;;AAlB9C;AAAA;AAAA,mBAoBL,cAAK0G,KAAL,EAAkB;AAAA;;AAChB,qBAAO,mDAAM;AAAA,uBACX,sDAAS,CACP,MAAI,CAACX,WAAL,CAAiBl4B,IAAjB,CAAsB,8DAAtB,CADO,EAEP,qEAAe64B,KAAf,CAFO,EAGP,0FAHO,CAAT,CADW;AAAA,eAAN,EAML74B,IANK,CAOL,iEAAU;AAAA;AAAA,oBAAE84B,UAAF;AAAA,oBAAc3tB,EAAd;AAAA,oBAAkB4tB,mBAAlB;;AAAA,uBACRD,UAAU,CAACE,MAAX,CAAkB;AAChB7tB,oBAAE,EAAFA,EADgB;AAEhButB,2BAAS,EAAEjzB,IAAI,CAACsU,GAAL,EAFK;AAGhBgf,qCAAmB,EAAEA,mBAAmB,GACpC;AACEE,4BAAQ,EAAEF,mBAAmB,CAACG,MAApB,CAA2BD,QADvC;AAEEE,6BAAS,EAAEJ,mBAAmB,CAACG,MAApB,CAA2BC;AAFxC,mBADoC,GAKpCv5B;AARY,iBAAlB,CADQ;AAAA,eAAV,CAPK,EAmBL,iEAAU,UAAAyE,QAAQ;AAAA,uBAChBA,QAAQ,CAAC+0B,aAAT,CACE;AAAEjuB,oBAAE,EAAE,+CAAOkuB,mBAAb;AAAkCrhB,sBAAI,EAAE6gB,KAAxC;AAA+CxzB,sBAAI,EAAEwzB,KAAK,CAACxzB;AAA3D,iBADF,EAEE,IAFF,CADgB;AAAA,eAAlB,CAnBK,EAyBL,2DAAI,UAAAi0B,UAAU;AAAA,uBAAIA,UAAU,CAACC,GAAf;AAAA,eAAd,CAzBK,CAAP;AA2BD;AAhDI;AAAA;AAAA,mBAkDL,iBAAQpuB,EAAR,EAAoB;AAClB,qBAAO,KAAK+sB,WAAL,CAAiBl4B,IAAjB,CAAsB,iEAAU,UAAAqQ,CAAC;AAAA,uBAAIA,CAAC,CAACmpB,UAAF,CAAa,CAACruB,EAAD,CAAb,CAAJ;AAAA,eAAX,CAAtB,CAAP;AACD;AApDI;;AAAA;AAAA;;;2BAAM6sB,gB,EAAgB,2H;AAAA,S;;;iBAAhBA,gB;AAAgB,mBAAhBA,gBAAgB,K;AAAA,sBAFf;;;OAEP;;AAuDP,UAAMK,eAAe,GAAG,SAAxB;;;;;;;;;;;;;;;;ACnEA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AA2BO;AAAA,YAAMoB,YAAN;AAAA;AAAA;;;gBAAMA;;;;6BAAAA,Y;AAAY,W;AAAA,oBAjBd,CACP,4DADO,EAEP,0DAFO,EAGP,kEAHO,EAIP,0DAJO,EAKP,qEALO,EAMP,uEANO,CAiBc,EARrB,4DAQqB,EAPrB,0DAOqB,EANrB,kEAMqB,EALrB,0DAKqB,EAJrB,uEAIqB;;;OAAlB;;;4HAAMA,Y,EAAY;AAAA,yBAlBR,qEAkBQ;AAlBM,oBAE3B,4DAF2B,EAG3B,0DAH2B,EAI3B,kEAJ2B,EAK3B,0DAL2B,EAM3B,qEAN2B,EAO3B,uEAP2B,CAkBN;AAXE,oBAGvB,4DAHuB,EAIvB,0DAJuB,EAKvB,kEALuB,EAMvB,0DANuB,EAOvB,uEAPuB,EAQvB,qEARuB;AAWF,S;AAHP,O;;;;;;;;;;;;;;;;;ACxBlB;AAAA;;;AAAA;AAAA;AAAA;;AAAO,eAASC,gBAAT,CAA0B/vB,WAA1B,EAAoD;AACzD,eAAO,mBAAI,IAAIwK,UAAJ,CAAexK,WAAf,CAAJ,EACJ+X,GADI,CACA,UAAAhP,CAAC;AAAA,iBAAIA,CAAC,CAAC2J,QAAF,CAAW,EAAX,EAAesd,QAAf,CAAwB,CAAxB,EAA2B,GAA3B,CAAJ;AAAA,SADD,EAEJ7S,IAFI,CAEC,EAFD,CAAP;AAGD;;;;;;;;;;;;;;;;;ACHD;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAGA,UAAM8S,MAAM,GAAW,CACrB;AACEC,YAAI,EAAE,EADR;AAEExyB,iBAAS,EAAE;AAFb,OADqB,EAKrB;AACEwyB,YAAI,EAAE,OADR;AAEEC,oBAAY,EAAE;AAAA,iBACZ;AAAA;AAAA;AAAA;AAAA,mBAA+B70B,IAA/B,CAAoC,UAAA6c,CAAC;AAAA,mBAAIA,CAAC,CAACiY,eAAN;AAAA,WAArC,CADY;AAAA;AAFhB,OALqB,CAAvB;;AAgBO;AAAA,YAAMC,qBAAN;AAAA;AAAA;;;gBAAMA;;;;6BAAAA,qB;AAAqB,W;AAAA,oBAHvB,CAAC,6DAAaC,QAAb,CAAsBL,MAAtB,CAAD,CAGuB,EAFtB,4DAEsB;;;OAA3B;;;4HAAMI,qB,EAAqB;AAAA;AAAA,oBAFtB,4DAEsB;AAAA,S;AAFV,O;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChBxB,UAAMjC,eAAe,GAAG,IAAI,yDAAJ,EAAxB;;AAEO,eAAemC,aAAf,QAMJ;AAAA,YALDjD,KAKC,SALDA,KAKC;AAAA,YAJDkD,OAIC,SAJDA,OAIC;;;;;;qDACMpC,eAAe,CAACtJ,MAAhB,CAAuBwI,KAAvB,EAA8B;AAAEjgB,uBAAG,EAAEmjB;AAAP,mBAA9B,C;;;;;;;;;AACR;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACFD;;AAIE;;AACF;;;;;;AAD0B;;AAAA;;;;;YCQbC,eAAe;AA2D1B,mCACmBx4B,eADnB,EAEmBy4B,eAFnB,EAGmBrwB,gBAHnB,EAGqD;AAAA;;AAAA;;AAFlC,iBAAApI,eAAA,GAAAA,eAAA;AACA,iBAAAy4B,eAAA,GAAAA,eAAA;AACA,iBAAArwB,gBAAA,GAAAA,gBAAA;AA7DF,iBAAAswB,cAAA,GAAiB,IAAI,oDAAJ,CAEhC16B,SAFgC,CAAjB;AAIA,iBAAA26B,aAAA,GAAgB,KAAKD,cAAL,CAAoBt6B,IAApB,CAC/B,2EAD+B,EAE/B,6EAF+B,CAAhB;AAUA,iBAAAw6B,YAAA,GAAe,mDAAM;AAAA,qBACpCp7B,SAAS,CAACq7B,YAAV,CAAuBC,YAAvB,CAAoC;AAClCC,qBAAK,EAAE;AAAEC,4BAAU,EAAE;AAAd;AAD2B,eAApC,CADoC;AAAA,aAAN,EAI9B56B,IAJ8B,CAK9B,kEAAW,UAAOkd,GAAP;AAAA,qBAAwB,wDAAD,OAAC,EAAD,MAAC,EAAD,MAAC,uCAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAChC,+BAAM,KAAK2d,kBAAL,CAAwB3d,GAAxB,CAAN;;AADgC;AAAA;AAEhC,+BAAM,KAAKnX,OAAL,EAAN;;AAFgC;AAAA,2DAGzBnG,SAHyB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAC,EAAxB;AAAA,aAAX,CAL8B,EAU9B,mEAAY;AAAE24B,wBAAU,EAAE,CAAd;AAAiBC,sBAAQ,EAAE;AAA3B,aAAZ,CAV8B,CAAf;AAaA,iBAAAsC,aAAA,GAAgB,KAAKN,YAAL,CAAkBx6B,IAAlB,CAC/B,2EAD+B,EAE/B,2DAAI,UAAA+6B,WAAW;AAAA,qBAAI,IAAIC,YAAJ,CAAiBD,WAAW,CAACE,cAAZ,GAA6B,CAA7B,CAAjB,CAAJ;AAAA,aAAf,CAF+B,EAG/B,mEAAY;AAAE1C,wBAAU,EAAE,CAAd;AAAiBC,sBAAQ,EAAE;AAA3B,aAAZ,CAH+B,CAAhB;AAMA,iBAAA0C,kBAAA,GAAqB,IAAI,oDAAJ,CACpCt7B,SADoC,CAArB;AAIA,iBAAAu7B,uBAAA,GAA0B,KAAKD,kBAAL,CAAwBl7B,IAAxB,CACzC,iEADyC,EAEzC,2DAAI,iBAAgB;AAAA;AAAA,kBAAdo7B,QAAc;;AAClB,kBAAIA,QAAJ,EAAclT,GAAG,CAAC8C,eAAJ,CAAoBoQ,QAApB;AACf,aAFD,CAFyC,CAA1B;AAOR,iBAAAC,iBAAA,GAAoB,KAAKH,kBAAL,CAAwBl7B,IAAxB,CAC3B,2EAD2B,EAE3B,6EAF2B,CAApB;AAKQ,iBAAAs7B,cAAA,GAAiB,2DAAc,CAC9C,KAAKf,aADyC,EAE9C,KAAKC,YAAL,CAAkBx6B,IAAlB,CAAuB,2EAAvB,CAF8C,CAAd,EAG/BA,IAH+B,CAIhC,2DAAI,kBAAiC;AAAA;AAAA,kBAA/Bu7B,YAA+B;AAAA,kBAAjBR,WAAiB;;AACnCQ,0BAAY,CAACC,SAAb,GAAyBT,WAAzB;AACD,aAFD,CAJgC,CAAjB;AAcf,iBAAKI,uBAAL,CAA6Bn7B,IAA7B,CAAkC,6EAAe,IAAf,CAAlC,EAAwDoM,SAAxD;AACA,iBAAKkvB,cAAL,CAAoBt7B,IAApB,CAAyB,6EAAe,IAAf,CAAzB,EAA+CoM,SAA/C;AACD;;AAlEyB;AAAA;AAAA,iBAU1B,aACiBjM,KADjB,EACsD;AACpD,mBAAKm6B,cAAL,CAAoBl6B,IAApB,CAAyBD,KAAK,CAACgI,aAA/B;AACD;AAbyB;AAAA;AAAA,mBAoE1B,mBAAU;AAAA;;AACR,mBAAK2yB,aAAL,CACG96B,IADH,CAEI,iEAAU,UAAAy7B,YAAY;AAAA,uBAAIA,YAAY,CAACC,SAAb,EAAJ;AAAA,eAAtB,CAFJ,EAGI,2DAAI,UAAAC,SAAS,EAAI;AACf,uBAAI,CAACT,kBAAL,CAAwB96B,IAAxB,CAA6B8nB,GAAG,CAACQ,eAAJ,CAAoBiT,SAApB,CAA7B;AACD,eAFD,CAHJ,EAMI,sEAAU,UAAAA,SAAS;AAAA,uBAAI,OAAI,CAAC3xB,gBAAL,CAAsB4xB,IAAtB,CAA2BD,SAA3B,CAAJ;AAAA,eAAnB,CANJ,EAOI,kEAAW,UAAOze,GAAP;AAAA,uBAAwB,wDAAD,OAAC,EAAD,MAAC,EAAD,MAAC,uCAAD;AAAA;AAAA;AAAA;AAAA;AAChC;AACA2e,iCAAO,CAACt8B,KAAR,CAAc2d,GAAd;AAFgC;AAGhC,iCAAM,KAAK2d,kBAAL,CAAwB3d,GAAxB,CAAN;;AAHgC;AAAA,6DAIzBtd,SAJyB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAC,EAAxB;AAAA,eAAX,CAPJ,EAaI,6EAAe,IAAf,CAbJ,EAeGwM,SAfH;AAgBD;AArFyB;AAAA;AAAA,mBAuFpB,mBAAU;;;;;;2DACP,KAAKxK,eAAL,CAAqBmE,OAArB,E;;;;;;;;;AACR;AAzFyB;AAAA;AAAA,mBA2FpB,4BAAmBmX,GAAnB,EAAiC;;;;;;;;AACvB,+BAAM,KAAKmd,eAAL,CAAqBjzB,MAArB,CAA4B;AAC9C+sB,gCAAM,EAAEjX,GAAG,YAAYpN,KAAf,GAAuBoN,GAAG,CAAC5P,IAA3B,GAAkC,eADI;AAE9C6hB,iCAAO,EAAEjS,GAAG,YAAYpN,KAAf,GAAuBoN,GAAG,CAACiS,OAA3B,GAAqC5H,IAAI,CAACD,SAAL,CAAepK,GAAf,CAFA;AAG9C4e,iCAAO,EAAE,CAAC;AAAE35B,gCAAI,EAAE;AAAR,2BAAD;AAHqC,yBAA5B,CAAN;;;AAAR45B,6B;;AAKN,+BAAMA,KAAK,CAACp0B,OAAN,EAAN;;;;;;;;;AACD;AAlGyB;AAAA;AAAA,mBAoG1B,uBAAc;AACZ,mBAAK6yB,YAAL,CACGx6B,IADH,CAEI,2EAFJ,EAGI,2DAAI,UAAA+6B,WAAW;AAAA,uBACbA,WAAW,CAACiB,SAAZ,GAAwB3sB,OAAxB,CAAgC,UAAA4sB,KAAK;AAAA,yBAAIA,KAAK,CAACC,IAAN,EAAJ;AAAA,iBAArC,CADa;AAAA,eAAf,CAHJ,EAOG9vB,SAPH;AAQD;AA7GyB;;AAAA;AAAA,W;;;2BAAfguB,e,EAAe,+H,EAAA,+H,EAAA,0J;AAAA,S;;;gBAAfA,e;AAAe,qC;AAAA;AAAA;;;;;;;;;;;;;;;ADtB5B;;AAAY;AAAA,uBAAS,IAAAr0B,OAAA,EAAT;AAAkB,eAAlB;;AACV;;AACF;;AACA;;AAAY;AAAA,uBAAS,IAAAo2B,OAAA,EAAT;AAAkB,eAAlB;;AACV;;AAKF;;AACA;;AAMA;;;;AALG;;AAAA;;;;;;ACWU/B,uBAAe,6DAN3B,4EAM2B,GAAfA,eAAe,CAAf;;;;;;;;;;;;;;;;;;;ACrBb;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAiBO;AAAA,YAAMgC,cAAN;AAAA;AAAA;;;gBAAMA;;;;6BAAAA,c;AAAc,W;AAAA,oBARhB,CAAC,kEAAD,EAAe,0EAAf,EAAsC,gFAAtC,CAQgB;;;OAApB;;;4HAAMA,c,EAAc;AAAA,yBANvB,mDAMuB,EALvB,8EAKuB,EAJvB,wEAIuB,EAHvB,qGAGuB;AAHC,oBALhB,kEAKgB,EALF,0EAKE,EALqB,gFAKrB;AAGD,S;AAR+C,O;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACDpE;;AACE;;AACF;;;;;;AAFgD;;AAC9C;;AAAA;;;;;;;;AANJ;;AAGE;AAAA;;AAAA;;AAAA;AAAA;;AAEA;;AAGF;;;;;;;;AANE;;AAGqC;;AAAA;;;;;YCG9BC,iBAAiB;AAO5B,qCAA6BC,eAA7B,EAA+D;AAAA;;AAAlC,iBAAAA,eAAA,GAAAA,eAAA;AANpB,iBAAAC,MAAA,GAAS,kFAAgBC,MAAzB;AAEA,iBAAAC,MAAA,GAAS,KAAKH,eAAL,CAAqBG,MAA9B;AAEA,iBAAAC,OAAA,GAAU,qDAAV;AAEwD;;AAPrC;AAAA;AAAA,mBAS5B,2BAAkBr8B,KAAlB,EAAgC;AAC9B,qBAAO,KAAKi8B,eAAL,CACJK,SADI,CACOt8B,KAAgC,CAACu8B,MAAjC,CAAwCz8B,KAD/C,EAEJH,IAFI,CAEC,6EAAe,IAAf,CAFD,EAGJoM,SAHI,EAAP;AAID;AAd2B;;AAAA;AAAA,W;;;2BAAjBiwB,iB,EAAiB,kJ;AAAA,S;;;gBAAjBA,iB;AAAiB,uC;AAAA,mB;AAAA,iB;AAAA,0Q;AAAA;AAAA;ADZ9B;;AACE;;AACE;;AACA;;AAAW;;AAAK;;AAChB;;AASF;;AACA;;AACE;;AACA;;AAAW;;AAAO;;AAClB;;AAAqB;;AAAa;;AACpC;;AACF;;;;AAdO;;AAAA;;AAYkB;;AAAA;;;;;;ACLZA,yBAAiB,6DAN7B,4EAM6B,GAAjBA,iBAAiB,CAAjB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXb;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;;;;;;;ACAE;;AAOE;;AACF;;;;;;;;AALE,uKAAiC,KAAjC,EAAiC,eAAjC;;;;;;AAJJ;;AACE;;AASF;;;;;;AARK;;AAAA;;;;ADSE;AAAA,YAAMQ,wBAAN;AALP;AAAA;;AAMmB,iBAAAC,QAAA,GAAW,IAAI,oDAAJ,CAC1Bl9B,SAD0B,CAAX;AAIR,iBAAAm9B,OAAA,GAAU,KAAKD,QAAL,CAAc98B,IAAd,CACjB,2EADiB,EAEjB,4EAAqB,UAACmX,CAAD,EAAImE,CAAJ;AAAA,qBAAUnE,CAAC,CAAChM,EAAF,KAASmQ,CAAC,CAACnQ,EAArB;AAAA,aAArB,CAFiB,CAAV;AAQV;;AAbM;AAAA;AAAA,iBAUL,aAAoBhL,KAApB,EAAmC;AACjC,mBAAK28B,QAAL,CAAc18B,IAAd,CAAmBD,KAAnB;AACD;AAZI;;AAAA;AAAA;;;2BAAM08B,wB;AAAwB,S;;;gBAAxBA,wB;AAAwB,+C;AAAA;AAAA;AAAA,W;AAAA,kB;AAAA,iB;AAAA,sM;AAAA;AAAA;ACXrC;;;;AAAe;;;;;;;ODWR;;;;;;;;;;;;;;;;;AEXP;AAAA;;;AAAA;AAAA;AAAA;;UAAaG,iB;;;;;AAAb;AAAA;;AAAA;;;AACE,kBAAA1vB,IAAA,GAAO0vB,iBAAiB,CAAC1vB,IAAzB;AADF;AAEC;;;uCAFsCwC,K;;;;;;;;;;;;;;;;;ACAvC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;;;;AAWA;;;;;;;;AAOA;;;;;;;;;;;;;;UAaMmtB,W;;;AAEN;;;;;;;;;;;;UAUMC,W;;;AAGN;;;;;;;;AAOA;;;;;;;;;UAOMC,W;AACF;AACA,6BAAYC,OAAZ,EAAqB;AAAA;;AAAA;;AACjB;;;;AAIA,eAAKC,eAAL,GAAuB,IAAIC,GAAJ,EAAvB;AACA;;;;AAGA,eAAKC,UAAL,GAAkB,IAAlB;;AACA,cAAI,CAACH,OAAL,EAAc;AACV,iBAAKA,OAAL,GAAe,IAAIE,GAAJ,EAAf;AACH,WAFD,MAGK,IAAI,OAAOF,OAAP,KAAmB,QAAvB,EAAiC;AAClC,iBAAKI,QAAL,GAAgB,YAAM;AAClB,qBAAI,CAACJ,OAAL,GAAe,IAAIE,GAAJ,EAAf;AACAF,qBAAO,CAACpW,KAAR,CAAc,IAAd,EAAoB3X,OAApB,CAA4B,UAAA4P,IAAI,EAAI;AAChC,oBAAMwe,KAAK,GAAGxe,IAAI,CAAC7N,OAAL,CAAa,GAAb,CAAd;;AACA,oBAAIqsB,KAAK,GAAG,CAAZ,EAAe;AACX,sBAAMnwB,IAAI,GAAG2R,IAAI,CAACqK,KAAL,CAAW,CAAX,EAAcmU,KAAd,CAAb;AACA,sBAAM1uB,GAAG,GAAGzB,IAAI,CAACowB,WAAL,EAAZ;AACA,sBAAMv9B,KAAK,GAAG8e,IAAI,CAACqK,KAAL,CAAWmU,KAAK,GAAG,CAAnB,EAAsBE,IAAtB,EAAd;;AACA,yBAAI,CAACC,sBAAL,CAA4BtwB,IAA5B,EAAkCyB,GAAlC;;AACA,sBAAI,OAAI,CAACquB,OAAL,CAAaS,GAAb,CAAiB9uB,GAAjB,CAAJ,EAA2B;AACvB,2BAAI,CAACquB,OAAL,CAAaU,GAAb,CAAiB/uB,GAAjB,EAAsBiL,IAAtB,CAA2B7Z,KAA3B;AACH,mBAFD,MAGK;AACD,2BAAI,CAACi9B,OAAL,CAAarmB,GAAb,CAAiBhI,GAAjB,EAAsB,CAAC5O,KAAD,CAAtB;AACH;AACJ;AACJ,eAdD;AAeH,aAjBD;AAkBH,WAnBI,MAoBA;AACD,iBAAKq9B,QAAL,GAAgB,YAAM;AAClB,qBAAI,CAACJ,OAAL,GAAe,IAAIE,GAAJ,EAAf;AACA55B,oBAAM,CAAC+d,IAAP,CAAY2b,OAAZ,EAAqB/tB,OAArB,CAA6B,UAAA/B,IAAI,EAAI;AACjC,oBAAIywB,MAAM,GAAGX,OAAO,CAAC9vB,IAAD,CAApB;AACA,oBAAMyB,GAAG,GAAGzB,IAAI,CAACowB,WAAL,EAAZ;;AACA,oBAAI,OAAOK,MAAP,KAAkB,QAAtB,EAAgC;AAC5BA,wBAAM,GAAG,CAACA,MAAD,CAAT;AACH;;AACD,oBAAIA,MAAM,CAAC/2B,MAAP,GAAgB,CAApB,EAAuB;AACnB,yBAAI,CAACo2B,OAAL,CAAarmB,GAAb,CAAiBhI,GAAjB,EAAsBgvB,MAAtB;;AACA,yBAAI,CAACH,sBAAL,CAA4BtwB,IAA5B,EAAkCyB,GAAlC;AACH;AACJ,eAVD;AAWH,aAbD;AAcH;AACJ;AACD;;;;;;;;;;;iBAOA,aAAIzB,IAAJ,EAAU;AACN,iBAAKgU,IAAL;AACA,mBAAO,KAAK8b,OAAL,CAAaS,GAAb,CAAiBvwB,IAAI,CAACowB,WAAL,EAAjB,CAAP;AACH;AACD;;;;;;;;;;iBAOA,aAAIpwB,IAAJ,EAAU;AACN,iBAAKgU,IAAL;AACA,gBAAMyc,MAAM,GAAG,KAAKX,OAAL,CAAaU,GAAb,CAAiBxwB,IAAI,CAACowB,WAAL,EAAjB,CAAf;AACA,mBAAOK,MAAM,IAAIA,MAAM,CAAC/2B,MAAP,GAAgB,CAA1B,GAA8B+2B,MAAM,CAAC,CAAD,CAApC,GAA0C,IAAjD;AACH;AACD;;;;;;;;iBAKA,gBAAO;AACH,iBAAKzc,IAAL;AACA,mBAAO9Z,KAAK,CAACoH,IAAN,CAAW,KAAKyuB,eAAL,CAAqBU,MAArB,EAAX,CAAP;AACH;AACD;;;;;;;;;;iBAOA,gBAAOzwB,IAAP,EAAa;AACT,iBAAKgU,IAAL;AACA,mBAAO,KAAK8b,OAAL,CAAaU,GAAb,CAAiBxwB,IAAI,CAACowB,WAAL,EAAjB,KAAwC,IAA/C;AACH;AACD;;;;;;;;;;;;iBASA,gBAAOpwB,IAAP,EAAanN,KAAb,EAAoB;AAChB,mBAAO,KAAK69B,KAAL,CAAW;AAAE1wB,kBAAI,EAAJA,IAAF;AAAQnN,mBAAK,EAALA,KAAR;AAAe89B,gBAAE,EAAE;AAAnB,aAAX,CAAP;AACH;AACD;;;;;;;;;;;;;iBAUA,aAAI3wB,IAAJ,EAAUnN,KAAV,EAAiB;AACb,mBAAO,KAAK69B,KAAL,CAAW;AAAE1wB,kBAAI,EAAJA,IAAF;AAAQnN,mBAAK,EAALA,KAAR;AAAe89B,gBAAE,EAAE;AAAnB,aAAX,CAAP;AACH;AACD;;;;;;;;;;;iBAQA,iBAAO3wB,IAAP,EAAanN,KAAb,EAAoB;AAChB,mBAAO,KAAK69B,KAAL,CAAW;AAAE1wB,kBAAI,EAAJA,IAAF;AAAQnN,mBAAK,EAALA,KAAR;AAAe89B,gBAAE,EAAE;AAAnB,aAAX,CAAP;AACH;;;iBACD,gCAAuB3wB,IAAvB,EAA6B4wB,MAA7B,EAAqC;AACjC,gBAAI,CAAC,KAAKb,eAAL,CAAqBQ,GAArB,CAAyBK,MAAzB,CAAL,EAAuC;AACnC,mBAAKb,eAAL,CAAqBtmB,GAArB,CAAyBmnB,MAAzB,EAAiC5wB,IAAjC;AACH;AACJ;;;iBACD,gBAAO;AAAA;;AACH,gBAAI,CAAC,CAAC,KAAKkwB,QAAX,EAAqB;AACjB,kBAAI,KAAKA,QAAL,YAAyBL,WAA7B,EAA0C;AACtC,qBAAKgB,QAAL,CAAc,KAAKX,QAAnB;AACH,eAFD,MAGK;AACD,qBAAKA,QAAL;AACH;;AACD,mBAAKA,QAAL,GAAgB,IAAhB;;AACA,kBAAI,CAAC,CAAC,KAAKD,UAAX,EAAuB;AACnB,qBAAKA,UAAL,CAAgBluB,OAAhB,CAAwB,UAAA+uB,MAAM;AAAA,yBAAI,OAAI,CAACC,WAAL,CAAiBD,MAAjB,CAAJ;AAAA,iBAA9B;AACA,qBAAKb,UAAL,GAAkB,IAAlB;AACH;AACJ;AACJ;;;iBACD,kBAASe,KAAT,EAAgB;AAAA;;AACZA,iBAAK,CAAChd,IAAN;AACA9Z,iBAAK,CAACoH,IAAN,CAAW0vB,KAAK,CAAClB,OAAN,CAAc3b,IAAd,EAAX,EAAiCpS,OAAjC,CAAyC,UAAAN,GAAG,EAAI;AAC5C,qBAAI,CAACquB,OAAL,CAAarmB,GAAb,CAAiBhI,GAAjB,EAAsBuvB,KAAK,CAAClB,OAAN,CAAcU,GAAd,CAAkB/uB,GAAlB,CAAtB;;AACA,qBAAI,CAACsuB,eAAL,CAAqBtmB,GAArB,CAAyBhI,GAAzB,EAA8BuvB,KAAK,CAACjB,eAAN,CAAsBS,GAAtB,CAA0B/uB,GAA1B,CAA9B;AACH,aAHD;AAIH;;;iBACD,eAAMqvB,MAAN,EAAc;AACV,gBAAMJ,KAAK,GAAG,IAAIb,WAAJ,EAAd;AACAa,iBAAK,CAACR,QAAN,GACK,CAAC,CAAC,KAAKA,QAAP,IAAmB,KAAKA,QAAL,YAAyBL,WAA7C,GAA4D,KAAKK,QAAjE,GAA4E,IADhF;AAEAQ,iBAAK,CAACT,UAAN,GAAmB,CAAC,KAAKA,UAAL,IAAmB,EAApB,EAAwBpS,MAAxB,CAA+B,CAACiT,MAAD,CAA/B,CAAnB;AACA,mBAAOJ,KAAP;AACH;;;iBACD,qBAAYI,MAAZ,EAAoB;AAChB,gBAAMrvB,GAAG,GAAGqvB,MAAM,CAAC9wB,IAAP,CAAYowB,WAAZ,EAAZ;;AACA,oBAAQU,MAAM,CAACH,EAAf;AACI,mBAAK,GAAL;AACA,mBAAK,GAAL;AACI,oBAAI99B,KAAK,GAAGi+B,MAAM,CAACj+B,KAAnB;;AACA,oBAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC3BA,uBAAK,GAAG,CAACA,KAAD,CAAR;AACH;;AACD,oBAAIA,KAAK,CAAC6G,MAAN,KAAiB,CAArB,EAAwB;AACpB;AACH;;AACD,qBAAK42B,sBAAL,CAA4BQ,MAAM,CAAC9wB,IAAnC,EAAyCyB,GAAzC;AACA,oBAAMoU,IAAI,GAAG,CAACib,MAAM,CAACH,EAAP,KAAc,GAAd,GAAoB,KAAKb,OAAL,CAAaU,GAAb,CAAiB/uB,GAAjB,CAApB,GAA4CnP,SAA7C,KAA2D,EAAxE;AACAujB,oBAAI,CAACnJ,IAAL,OAAAmJ,IAAI,qBAAShjB,KAAT,EAAJ;AACA,qBAAKi9B,OAAL,CAAarmB,GAAb,CAAiBhI,GAAjB,EAAsBoU,IAAtB;AACA;;AACJ,mBAAK,GAAL;AACI,oBAAMob,QAAQ,GAAGH,MAAM,CAACj+B,KAAxB;;AACA,oBAAI,CAACo+B,QAAL,EAAe;AACX,uBAAKnB,OAAL,WAAoBruB,GAApB;AACA,uBAAKsuB,eAAL,WAA4BtuB,GAA5B;AACH,iBAHD,MAIK;AACD,sBAAIyvB,QAAQ,GAAG,KAAKpB,OAAL,CAAaU,GAAb,CAAiB/uB,GAAjB,CAAf;;AACA,sBAAI,CAACyvB,QAAL,EAAe;AACX;AACH;;AACDA,0BAAQ,GAAGA,QAAQ,CAACppB,MAAT,CAAgB,UAAAjV,KAAK;AAAA,2BAAIo+B,QAAQ,CAACntB,OAAT,CAAiBjR,KAAjB,MAA4B,CAAC,CAAjC;AAAA,mBAArB,CAAX;;AACA,sBAAIq+B,QAAQ,CAACx3B,MAAT,KAAoB,CAAxB,EAA2B;AACvB,yBAAKo2B,OAAL,WAAoBruB,GAApB;AACA,yBAAKsuB,eAAL,WAA4BtuB,GAA5B;AACH,mBAHD,MAIK;AACD,yBAAKquB,OAAL,CAAarmB,GAAb,CAAiBhI,GAAjB,EAAsByvB,QAAtB;AACH;AACJ;;AACD;AAnCR;AAqCH;AACD;;;;;;iBAGA,iBAAQ7uB,EAAR,EAAY;AAAA;;AACR,iBAAK2R,IAAL;AACA9Z,iBAAK,CAACoH,IAAN,CAAW,KAAKyuB,eAAL,CAAqB5b,IAArB,EAAX,EACKpS,OADL,CACa,UAAAN,GAAG;AAAA,qBAAIY,EAAE,CAAC,OAAI,CAAC0tB,eAAL,CAAqBS,GAArB,CAAyB/uB,GAAzB,CAAD,EAAgC,OAAI,CAACquB,OAAL,CAAaU,GAAb,CAAiB/uB,GAAjB,CAAhC,CAAN;AAAA,aADhB;AAEH;;;;;AAGL;;;;;;;;AAOA;;;;;;;;;;;;UAUM0vB,oB;;;;;;;;AACF;;;;;AAKA,6BAAU1vB,GAAV,EAAe;AACX,mBAAO2vB,gBAAgB,CAAC3vB,GAAD,CAAvB;AACH;AACD;;;;;;;;iBAKA,qBAAY5O,KAAZ,EAAmB;AACf,mBAAOu+B,gBAAgB,CAACv+B,KAAD,CAAvB;AACH;AACD;;;;;;;;iBAKA,mBAAU4O,GAAV,EAAe;AACX,mBAAO2gB,kBAAkB,CAAC3gB,GAAD,CAAzB;AACH;AACD;;;;;;;;iBAKA,qBAAY5O,KAAZ,EAAmB;AACf,mBAAOuvB,kBAAkB,CAACvvB,KAAD,CAAzB;AACH;;;;;;AAEL,eAASw+B,WAAT,CAAqBC,SAArB,EAAgCC,KAAhC,EAAuC;AACnC,YAAMnd,GAAG,GAAG,IAAI4b,GAAJ,EAAZ;;AACA,YAAIsB,SAAS,CAAC53B,MAAV,GAAmB,CAAvB,EAA0B;AACtB;AACA;AACA;AACA,cAAM83B,MAAM,GAAGF,SAAS,CAACpb,OAAV,CAAkB,KAAlB,EAAyB,EAAzB,EAA6BwD,KAA7B,CAAmC,GAAnC,CAAf;AACA8X,gBAAM,CAACzvB,OAAP,CAAe,UAAC0vB,KAAD,EAAW;AACtB,gBAAMC,KAAK,GAAGD,KAAK,CAAC3tB,OAAN,CAAc,GAAd,CAAd;;AADsB,yBAEH4tB,KAAK,IAAI,CAAC,CAAV,GACf,CAACH,KAAK,CAACI,SAAN,CAAgBF,KAAhB,CAAD,EAAyB,EAAzB,CADe,GAEf,CAACF,KAAK,CAACI,SAAN,CAAgBF,KAAK,CAACzV,KAAN,CAAY,CAAZ,EAAe0V,KAAf,CAAhB,CAAD,EAAyCH,KAAK,CAACK,WAAN,CAAkBH,KAAK,CAACzV,KAAN,CAAY0V,KAAK,GAAG,CAApB,CAAlB,CAAzC,CAJkB;AAAA;AAAA,gBAEfjwB,GAFe;AAAA,gBAEVsX,GAFU;;AAKtB,gBAAM8Y,IAAI,GAAGzd,GAAG,CAACoc,GAAJ,CAAQ/uB,GAAR,KAAgB,EAA7B;AACAowB,gBAAI,CAACnlB,IAAL,CAAUqM,GAAV;AACA3E,eAAG,CAAC3K,GAAJ,CAAQhI,GAAR,EAAaowB,IAAb;AACH,WARD;AASH;;AACD,eAAOzd,GAAP;AACH;;AACD,eAASgd,gBAAT,CAA0BpM,CAA1B,EAA6B;AACzB,eAAO9C,kBAAkB,CAAC8C,CAAD,CAAlB,CACF9O,OADE,CACM,OADN,EACe,GADf,EAEFA,OAFE,CAEM,OAFN,EAEe,GAFf,EAGFA,OAHE,CAGM,OAHN,EAGe,GAHf,EAIFA,OAJE,CAIM,OAJN,EAIe,GAJf,EAKFA,OALE,CAKM,OALN,EAKe,GALf,EAMFA,OANE,CAMM,OANN,EAMe,GANf,EAOFA,OAPE,CAOM,OAPN,EAOe,GAPf,EAQFA,OARE,CAQM,OARN,EAQe,GARf,EASFA,OATE,CASM,OATN,EASe,GATf,CAAP;AAUH;AACD;;;;;;;;;;UAQM4b,U;AACF,8BAA0B;AAAA;;AAAA,cAAdz8B,OAAc,uEAAJ,EAAI;;AAAA;;AACtB,eAAK08B,OAAL,GAAe,IAAf;AACA,eAAKC,SAAL,GAAiB,IAAjB;AACA,eAAKC,OAAL,GAAe58B,OAAO,CAAC48B,OAAR,IAAmB,IAAId,oBAAJ,EAAlC;;AACA,cAAI,CAAC,CAAC97B,OAAO,CAAC68B,UAAd,EAA0B;AACtB,gBAAI,CAAC,CAAC78B,OAAO,CAAC88B,UAAd,EAA0B;AACtB,oBAAM,IAAI3vB,KAAJ,kDAAN;AACH;;AACD,iBAAK4R,GAAL,GAAWid,WAAW,CAACh8B,OAAO,CAAC68B,UAAT,EAAqB,KAAKD,OAA1B,CAAtB;AACH,WALD,MAMK,IAAI,CAAC,CAAC58B,OAAO,CAAC88B,UAAd,EAA0B;AAC3B,iBAAK/d,GAAL,GAAW,IAAI4b,GAAJ,EAAX;AACA55B,kBAAM,CAAC+d,IAAP,CAAY9e,OAAO,CAAC88B,UAApB,EAAgCpwB,OAAhC,CAAwC,UAAAN,GAAG,EAAI;AAC3C,kBAAM5O,KAAK,GAAGwC,OAAO,CAAC88B,UAAR,CAAmB1wB,GAAnB,CAAd;;AACA,qBAAI,CAAC2S,GAAL,CAAS3K,GAAT,CAAahI,GAAb,EAAkBvH,KAAK,CAACyiB,OAAN,CAAc9pB,KAAd,IAAuBA,KAAvB,GAA+B,CAACA,KAAD,CAAjD;AACH,aAHD;AAIH,WANI,MAOA;AACD,iBAAKuhB,GAAL,GAAW,IAAX;AACH;AACJ;AACD;;;;;;;;;;iBAMA,aAAIqd,KAAJ,EAAW;AACP,iBAAKzd,IAAL;AACA,mBAAO,KAAKI,GAAL,CAASmc,GAAT,CAAakB,KAAb,CAAP;AACH;AACD;;;;;;;;;iBAMA,aAAIA,KAAJ,EAAW;AACP,iBAAKzd,IAAL;AACA,gBAAMiN,GAAG,GAAG,KAAK7M,GAAL,CAASoc,GAAT,CAAaiB,KAAb,CAAZ;AACA,mBAAO,CAAC,CAACxQ,GAAF,GAAQA,GAAG,CAAC,CAAD,CAAX,GAAiB,IAAxB;AACH;AACD;;;;;;;;;iBAMA,gBAAOwQ,KAAP,EAAc;AACV,iBAAKzd,IAAL;AACA,mBAAO,KAAKI,GAAL,CAASoc,GAAT,CAAaiB,KAAb,KAAuB,IAA9B;AACH;AACD;;;;;;;iBAIA,gBAAO;AACH,iBAAKzd,IAAL;AACA,mBAAO9Z,KAAK,CAACoH,IAAN,CAAW,KAAK8S,GAAL,CAASD,IAAT,EAAX,CAAP;AACH;AACD;;;;;;;;;iBAMA,gBAAOsd,KAAP,EAAc5+B,KAAd,EAAqB;AACjB,mBAAO,KAAK69B,KAAL,CAAW;AAAEe,mBAAK,EAALA,KAAF;AAAS5+B,mBAAK,EAALA,KAAT;AAAgB89B,gBAAE,EAAE;AAApB,aAAX,CAAP;AACH;AACD;;;;;;;;iBAKA,mBAAUa,MAAV,EAAkB;AACd,gBAAMO,OAAO,GAAG,EAAhB;AACA37B,kBAAM,CAAC+d,IAAP,CAAYqd,MAAZ,EAAoBzvB,OAApB,CAA4B,UAAA0vB,KAAK,EAAI;AACjC,kBAAM5+B,KAAK,GAAG2+B,MAAM,CAACC,KAAD,CAApB;;AACA,kBAAIv3B,KAAK,CAACyiB,OAAN,CAAc9pB,KAAd,CAAJ,EAA0B;AACtBA,qBAAK,CAACkP,OAAN,CAAc,UAAAqwB,MAAM,EAAI;AACpBL,yBAAO,CAACrlB,IAAR,CAAa;AAAE+kB,yBAAK,EAALA,KAAF;AAAS5+B,yBAAK,EAAEu/B,MAAhB;AAAwBzB,sBAAE,EAAE;AAA5B,mBAAb;AACH,iBAFD;AAGH,eAJD,MAKK;AACDoB,uBAAO,CAACrlB,IAAR,CAAa;AAAE+kB,uBAAK,EAALA,KAAF;AAAS5+B,uBAAK,EAALA,KAAT;AAAgB89B,oBAAE,EAAE;AAApB,iBAAb;AACH;AACJ,aAVD;AAWA,mBAAO,KAAKD,KAAL,CAAWqB,OAAX,CAAP;AACH;AACD;;;;;;;;;iBAMA,aAAIN,KAAJ,EAAW5+B,KAAX,EAAkB;AACd,mBAAO,KAAK69B,KAAL,CAAW;AAAEe,mBAAK,EAALA,KAAF;AAAS5+B,mBAAK,EAALA,KAAT;AAAgB89B,gBAAE,EAAE;AAApB,aAAX,CAAP;AACH;AACD;;;;;;;;;;iBAOA,iBAAOc,KAAP,EAAc5+B,KAAd,EAAqB;AACjB,mBAAO,KAAK69B,KAAL,CAAW;AAAEe,mBAAK,EAALA,KAAF;AAAS5+B,mBAAK,EAALA,KAAT;AAAgB89B,gBAAE,EAAE;AAApB,aAAX,CAAP;AACH;AACD;;;;;;;iBAIA,oBAAW;AAAA;;AACP,iBAAK3c,IAAL;AACA,mBAAO,KAAKG,IAAL,GACFC,GADE,CACE,UAAA3S,GAAG,EAAI;AACZ,kBAAM4wB,IAAI,GAAG,OAAI,CAACJ,OAAL,CAAaK,SAAb,CAAuB7wB,GAAvB,CAAb,CADY,CAEZ;AACA;AACA;;;AACA,qBAAO,OAAI,CAAC2S,GAAL,CAASoc,GAAT,CAAa/uB,GAAb,EAAkB2S,GAAlB,CAAsB,UAAAvhB,KAAK;AAAA,uBAAIw/B,IAAI,GAAG,GAAP,GAAa,OAAI,CAACJ,OAAL,CAAaM,WAAb,CAAyB1/B,KAAzB,CAAjB;AAAA,eAA3B,EACF2mB,IADE,CACG,GADH,CAAP;AAEH,aARM,EASH;AACA;AAVG,aAWF1R,MAXE,CAWK,UAAA2pB,KAAK;AAAA,qBAAIA,KAAK,KAAK,EAAd;AAAA,aAXV,EAYFjY,IAZE,CAYG,GAZH,CAAP;AAaH;;;iBACD,eAAMsX,MAAN,EAAc;AACV,gBAAMJ,KAAK,GAAG,IAAIoB,UAAJ,CAAe;AAAEG,qBAAO,EAAE,KAAKA;AAAhB,aAAf,CAAd;AACAvB,iBAAK,CAACsB,SAAN,GAAkB,KAAKA,SAAL,IAAkB,IAApC;AACAtB,iBAAK,CAACqB,OAAN,GAAgB,CAAC,KAAKA,OAAL,IAAgB,EAAjB,EAAqBlU,MAArB,CAA4BiT,MAA5B,CAAhB;AACA,mBAAOJ,KAAP;AACH;;;iBACD,gBAAO;AAAA;;AACH,gBAAI,KAAKtc,GAAL,KAAa,IAAjB,EAAuB;AACnB,mBAAKA,GAAL,GAAW,IAAI4b,GAAJ,EAAX;AACH;;AACD,gBAAI,KAAKgC,SAAL,KAAmB,IAAvB,EAA6B;AACzB,mBAAKA,SAAL,CAAehe,IAAf;AACA,mBAAKge,SAAL,CAAe7d,IAAf,GAAsBpS,OAAtB,CAA8B,UAAAN,GAAG;AAAA,uBAAI,OAAI,CAAC2S,GAAL,CAAS3K,GAAT,CAAahI,GAAb,EAAkB,OAAI,CAACuwB,SAAL,CAAe5d,GAAf,CAAmBoc,GAAnB,CAAuB/uB,GAAvB,CAAlB,CAAJ;AAAA,eAAjC;AACA,mBAAKswB,OAAL,CAAahwB,OAAb,CAAqB,UAAA+uB,MAAM,EAAI;AAC3B,wBAAQA,MAAM,CAACH,EAAf;AACI,uBAAK,GAAL;AACA,uBAAK,GAAL;AACI,wBAAM9a,IAAI,GAAG,CAACib,MAAM,CAACH,EAAP,KAAc,GAAd,GAAoB,OAAI,CAACvc,GAAL,CAASoc,GAAT,CAAaM,MAAM,CAACW,KAApB,CAApB,GAAiDn/B,SAAlD,KAAgE,EAA7E;AACAujB,wBAAI,CAACnJ,IAAL,CAAUokB,MAAM,CAACj+B,KAAjB;;AACA,2BAAI,CAACuhB,GAAL,CAAS3K,GAAT,CAAaqnB,MAAM,CAACW,KAApB,EAA2B5b,IAA3B;;AACA;;AACJ,uBAAK,GAAL;AACI,wBAAIib,MAAM,CAACj+B,KAAP,KAAiBP,SAArB,EAAgC;AAC5B,0BAAIujB,KAAI,GAAG,OAAI,CAACzB,GAAL,CAASoc,GAAT,CAAaM,MAAM,CAACW,KAApB,KAA8B,EAAzC;;AACA,0BAAM5oB,GAAG,GAAGgN,KAAI,CAAC/R,OAAL,CAAagtB,MAAM,CAACj+B,KAApB,CAAZ;;AACA,0BAAIgW,GAAG,KAAK,CAAC,CAAb,EAAgB;AACZgN,6BAAI,CAAC2c,MAAL,CAAY3pB,GAAZ,EAAiB,CAAjB;AACH;;AACD,0BAAIgN,KAAI,CAACnc,MAAL,GAAc,CAAlB,EAAqB;AACjB,+BAAI,CAAC0a,GAAL,CAAS3K,GAAT,CAAaqnB,MAAM,CAACW,KAApB,EAA2B5b,KAA3B;AACH,uBAFD,MAGK;AACD,+BAAI,CAACzB,GAAL,WAAgB0c,MAAM,CAACW,KAAvB;AACH;AACJ,qBAZD,MAaK;AACD,6BAAI,CAACrd,GAAL,WAAgB0c,MAAM,CAACW,KAAvB;;AACA;AACH;;AAxBT;AA0BH,eA3BD;AA4BA,mBAAKO,SAAL,GAAiB,KAAKD,OAAL,GAAe,IAAhC;AACH;AACJ;;;;;AAGL;;;;;;;;AAOA;;;;;AAGA,eAASU,aAAT,CAAuBC,MAAvB,EAA+B;AAC3B,gBAAQA,MAAR;AACI,eAAK,QAAL;AACA,eAAK,KAAL;AACA,eAAK,MAAL;AACA,eAAK,SAAL;AACA,eAAK,OAAL;AACI,mBAAO,KAAP;;AACJ;AACI,mBAAO,IAAP;AARR;AAUH;AACD;;;;;;;AAKA,eAASC,aAAT,CAAuB9/B,KAAvB,EAA8B;AAC1B,eAAO,OAAO+/B,WAAP,KAAuB,WAAvB,IAAsC//B,KAAK,YAAY+/B,WAA9D;AACH;AACD;;;;;;;AAKA,eAASC,MAAT,CAAgBhgC,KAAhB,EAAuB;AACnB,eAAO,OAAOooB,IAAP,KAAgB,WAAhB,IAA+BpoB,KAAK,YAAYooB,IAAvD;AACH;AACD;;;;;;;AAKA,eAAS6X,UAAT,CAAoBjgC,KAApB,EAA2B;AACvB,eAAO,OAAOkgC,QAAP,KAAoB,WAApB,IAAmClgC,KAAK,YAAYkgC,QAA3D;AACH;AACD;;;;;;;;;;;;UAUMC,W;AACF,6BAAYN,MAAZ,EAAoBjV,GAApB,EAAyBwV,KAAzB,EAAgCC,MAAhC,EAAwC;AAAA;;AACpC,eAAKzV,GAAL,GAAWA,GAAX;AACA;;;;;;;;AAOA,eAAK0V,IAAL,GAAY,IAAZ;AACA;;;;;;;AAMA,eAAKC,cAAL,GAAsB,KAAtB;AACA;;;;AAGA,eAAKC,eAAL,GAAuB,KAAvB;AACA;;;;;;;AAMA,eAAKC,YAAL,GAAoB,MAApB;AACA,eAAKZ,MAAL,GAAcA,MAAM,CAAC3Q,WAAP,EAAd,CA5BoC,CA6BpC;AACA;;AACA,cAAI1sB,OAAJ,CA/BoC,CAgCpC;AACA;;AACA,cAAIo9B,aAAa,CAAC,KAAKC,MAAN,CAAb,IAA8B,CAAC,CAACQ,MAApC,EAA4C;AACxC;AACA,iBAAKC,IAAL,GAAaF,KAAK,KAAK3gC,SAAX,GAAwB2gC,KAAxB,GAAgC,IAA5C;AACA59B,mBAAO,GAAG69B,MAAV;AACH,WAJD,MAKK;AACD;AACA79B,mBAAO,GAAG49B,KAAV;AACH,WA1CmC,CA2CpC;;;AACA,cAAI59B,OAAJ,EAAa;AACT;AACA,iBAAK+9B,cAAL,GAAsB,CAAC,CAAC/9B,OAAO,CAAC+9B,cAAhC;AACA,iBAAKC,eAAL,GAAuB,CAAC,CAACh+B,OAAO,CAACg+B,eAAjC,CAHS,CAIT;;AACA,gBAAI,CAAC,CAACh+B,OAAO,CAACi+B,YAAd,EAA4B;AACxB,mBAAKA,YAAL,GAAoBj+B,OAAO,CAACi+B,YAA5B;AACH,aAPQ,CAQT;;;AACA,gBAAI,CAAC,CAACj+B,OAAO,CAACy6B,OAAd,EAAuB;AACnB,mBAAKA,OAAL,GAAez6B,OAAO,CAACy6B,OAAvB;AACH;;AACD,gBAAI,CAAC,CAACz6B,OAAO,CAACm8B,MAAd,EAAsB;AAClB,mBAAKA,MAAL,GAAcn8B,OAAO,CAACm8B,MAAtB;AACH;AACJ,WA3DmC,CA4DpC;;;AACA,cAAI,CAAC,KAAK1B,OAAV,EAAmB;AACf,iBAAKA,OAAL,GAAe,IAAID,WAAJ,EAAf;AACH,WA/DmC,CAgEpC;;;AACA,cAAI,CAAC,KAAK2B,MAAV,EAAkB;AACd,iBAAKA,MAAL,GAAc,IAAIM,UAAJ,EAAd;AACA,iBAAKyB,aAAL,GAAqB9V,GAArB;AACH,WAHD,MAIK;AACD;AACA,gBAAM+T,MAAM,GAAG,KAAKA,MAAL,CAAYziB,QAAZ,EAAf;;AACA,gBAAIyiB,MAAM,CAAC93B,MAAP,KAAkB,CAAtB,EAAyB;AACrB;AACA,mBAAK65B,aAAL,GAAqB9V,GAArB;AACH,aAHD,MAIK;AACD;AACA,kBAAM+V,IAAI,GAAG/V,GAAG,CAAC3Z,OAAJ,CAAY,GAAZ,CAAb,CAFC,CAGD;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,kBAAM2vB,GAAG,GAAGD,IAAI,KAAK,CAAC,CAAV,GAAc,GAAd,GAAqBA,IAAI,GAAG/V,GAAG,CAAC/jB,MAAJ,GAAa,CAApB,GAAwB,GAAxB,GAA8B,EAA/D;AACA,mBAAK65B,aAAL,GAAqB9V,GAAG,GAAGgW,GAAN,GAAYjC,MAAjC;AACH;AACJ;AACJ;AACD;;;;;;;;iBAIA,yBAAgB;AACZ;AACA,gBAAI,KAAK2B,IAAL,KAAc,IAAlB,EAAwB;AACpB,qBAAO,IAAP;AACH,aAJW,CAKZ;AACA;;;AACA,gBAAIR,aAAa,CAAC,KAAKQ,IAAN,CAAb,IAA4BN,MAAM,CAAC,KAAKM,IAAN,CAAlC,IAAiDL,UAAU,CAAC,KAAKK,IAAN,CAA3D,IACA,OAAO,KAAKA,IAAZ,KAAqB,QADzB,EACmC;AAC/B,qBAAO,KAAKA,IAAZ;AACH,aAVW,CAWZ;;;AACA,gBAAI,KAAKA,IAAL,YAAqBrB,UAAzB,EAAqC;AACjC,qBAAO,KAAKqB,IAAL,CAAUpkB,QAAV,EAAP;AACH,aAdW,CAeZ;;;AACA,gBAAI,OAAO,KAAKokB,IAAZ,KAAqB,QAArB,IAAiC,OAAO,KAAKA,IAAZ,KAAqB,SAAtD,IACAj5B,KAAK,CAACyiB,OAAN,CAAc,KAAKwW,IAAnB,CADJ,EAC8B;AAC1B,qBAAOlZ,IAAI,CAACD,SAAL,CAAe,KAAKmZ,IAApB,CAAP;AACH,aAnBW,CAoBZ;;;AACA,mBAAO,KAAKA,IAAL,CAAUpkB,QAAV,EAAP;AACH;AACD;;;;;;;;;iBAMA,mCAA0B;AACtB;AACA,gBAAI,KAAKokB,IAAL,KAAc,IAAlB,EAAwB;AACpB,qBAAO,IAAP;AACH,aAJqB,CAKtB;;;AACA,gBAAIL,UAAU,CAAC,KAAKK,IAAN,CAAd,EAA2B;AACvB,qBAAO,IAAP;AACH,aARqB,CAStB;AACA;;;AACA,gBAAIN,MAAM,CAAC,KAAKM,IAAN,CAAV,EAAuB;AACnB,qBAAO,KAAKA,IAAL,CAAUp7B,IAAV,IAAkB,IAAzB;AACH,aAbqB,CActB;;;AACA,gBAAI46B,aAAa,CAAC,KAAKQ,IAAN,CAAjB,EAA8B;AAC1B,qBAAO,IAAP;AACH,aAjBqB,CAkBtB;AACA;;;AACA,gBAAI,OAAO,KAAKA,IAAZ,KAAqB,QAAzB,EAAmC;AAC/B,qBAAO,YAAP;AACH,aAtBqB,CAuBtB;;;AACA,gBAAI,KAAKA,IAAL,YAAqBrB,UAAzB,EAAqC;AACjC,qBAAO,iDAAP;AACH,aA1BqB,CA2BtB;;;AACA,gBAAI,OAAO,KAAKqB,IAAZ,KAAqB,QAArB,IAAiC,OAAO,KAAKA,IAAZ,KAAqB,QAAtD,IACAj5B,KAAK,CAACyiB,OAAN,CAAc,KAAKwW,IAAnB,CADJ,EAC8B;AAC1B,qBAAO,kBAAP;AACH,aA/BqB,CAgCtB;;;AACA,mBAAO,IAAP;AACH;;;iBACD,iBAAmB;AAAA,gBAAbrC,MAAa,uEAAJ,EAAI;AACf;AACA;AACA,gBAAM4B,MAAM,GAAG5B,MAAM,CAAC4B,MAAP,IAAiB,KAAKA,MAArC;AACA,gBAAMjV,GAAG,GAAGqT,MAAM,CAACrT,GAAP,IAAc,KAAKA,GAA/B;AACA,gBAAM6V,YAAY,GAAGxC,MAAM,CAACwC,YAAP,IAAuB,KAAKA,YAAjD,CALe,CAMf;AACA;AACA;AACA;;AACA,gBAAMH,IAAI,GAAIrC,MAAM,CAACqC,IAAP,KAAgB7gC,SAAjB,GAA8Bw+B,MAAM,CAACqC,IAArC,GAA4C,KAAKA,IAA9D,CAVe,CAWf;AACA;;AACA,gBAAME,eAAe,GAAIvC,MAAM,CAACuC,eAAP,KAA2B/gC,SAA5B,GAAyCw+B,MAAM,CAACuC,eAAhD,GAAkE,KAAKA,eAA/F;AACA,gBAAMD,cAAc,GAAItC,MAAM,CAACsC,cAAP,KAA0B9gC,SAA3B,GAAwCw+B,MAAM,CAACsC,cAA/C,GAAgE,KAAKA,cAA5F,CAde,CAef;AACA;;AACA,gBAAItD,OAAO,GAAGgB,MAAM,CAAChB,OAAP,IAAkB,KAAKA,OAArC;AACA,gBAAI0B,MAAM,GAAGV,MAAM,CAACU,MAAP,IAAiB,KAAKA,MAAnC,CAlBe,CAmBf;;AACA,gBAAIV,MAAM,CAAC4C,UAAP,KAAsBphC,SAA1B,EAAqC;AACjC;AACAw9B,qBAAO,GACH15B,MAAM,CAAC+d,IAAP,CAAY2c,MAAM,CAAC4C,UAAnB,EACKC,MADL,CACY,UAAC7D,OAAD,EAAU9vB,IAAV;AAAA,uBAAmB8vB,OAAO,CAACrmB,GAAR,CAAYzJ,IAAZ,EAAkB8wB,MAAM,CAAC4C,UAAP,CAAkB1zB,IAAlB,CAAlB,CAAnB;AAAA,eADZ,EAC2E8vB,OAD3E,CADJ;AAGH,aAzBc,CA0Bf;;;AACA,gBAAIgB,MAAM,CAAC8C,SAAX,EAAsB;AAClB;AACApC,oBAAM,GAAGp7B,MAAM,CAAC+d,IAAP,CAAY2c,MAAM,CAAC8C,SAAnB,EACJD,MADI,CACG,UAACnC,MAAD,EAASC,KAAT;AAAA,uBAAmBD,MAAM,CAAC/nB,GAAP,CAAWgoB,KAAX,EAAkBX,MAAM,CAAC8C,SAAP,CAAiBnC,KAAjB,CAAlB,CAAnB;AAAA,eADH,EACkED,MADlE,CAAT;AAEH,aA/Bc,CAgCf;;;AACA,mBAAO,IAAIwB,WAAJ,CAAgBN,MAAhB,EAAwBjV,GAAxB,EAA6B0V,IAA7B,EAAmC;AACtC3B,oBAAM,EAANA,MADsC;AAEtC1B,qBAAO,EAAPA,OAFsC;AAGtCsD,4BAAc,EAAdA,cAHsC;AAItCE,0BAAY,EAAZA,YAJsC;AAKtCD,6BAAe,EAAfA;AALsC,aAAnC,CAAP;AAOH;;;;;AAGL;;;;;;;;AAOA;;;;;;;AAKA,UAAIQ,aAAa,gBAChB,UAAUA,aAAV,EAAyB;AACtB;;;AAGAA,qBAAa,CAACA,aAAa,CAAC,MAAD,CAAb,GAAwB,CAAzB,CAAb,GAA2C,MAA3C;AACA;;;;AAGAA,qBAAa,CAACA,aAAa,CAAC,gBAAD,CAAb,GAAkC,CAAnC,CAAb,GAAqD,gBAArD;AACA;;;;AAGAA,qBAAa,CAACA,aAAa,CAAC,gBAAD,CAAb,GAAkC,CAAnC,CAAb,GAAqD,gBAArD;AACA;;;;AAGAA,qBAAa,CAACA,aAAa,CAAC,kBAAD,CAAb,GAAoC,CAArC,CAAb,GAAuD,kBAAvD;AACA;;;;AAGAA,qBAAa,CAACA,aAAa,CAAC,UAAD,CAAb,GAA4B,CAA7B,CAAb,GAA+C,UAA/C;AACA;;;;AAGAA,qBAAa,CAACA,aAAa,CAAC,MAAD,CAAb,GAAwB,CAAzB,CAAb,GAA2C,MAA3C;eAxBOA,a;AAyBV,OAzBD,CAyBG,EAzBH,CADA;AA2BA;;;;;;;UAKMC,gB;AACF;;;;;;AAMA,gCAAY9f,IAAZ,EAAiE;AAAA,YAA/C+f,aAA+C,uEAA/B,GAA+B;AAAA,YAA1BC,iBAA0B,uEAAN,IAAM;;AAAA;;AAC7D;AACA;AACA,aAAKlE,OAAL,GAAe9b,IAAI,CAAC8b,OAAL,IAAgB,IAAID,WAAJ,EAA/B;AACA,aAAKxf,MAAL,GAAc2D,IAAI,CAAC3D,MAAL,KAAgB/d,SAAhB,GAA4B0hB,IAAI,CAAC3D,MAAjC,GAA0C0jB,aAAxD;AACA,aAAKE,UAAL,GAAkBjgB,IAAI,CAACigB,UAAL,IAAmBD,iBAArC;AACA,aAAKvW,GAAL,GAAWzJ,IAAI,CAACyJ,GAAL,IAAY,IAAvB,CAN6D,CAO7D;;AACA,aAAKyW,EAAL,GAAU,KAAK7jB,MAAL,IAAe,GAAf,IAAsB,KAAKA,MAAL,GAAc,GAA9C;AACH,O;AAEL;;;;;;;;;;;UASM8jB,kB;;;;;AACF;;;AAGA,sCAAuB;AAAA;;AAAA,cAAXngB,IAAW,uEAAJ,EAAI;;AAAA;;AACnB,uCAAMA,IAAN;AACA,kBAAKjc,IAAL,GAAY87B,aAAa,CAACO,cAA1B;AAFmB;AAGtB;AACD;;;;;;;;iBAIA,iBAAmB;AAAA,gBAAbtD,MAAa,uEAAJ,EAAI;AACf;AACA;AACA,mBAAO,IAAIqD,kBAAJ,CAAuB;AAC1BrE,qBAAO,EAAEgB,MAAM,CAAChB,OAAP,IAAkB,KAAKA,OADN;AAE1Bzf,oBAAM,EAAEygB,MAAM,CAACzgB,MAAP,KAAkB/d,SAAlB,GAA8Bw+B,MAAM,CAACzgB,MAArC,GAA8C,KAAKA,MAFjC;AAG1B4jB,wBAAU,EAAEnD,MAAM,CAACmD,UAAP,IAAqB,KAAKA,UAHZ;AAI1BxW,iBAAG,EAAEqT,MAAM,CAACrT,GAAP,IAAc,KAAKA,GAAnB,IAA0BnrB;AAJL,aAAvB,CAAP;AAMH;;;;QArB4BwhC,gB;AAuBjC;;;;;;;;;;;UASMO,Y;;;;;AACF;;;AAGA,gCAAuB;AAAA;;AAAA,cAAXrgB,IAAW,uEAAJ,EAAI;;AAAA;;AACnB,uCAAMA,IAAN;AACA,kBAAKjc,IAAL,GAAY87B,aAAa,CAACS,QAA1B;AACA,kBAAKnB,IAAL,GAAYnf,IAAI,CAACmf,IAAL,KAAc7gC,SAAd,GAA0B0hB,IAAI,CAACmf,IAA/B,GAAsC,IAAlD;AAHmB;AAItB;;;;iBACD,iBAAmB;AAAA,gBAAbrC,MAAa,uEAAJ,EAAI;AACf,mBAAO,IAAIuD,YAAJ,CAAiB;AACpBlB,kBAAI,EAAGrC,MAAM,CAACqC,IAAP,KAAgB7gC,SAAjB,GAA8Bw+B,MAAM,CAACqC,IAArC,GAA4C,KAAKA,IADnC;AAEpBrD,qBAAO,EAAEgB,MAAM,CAAChB,OAAP,IAAkB,KAAKA,OAFZ;AAGpBzf,oBAAM,EAAGygB,MAAM,CAACzgB,MAAP,KAAkB/d,SAAnB,GAAgCw+B,MAAM,CAACzgB,MAAvC,GAAgD,KAAKA,MAHzC;AAIpB4jB,wBAAU,EAAEnD,MAAM,CAACmD,UAAP,IAAqB,KAAKA,UAJlB;AAKpBxW,iBAAG,EAAEqT,MAAM,CAACrT,GAAP,IAAc,KAAKA,GAAnB,IAA0BnrB;AALX,aAAjB,CAAP;AAOH;;;;QAjBsBwhC,gB;AAmB3B;;;;;;;;;;;;;;;UAaMS,iB;;;;;AACF,mCAAYvgB,IAAZ,EAAkB;AAAA;;AAAA;;AACd;AACA,uCAAMA,IAAN,EAAY,CAAZ,EAAe,eAAf;AACA,kBAAKhU,IAAL,GAAY,mBAAZ;AACA;;;;AAGA,kBAAKk0B,EAAL,GAAU,KAAV,CAPc,CAQd;AACA;AACA;;AACA,cAAI,QAAK7jB,MAAL,IAAe,GAAf,IAAsB,QAAKA,MAAL,GAAc,GAAxC,EAA6C;AACzC,oBAAKwR,OAAL,6CAAkD7N,IAAI,CAACyJ,GAAL,IAAY,eAA9D;AACH,WAFD,MAGK;AACD,oBAAKoE,OAAL,uCAA4C7N,IAAI,CAACyJ,GAAL,IAAY,eAAxD,eAA4EzJ,IAAI,CAAC3D,MAAjF,cAA2F2D,IAAI,CAACigB,UAAhG;AACH;;AACD,kBAAKhiC,KAAL,GAAa+hB,IAAI,CAAC/hB,KAAL,IAAc,IAA3B;AAjBc;AAkBjB;;;QAnB2B6hC,gB;AAsBhC;;;;;;;;AAOA;;;;;;;;;;;;AAUA,eAASU,OAAT,CAAiBn/B,OAAjB,EAA0B89B,IAA1B,EAAgC;AAC5B,eAAO;AACHA,cAAI,EAAJA,IADG;AAEHrD,iBAAO,EAAEz6B,OAAO,CAACy6B,OAFd;AAGH2E,iBAAO,EAAEp/B,OAAO,CAACo/B,OAHd;AAIHjD,gBAAM,EAAEn8B,OAAO,CAACm8B,MAJb;AAKH4B,wBAAc,EAAE/9B,OAAO,CAAC+9B,cALrB;AAMHE,sBAAY,EAAEj+B,OAAO,CAACi+B,YANnB;AAOHD,yBAAe,EAAEh+B,OAAO,CAACg+B;AAPtB,SAAP;AASH;;;YA+CKqB,U;AACF,8BAAYC,OAAZ,EAAqB;AAAA;;AACjB,iBAAKA,OAAL,GAAeA,OAAf;AACH;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;mBA0BA,iBAAQz7B,KAAR,EAAeukB,GAAf,EAAkC;AAAA;;AAAA,kBAAdpoB,OAAc,uEAAJ,EAAI;AAC9B,kBAAIu/B,GAAJ,CAD8B,CAE9B;;AACA,kBAAI17B,KAAK,YAAY85B,WAArB,EAAkC;AAC9B;AACA;AACA4B,mBAAG,GAAG17B,KAAN;AACH,eAJD,MAKK;AACD;AACA;AACA;AACA;AACA,oBAAI42B,OAAO,GAAGx9B,SAAd;;AACA,oBAAI+C,OAAO,CAACy6B,OAAR,YAA2BD,WAA/B,EAA4C;AACxCC,yBAAO,GAAGz6B,OAAO,CAACy6B,OAAlB;AACH,iBAFD,MAGK;AACDA,yBAAO,GAAG,IAAID,WAAJ,CAAgBx6B,OAAO,CAACy6B,OAAxB,CAAV;AACH,iBAXA,CAYD;;;AACA,oBAAI0B,MAAM,GAAGl/B,SAAb;;AACA,oBAAI,CAAC,CAAC+C,OAAO,CAACm8B,MAAd,EAAsB;AAClB,sBAAIn8B,OAAO,CAACm8B,MAAR,YAA0BM,UAA9B,EAA0C;AACtCN,0BAAM,GAAGn8B,OAAO,CAACm8B,MAAjB;AACH,mBAFD,MAGK;AACDA,0BAAM,GAAG,IAAIM,UAAJ,CAAe;AAAEK,gCAAU,EAAE98B,OAAO,CAACm8B;AAAtB,qBAAf,CAAT;AACH;AACJ,iBArBA,CAsBD;;;AACAoD,mBAAG,GAAG,IAAI5B,WAAJ,CAAgB95B,KAAhB,EAAuBukB,GAAvB,EAA6BpoB,OAAO,CAAC89B,IAAR,KAAiB7gC,SAAjB,GAA6B+C,OAAO,CAAC89B,IAArC,GAA4C,IAAzE,EAAgF;AAClFrD,yBAAO,EAAPA,OADkF;AAElF0B,wBAAM,EAANA,MAFkF;AAGlF4B,gCAAc,EAAE/9B,OAAO,CAAC+9B,cAH0D;AAIlF;AACAE,8BAAY,EAAEj+B,OAAO,CAACi+B,YAAR,IAAwB,MAL4C;AAMlFD,iCAAe,EAAEh+B,OAAO,CAACg+B;AANyD,iBAAhF,CAAN;AAQH,eAvC6B,CAwC9B;AACA;AACA;AACA;;;AACA,kBAAMwB,OAAO,GAAG,gDAAGD,GAAH,EAAQliC,IAAR,CAAa,iEAAU,UAACkiC,GAAD;AAAA,uBAAS,OAAI,CAACD,OAAL,CAAaG,MAAb,CAAoBF,GAApB,CAAT;AAAA,eAAV,CAAb,CAAhB,CA5C8B,CA6C9B;AACA;AACA;;AACA,kBAAI17B,KAAK,YAAY85B,WAAjB,IAAgC39B,OAAO,CAACo/B,OAAR,KAAoB,QAAxD,EAAkE;AAC9D,uBAAOI,OAAP;AACH,eAlD6B,CAmD9B;AACA;AACA;;;AACA,kBAAME,IAAI,GAAGF,OAAO,CAACniC,IAAR,CAAa,8DAAO,UAACK,KAAD;AAAA,uBAAWA,KAAK,YAAYshC,YAA5B;AAAA,eAAP,CAAb,CAAb,CAtD8B,CAuD9B;;AACA,sBAAQh/B,OAAO,CAACo/B,OAAR,IAAmB,MAA3B;AACI,qBAAK,MAAL;AACI;AACA;AACA;AACA;AACA;AACA,0BAAQG,GAAG,CAACtB,YAAZ;AACI,yBAAK,aAAL;AACI,6BAAOyB,IAAI,CAACriC,IAAL,CAAU,2DAAI,UAACuuB,GAAD,EAAS;AAC1B;AACA,4BAAIA,GAAG,CAACkS,IAAJ,KAAa,IAAb,IAAqB,EAAElS,GAAG,CAACkS,IAAJ,YAAoBP,WAAtB,CAAzB,EAA6D;AACzD,gCAAM,IAAIpwB,KAAJ,CAAU,iCAAV,CAAN;AACH;;AACD,+BAAOye,GAAG,CAACkS,IAAX;AACH,uBANgB,CAAV,CAAP;;AAOJ,yBAAK,MAAL;AACI,6BAAO4B,IAAI,CAACriC,IAAL,CAAU,2DAAI,UAACuuB,GAAD,EAAS;AAC1B;AACA,4BAAIA,GAAG,CAACkS,IAAJ,KAAa,IAAb,IAAqB,EAAElS,GAAG,CAACkS,IAAJ,YAAoBlY,IAAtB,CAAzB,EAAsD;AAClD,gCAAM,IAAIzY,KAAJ,CAAU,yBAAV,CAAN;AACH;;AACD,+BAAOye,GAAG,CAACkS,IAAX;AACH,uBANgB,CAAV,CAAP;;AAOJ,yBAAK,MAAL;AACI,6BAAO4B,IAAI,CAACriC,IAAL,CAAU,2DAAI,UAACuuB,GAAD,EAAS;AAC1B;AACA,4BAAIA,GAAG,CAACkS,IAAJ,KAAa,IAAb,IAAqB,OAAOlS,GAAG,CAACkS,IAAX,KAAoB,QAA7C,EAAuD;AACnD,gCAAM,IAAI3wB,KAAJ,CAAU,2BAAV,CAAN;AACH;;AACD,+BAAOye,GAAG,CAACkS,IAAX;AACH,uBANgB,CAAV,CAAP;;AAOJ,yBAAK,MAAL;AACA;AACI;AACA,6BAAO4B,IAAI,CAACriC,IAAL,CAAU,2DAAI,UAACuuB,GAAD;AAAA,+BAASA,GAAG,CAACkS,IAAb;AAAA,uBAAJ,CAAV,CAAP;AA5BR;;AA8BJ,qBAAK,UAAL;AACI;AACA,yBAAO4B,IAAP;;AACJ;AACI;AACA,wBAAM,IAAIvyB,KAAJ,+CAAiDnN,OAAO,CAACo/B,OAAzD,OAAN;AA1CR;AA4CH;AACD;;;;;;;;;;;;mBASA,iBAAOhX,GAAP,EAA0B;AAAA,kBAAdpoB,OAAc,uEAAJ,EAAI;AACtB,qBAAO,KAAK2/B,OAAL,CAAa,QAAb,EAAuBvX,GAAvB,EAA4BpoB,OAA5B,CAAP;AACH;AACD;;;;;;;;mBAKA,aAAIooB,GAAJ,EAAuB;AAAA,kBAAdpoB,OAAc,uEAAJ,EAAI;AACnB,qBAAO,KAAK2/B,OAAL,CAAa,KAAb,EAAoBvX,GAApB,EAAyBpoB,OAAzB,CAAP;AACH;AACD;;;;;;;;;;mBAOA,cAAKooB,GAAL,EAAwB;AAAA,kBAAdpoB,OAAc,uEAAJ,EAAI;AACpB,qBAAO,KAAK2/B,OAAL,CAAa,MAAb,EAAqBvX,GAArB,EAA0BpoB,OAA1B,CAAP;AACH;AACD;;;;;;;;;;;;;;;;;;;;;mBAkBA,eAAMooB,GAAN,EAAWwX,aAAX,EAA0B;AACtB,qBAAO,KAAKD,OAAL,CAAa,OAAb,EAAsBvX,GAAtB,EAA2B;AAC9B+T,sBAAM,EAAE,IAAIM,UAAJ,GAAiBoD,MAAjB,CAAwBD,aAAxB,EAAuC,gBAAvC,CADsB;AAE9BR,uBAAO,EAAE,MAFqB;AAG9BnB,4BAAY,EAAE;AAHgB,eAA3B,CAAP;AAKH;AACD;;;;;;;;;;mBAOA,iBAAQ7V,GAAR,EAA2B;AAAA,kBAAdpoB,QAAc,uEAAJ,EAAI;;AACvB,qBAAO,KAAK2/B,OAAL,CAAa,SAAb,EAAwBvX,GAAxB,EAA6BpoB,QAA7B,CAAP;AACH;AACD;;;;;;;;mBAKA,eAAMooB,GAAN,EAAW0V,IAAX,EAA+B;AAAA,kBAAd99B,OAAc,uEAAJ,EAAI;AAC3B,qBAAO,KAAK2/B,OAAL,CAAa,OAAb,EAAsBvX,GAAtB,EAA2B+W,OAAO,CAACn/B,OAAD,EAAU89B,IAAV,CAAlC,CAAP;AACH;AACD;;;;;;;;;mBAMA,cAAK1V,GAAL,EAAU0V,IAAV,EAA8B;AAAA,kBAAd99B,OAAc,uEAAJ,EAAI;AAC1B,qBAAO,KAAK2/B,OAAL,CAAa,MAAb,EAAqBvX,GAArB,EAA0B+W,OAAO,CAACn/B,OAAD,EAAU89B,IAAV,CAAjC,CAAP;AACH;AACD;;;;;;;;;mBAMA,aAAI1V,GAAJ,EAAS0V,IAAT,EAA6B;AAAA,kBAAd99B,OAAc,uEAAJ,EAAI;AACzB,qBAAO,KAAK2/B,OAAL,CAAa,KAAb,EAAoBvX,GAApB,EAAyB+W,OAAO,CAACn/B,OAAD,EAAU89B,IAAV,CAAhC,CAAP;AACH;;;;;;AAELuB,kBAAU,CAAC7gC,IAAX,GAAkB,SAASshC,kBAAT,CAA4BphC,CAA5B,EAA+B;AAAE,iBAAO,KAAKA,CAAC,IAAI2gC,UAAV,EAAsB,uDAAgB/E,WAAhB,CAAtB,CAAP;AAA6D,SAAhH;;AACA+E,kBAAU,CAAC1gC,KAAX,GAAmB,8EAA0B;AAAEC,eAAK,EAAEygC,UAAT;AAAqBxgC,iBAAO,EAAEwgC,UAAU,CAAC7gC;AAAzC,SAA1B,CAAnB;;;AAQA;;;;;;;;AAOA;;;;;;;UAKMuhC,sB;AACF,wCAAYtiC,IAAZ,EAAkBuiC,WAAlB,EAA+B;AAAA;;AAC3B,eAAKviC,IAAL,GAAYA,IAAZ;AACA,eAAKuiC,WAAL,GAAmBA,WAAnB;AACH;;;;iBACD,gBAAOT,GAAP,EAAY;AACR,mBAAO,KAAKS,WAAL,CAAiBC,SAAjB,CAA2BV,GAA3B,EAAgC,KAAK9hC,IAArC,CAAP;AACH;;;;;AAEL;;;;;;;;AAMA,UAAMyiC,iBAAiB,GAAG,iBAAI,4DAAJ,CAAmB,mBAAnB,CAA1B;;;YACMC,e;;;;;;;mBACF,mBAAUZ,GAAV,EAAe9hC,IAAf,EAAqB;AACjB,qBAAOA,IAAI,CAACgiC,MAAL,CAAYF,GAAZ,CAAP;AACH;;;;;;AAELY,uBAAe,CAAC3hC,IAAhB,GAAuB,SAAS4hC,uBAAT,CAAiC1hC,CAAjC,EAAoC;AAAE,iBAAO,KAAKA,CAAC,IAAIyhC,eAAV,GAAP;AAAsC,SAAnG;;AACAA,uBAAe,CAACxhC,KAAhB,GAAwB,8EAA0B;AAAEC,eAAK,EAAEuhC,eAAT;AAA0BthC,iBAAO,EAAEshC,eAAe,CAAC3hC;AAAnD,SAA1B,CAAxB;;;AAKA;;;;;;;AAOA;AACA;AACA;AACA;;;AACA,UAAI6hC,aAAa,GAAG,CAApB,C,CACA;AACA;;AACA,UAAMC,qBAAqB,GAAG,gDAA9B,C,CACA;AACA;;AACA,UAAMC,sBAAsB,GAAG,+CAA/B;AACA,UAAMC,6BAA6B,GAAG,6CAAtC;AACA;;;;;;;;UAOMC,oB;;;;;YAUAC,kB;AACF,sCAAYC,WAAZ,EAAyBj/B,QAAzB,EAAmC;AAAA;;AAC/B,iBAAKi/B,WAAL,GAAmBA,WAAnB;AACA,iBAAKj/B,QAAL,GAAgBA,QAAhB;AACA;;;;AAGA,iBAAKk/B,eAAL,GAAuBtkC,OAAO,CAACC,OAAR,EAAvB;AACH;AACD;;;;;;;mBAGA,wBAAe;AACX,iDAA4B8jC,aAAa,EAAzC;AACH;AACD;;;;;;;;;mBAMA,gBAAOd,GAAP,EAAY;AAAA;;AACR;AACA;AACA,kBAAIA,GAAG,CAAClC,MAAJ,KAAe,OAAnB,EAA4B;AACxB,sBAAM,IAAIlwB,KAAJ,CAAUozB,sBAAV,CAAN;AACH,eAFD,MAGK,IAAIhB,GAAG,CAACtB,YAAJ,KAAqB,MAAzB,EAAiC;AAClC,sBAAM,IAAI9wB,KAAJ,CAAUqzB,6BAAV,CAAN;AACH,eARO,CASR;;;AACA,qBAAO,IAAI,+CAAJ,CAAe,UAACK,QAAD,EAAc;AAChC;AACA;AACA;AACA,oBAAMC,QAAQ,GAAG,OAAI,CAACC,YAAL,EAAjB;;AACA,oBAAM3Y,GAAG,GAAGmX,GAAG,CAACrB,aAAJ,CAAkBrd,OAAlB,CAA0B,sBAA1B,aAAsDigB,QAAtD,QAAZ,CALgC,CAMhC;;AACA,oBAAME,IAAI,GAAG,OAAI,CAACt/B,QAAL,CAAcomB,aAAd,CAA4B,QAA5B,CAAb;;AACAkZ,oBAAI,CAAC//B,GAAL,GAAWmnB,GAAX,CARgC,CAShC;AACA;AACA;;AACA,oBAAI0V,IAAI,GAAG,IAAX,CAZgC,CAahC;;AACA,oBAAImD,QAAQ,GAAG,KAAf,CAdgC,CAehC;AACA;;AACA,oBAAIC,SAAS,GAAG,KAAhB,CAjBgC,CAkBhC;AACA;AACA;;AACA,uBAAI,CAACP,WAAL,CAAiBG,QAAjB,IAA6B,UAACzrB,IAAD,EAAU;AACnC;AACA,yBAAO,OAAI,CAACsrB,WAAL,CAAiBG,QAAjB,CAAP,CAFmC,CAGnC;;AACA,sBAAII,SAAJ,EAAe;AACX;AACH,mBANkC,CAOnC;;;AACApD,sBAAI,GAAGzoB,IAAP;AACA4rB,0BAAQ,GAAG,IAAX;AACH,iBAVD,CArBgC,CAgChC;AACA;AACA;;;AACA,oBAAM3V,OAAO,GAAG,SAAVA,OAAU,GAAM;AAClB;AACA,sBAAI0V,IAAI,CAACG,UAAT,EAAqB;AACjBH,wBAAI,CAACG,UAAL,CAAgBC,WAAhB,CAA4BJ,IAA5B;AACH,mBAJiB,CAKlB;AACA;;;AACA,yBAAO,OAAI,CAACL,WAAL,CAAiBG,QAAjB,CAAP;AACH,iBARD,CAnCgC,CA4ChC;AACA;AACA;AACA;;;AACA,oBAAMO,MAAM,GAAG,SAATA,MAAS,CAAC3jC,KAAD,EAAW;AACtB;AACA,sBAAIwjC,SAAJ,EAAe;AACX;AACH,mBAJqB,CAKtB;AACA;AACA;;;AACA,yBAAI,CAACN,eAAL,CAAqBt+B,IAArB,CAA0B,YAAM;AAC5B;AACAgpB,2BAAO,GAFqB,CAG5B;;AACA,wBAAI,CAAC2V,QAAL,EAAe;AACX;AACA;AACAJ,8BAAQ,CAACjkC,KAAT,CAAe,IAAIsiC,iBAAJ,CAAsB;AACjC9W,2BAAG,EAAHA,GADiC;AAEjCpN,8BAAM,EAAE,CAFyB;AAGjC4jB,kCAAU,EAAE,aAHqB;AAIjChiC,6BAAK,EAAE,IAAIuQ,KAAJ,CAAUmzB,qBAAV;AAJ0B,uBAAtB,CAAf;AAMA;AACH,qBAd2B,CAe5B;AACA;;;AACAO,4BAAQ,CAACpjC,IAAT,CAAc,IAAIuhC,YAAJ,CAAiB;AAC3BlB,0BAAI,EAAJA,IAD2B;AAE3B9iB,4BAAM,EAAE,GAFmB;AAG3B4jB,gCAAU,EAAE,IAHe;AAI3BxW,yBAAG,EAAHA;AAJ2B,qBAAjB,CAAd,EAjB4B,CAuB5B;;AACAyY,4BAAQ,CAACr1B,QAAT;AACH,mBAzBD;AA0BH,iBAlCD,CAhDgC,CAmFhC;AACA;AACA;;;AACA,oBAAMrF,OAAO,GAAG,SAAVA,OAAU,CAACvJ,KAAD,EAAW;AACvB;AACA,sBAAIskC,SAAJ,EAAe;AACX;AACH;;AACD5V,yBAAO,GALgB,CAMvB;;AACAuV,0BAAQ,CAACjkC,KAAT,CAAe,IAAIsiC,iBAAJ,CAAsB;AACjCtiC,yBAAK,EAALA,KADiC;AAEjCoe,0BAAM,EAAE,CAFyB;AAGjC4jB,8BAAU,EAAE,aAHqB;AAIjCxW,uBAAG,EAAHA;AAJiC,mBAAtB,CAAf;AAMH,iBAbD,CAtFgC,CAoGhC;AACA;;;AACA4Y,oBAAI,CAAC/+B,gBAAL,CAAsB,MAAtB,EAA8Bo/B,MAA9B;AACAL,oBAAI,CAAC/+B,gBAAL,CAAsB,OAAtB,EAA+BkE,OAA/B;;AACA,uBAAI,CAACzE,QAAL,CAAco8B,IAAd,CAAmBwD,WAAnB,CAA+BN,IAA/B,EAxGgC,CAyGhC;;;AACAH,wBAAQ,CAACpjC,IAAT,CAAc;AAAEiF,sBAAI,EAAE87B,aAAa,CAAC+C;AAAtB,iBAAd,EA1GgC,CA2GhC;;AACA,uBAAO,YAAM;AACT;AACAL,2BAAS,GAAG,IAAZ,CAFS,CAGT;;AACAF,sBAAI,CAACv+B,mBAAL,CAAyB,MAAzB,EAAiC4+B,MAAjC;AACAL,sBAAI,CAACv+B,mBAAL,CAAyB,OAAzB,EAAkC0D,OAAlC,EALS,CAMT;;AACAmlB,yBAAO;AACV,iBARD;AASH,eArHM,CAAP;AAsHH;;;;;;AAELoV,0BAAkB,CAACliC,IAAnB,GAA0B,SAASgjC,0BAAT,CAAoC9iC,CAApC,EAAuC;AAAE,iBAAO,KAAKA,CAAC,IAAIgiC,kBAAV,EAA8B,uDAAgBD,oBAAhB,CAA9B,EAAqE,uDAAgB,wDAAhB,CAArE,CAAP;AAAyG,SAA5K;;AACAC,0BAAkB,CAAC/hC,KAAnB,GAA2B,8EAA0B;AAAEC,eAAK,EAAE8hC,kBAAT;AAA6B7hC,iBAAO,EAAE6hC,kBAAkB,CAACliC;AAAzD,SAA1B,CAA3B;;;;;YAmBMijC,gB;AACF,oCAAYC,KAAZ,EAAmB;AAAA;;AACf,iBAAKA,KAAL,GAAaA,KAAb;AACH;AACD;;;;;;;;;;;mBAOA,mBAAUnC,GAAV,EAAe9hC,IAAf,EAAqB;AACjB,kBAAI8hC,GAAG,CAAClC,MAAJ,KAAe,OAAnB,EAA4B;AACxB,uBAAO,KAAKqE,KAAL,CAAWjC,MAAX,CAAkBF,GAAlB,CAAP;AACH,eAHgB,CAIjB;;;AACA,qBAAO9hC,IAAI,CAACgiC,MAAL,CAAYF,GAAZ,CAAP;AACH;;;;;;AAELkC,wBAAgB,CAACjjC,IAAjB,GAAwB,SAASmjC,wBAAT,CAAkCjjC,CAAlC,EAAqC;AAAE,iBAAO,KAAKA,CAAC,IAAI+iC,gBAAV,EAA4B,uDAAgBf,kBAAhB,CAA5B,CAAP;AAA0E,SAAzI;;AACAe,wBAAgB,CAAC9iC,KAAjB,GAAyB,8EAA0B;AAAEC,eAAK,EAAE6iC,gBAAT;AAA2B5iC,iBAAO,EAAE4iC,gBAAgB,CAACjjC;AAArD,SAA1B,CAAzB;;;AAQA;;;;;;;;;AAOA,UAAMojC,WAAW,GAAG,cAApB;AACA;;;;;AAIA,eAASC,cAAT,CAAwBC,GAAxB,EAA6B;AACzB,YAAI,iBAAiBA,GAAjB,IAAwBA,GAAG,CAACC,WAAhC,EAA6C;AACzC,iBAAOD,GAAG,CAACC,WAAX;AACH;;AACD,YAAI,mBAAmB1e,IAAnB,CAAwBye,GAAG,CAACE,qBAAJ,EAAxB,CAAJ,EAA0D;AACtD,iBAAOF,GAAG,CAACG,iBAAJ,CAAsB,eAAtB,CAAP;AACH;;AACD,eAAO,IAAP;AACH;AACD;;;;;;;UAKMC,U;;;;;YAMAC,U;AACF,gCAAc;AAAA;AAAG;;;;mBACjB,iBAAQ;AACJ,qBAAQ,IAAIC,cAAJ,EAAR;AACH;;;;;;AAELD,kBAAU,CAAC3jC,IAAX,GAAkB,SAAS6jC,kBAAT,CAA4B3jC,CAA5B,EAA+B;AAAE,iBAAO,KAAKA,CAAC,IAAIyjC,UAAV,GAAP;AAAiC,SAApF;;AACAA,kBAAU,CAACxjC,KAAX,GAAmB,8EAA0B;AAAEC,eAAK,EAAEujC,UAAT;AAAqBtjC,iBAAO,EAAEsjC,UAAU,CAAC3jC;AAAzC,SAA1B,CAAnB;;;;;YAYM8jC,c;AACF,kCAAYC,UAAZ,EAAwB;AAAA;;AACpB,iBAAKA,UAAL,GAAkBA,UAAlB;AACH;AACD;;;;;;;;;mBAKA,gBAAOhD,GAAP,EAAY;AAAA;;AACR;AACA;AACA,kBAAIA,GAAG,CAAClC,MAAJ,KAAe,OAAnB,EAA4B;AACxB,sBAAM,IAAIlwB,KAAJ,iFAAN;AACH,eALO,CAMR;;;AACA,qBAAO,IAAI,+CAAJ,CAAe,UAAC0zB,QAAD,EAAc;AAChC;AACA,oBAAMiB,GAAG,GAAG,OAAI,CAACS,UAAL,CAAgBC,KAAhB,EAAZ;;AACAV,mBAAG,CAACW,IAAJ,CAASlD,GAAG,CAAClC,MAAb,EAAqBkC,GAAG,CAACrB,aAAzB;;AACA,oBAAI,CAAC,CAACqB,GAAG,CAACvB,eAAV,EAA2B;AACvB8D,qBAAG,CAAC9D,eAAJ,GAAsB,IAAtB;AACH,iBAN+B,CAOhC;;;AACAuB,mBAAG,CAAC9E,OAAJ,CAAY/tB,OAAZ,CAAoB,UAAC/B,IAAD,EAAOywB,MAAP;AAAA,yBAAkB0G,GAAG,CAACY,gBAAJ,CAAqB/3B,IAArB,EAA2BywB,MAAM,CAACjX,IAAP,CAAY,GAAZ,CAA3B,CAAlB;AAAA,iBAApB,EARgC,CAShC;;AACA,oBAAI,CAACob,GAAG,CAAC9E,OAAJ,CAAYS,GAAZ,CAAgB,QAAhB,CAAL,EAAgC;AAC5B4G,qBAAG,CAACY,gBAAJ,CAAqB,QAArB,EAA+B,mCAA/B;AACH,iBAZ+B,CAahC;;;AACA,oBAAI,CAACnD,GAAG,CAAC9E,OAAJ,CAAYS,GAAZ,CAAgB,cAAhB,CAAL,EAAsC;AAClC,sBAAMyH,YAAY,GAAGpD,GAAG,CAACqD,uBAAJ,EAArB,CADkC,CAElC;;AACA,sBAAID,YAAY,KAAK,IAArB,EAA2B;AACvBb,uBAAG,CAACY,gBAAJ,CAAqB,cAArB,EAAqCC,YAArC;AACH;AACJ,iBApB+B,CAqBhC;;;AACA,oBAAIpD,GAAG,CAACtB,YAAR,EAAsB;AAClB,sBAAMA,YAAY,GAAGsB,GAAG,CAACtB,YAAJ,CAAiBlD,WAAjB,EAArB,CADkB,CAElB;AACA;AACA;AACA;AACA;;AACA+G,qBAAG,CAAC7D,YAAJ,GAAqBA,YAAY,KAAK,MAAlB,GAA4BA,YAA5B,GAA2C,MAA/D;AACH,iBA9B+B,CA+BhC;;;AACA,oBAAM4E,OAAO,GAAGtD,GAAG,CAACuD,aAAJ,EAAhB,CAhCgC,CAiChC;AACA;AACA;AACA;AACA;AACA;;AACA,oBAAIC,cAAc,GAAG,IAArB,CAvCgC,CAwChC;AACA;;AACA,oBAAMC,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AACzB,sBAAID,cAAc,KAAK,IAAvB,EAA6B;AACzB,2BAAOA,cAAP;AACH,mBAHwB,CAIzB;;;AACA,sBAAM/nB,MAAM,GAAG8mB,GAAG,CAAC9mB,MAAJ,KAAe,IAAf,GAAsB,GAAtB,GAA4B8mB,GAAG,CAAC9mB,MAA/C;AACA,sBAAM4jB,UAAU,GAAGkD,GAAG,CAAClD,UAAJ,IAAkB,IAArC,CANyB,CAOzB;;AACA,sBAAMnE,OAAO,GAAG,IAAID,WAAJ,CAAgBsH,GAAG,CAACE,qBAAJ,EAAhB,CAAhB,CARyB,CASzB;AACA;;AACA,sBAAM5Z,GAAG,GAAGyZ,cAAc,CAACC,GAAD,CAAd,IAAuBvC,GAAG,CAACnX,GAAvC,CAXyB,CAYzB;;AACA2a,gCAAc,GAAG,IAAIjE,kBAAJ,CAAuB;AAAErE,2BAAO,EAAPA,OAAF;AAAWzf,0BAAM,EAANA,MAAX;AAAmB4jB,8BAAU,EAAVA,UAAnB;AAA+BxW,uBAAG,EAAHA;AAA/B,mBAAvB,CAAjB;AACA,yBAAO2a,cAAP;AACH,iBAfD,CA1CgC,CA0DhC;AACA;AACA;;;AACA,oBAAM1B,MAAM,GAAG,SAATA,MAAS,GAAM;AACjB;AADiB,wCAE0B2B,cAAc,EAFxC;AAAA,sBAEXvI,OAFW,mBAEXA,OAFW;AAAA,sBAEFzf,MAFE,mBAEFA,MAFE;AAAA,sBAEM4jB,UAFN,mBAEMA,UAFN;AAAA,sBAEkBxW,GAFlB,mBAEkBA,GAFlB,EAGjB;;;AACA,sBAAI0V,IAAI,GAAG,IAAX;;AACA,sBAAI9iB,MAAM,KAAK,GAAf,EAAoB;AAChB;AACA8iB,wBAAI,GAAI,OAAOgE,GAAG,CAACmB,QAAX,KAAwB,WAAzB,GAAwCnB,GAAG,CAACoB,YAA5C,GAA2DpB,GAAG,CAACmB,QAAtE;AACH,mBARgB,CASjB;;;AACA,sBAAIjoB,MAAM,KAAK,CAAf,EAAkB;AACdA,0BAAM,GAAG,CAAC,CAAC8iB,IAAF,GAAS,GAAT,GAAe,CAAxB;AACH,mBAZgB,CAajB;AACA;AACA;AACA;;;AACA,sBAAIe,EAAE,GAAG7jB,MAAM,IAAI,GAAV,IAAiBA,MAAM,GAAG,GAAnC,CAjBiB,CAkBjB;AACA;;AACA,sBAAIukB,GAAG,CAACtB,YAAJ,KAAqB,MAArB,IAA+B,OAAOH,IAAP,KAAgB,QAAnD,EAA6D;AACzD;AACA,wBAAMqF,YAAY,GAAGrF,IAArB;AACAA,wBAAI,GAAGA,IAAI,CAACjd,OAAL,CAAa+gB,WAAb,EAA0B,EAA1B,CAAP;;AACA,wBAAI;AACA;AACA9D,0BAAI,GAAGA,IAAI,KAAK,EAAT,GAAclZ,IAAI,CAACwe,KAAL,CAAWtF,IAAX,CAAd,GAAiC,IAAxC;AACH,qBAHD,CAIA,OAAOlhC,KAAP,EAAc;AACV;AACA;AACA;AACAkhC,0BAAI,GAAGqF,YAAP,CAJU,CAKV;AACA;;AACA,0BAAItE,EAAJ,EAAQ;AACJ;AACAA,0BAAE,GAAG,KAAL,CAFI,CAGJ;;AACAf,4BAAI,GAAG;AAAElhC,+BAAK,EAALA,KAAF;AAAS4C,8BAAI,EAAEs+B;AAAf,yBAAP;AACH;AACJ;AACJ;;AACD,sBAAIe,EAAJ,EAAQ;AACJ;AACAgC,4BAAQ,CAACpjC,IAAT,CAAc,IAAIuhC,YAAJ,CAAiB;AAC3BlB,0BAAI,EAAJA,IAD2B;AAE3BrD,6BAAO,EAAPA,OAF2B;AAG3Bzf,4BAAM,EAANA,MAH2B;AAI3B4jB,gCAAU,EAAVA,UAJ2B;AAK3BxW,yBAAG,EAAEA,GAAG,IAAInrB;AALe,qBAAjB,CAAd,EAFI,CASJ;AACA;;AACA4jC,4BAAQ,CAACr1B,QAAT;AACH,mBAZD,MAaK;AACD;AACAq1B,4BAAQ,CAACjkC,KAAT,CAAe,IAAIsiC,iBAAJ,CAAsB;AACjC;AACAtiC,2BAAK,EAAEkhC,IAF0B;AAGjCrD,6BAAO,EAAPA,OAHiC;AAIjCzf,4BAAM,EAANA,MAJiC;AAKjC4jB,gCAAU,EAAVA,UALiC;AAMjCxW,yBAAG,EAAEA,GAAG,IAAInrB;AANqB,qBAAtB,CAAf;AAQH;AACJ,iBAnED,CA7DgC,CAiIhC;AACA;AACA;;;AACA,oBAAMkJ,OAAO,GAAG,SAAVA,OAAU,CAACvJ,KAAD,EAAW;AAAA,yCACPomC,cAAc,EADP;AAAA,sBACf5a,GADe,oBACfA,GADe;;AAEvB,sBAAMwD,GAAG,GAAG,IAAIsT,iBAAJ,CAAsB;AAC9BtiC,yBAAK,EAALA,KAD8B;AAE9Boe,0BAAM,EAAE8mB,GAAG,CAAC9mB,MAAJ,IAAc,CAFQ;AAG9B4jB,8BAAU,EAAEkD,GAAG,CAAClD,UAAJ,IAAkB,eAHA;AAI9BxW,uBAAG,EAAEA,GAAG,IAAInrB;AAJkB,mBAAtB,CAAZ;AAMA4jC,0BAAQ,CAACjkC,KAAT,CAAegvB,GAAf;AACH,iBATD,CApIgC,CA8IhC;AACA;AACA;AACA;;;AACA,oBAAIyX,WAAW,GAAG,KAAlB,CAlJgC,CAmJhC;AACA;;AACA,oBAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAAC5lC,KAAD,EAAW;AAC9B;AACA,sBAAI,CAAC2lC,WAAL,EAAkB;AACdxC,4BAAQ,CAACpjC,IAAT,CAAculC,cAAc,EAA5B;AACAK,+BAAW,GAAG,IAAd;AACH,mBAL6B,CAM9B;AACA;;;AACA,sBAAIE,aAAa,GAAG;AAChB7gC,wBAAI,EAAE87B,aAAa,CAACgF,gBADJ;AAEhBC,0BAAM,EAAE/lC,KAAK,CAAC+lC;AAFE,mBAApB,CAR8B,CAY9B;;AACA,sBAAI/lC,KAAK,CAACgmC,gBAAV,EAA4B;AACxBH,iCAAa,CAACjwB,KAAd,GAAsB5V,KAAK,CAAC4V,KAA5B;AACH,mBAf6B,CAgB9B;AACA;AACA;;;AACA,sBAAIisB,GAAG,CAACtB,YAAJ,KAAqB,MAArB,IAA+B,CAAC,CAAC6D,GAAG,CAACoB,YAAzC,EAAuD;AACnDK,iCAAa,CAACI,WAAd,GAA4B7B,GAAG,CAACoB,YAAhC;AACH,mBArB6B,CAsB9B;;;AACArC,0BAAQ,CAACpjC,IAAT,CAAc8lC,aAAd;AACH,iBAxBD,CArJgC,CA8KhC;AACA;;;AACA,oBAAMK,YAAY,GAAG,SAAfA,YAAe,CAAClmC,KAAD,EAAW;AAC5B;AACA;AACA,sBAAImmC,QAAQ,GAAG;AACXnhC,wBAAI,EAAE87B,aAAa,CAACsF,cADT;AAEXL,0BAAM,EAAE/lC,KAAK,CAAC+lC;AAFH,mBAAf,CAH4B,CAO5B;AACA;;AACA,sBAAI/lC,KAAK,CAACgmC,gBAAV,EAA4B;AACxBG,4BAAQ,CAACvwB,KAAT,GAAiB5V,KAAK,CAAC4V,KAAvB;AACH,mBAX2B,CAY5B;;;AACAutB,0BAAQ,CAACpjC,IAAT,CAAcomC,QAAd;AACH,iBAdD,CAhLgC,CA+LhC;;;AACA/B,mBAAG,CAAC7/B,gBAAJ,CAAqB,MAArB,EAA6Bo/B,MAA7B;AACAS,mBAAG,CAAC7/B,gBAAJ,CAAqB,OAArB,EAA8BkE,OAA9B;AACA27B,mBAAG,CAAC7/B,gBAAJ,CAAqB,SAArB,EAAgCkE,OAAhC;AACA27B,mBAAG,CAAC7/B,gBAAJ,CAAqB,OAArB,EAA8BkE,OAA9B,EAnMgC,CAoMhC;;AACA,oBAAIo5B,GAAG,CAACxB,cAAR,EAAwB;AACpB;AACA+D,qBAAG,CAAC7/B,gBAAJ,CAAqB,UAArB,EAAiCqhC,cAAjC,EAFoB,CAGpB;;AACA,sBAAIT,OAAO,KAAK,IAAZ,IAAoBf,GAAG,CAACiC,MAA5B,EAAoC;AAChCjC,uBAAG,CAACiC,MAAJ,CAAW9hC,gBAAX,CAA4B,UAA5B,EAAwC2hC,YAAxC;AACH;AACJ,iBA5M+B,CA6MhC;;;AACA9B,mBAAG,CAACkC,IAAJ,CAASnB,OAAT;AACAhC,wBAAQ,CAACpjC,IAAT,CAAc;AAAEiF,sBAAI,EAAE87B,aAAa,CAAC+C;AAAtB,iBAAd,EA/MgC,CAgNhC;AACA;;AACA,uBAAO,YAAM;AACT;AACAO,qBAAG,CAACr/B,mBAAJ,CAAwB,OAAxB,EAAiC0D,OAAjC;AACA27B,qBAAG,CAACr/B,mBAAJ,CAAwB,OAAxB,EAAiC0D,OAAjC;AACA27B,qBAAG,CAACr/B,mBAAJ,CAAwB,MAAxB,EAAgC4+B,MAAhC;AACAS,qBAAG,CAACr/B,mBAAJ,CAAwB,SAAxB,EAAmC0D,OAAnC;;AACA,sBAAIo5B,GAAG,CAACxB,cAAR,EAAwB;AACpB+D,uBAAG,CAACr/B,mBAAJ,CAAwB,UAAxB,EAAoC6gC,cAApC;;AACA,wBAAIT,OAAO,KAAK,IAAZ,IAAoBf,GAAG,CAACiC,MAA5B,EAAoC;AAChCjC,yBAAG,CAACiC,MAAJ,CAAWthC,mBAAX,CAA+B,UAA/B,EAA2CmhC,YAA3C;AACH;AACJ,mBAXQ,CAYT;;;AACA,sBAAI9B,GAAG,CAACmC,UAAJ,KAAmBnC,GAAG,CAACoC,IAA3B,EAAiC;AAC7BpC,uBAAG,CAAC5M,KAAJ;AACH;AACJ,iBAhBD;AAiBH,eAnOM,CAAP;AAoOH;;;;;;AAELoN,sBAAc,CAAC9jC,IAAf,GAAsB,SAAS2lC,sBAAT,CAAgCzlC,CAAhC,EAAmC;AAAE,iBAAO,KAAKA,CAAC,IAAI4jC,cAAV,EAA0B,uDAAgBJ,UAAhB,CAA1B,CAAP;AAAgE,SAA3H;;AACAI,sBAAc,CAAC3jC,KAAf,GAAuB,8EAA0B;AAAEC,eAAK,EAAE0jC,cAAT;AAAyBzjC,iBAAO,EAAEyjC,cAAc,CAAC9jC;AAAjD,SAA1B,CAAvB;;;AAQA;;;;;;;;;AAOA,UAAM4lC,gBAAgB,GAAG,iBAAI,4DAAJ,CAAmB,kBAAnB,CAAzB;AACA,UAAMC,gBAAgB,GAAG,iBAAI,4DAAJ,CAAmB,kBAAnB,CAAzB;AACA;;;;;;UAKMC,sB;;;;;YAKAC,uB;AACF,2CAAY3N,GAAZ,EAAiB4N,QAAjB,EAA2BC,UAA3B,EAAuC;AAAA;;AACnC,iBAAK7N,GAAL,GAAWA,GAAX;AACA,iBAAK4N,QAAL,GAAgBA,QAAhB;AACA,iBAAKC,UAAL,GAAkBA,UAAlB;AACA,iBAAKC,gBAAL,GAAwB,EAAxB;AACA,iBAAKC,SAAL,GAAiB,IAAjB;AACA;;;;AAGA,iBAAKC,UAAL,GAAkB,CAAlB;AACH;;;;mBACD,oBAAW;AACP,kBAAI,KAAKJ,QAAL,KAAkB,QAAtB,EAAgC;AAC5B,uBAAO,IAAP;AACH;;AACD,kBAAMK,YAAY,GAAG,KAAKjO,GAAL,CAASkO,MAAT,IAAmB,EAAxC;;AACA,kBAAID,YAAY,KAAK,KAAKH,gBAA1B,EAA4C;AACxC,qBAAKE,UAAL;AACA,qBAAKD,SAAL,GAAiB,0EAAkBE,YAAlB,EAAgC,KAAKJ,UAArC,CAAjB;AACA,qBAAKC,gBAAL,GAAwBG,YAAxB;AACH;;AACD,qBAAO,KAAKF,SAAZ;AACH;;;;;;AAELJ,+BAAuB,CAAC/lC,IAAxB,GAA+B,SAASumC,+BAAT,CAAyCrmC,CAAzC,EAA4C;AAAE,iBAAO,KAAKA,CAAC,IAAI6lC,uBAAV,EAAmC,uDAAgB,wDAAhB,CAAnC,EAA8D,uDAAgB,yDAAhB,CAA9D,EAA4F,uDAAgBH,gBAAhB,CAA5F,CAAP;AAAwI,SAArN;;AACAG,+BAAuB,CAAC5lC,KAAxB,GAAgC,8EAA0B;AAAEC,eAAK,EAAE2lC,uBAAT;AAAkC1lC,iBAAO,EAAE0lC,uBAAuB,CAAC/lC;AAAnE,SAA1B,CAAhC;;;;;YAqBMwmC,mB;AACF,uCAAYC,YAAZ,EAA0BC,UAA1B,EAAsC;AAAA;;AAClC,iBAAKD,YAAL,GAAoBA,YAApB;AACA,iBAAKC,UAAL,GAAkBA,UAAlB;AACH;;;;mBACD,mBAAU3F,GAAV,EAAe9hC,IAAf,EAAqB;AACjB,kBAAM0nC,KAAK,GAAG5F,GAAG,CAACnX,GAAJ,CAAQ2S,WAAR,EAAd,CADiB,CAEjB;AACA;AACA;AACA;;AACA,kBAAIwE,GAAG,CAAClC,MAAJ,KAAe,KAAf,IAAwBkC,GAAG,CAAClC,MAAJ,KAAe,MAAvC,IAAiD8H,KAAK,CAACC,UAAN,CAAiB,SAAjB,CAAjD,IACAD,KAAK,CAACC,UAAN,CAAiB,UAAjB,CADJ,EACkC;AAC9B,uBAAO3nC,IAAI,CAACgiC,MAAL,CAAYF,GAAZ,CAAP;AACH;;AACD,kBAAM3gC,KAAK,GAAG,KAAKqmC,YAAL,CAAkBI,QAAlB,EAAd,CAViB,CAWjB;;AACA,kBAAIzmC,KAAK,KAAK,IAAV,IAAkB,CAAC2gC,GAAG,CAAC9E,OAAJ,CAAYS,GAAZ,CAAgB,KAAKgK,UAArB,CAAvB,EAAyD;AACrD3F,mBAAG,GAAGA,GAAG,CAAClE,KAAJ,CAAU;AAAEZ,yBAAO,EAAE8E,GAAG,CAAC9E,OAAJ,CAAYrmB,GAAZ,CAAgB,KAAK8wB,UAArB,EAAiCtmC,KAAjC;AAAX,iBAAV,CAAN;AACH;;AACD,qBAAOnB,IAAI,CAACgiC,MAAL,CAAYF,GAAZ,CAAP;AACH;;;;;;AAELyF,2BAAmB,CAACxmC,IAApB,GAA2B,SAAS8mC,2BAAT,CAAqC5mC,CAArC,EAAwC;AAAE,iBAAO,KAAKA,CAAC,IAAIsmC,mBAAV,EAA+B,uDAAgBV,sBAAhB,CAA/B,EAAwE,uDAAgBD,gBAAhB,CAAxE,CAAP;AAAoH,SAAzL;;AACAW,2BAAmB,CAACrmC,KAApB,GAA4B,8EAA0B;AAAEC,eAAK,EAAEomC,mBAAT;AAA8BnmC,iBAAO,EAAEmmC,mBAAmB,CAACxmC;AAA3D,SAA1B,CAA5B;;;;;YA4BM+mC,uB;AACF,2CAAYC,OAAZ,EAAqBC,QAArB,EAA+B;AAAA;;AAC3B,iBAAKD,OAAL,GAAeA,OAAf;AACA,iBAAKC,QAAL,GAAgBA,QAAhB;AACA,iBAAKC,KAAL,GAAa,IAAb;AACH;;;;mBACD,gBAAOnG,GAAP,EAAY;AACR,kBAAI,KAAKmG,KAAL,KAAe,IAAnB,EAAyB;AACrB,oBAAMC,YAAY,GAAG,KAAKF,QAAL,CAActK,GAAd,CAAkB+E,iBAAlB,EAAqC,EAArC,CAArB;AACA,qBAAKwF,KAAL,GAAaC,YAAY,CAACC,WAAb,CAAyB,UAACnoC,IAAD,EAAOuiC,WAAP;AAAA,yBAAuB,IAAID,sBAAJ,CAA2BtiC,IAA3B,EAAiCuiC,WAAjC,CAAvB;AAAA,iBAAzB,EAA+F,KAAKwF,OAApG,CAAb;AACH;;AACD,qBAAO,KAAKE,KAAL,CAAWjG,MAAX,CAAkBF,GAAlB,CAAP;AACH;;;;;;AAELgG,+BAAuB,CAAC/mC,IAAxB,GAA+B,SAASqnC,+BAAT,CAAyCnnC,CAAzC,EAA4C;AAAE,iBAAO,KAAKA,CAAC,IAAI6mC,uBAAV,EAAmC,uDAAgBhL,WAAhB,CAAnC,EAAiE,uDAAgB,sDAAhB,CAAjE,CAAP;AAA4G,SAAzL;;AACAgL,+BAAuB,CAAC5mC,KAAxB,GAAgC,8EAA0B;AAAEC,eAAK,EAAE2mC,uBAAT;AAAkC1mC,iBAAO,EAAE0mC,uBAAuB,CAAC/mC;AAAnE,SAA1B,CAAhC;;;AAQA;;;;;;;;;;AAQA,eAASsnC,mBAAT,CAA6BN,OAA7B,EAAyD;AAAA,YAAnBG,YAAmB,uEAAJ,EAAI;;AACrD,YAAI,CAACA,YAAL,EAAmB;AACf,iBAAOH,OAAP;AACH;;AACD,eAAOG,YAAY,CAACC,WAAb,CAAyB,UAACnoC,IAAD,EAAOuiC,WAAP;AAAA,iBAAuB,IAAID,sBAAJ,CAA2BtiC,IAA3B,EAAiCuiC,WAAjC,CAAvB;AAAA,SAAzB,EAA+FwF,OAA/F,CAAP;AACH;AACD;;;;;;;;;;AAQA,eAASO,oBAAT,GAAgC;AAC5B,YAAI,OAAOvgB,MAAP,KAAkB,QAAtB,EAAgC;AAC5B,iBAAOA,MAAP;AACH;;AACD,eAAO,EAAP;AACH;;;YAaKwgB,oB;;;;;;;;AACF;;;AAGA,+BAAiB;AACb,qBAAO;AACHC,wBAAQ,EAAED,oBADP;AAEHE,yBAAS,EAAE,CACP;AAAEC,yBAAO,EAAEnB,mBAAX;AAAgCoB,0BAAQ,EAAEjG;AAA1C,iBADO;AAFR,eAAP;AAMH;AACD;;;;;;;;;;;mBAQA,uBAAiC;AAAA,kBAAdngC,OAAc,uEAAJ,EAAI;AAC7B,qBAAO;AACHimC,wBAAQ,EAAED,oBADP;AAEHE,yBAAS,EAAE,CACPlmC,OAAO,CAACykC,UAAR,GAAqB;AAAE0B,yBAAO,EAAE/B,gBAAX;AAA6BiC,0BAAQ,EAAErmC,OAAO,CAACykC;AAA/C,iBAArB,GAAmF,EAD5E,EAEPzkC,OAAO,CAACklC,UAAR,GAAqB;AAAEiB,yBAAO,EAAE9B,gBAAX;AAA6BgC,0BAAQ,EAAErmC,OAAO,CAACklC;AAA/C,iBAArB,GAAmF,EAF5E;AAFR,eAAP;AAOH;;;;;;AAELc,4BAAoB,CAAC3/B,IAArB,GAA4B,4EAAwB;AAAE3D,cAAI,EAAEsjC;AAAR,SAAxB,CAA5B;AACAA,4BAAoB,CAAC1/B,IAArB,GAA4B,4EAAwB;AAAEzH,iBAAO,EAAE,SAASynC,4BAAT,CAAsC5nC,CAAtC,EAAyC;AAAE,mBAAO,KAAKA,CAAC,IAAIsnC,oBAAV,GAAP;AAA2C,WAAjG;AAAmGE,mBAAS,EAAE,CAC1JlB,mBAD0J,EAE1J;AAAEmB,mBAAO,EAAEjG,iBAAX;AAA8BqG,uBAAW,EAAEvB,mBAA3C;AAAgEwB,iBAAK,EAAE;AAAvE,WAF0J,EAG1J;AAAEL,mBAAO,EAAE7B,sBAAX;AAAmC8B,oBAAQ,EAAE7B;AAA7C,WAH0J,EAI1J;AAAE4B,mBAAO,EAAE/B,gBAAX;AAA6BiC,oBAAQ,EAAE;AAAvC,WAJ0J,EAK1J;AAAEF,mBAAO,EAAE9B,gBAAX;AAA6BgC,oBAAQ,EAAE;AAAvC,WAL0J;AAA9G,SAAxB,CAA5B;;;;;YA4BMI,gB;;;;AAENA,wBAAgB,CAACpgC,IAAjB,GAAwB,4EAAwB;AAAE3D,cAAI,EAAE+jC;AAAR,SAAxB,CAAxB;AACAA,wBAAgB,CAACngC,IAAjB,GAAwB,4EAAwB;AAAEzH,iBAAO,EAAE,SAAS6nC,wBAAT,CAAkChoC,CAAlC,EAAqC;AAAE,mBAAO,KAAKA,CAAC,IAAI+nC,gBAAV,GAAP;AAAuC,WAAzF;AAA2FP,mBAAS,EAAE,CAC9I7G,UAD8I,EAE9I;AAAE8G,mBAAO,EAAE7L,WAAX;AAAwB8L,oBAAQ,EAAEb;AAAlC,WAF8I,EAG9IjD,cAH8I,EAI9I;AAAE6D,mBAAO,EAAE5L,WAAX;AAAwBgM,uBAAW,EAAEjE;AAArC,WAJ8I,EAK9IH,UAL8I,EAM9I;AAAEgE,mBAAO,EAAEjE,UAAX;AAAuBqE,uBAAW,EAAEpE;AAApC,WAN8I,CAAtG;AAOzC37B,iBAAO,EAAE,CAAC,C,aACLw/B,oBAAoB,CAACW,WAArB,CAAiC;AAC7BlC,sBAAU,EAAE,YADiB;AAE7BS,sBAAU,EAAE;AAFiB,WAAjC,CADK,CAAD;AAPgC,SAAxB,CAAxB;;;AAaA;;;AAAA,OAAC,YAAY;AAAE,SAAC,OAAOz+B,SAAP,KAAqB,WAArB,IAAoCA,SAArC,KAAmD,iEAA0BggC,gBAA1B,EAA4C;AAAEjgC,iBAAO,EAAE,CAACw/B,oBAAD;AAAX,SAA5C,CAAnD;AAAsI,OAArJ;;;YAsCMY,qB;;;;AAENA,6BAAqB,CAACvgC,IAAtB,GAA6B,4EAAwB;AAAE3D,cAAI,EAAEkkC;AAAR,SAAxB,CAA7B;AACAA,6BAAqB,CAACtgC,IAAtB,GAA6B,4EAAwB;AAAEzH,iBAAO,EAAE,SAASgoC,6BAAT,CAAuCnoC,CAAvC,EAA0C;AAAE,mBAAO,KAAKA,CAAC,IAAIkoC,qBAAV,GAAP;AAA4C,WAAnG;AAAqGV,mBAAS,EAAE,CAC7JxF,kBAD6J,EAE7J;AAAEyF,mBAAO,EAAE1F,oBAAX;AAAiCqG,sBAAU,EAAEf;AAA7C,WAF6J,EAG7J;AAAEI,mBAAO,EAAEjG,iBAAX;AAA8BkG,oBAAQ,EAAE3E,gBAAxC;AAA0D+E,iBAAK,EAAE;AAAjE,WAH6J;AAAhH,SAAxB,CAA7B;;;AAgBA;;;;;;;;AAQA;;;;;;;;AAQA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5mEO,UAAM7Q,MAAM,GAA8B;AAC/CoE,eAAO,EAAE,CADsC;AAE/Cr3B,YAAI,EAAE,QAFyC;AAG/CqkC,kBAAU,EAAE;AACVv+B,YAAE,EAAE;AACF9F,gBAAI,EAAE,QADJ;AAEFskC,mBAAO,EAAE;AAFP,WADM;AAKVjR,mBAAS,EAAE;AAAErzB,gBAAI,EAAE;AAAR,WALD;AAMV0zB,6BAAmB,EAAE;AACnB1zB,gBAAI,EAAE,QADa;AAEnBqkC,sBAAU,EAAE;AACVzQ,sBAAQ,EAAE;AAAE5zB,oBAAI,EAAE;AAAR,eADA;AAEV8zB,uBAAS,EAAE;AAAE9zB,oBAAI,EAAE;AAAR;AAFD,aAFO;AAMnBukC,oBAAQ,EAAE,CAAC,UAAD,EAAa,WAAb;AANS;AANX,SAHmC;AAkB/CC,eAAO,EAAE,CAAC,WAAD,CAlBsC;AAmB/CD,gBAAQ,EAAE,CAAC,WAAD,CAnBqC;AAoB/CE,mBAAW,EAAE;AACXC,mBAAS,EAAE;AADA;AApBkC,OAA1C;;AAyBA;AAAA,YAAMC,MAAN;AA2CL,0BAA6B3lC,QAA7B,EAAgE;AAAA;;AAAA;;AAAnC,iBAAAA,QAAA,GAAAA,QAAA;AAtCpB,iBAAA8G,EAAA,GAAK,KAAK9G,QAAL,CAAc8G,EAAnB;AAEA,iBAAAwjB,QAAA,GAAW,KAAKsb,aAAL,CAAmBD,MAAM,CAAC3Q,mBAA1B,EAA+Ch0B,IAA1D;AAEA,iBAAAqzB,SAAA,GAAY,KAAKr0B,QAAL,CAAcq0B,SAA1B;AAEA,iBAAAK,mBAAA,GAAsB,KAAK10B,QAAL,CAAc00B,mBAApC;AAEA,iBAAAmR,SAAA,GAAY,mDAAM;AAAA,qBACzB,OAAI,CAACD,aAAL,CAAmBD,MAAM,CAAC3Q,mBAA1B,EAA+C8Q,OAA/C,EADyB;AAAA,aAAN,EAEnBnqC,IAFmB,CAGnB,2DAAI,UAAAwJ,IAAI;AAAA,qBAAI0e,GAAG,CAACQ,eAAJ,CAAoBlf,IAApB,CAAJ;AAAA,aAAR,CAHmB,EAInB,mEAAY;AAAE+uB,wBAAU,EAAE,CAAd;AAAiBC,sBAAQ,EAAE;AAA3B,aAAZ,CAJmB,CAAZ;AAOA,iBAAA4R,aAAA,GAAgB,mDAAM;AAAA,qBAC7B,gDAAG,OAAI,CAAC/lC,QAAL,CAAc4lC,aAAd,CAA4BD,MAAM,CAACK,uBAAnC,CAAH,CAD6B;AAAA,aAAN,EAEvBrqC,IAFuB,CAGvB,iEAAU,UAAMs5B,UAAN;AAAA,qBAAoB,wDAAD,OAAC,EAAD,MAAC,EAAD,MAAC,uCAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BACvBA,UADuB;AAAA;AAAA;AAAA;;AAAA,2DACJA,UAAU,CAAC6Q,OAAX,EADI;;AAAA;AAAA,wCAEH,sEAFG;AAAA;AAGlB,+BAAM,KAAKF,aAAL,CAAmBD,MAAM,CAAC3Q,mBAA1B,EAA+C8Q,OAA/C,EAAN;;AAHkB;AAAA;AAAA;AAGzBlT,+BAHyB;AAIzBkD,iCAJyB,EAIhB;AAJgB;AAAA;AAET;;AAFS;AAErBmQ,iCAFqB;AAAA;AAM3B,+BAAM,KAAKjmC,QAAL,CAAc+0B,aAAd,CACJ;AACEjuB,4BAAE,EAAE6+B,MAAM,CAACK,uBADb;AAEEryB,8BAAI,EAAEsyB,SAFR;AAGEjlC,8BAAI,EAAE,KAAKspB;AAHb,yBADI,EAMJ,IANI,CAAN;;AAN2B;AAAA,2DAcpB2b,SAdoB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAC,EAApB;AAAA,aAAV,CAHuB,EAmBvB,2DAAI,UAAA9gC,IAAI;AAAA,qBAAI0e,GAAG,CAACQ,eAAJ,CAAoBlf,IAApB,CAAJ;AAAA,aAAR,CAnBuB,EAoBvB,mEAAY;AAAE+uB,wBAAU,EAAE,CAAd;AAAiBC,sBAAQ,EAAE;AAA3B,aAAZ,CApBuB,CAAhB;AAuByD;;AA3C7D;AAAA;AAAA,mBA6CG,uBACNrtB,EADM,EAGmC;AAEzC,kBAAMmuB,UAAU,GAAG,KAAKj1B,QAAL,CAAc4lC,aAAd,CAA4B9+B,EAA5B,CAAnB;AACA,kBAAImuB,UAAJ,EAAgB,OAAOA,UAAP;AAChB,oBAAM,IAAI,+DAAJ,8CAA4DnuB,EAA5D,EAAN;AACD;AArDI;;AAAA;AAAA;;AACW,eAAAkuB,mBAAA,GAAsB,UAAtB;AAEQ,eAAAgR,uBAAA,GAA0B,WAA1B;;OAHnB","file":"1-es5.6ef195e63c63e8bc6a0a.js","sourcesContent":["async function getCurrentPosition() {\n  return new Promise<GeolocationPosition>((resolve, reject) => {\n    navigator.geolocation.getCurrentPosition(\n      success => resolve(success),\n      error => reject(error),\n      { enableHighAccuracy: true, timeout: 10000, maximumAge: 60000 }\n    );\n  });\n}\n\nexport async function getCurrentPositionOrUndefined() {\n  try {\n    return await getCurrentPosition();\n  } catch {\n    return undefined;\n  }\n}\n","<ion-icon\n  *ngIf=\"isImageError\"\n  src=\"/assets/icons/broken-image.svg\"\n  color=\"danger\"\n  size=\"large\"\n></ion-icon>\n<ion-img\n  *ngIf=\"!isImageError\"\n  (ionImgDidLoad)=\"onImageLoaded($event)\"\n  (ionError)=\"onImageError()\"\n  [attr.src]=\"src$ | ngrxPush\"\n></ion-img>\n<ng-content *ngIf=\"!isImageError\"></ng-content>\n","import { Component, Input } from '@angular/core';\nimport { createAnimation } from '@ionic/angular';\nimport { BehaviorSubject } from 'rxjs';\nimport { distinctUntilChanged, startWith, tap } from 'rxjs/operators';\nimport { isNonNullable } from '../../utils/rx-operators';\n\n@Component({\n  selector: 'app-image',\n  templateUrl: './image.component.html',\n  styleUrls: ['./image.component.scss'],\n})\nexport class ImageComponent {\n  private readonly _src$ = new BehaviorSubject<string | undefined>(undefined);\n\n  readonly src$ = this._src$.pipe(\n    startWith(TINIEST_GIF),\n    isNonNullable(),\n    distinctUntilChanged(),\n    tap(() => (this.isImageError = false))\n  );\n\n  @Input()\n  set src(value: string) {\n    this._src$.next(value);\n  }\n\n  isImageError = false;\n\n  async onImageLoaded(event: Event) {\n    const imgElement = event.target as HTMLIonImgElement;\n    const fadeInAnimation = createAnimation()\n      .addElement(imgElement)\n      .duration(300)\n      .iterations(1)\n      .fromTo('opacity', '0', '1');\n    return fadeInAnimation.play();\n  }\n\n  onImageError() {\n    this.isImageError = true;\n  }\n}\n\nconst TINIEST_GIF =\n  'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n","import { Injectable, ɵɵdefineInjectable, Component, Input, ViewChild, ViewEncapsulation, Directive, ElementRef, Renderer2, HostListener, NgModule } from '@angular/core';\nimport { __awaiter } from 'tslib';\nimport { ModalController, IonicModule } from '@ionic/angular';\nimport { CommonModule } from '@angular/common';\n\n/**\n * @fileoverview added by tsickle\n * Generated from: lib/ngx-ionic-image-viewer.service.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@ionic/angular';\nimport * as ɵngcc2 from '@angular/common';\n\nconst _c0 = [\"sliderRef\"];\nconst _c1 = function (a0) { return { \"no-title\": a0 }; };\nconst _c2 = function (a0) { return { \"no-text\": a0 }; };\nclass NgxIonicImageViewerService {\n    constructor() { }\n}\nNgxIonicImageViewerService.ɵfac = function NgxIonicImageViewerService_Factory(t) { return new (t || NgxIonicImageViewerService)(); };\nNgxIonicImageViewerService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: NgxIonicImageViewerService, factory: NgxIonicImageViewerService.ɵfac, providedIn: 'root' });\n/** @nocollapse */\nNgxIonicImageViewerService.ctorParameters = () => [];\n/** @nocollapse */ NgxIonicImageViewerService.ngInjectableDef = ɵɵdefineInjectable({ factory: function NgxIonicImageViewerService_Factory() { return new NgxIonicImageViewerService(); }, token: NgxIonicImageViewerService, providedIn: \"root\" });\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NgxIonicImageViewerService, [{\n        type: Injectable,\n        args: [{\n                providedIn: 'root'\n            }]\n    }], function () { return []; }, null); })();\n\n/**\n * @fileoverview added by tsickle\n * Generated from: lib/viewer-modal/viewer-modal.component.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\nclass ViewerModalComponent {\n    /**\n     * @param {?} modalController\n     */\n    constructor(modalController) {\n        this.modalController = modalController;\n        // tslint:disable: no-inferrable-types\n        this.alt = '';\n        this.scheme = 'auto';\n        this.slideOptions = {};\n        this.srcFallback = '';\n        this.srcHighRes = '';\n        this.swipeToClose = true;\n        this.text = '';\n        this.title = '';\n        this.titleSize = '';\n        // tslint:enable: no-inferrable-types\n        this.defaultSlideOptions = {\n            centeredSlides: true,\n            passiveListeners: false,\n            zoom: {\n                enabled: true,\n            },\n        };\n        this.options = {};\n        this.swipeState = {\n            phase: 'init',\n            direction: 'none',\n            swipeType: 'none',\n            startX: 0,\n            startY: 0,\n            distance: 0,\n            distanceX: 0,\n            distanceY: 0,\n            threshold: 150,\n            // required min distance traveled to be considered swipe\n            restraint: 100,\n            // maximum distance allowed at the same time in perpendicular direction\n            allowedTime: 500,\n            // maximum time allowed to travel that distance\n            elapsedTime: 0,\n            startTime: 0,\n        };\n    }\n    /**\n     * @return {?}\n     */\n    ngOnInit() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.options = Object.assign({}, this.defaultSlideOptions, this.slideOptions);\n            this.src = this.srcHighRes || this.src;\n            this.setStyle();\n            this.setScheme(this.scheme);\n            this.initSwipeToClose(this.swipeToClose);\n            /**\n             * Current Workaround\n             * See reported bug: https://github.com/ionic-team/ionic/issues/19638#issuecomment-584828315\n             * Hint: Comment in '<ion-slide>' in component\n             * @type {?}\n             */\n            const swiper = yield this.slides.getSwiper();\n            swiper.appendSlide(`<ion-slide><img alt=\"${this.alt}\" src=\"${this.src}\" onerror=\"this.src='${this.srcFallback}'\"/></ion-slide>`);\n        });\n    }\n    /**\n     * @return {?}\n     */\n    setStyle() {\n        /** @type {?} */\n        const el = document.querySelector('.ion-img-viewer');\n        el.style.setProperty('--height', '100%');\n        el.style.setProperty('--width', '100%');\n        el.style.setProperty('--border-radius', '0');\n    }\n    /**\n     * @param {?} scheme\n     * @return {?}\n     */\n    setScheme(scheme) {\n        if (scheme === 'auto') {\n            return;\n        }\n        /** @type {?} */\n        const el = document.querySelector('.ion-img-viewer');\n        if (this.scheme === 'light') {\n            el.style.setProperty('--ion-background-color', '#ffffff');\n            el.style.setProperty('--ion-background-color-rgb', '255, 255, 255');\n            el.style.setProperty('--ion-text-color', '#000');\n            el.style.setProperty('--ion-text-color-rgb', '0,0,0');\n        }\n        if (this.scheme === 'dark') {\n            if (el.classList.contains('ios')) {\n                el.style.setProperty('--ion-background-color', '#000000');\n                el.style.setProperty('--ion-background-color-rgb', '0, 0, 0');\n            }\n            else {\n                el.style.setProperty('--ion-background-color', '#121212');\n                el.style.setProperty('--ion-background-color-rgb', '18,18,18');\n            }\n            el.style.setProperty('--ion-text-color', '#ffffff');\n            el.style.setProperty('--ion-text-color-rgb', '255,255,255');\n        }\n    }\n    /**\n     * @see http://www.javascriptkit.com/javatutors/touchevents3.shtml\n     * @param {?=} isActive\n     * @return {?}\n     */\n    initSwipeToClose(isActive = true) {\n        if (!isActive) {\n            return;\n        }\n        /** @type {?} */\n        const el = document.querySelector('ion-modal');\n        el.addEventListener('mousedown', (/**\n         * @param {?} event\n         * @return {?}\n         */\n        (event) => this.swipeStart(event)), true);\n        el.addEventListener('mousemove', (/**\n         * @param {?} event\n         * @return {?}\n         */\n        (event) => this.swipeMove(event)), true);\n        el.addEventListener('mouseup', (/**\n         * @param {?} event\n         * @return {?}\n         */\n        (event) => this.swipeEnd(event)), true);\n        el.addEventListener('touchstart', (/**\n         * @param {?} event\n         * @return {?}\n         */\n        (event) => this.swipeStart(event)), true);\n        el.addEventListener('touchmove', (/**\n         * @param {?} event\n         * @return {?}\n         */\n        (event) => this.swipeMove(event)), true);\n        el.addEventListener('touchend', (/**\n         * @param {?} event\n         * @return {?}\n         */\n        (event) => this.swipeEnd(event)), true);\n        this.modalController.getTop().then((/**\n         * @param {?} modal\n         * @return {?}\n         */\n        (modal) => {\n            modal.onWillDismiss().then((/**\n             * @return {?}\n             */\n            () => {\n                document.removeEventListener('mousedown', this.swipeStart, true);\n                document.removeEventListener('mousemove', this.swipeMove, true);\n                document.removeEventListener('mouseup', this.swipeMove, true);\n                document.removeEventListener('touchstart', this.swipeStart, true);\n                document.removeEventListener('touchmove', this.swipeMove, true);\n                document.removeEventListener('touchend', this.swipeMove, true);\n            }));\n        }));\n    }\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n    swipeStart(event) {\n        const { pageX, pageY } = event.type === 'touchstart' ? event.changedTouches[0] : event;\n        this.swipeState = Object.assign({}, this.swipeState, { phase: 'start', direction: 'none', distance: 0, startX: pageX, startY: pageY, startTime: new Date().getTime() });\n    }\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n    swipeMove(event) {\n        if (this.swipeState.phase === 'none') {\n            return;\n        }\n        const { pageX, pageY } = event.type === 'touchmove' ? event.changedTouches[0] : event;\n        // get horizontal dist traveled by finger while in contact with surface\n        /** @type {?} */\n        const distanceX = pageX - this.swipeState.startX;\n        // get vertical dist traveled by finger while in contact with surface\n        /** @type {?} */\n        const distanceY = pageY - this.swipeState.startY;\n        /** @type {?} */\n        let direction;\n        /** @type {?} */\n        let distance;\n        if (Math.abs(distanceX) > Math.abs(distanceY)) {\n            // if distance traveled horizontally is greater than vertically, consider this a horizontal swipe\n            direction = distanceX < 0 ? 'left' : 'right';\n            distance = distanceX;\n        }\n        else {\n            // else consider this a vertical swipe\n            direction = distanceY < 0 ? 'up' : 'down';\n            distance = distanceY;\n        }\n        this.swipeState = Object.assign({}, this.swipeState, { phase: 'move', direction,\n            distance,\n            distanceX,\n            distanceY });\n        event.preventDefault();\n    }\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n    swipeEnd(event) {\n        if (this.swipeState.phase === 'none') {\n            return;\n        }\n        const { allowedTime, direction, restraint, startTime, threshold, distanceX, distanceY } = this.swipeState;\n        /** @type {?} */\n        let swipeType;\n        /** @type {?} */\n        const elapsedTime = new Date().getTime() - startTime;\n        if (elapsedTime <= allowedTime) {\n            // first condition for a swipe met\n            if (Math.abs(distanceX) >= threshold && Math.abs(distanceY) <= restraint) {\n                // 2nd condition for horizontal swipe met\n                swipeType = direction; // set swipeType to either \"left\" or \"right\"\n            }\n            else if (Math.abs(distanceY) >= threshold && Math.abs(distanceX) <= restraint) {\n                // 2nd condition for vertical swipe met\n                swipeType = direction; // set swipeType to either \"top\" or \"down\"\n            }\n        }\n        this.swipeState = Object.assign({}, this.swipeState, { phase: 'end', swipeType });\n        if (swipeType === 'down') {\n            return this.closeModal();\n        }\n    }\n    /**\n     * @return {?}\n     */\n    closeModal() {\n        this.modalController.dismiss();\n    }\n}\nViewerModalComponent.ɵfac = function ViewerModalComponent_Factory(t) { return new (t || ViewerModalComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.ModalController)); };\nViewerModalComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ViewerModalComponent, selectors: [[\"ion-viewer-modal\"]], viewQuery: function ViewerModalComponent_Query(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵviewQuery(_c0, 3);\n    } if (rf & 2) {\n        let _t;\n        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.slides = _t.first);\n    } }, inputs: { alt: \"alt\", scheme: \"scheme\", slideOptions: \"slideOptions\", srcFallback: \"srcFallback\", srcHighRes: \"srcHighRes\", swipeToClose: \"swipeToClose\", text: \"text\", title: \"title\", titleSize: \"titleSize\", src: \"src\" }, decls: 14, vars: 11, consts: [[3, \"ngClass\"], [\"slot\", \"primary\"], [3, \"click\"], [\"slot\", \"icon-only\", \"name\", \"close\"], [3, \"size\"], [3, \"forceOverscroll\"], [3, \"options\"], [\"sliderRef\", \"\"], [1, \"ion-text-center\"]], template: function ViewerModalComponent_Template(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"ion-header\", 0);\n        ɵngcc0.ɵɵelementStart(1, \"ion-toolbar\");\n        ɵngcc0.ɵɵelementStart(2, \"ion-buttons\", 1);\n        ɵngcc0.ɵɵelementStart(3, \"ion-button\", 2);\n        ɵngcc0.ɵɵlistener(\"click\", function ViewerModalComponent_Template_ion_button_click_3_listener() { return ctx.closeModal(); });\n        ɵngcc0.ɵɵelement(4, \"ion-icon\", 3);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(5, \"ion-title\", 4);\n        ɵngcc0.ɵɵtext(6);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(7, \"ion-content\", 5);\n        ɵngcc0.ɵɵelement(8, \"ion-slides\", 6, 7);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(10, \"ion-footer\", 0);\n        ɵngcc0.ɵɵelementStart(11, \"ion-toolbar\", 8);\n        ɵngcc0.ɵɵelementStart(12, \"ion-text\");\n        ɵngcc0.ɵɵtext(13);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n    } if (rf & 2) {\n        ɵngcc0.ɵɵproperty(\"ngClass\", ɵngcc0.ɵɵpureFunction1(7, _c1, ctx.title.length <= 0));\n        ɵngcc0.ɵɵadvance(5);\n        ɵngcc0.ɵɵproperty(\"size\", ctx.titleSize);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵtextInterpolate(ctx.title);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"forceOverscroll\", false);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"options\", ctx.options);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngClass\", ɵngcc0.ɵɵpureFunction1(9, _c2, ctx.text.length <= 0));\n        ɵngcc0.ɵɵadvance(3);\n        ɵngcc0.ɵɵtextInterpolate(ctx.text);\n    } }, directives: [ɵngcc1.IonHeader, ɵngcc2.NgClass, ɵngcc1.IonToolbar, ɵngcc1.IonButtons, ɵngcc1.IonButton, ɵngcc1.IonIcon, ɵngcc1.IonTitle, ɵngcc1.IonContent, ɵngcc1.IonSlides, ɵngcc1.IonFooter, ɵngcc1.IonText], styles: [\"ion-slides[_ngcontent-%COMP%]{--height:100%;height:100%}ion-toolbar[_ngcontent-%COMP%]{--border-style:none;--background:rgba(var(--ion-background-color-rgb, (255, 255, 255)), 0.6);background:rgba(var(--ion-background-color-rgb,255,255,255),.6)}ion-header[_ngcontent-%COMP%]{opacity:1;position:absolute}ion-header.no-title[_ngcontent-%COMP%]:after{content:none}ion-header.no-title[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:rgba(0, 0, 0, 0);background:rgba(0,0,0,0)}ion-footer[_ngcontent-%COMP%]{position:absolute;bottom:0}ion-footer.no-text[_ngcontent-%COMP%]:before{content:none}ion-footer.no-text[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:rgba(0, 0, 0, 0);background:rgba(0,0,0,0)}\"] });\n/** @nocollapse */\nViewerModalComponent.ctorParameters = () => [\n    { type: ModalController }\n];\nViewerModalComponent.propDecorators = {\n    alt: [{ type: Input }],\n    scheme: [{ type: Input }],\n    slideOptions: [{ type: Input }],\n    src: [{ type: Input }],\n    srcFallback: [{ type: Input }],\n    srcHighRes: [{ type: Input }],\n    swipeToClose: [{ type: Input }],\n    text: [{ type: Input }],\n    title: [{ type: Input }],\n    titleSize: [{ type: Input }],\n    slides: [{ type: ViewChild, args: ['sliderRef', { static: true },] }]\n};\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ViewerModalComponent, [{\n        type: Component,\n        args: [{\n                selector: 'ion-viewer-modal',\n                template: \"<ion-header [ngClass]=\\\"{ 'no-title': title.length <= 0 }\\\">\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"primary\\\">\\n      <ion-button (click)=\\\"closeModal()\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"close\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n    <ion-title [size]=\\\"titleSize\\\">{{ title }}</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content [forceOverscroll]=\\\"false\\\">\\n  <ion-slides [options]=\\\"options\\\" #sliderRef>\\n    <!-- <ion-slide>\\n      <div class=\\\"swiper-zoom-container\\\">\\n        <img [alt]=\\\"this.alt\\\" [src]=\\\"this.src\\\" (error)=\\\"onError($event)\\\" />\\n      </div>\\n    </ion-slide> -->\\n  </ion-slides>\\n</ion-content>\\n\\n<ion-footer [ngClass]=\\\"{ 'no-text': text.length <= 0 }\\\">\\n  <ion-toolbar class=\\\"ion-text-center\\\">\\n    <ion-text>{{ text }}</ion-text>\\n  </ion-toolbar>\\n</ion-footer>\\n\",\n                styles: [\"ion-slides{--height:100%;height:100%}ion-toolbar{--border-style:none;--background:rgba(var(--ion-background-color-rgb, (255, 255, 255)), 0.6);background:rgba(var(--ion-background-color-rgb,255,255,255),.6)}ion-header{opacity:1;position:absolute}ion-header.no-title:after{content:none}ion-header.no-title ion-toolbar{--background:rgba(0, 0, 0, 0);background:rgba(0,0,0,0)}ion-footer{position:absolute;bottom:0}ion-footer.no-text:before{content:none}ion-footer.no-text ion-toolbar{--background:rgba(0, 0, 0, 0);background:rgba(0,0,0,0)}\"]\n            }]\n    }], function () { return [{ type: ɵngcc1.ModalController }]; }, { alt: [{\n            type: Input\n        }], scheme: [{\n            type: Input\n        }], slideOptions: [{\n            type: Input\n        }], srcFallback: [{\n            type: Input\n        }], srcHighRes: [{\n            type: Input\n        }], swipeToClose: [{\n            type: Input\n        }], text: [{\n            type: Input\n        }], title: [{\n            type: Input\n        }], titleSize: [{\n            type: Input\n        }], src: [{\n            type: Input\n        }], slides: [{\n            type: ViewChild,\n            args: ['sliderRef', { static: true }]\n        }] }); })();\nif (false) {\n    /** @type {?} */\n    ViewerModalComponent.prototype.alt;\n    /** @type {?} */\n    ViewerModalComponent.prototype.scheme;\n    /** @type {?} */\n    ViewerModalComponent.prototype.slideOptions;\n    /** @type {?} */\n    ViewerModalComponent.prototype.src;\n    /** @type {?} */\n    ViewerModalComponent.prototype.srcFallback;\n    /** @type {?} */\n    ViewerModalComponent.prototype.srcHighRes;\n    /** @type {?} */\n    ViewerModalComponent.prototype.swipeToClose;\n    /** @type {?} */\n    ViewerModalComponent.prototype.text;\n    /** @type {?} */\n    ViewerModalComponent.prototype.title;\n    /** @type {?} */\n    ViewerModalComponent.prototype.titleSize;\n    /** @type {?} */\n    ViewerModalComponent.prototype.defaultSlideOptions;\n    /** @type {?} */\n    ViewerModalComponent.prototype.options;\n    /** @type {?} */\n    ViewerModalComponent.prototype.swipeState;\n    /** @type {?} */\n    ViewerModalComponent.prototype.slides;\n    /**\n     * @type {?}\n     * @private\n     */\n    ViewerModalComponent.prototype.modalController;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: lib/ngx-ionic-image-viewer.component.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\nclass NgxIonicImageViewerComponent {\n    /**\n     * @param {?} modalController\n     */\n    constructor(modalController) {\n        this.modalController = modalController;\n    }\n    /**\n     * @param {?} src\n     * @param {?=} srcFallback\n     * @param {?=} srcHighRes\n     * @param {?=} title\n     * @param {?=} titleSize\n     * @param {?=} text\n     * @param {?=} scheme\n     * @param {?=} slideOptions\n     * @param {?=} swipeToClose\n     * @return {?}\n     */\n    viewImage(src, srcFallback = '', srcHighRes = '', title = '', titleSize = '', text = '', scheme = 'auto', slideOptions = {}, swipeToClose = true) {\n        return __awaiter(this, void 0, void 0, function* () {\n            /** @type {?} */\n            const modal = yield this.modalController.create({\n                component: ViewerModalComponent,\n                componentProps: {\n                    src,\n                    srcFallback,\n                    srcHighRes,\n                    title,\n                    titleSize,\n                    text,\n                    scheme,\n                    slideOptions,\n                    swipeToClose\n                },\n                cssClass: this.cssClass instanceof Array ? ['ion-img-viewer', ...this.cssClass] : ['ion-img-viewer', this.cssClass],\n                keyboardClose: true,\n                showBackdrop: true\n            });\n            return yield modal.present();\n        });\n    }\n    /**\n     * @return {?}\n     */\n    ngOnInit() { }\n}\nNgxIonicImageViewerComponent.ɵfac = function NgxIonicImageViewerComponent_Factory(t) { return new (t || NgxIonicImageViewerComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.ModalController)); };\nNgxIonicImageViewerComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: NgxIonicImageViewerComponent, selectors: [[\"ion-img-viewer\"]], inputs: { alt: \"alt\", cssClass: \"cssClass\", scheme: \"scheme\", slideOptions: \"slideOptions\", src: \"src\", srcFallback: \"srcFallback\", srcHighRes: \"srcHighRes\", swipeToClose: \"swipeToClose\", text: \"text\", title: \"title\", titleSize: \"titleSize\" }, decls: 1, vars: 2, consts: [[3, \"alt\", \"src\", \"click\", \"error\"]], template: function NgxIonicImageViewerComponent_Template(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"img\", 0);\n        ɵngcc0.ɵɵlistener(\"click\", function NgxIonicImageViewerComponent_Template_img_click_0_listener() { return ctx.viewImage(ctx.src, ctx.srcFallback, ctx.srcHighRes, ctx.title, ctx.titleSize, ctx.text, ctx.scheme, ctx.slideOptions, ctx.swipeToClose); })(\"error\", function NgxIonicImageViewerComponent_Template_img_error_0_listener() { return ctx.src = ctx.srcFallback; });\n        ɵngcc0.ɵɵelementEnd();\n    } if (rf & 2) {\n        ɵngcc0.ɵɵproperty(\"alt\", ctx.alt)(\"src\", ctx.src, ɵngcc0.ɵɵsanitizeUrl);\n    } }, styles: [\"[_nghost-%COMP%] {\\n        display: block;\\n      }\"] });\n/** @nocollapse */\nNgxIonicImageViewerComponent.ctorParameters = () => [\n    { type: ModalController }\n];\nNgxIonicImageViewerComponent.propDecorators = {\n    alt: [{ type: Input }],\n    cssClass: [{ type: Input }],\n    scheme: [{ type: Input }],\n    slideOptions: [{ type: Input }],\n    src: [{ type: Input }],\n    srcFallback: [{ type: Input }],\n    srcHighRes: [{ type: Input }],\n    swipeToClose: [{ type: Input }],\n    text: [{ type: Input }],\n    title: [{ type: Input }],\n    titleSize: [{ type: Input }]\n};\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NgxIonicImageViewerComponent, [{\n        type: Component,\n        args: [{\n                selector: 'ion-img-viewer',\n                template: \"<img\\n  [alt]=\\\"alt\\\"\\n  [src]=\\\"src\\\"\\n  (click)=\\\"viewImage(src, srcFallback, srcHighRes, title, titleSize, text, scheme, slideOptions, swipeToClose)\\\"\\n  (error)=\\\"src = srcFallback\\\"\\n/>\\n\",\n                encapsulation: ViewEncapsulation.Emulated,\n                styles: [`\n      :host {\n        display: block;\n      }\n    `]\n            }]\n    }], function () { return [{ type: ɵngcc1.ModalController }]; }, { alt: [{\n            type: Input\n        }], cssClass: [{\n            type: Input\n        }], scheme: [{\n            type: Input\n        }], slideOptions: [{\n            type: Input\n        }], src: [{\n            type: Input\n        }], srcFallback: [{\n            type: Input\n        }], srcHighRes: [{\n            type: Input\n        }], swipeToClose: [{\n            type: Input\n        }], text: [{\n            type: Input\n        }], title: [{\n            type: Input\n        }], titleSize: [{\n            type: Input\n        }] }); })();\nif (false) {\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.alt;\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.cssClass;\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.scheme;\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.slideOptions;\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.src;\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.srcFallback;\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.srcHighRes;\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.swipeToClose;\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.text;\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.title;\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.titleSize;\n    /** @type {?} */\n    NgxIonicImageViewerComponent.prototype.modalController;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: lib/ngx-ionic-image-viewer.directive.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\nclass NgxIonicImageViewerDirective {\n    /**\n     * @param {?} el\n     * @param {?} renderer\n     * @param {?} modalController\n     */\n    constructor(el, renderer, modalController) {\n        this.el = el;\n        this.renderer = renderer;\n        this.modalController = modalController;\n    }\n    /**\n     * @return {?}\n     */\n    onClick() {\n        this.viewImage(this.src, this.srcFallback, this.srcHighRes, this.title, this.titleSize, this.text, this.scheme, this.slideOptions, this.swipeToClose);\n    }\n    /**\n     * @param {?} error\n     * @return {?}\n     */\n    onError(error) {\n        if (this.src !== this.el.nativeElement.src) {\n            this.src = this.el.nativeElement.src;\n        }\n        if (this.srcFallback) {\n            this.renderer.setAttribute(this.el.nativeElement, 'src', this.srcFallback);\n        }\n    }\n    /**\n     * @return {?}\n     */\n    ngOnInit() {\n        if (!this.el.nativeElement.hasAttribute('src')) {\n            this.renderer.setAttribute(this.el.nativeElement, 'src', this.src);\n        }\n    }\n    /**\n     * @param {?} src\n     * @param {?=} srcFallback\n     * @param {?=} srcHighRes\n     * @param {?=} title\n     * @param {?=} titleSize\n     * @param {?=} text\n     * @param {?=} scheme\n     * @param {?=} slideOptions\n     * @param {?=} swipeToClose\n     * @return {?}\n     */\n    viewImage(src, srcFallback = '', srcHighRes = '', title = '', titleSize = '', text = '', scheme = 'auto', slideOptions = {}, swipeToClose = true) {\n        return __awaiter(this, void 0, void 0, function* () {\n            /** @type {?} */\n            const modal = yield this.modalController.create({\n                component: ViewerModalComponent,\n                componentProps: {\n                    src,\n                    srcFallback,\n                    srcHighRes,\n                    title,\n                    titleSize,\n                    text,\n                    scheme,\n                    slideOptions,\n                    swipeToClose\n                },\n                cssClass: this.cssClass instanceof Array ? ['ion-img-viewer', ...this.cssClass] : ['ion-img-viewer', this.cssClass],\n                keyboardClose: true,\n                showBackdrop: true\n            });\n            return yield modal.present();\n        });\n    }\n}\nNgxIonicImageViewerDirective.ɵfac = function NgxIonicImageViewerDirective_Factory(t) { return new (t || NgxIonicImageViewerDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.ModalController)); };\nNgxIonicImageViewerDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: NgxIonicImageViewerDirective, selectors: [[\"\", \"ionImgViewer\", \"\"]], hostBindings: function NgxIonicImageViewerDirective_HostBindings(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵlistener(\"click\", function NgxIonicImageViewerDirective_click_HostBindingHandler() { return ctx.onClick(); })(\"error\", function NgxIonicImageViewerDirective_error_HostBindingHandler($event) { return ctx.onError($event); });\n    } }, inputs: { src: \"src\", cssClass: \"cssClass\", scheme: \"scheme\", slideOptions: \"slideOptions\", srcFallback: \"srcFallback\", srcHighRes: \"srcHighRes\", swipeToClose: \"swipeToClose\", text: \"text\", title: \"title\", titleSize: \"titleSize\" } });\n/** @nocollapse */\nNgxIonicImageViewerDirective.ctorParameters = () => [\n    { type: ElementRef },\n    { type: Renderer2 },\n    { type: ModalController }\n];\nNgxIonicImageViewerDirective.propDecorators = {\n    cssClass: [{ type: Input }],\n    scheme: [{ type: Input }],\n    slideOptions: [{ type: Input }],\n    src: [{ type: Input }],\n    srcFallback: [{ type: Input }],\n    srcHighRes: [{ type: Input }],\n    swipeToClose: [{ type: Input }],\n    text: [{ type: Input }],\n    title: [{ type: Input }],\n    titleSize: [{ type: Input }],\n    onClick: [{ type: HostListener, args: ['click',] }],\n    onError: [{ type: HostListener, args: ['error', ['$event'],] }]\n};\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NgxIonicImageViewerDirective, [{\n        type: Directive,\n        args: [{\n                selector: '[ionImgViewer]'\n            }]\n    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc1.ModalController }]; }, { \n    /**\n     * @return {?}\n     */\n    onClick: [{\n            type: HostListener,\n            args: ['click']\n        }], \n    /**\n     * @param {?} error\n     * @return {?}\n     */\n    onError: [{\n            type: HostListener,\n            args: ['error', ['$event']]\n        }], src: [{\n            type: Input\n        }], cssClass: [{\n            type: Input\n        }], scheme: [{\n            type: Input\n        }], slideOptions: [{\n            type: Input\n        }], srcFallback: [{\n            type: Input\n        }], srcHighRes: [{\n            type: Input\n        }], swipeToClose: [{\n            type: Input\n        }], text: [{\n            type: Input\n        }], title: [{\n            type: Input\n        }], titleSize: [{\n            type: Input\n        }] }); })();\nif (false) {\n    /** @type {?} */\n    NgxIonicImageViewerDirective.prototype.cssClass;\n    /** @type {?} */\n    NgxIonicImageViewerDirective.prototype.scheme;\n    /** @type {?} */\n    NgxIonicImageViewerDirective.prototype.slideOptions;\n    /** @type {?} */\n    NgxIonicImageViewerDirective.prototype.src;\n    /** @type {?} */\n    NgxIonicImageViewerDirective.prototype.srcFallback;\n    /** @type {?} */\n    NgxIonicImageViewerDirective.prototype.srcHighRes;\n    /** @type {?} */\n    NgxIonicImageViewerDirective.prototype.swipeToClose;\n    /** @type {?} */\n    NgxIonicImageViewerDirective.prototype.text;\n    /** @type {?} */\n    NgxIonicImageViewerDirective.prototype.title;\n    /** @type {?} */\n    NgxIonicImageViewerDirective.prototype.titleSize;\n    /**\n     * @type {?}\n     * @private\n     */\n    NgxIonicImageViewerDirective.prototype.el;\n    /**\n     * @type {?}\n     * @private\n     */\n    NgxIonicImageViewerDirective.prototype.renderer;\n    /** @type {?} */\n    NgxIonicImageViewerDirective.prototype.modalController;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: lib/ngx-ionic-image-viewer.module.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\nclass NgxIonicImageViewerModule {\n}\nNgxIonicImageViewerModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: NgxIonicImageViewerModule });\nNgxIonicImageViewerModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function NgxIonicImageViewerModule_Factory(t) { return new (t || NgxIonicImageViewerModule)(); }, imports: [[CommonModule, IonicModule]] });\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(NgxIonicImageViewerModule, { declarations: function () { return [NgxIonicImageViewerComponent, NgxIonicImageViewerDirective, ViewerModalComponent]; }, imports: function () { return [CommonModule, IonicModule]; }, exports: function () { return [NgxIonicImageViewerComponent, NgxIonicImageViewerDirective, ViewerModalComponent]; } }); })();\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NgxIonicImageViewerModule, [{\n        type: NgModule,\n        args: [{\n                declarations: [NgxIonicImageViewerComponent, NgxIonicImageViewerDirective, ViewerModalComponent],\n                imports: [CommonModule, IonicModule],\n                entryComponents: [ViewerModalComponent],\n                exports: [NgxIonicImageViewerComponent, NgxIonicImageViewerDirective, ViewerModalComponent]\n            }]\n    }], null, null); })();\n\n/**\n * @fileoverview added by tsickle\n * Generated from: public-api.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * @fileoverview added by tsickle\n * Generated from: ngx-ionic-image-viewer.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\nexport { NgxIonicImageViewerComponent, NgxIonicImageViewerDirective, NgxIonicImageViewerModule, NgxIonicImageViewerService, ViewerModalComponent };\n\n//# sourceMappingURL=ngx-ionic-image-viewer.js.map","import { arrayBufferToHex } from './encoding';\n\nexport async function sha256WithBlob(blob: Blob) {\n  const digested = await crypto.subtle.digest(\n    'SHA-256',\n    await blob.arrayBuffer()\n  );\n  return arrayBufferToHex(digested);\n}\n","<ion-content scrollEvents (ionScroll)=\"onScroll($event)\">\n  <ion-grid>\n    <ion-row>\n      <ion-col\n        #col\n        *ngFor=\"let moment of moments$ | ngrxPush; trackBy: trackMoment\"\n        size=\"6\"\n        size-sm=\"4\"\n        size-md=\"3\"\n        size-lg=\"2\"\n      >\n        <app-moment-thumbnail [moment]=\"moment\"></app-moment-thumbnail>\n      </ion-col>\n    </ion-row>\n  </ion-grid>\n  <ion-fab vertical=\"bottom\" horizontal=\"center\" slot=\"fixed\" edge>\n    <ion-fab-button (click)=\"presentCamera()\">\n      <ion-icon name=\"camera-outline\"></ion-icon>\n    </ion-fab-button>\n  </ion-fab>\n</ion-content>\n<ion-footer [class.ion-no-border]=\"noFooterBorder$ | ngrxPush\">\n  <ion-toolbar>\n    <ion-buttons slot=\"primary\">\n      <ion-button (click)=\"presentSettings($event)\" slot=\"secondary\">\n        <ion-icon slot=\"icon-only\" name=\"settings-outline\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-footer>\n","import { Component, ViewChild } from '@angular/core';\nimport { IonContent, ModalController, PopoverController } from '@ionic/angular';\nimport { BehaviorSubject, combineLatest, Subject } from 'rxjs';\nimport { distinctUntilChanged, switchMap } from 'rxjs/operators';\nimport { Moment } from '../../shared/moment/moment';\nimport { MomentRepository } from '../../shared/moment/moment-repository.service';\nimport { isNonNullable } from '../../utils/rx-operators';\nimport { CameraComponent } from './camera/camera.component';\nimport { SettingsComponent } from './settings/settings.component';\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n})\nexport class HomePage {\n  readonly moments$ = this.momentRepository.all$;\n\n  private readonly _ionContent$ = new BehaviorSubject<IonContent | undefined>(\n    undefined\n  );\n\n  private readonly ionContent$ = this._ionContent$.pipe(\n    isNonNullable(),\n    distinctUntilChanged()\n  );\n\n  @ViewChild(IonContent)\n  set ionContent(value: IonContent) {\n    this._ionContent$.next(value);\n  }\n\n  private readonly _scrollEvent$ = new Subject<Event>();\n\n  private readonly scrollEvent$ = this._scrollEvent$.pipe(\n    distinctUntilChanged()\n  );\n\n  readonly noFooterBorder$ = combineLatest([\n    this.ionContent$,\n    this.scrollEvent$,\n  ]).pipe(switchMap(([ionContent]) => this.detectBottom(ionContent)));\n\n  constructor(\n    private readonly popoverController: PopoverController,\n    private readonly modalController: ModalController,\n    private readonly momentRepository: MomentRepository\n  ) {}\n\n  onScroll(event: Event) {\n    this._scrollEvent$.next(event);\n  }\n\n  private async detectBottom(ionContent: IonContent) {\n    const scrollElement = await ionContent.getScrollElement();\n    return (\n      scrollElement.scrollTop ===\n      scrollElement.scrollHeight - scrollElement.clientHeight\n    );\n  }\n\n  async presentSettings(event: Event) {\n    const settingsPopover = await this.popoverController.create({\n      component: SettingsComponent,\n      event,\n    });\n    return await settingsPopover.present();\n  }\n\n  async presentCamera() {\n    const cameraModal = await this.modalController.create({\n      component: CameraComponent,\n    });\n    return await cameraModal.present();\n  }\n\n  trackMoment(_: number, item: Moment) {\n    return item.id;\n  }\n}\n","import { NgZone, Pipe, ChangeDetectorRef, Directive, TemplateRef, ViewContainerRef, Input, NgModule } from '@angular/core';\nimport { Subject, EMPTY, isObservable, from } from 'rxjs';\nimport { distinctUntilChanged, switchMap, tap, catchError } from 'rxjs/operators';\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/core/cd-aware/cd-aware_creator.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @record\n * @template U\n */\nimport * as ɵngcc0 from '@angular/core';\nfunction CdAware() { }\nif (false) {\n    /** @type {?} */\n    CdAware.prototype.nextPotentialObservable;\n}\n/**\n * class CdAware\n *\n * \\@description\n * This abstract class holds all the shared logic for the push pipe and the let directive\n * responsible for change detection\n * If you extend this class you need to implement how the update of the rendered value happens.\n * Also custom behaviour is something you need to implement in the extending class\n * @template U\n * @param {?} cfg\n * @return {?}\n */\nfunction createCdAware(cfg) {\n    /** @type {?} */\n    const potentialObservablesSubject = new Subject();\n    /** @type {?} */\n    const observablesFromTemplate$ = potentialObservablesSubject.pipe(distinctUntilChanged());\n    /** @type {?} */\n    const rendering$ = observablesFromTemplate$.pipe(\n    // Compose the observables from the template and the strategy\n    switchMap((/**\n     * @param {?} observable$\n     * @return {?}\n     */\n    (observable$) => {\n        // If the passed observable is:\n        // - undefined - No value set\n        // - null - null passed directly or no value set over `async` pipe\n        if (observable$ == null) {\n            // Update the value to render_creator with null/undefined\n            cfg.updateViewContextObserver.next((/** @type {?} */ (observable$)));\n            // Render the view\n            cfg.render();\n            // Stop further processing\n            return EMPTY;\n        }\n        /** @type {?} */\n        const ob$ = isObservable(observable$)\n            ? ((/** @type {?} */ (observable$)))\n            : from(observable$);\n        // If a new Observable arrives, reset the value to render_creator\n        // We do this because we don't know when the next value arrives and want to get rid of the old value\n        cfg.resetContextObserver.next();\n        cfg.render();\n        return ((/** @type {?} */ (ob$))).pipe(distinctUntilChanged(), tap(cfg.updateViewContextObserver), tap((/**\n         * @return {?}\n         */\n        () => cfg.render())), catchError((/**\n         * @param {?} e\n         * @return {?}\n         */\n        (e) => {\n            return EMPTY;\n        })));\n    })));\n    return (/** @type {?} */ ({\n        /**\n         * @param {?} value\n         * @return {?}\n         */\n        nextPotentialObservable(value) {\n            potentialObservablesSubject.next(value);\n        },\n        /**\n         * @return {?}\n         */\n        subscribe() {\n            return rendering$.subscribe();\n        },\n    }));\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/core/utils/has-zone.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * \\@description\n *\n * Determines if the application uses `NgZone` or `NgNoopZone` as ngZone service instance.\n *\n * The function can be just imported and used everywhere.\n *\n * ```ts\n * import { hasZone } from `utils/has-zone`;\n *\n * console.log(hasZone());\n * ```\n * @param {?} z\n * @return {?}\n */\nfunction hasZone(z) {\n    return z instanceof NgZone;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/core/cd-aware/creator_render.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @record\n */\nfunction RenderConfig() { }\nif (false) {\n    /** @type {?} */\n    RenderConfig.prototype.ngZone;\n    /** @type {?} */\n    RenderConfig.prototype.cdRef;\n}\n/**\n * @template T\n * @param {?} config\n * @return {?}\n */\nfunction createRender(config) {\n    /**\n     * @return {?}\n     */\n    function render() {\n        if (hasZone(config.ngZone)) {\n            config.cdRef.markForCheck();\n        }\n        else {\n            config.cdRef.detectChanges();\n        }\n    }\n    return render;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/push/push.pipe.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * \\@Pipe PushPipe\n *\n * \\@description\n *\n * The `ngrxPush` pipe serves as a drop-in replacement for the `async` pipe.\n * It contains intelligent handling of change detection to enable us\n * running in zone-full as well as zone-less mode without any changes to the code.\n *\n * The current way of binding an observable to the view looks like that:\n *  ```html\n *  {{observable$ | async}}\n * <ng-container *ngIf=\"observable$ | async as o\">{{o}}</ng-container>\n * <component [value]=\"observable$ | async\"></component>\n * ```\n *\n * The problem is `async` pipe just marks the component and all its ancestors as dirty.\n * It needs zone.js microtask queue to exhaust until `ApplicationRef.tick` is called to render_creator all dirty marked\n *     components.\n *\n * Heavy dynamic and interactive UIs suffer from zones change detection a lot and can\n * lean to bad performance or even unusable applications, but the `async` pipe does not work in zone-less mode.\n *\n * `ngrxPush` pipe solves that problem.\n *\n * Included Features:\n *  - Take observables or promises, retrieve their values and render_creator the value to the template\n *  - Handling null and undefined values in a clean unified/structured way\n *  - Triggers change-detection differently if `zone.js` is present or not (`detectChanges` or `markForCheck`)\n *  - Distinct same values in a row to increase performance\n *  - Coalescing of change detection calls to boost performance\n *\n * \\@usageNotes\n *\n * `ngrxPush` pipe solves that problem. It can be used like shown here:\n * ```html\n * {{observable$ | ngrxPush}}\n * <ng-container *ngIf=\"observable$ | ngrxPush as o\">{{o}}</ng-container>\n * <component [value]=\"observable$ | ngrxPush\"></component>\n * ```\n *\n * \\@publicApi\n * @template S\n */\nclass PushPipe {\n    /**\n     * @param {?} cdRef\n     * @param {?} ngZone\n     */\n    constructor(cdRef, ngZone) {\n        this.resetContextObserver = {\n            next: (/**\n             * @return {?}\n             */\n            () => (this.renderedValue = undefined)),\n        };\n        this.updateViewContextObserver = {\n            next: (/**\n             * @param {?} value\n             * @return {?}\n             */\n            (value) => (this.renderedValue = value)),\n        };\n        this.cdAware = createCdAware({\n            render: createRender({ cdRef, ngZone }),\n            updateViewContextObserver: this.updateViewContextObserver,\n            resetContextObserver: this.resetContextObserver,\n        });\n        this.subscription = this.cdAware.subscribe();\n    }\n    /**\n     * @template T\n     * @param {?} potentialObservable\n     * @return {?}\n     */\n    transform(potentialObservable) {\n        this.cdAware.nextPotentialObservable(potentialObservable);\n        return (/** @type {?} */ (this.renderedValue));\n    }\n    /**\n     * @return {?}\n     */\n    ngOnDestroy() {\n        this.subscription.unsubscribe();\n    }\n}\nPushPipe.ɵfac = function PushPipe_Factory(t) { return new (t || PushPipe)(ɵngcc0.ɵɵinjectPipeChangeDetectorRef(), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone)); };\nPushPipe.ɵpipe = ɵngcc0.ɵɵdefinePipe({ name: \"ngrxPush\", type: PushPipe, pure: false });\n/** @nocollapse */\nPushPipe.ctorParameters = () => [\n    { type: ChangeDetectorRef },\n    { type: NgZone }\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(PushPipe, [{\n        type: Pipe,\n        args: [{ name: 'ngrxPush', pure: false }]\n    }], function () { return [{ type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.NgZone }]; }, null); })();\nif (false) {\n    /**\n     * @type {?}\n     * @private\n     */\n    PushPipe.prototype.renderedValue;\n    /**\n     * @type {?}\n     * @private\n     */\n    PushPipe.prototype.subscription;\n    /**\n     * @type {?}\n     * @private\n     */\n    PushPipe.prototype.cdAware;\n    /**\n     * @type {?}\n     * @private\n     */\n    PushPipe.prototype.resetContextObserver;\n    /**\n     * @type {?}\n     * @private\n     */\n    PushPipe.prototype.updateViewContextObserver;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/let/let.directive.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @record\n * @template T\n */\nfunction LetViewContext() { }\nif (false) {\n    /** @type {?} */\n    LetViewContext.prototype.$implicit;\n    /** @type {?} */\n    LetViewContext.prototype.ngrxLet;\n    /** @type {?} */\n    LetViewContext.prototype.$error;\n    /** @type {?} */\n    LetViewContext.prototype.$complete;\n}\n/**\n * \\@Directive LetDirective\n *\n * \\@description\n *\n * The `*ngrxLet` directive serves a convenient way of binding observables to a view context (a dom element scope).\n * It also helps with several internal processing under the hood.\n *\n * The current way of binding an observable to the view looks like that:\n * ```html\n * <ng-container *ngIf=\"observableNumber$ as n\">\n * <app-number [number]=\"n\">\n * </app-number>\n * <app-number-special [number]=\"n\">\n * </app-number-special>\n * </ng-container>\n *  ```\n *\n *  The problem is `*ngIf` is also interfering with rendering and in case of a `0` the component would be hidden\n *\n * Included Features:\n * - binding is always present. (`*ngIf=\"truthy$\"`)\n * - it takes away the multiple usages of the `async` or `ngrxPush` pipe\n * - a unified/structured way of handling null and undefined\n * - triggers change-detection differently if `zone.js` is present or not (`ChangeDetectorRef.detectChanges` or `ChangeDetectorRef.markForCheck`)\n * - triggers change-detection differently if ViewEngine or Ivy is present (`ChangeDetectorRef.detectChanges` or `ɵdetectChanges`)\n * - distinct same values in a row (distinctUntilChanged operator),\n *\n * \\@usageNotes\n *\n * The `*ngrxLet` directive take over several things and makes it more convenient and save to work with streams in the template\n * `<ng-container *ngrxLet=\"observableNumber$ as c\"></ng-container>`\n *\n * ```html\n * <ng-container *ngrxLet=\"observableNumber$ as n\">\n * <app-number [number]=\"n\">\n * </app-number>\n * </ng-container>\n *\n * <ng-container *ngrxLet=\"observableNumber$; let n\">\n * <app-number [number]=\"n\">\n * </app-number>\n * </ng-container>\n * ```\n *\n * In addition to that it provides us information from the whole observable context.\n * We can track the observables:\n * - next value\n * - error value\n * - complete state\n *\n * ```html\n * <ng-container *ngrxLet=\"observableNumber$; let n; let e = $error, let c = $complete\">\n * <app-number [number]=\"n\"  *ngIf=\"!e && !c\">\n * </app-number>\n * <ng-container *ngIf=\"e\">\n * There is an error: {{e}}\n * </ng-container>\n * <ng-container *ngIf=\"c\">\n * Observable completed: {{c}}\n * </ng-container>\n * </ng-container>\n * ```\n *\n * \\@publicApi\n * @template U\n */\nclass LetDirective {\n    /**\n     * @param {?} cdRef\n     * @param {?} ngZone\n     * @param {?} templateRef\n     * @param {?} viewContainerRef\n     */\n    constructor(cdRef, ngZone, templateRef, viewContainerRef) {\n        this.templateRef = templateRef;\n        this.viewContainerRef = viewContainerRef;\n        this.ViewContext = {\n            $implicit: undefined,\n            ngrxLet: undefined,\n            $error: false,\n            $complete: false,\n        };\n        this.resetContextObserver = {\n            next: (/**\n             * @return {?}\n             */\n            () => {\n                // if not initialized no need to set undefined\n                if (this.embeddedView) {\n                    this.ViewContext.$implicit = undefined;\n                    this.ViewContext.ngrxLet = undefined;\n                    this.ViewContext.$error = false;\n                    this.ViewContext.$complete = false;\n                }\n            }),\n        };\n        this.updateViewContextObserver = {\n            next: (/**\n             * @param {?} value\n             * @return {?}\n             */\n            (value) => {\n                // to have init lazy\n                if (!this.embeddedView) {\n                    this.createEmbeddedView();\n                }\n                this.ViewContext.$implicit = value;\n                this.ViewContext.ngrxLet = value;\n            }),\n            error: (/**\n             * @param {?} error\n             * @return {?}\n             */\n            (error) => {\n                // to have init lazy\n                if (!this.embeddedView) {\n                    this.createEmbeddedView();\n                }\n                this.ViewContext.$error = true;\n            }),\n            complete: (/**\n             * @return {?}\n             */\n            () => {\n                // to have init lazy\n                if (!this.embeddedView) {\n                    this.createEmbeddedView();\n                }\n                this.ViewContext.$complete = true;\n            }),\n        };\n        this.cdAware = createCdAware({\n            render: createRender({ cdRef, ngZone }),\n            resetContextObserver: this.resetContextObserver,\n            updateViewContextObserver: this.updateViewContextObserver,\n        });\n        this.subscription = this.cdAware.subscribe();\n    }\n    /**\n     * @template U\n     * @param {?} dir\n     * @param {?} ctx\n     * @return {?}\n     */\n    static ngTemplateContextGuard(dir, ctx) {\n        return true;\n    }\n    /**\n     * @param {?} potentialObservable\n     * @return {?}\n     */\n    set ngrxLet(potentialObservable) {\n        this.cdAware.nextPotentialObservable(potentialObservable);\n    }\n    /**\n     * @return {?}\n     */\n    createEmbeddedView() {\n        this.embeddedView = this.viewContainerRef.createEmbeddedView(this.templateRef, this.ViewContext);\n    }\n    /**\n     * @return {?}\n     */\n    ngOnDestroy() {\n        this.subscription.unsubscribe();\n        this.viewContainerRef.clear();\n    }\n}\nLetDirective.ɵfac = function LetDirective_Factory(t) { return new (t || LetDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ViewContainerRef)); };\nLetDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: LetDirective, selectors: [[\"\", \"ngrxLet\", \"\"]], inputs: { ngrxLet: \"ngrxLet\" } });\n/** @nocollapse */\nLetDirective.ctorParameters = () => [\n    { type: ChangeDetectorRef },\n    { type: NgZone },\n    { type: TemplateRef },\n    { type: ViewContainerRef }\n];\nLetDirective.propDecorators = {\n    ngrxLet: [{ type: Input }]\n};\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(LetDirective, [{\n        type: Directive,\n        args: [{ selector: '[ngrxLet]' }]\n    }], function () { return [{ type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.TemplateRef }, { type: ɵngcc0.ViewContainerRef }]; }, { ngrxLet: [{\n            type: Input\n        }] }); })();\nif (false) {\n    /** @type {?} */\n    LetDirective.ngTemplateGuard_ngrxLet;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.embeddedView;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.ViewContext;\n    /**\n     * @type {?}\n     * @protected\n     */\n    LetDirective.prototype.subscription;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.cdAware;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.resetContextObserver;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.updateViewContextObserver;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.templateRef;\n    /**\n     * @type {?}\n     * @private\n     */\n    LetDirective.prototype.viewContainerRef;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/reactive-component.module.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/** @type {?} */\nconst DECLARATIONS = [LetDirective, PushPipe];\n/** @type {?} */\nconst EXPORTS = [DECLARATIONS];\nclass ReactiveComponentModule {\n}\nReactiveComponentModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: ReactiveComponentModule });\nReactiveComponentModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function ReactiveComponentModule_Factory(t) { return new (t || ReactiveComponentModule)(); } });\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(ReactiveComponentModule, { declarations: [LetDirective, PushPipe], exports: [LetDirective, PushPipe] }); })();\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ReactiveComponentModule, [{\n        type: NgModule,\n        args: [{\n                declarations: [DECLARATIONS],\n                exports: [EXPORTS]\n            }]\n    }], null, null); })();\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/index.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * @fileoverview added by tsickle\n * Generated from: public_api.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * @fileoverview added by tsickle\n * Generated from: index.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * @fileoverview added by tsickle\n * Generated from: ngrx-component.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\nexport { LetDirective, PushPipe, ReactiveComponentModule };\n\n//# sourceMappingURL=ngrx-component.js.map","\n/*! image-blob-reduce 2.2.2 https://github.com/nodeca/image-blob-reduce @license MIT */\nvar assign = function assign(to) {\n  var from;\n\n  for (var s = 1; s < arguments.length; s++) {\n    from = Object(arguments[s]);\n\n    for (var key in from) {\n      if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n    }\n  }\n\n  return to;\n};\n\n\nfunction pick(from, props) {\n  var to = {};\n\n  props.forEach(function (key) {\n    if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n  });\n\n  return to;\n}\n\n\nfunction pick_pica_resize_options(from) {\n  return pick(from, [\n    'alpha',\n    'unsharpAmount',\n    'unsharpRadius',\n    'unsharpThreshold',\n    'cancelToken'\n  ]);\n}\n\n\nvar pick_1 = pick;\nvar pick_pica_resize_options_1 = pick_pica_resize_options;\n\nvar utils = {\n\tassign: assign,\n\tpick: pick_1,\n\tpick_pica_resize_options: pick_pica_resize_options_1\n};\n\nfunction createCommonjsModule(fn) {\n  var module = { exports: {} };\n\treturn fn(module, module.exports), module.exports;\n}\n\nfunction commonjsRequire (target) {\n\tthrow new Error('Could not dynamically require \"' + target + '\". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.');\n}\n\n/*!\n\npica\nhttps://github.com/nodeca/pica\n\n*/\n\nvar pica = createCommonjsModule(function (module, exports) {\n(function(f){{module.exports=f();}})(function(){return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof commonjsRequire&&commonjsRequire;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t);}return n[i].exports}for(var u=\"function\"==typeof commonjsRequire&&commonjsRequire,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(_dereq_,module,exports){\n\nvar inherits = _dereq_('inherits');\n\nvar Multimath = _dereq_('multimath');\n\nvar mm_unsharp_mask = _dereq_('multimath/lib/unsharp_mask');\n\nvar mm_resize = _dereq_('./mm_resize');\n\nfunction MathLib(requested_features) {\n  var __requested_features = requested_features || [];\n\n  var features = {\n    js: __requested_features.indexOf('js') >= 0,\n    wasm: __requested_features.indexOf('wasm') >= 0\n  };\n  Multimath.call(this, features);\n  this.features = {\n    js: features.js,\n    wasm: features.wasm && this.has_wasm()\n  };\n  this.use(mm_unsharp_mask);\n  this.use(mm_resize);\n}\n\ninherits(MathLib, Multimath);\n\nMathLib.prototype.resizeAndUnsharp = function resizeAndUnsharp(options, cache) {\n  var result = this.resize(options, cache);\n\n  if (options.unsharpAmount) {\n    this.unsharp_mask(result, options.toWidth, options.toHeight, options.unsharpAmount, options.unsharpRadius, options.unsharpThreshold);\n  }\n\n  return result;\n};\n\nmodule.exports = MathLib;\n\n},{\"./mm_resize\":4,\"inherits\":15,\"multimath\":16,\"multimath/lib/unsharp_mask\":19}],2:[function(_dereq_,module,exports){\n//var FIXED_FRAC_BITS = 14;\n\nfunction clampTo8(i) {\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n} // Convolve image in horizontal directions and transpose output. In theory,\n// transpose allow:\n//\n// - use the same convolver for both passes (this fails due different\n//   types of input array and temporary buffer)\n// - making vertical pass by horisonltal lines inprove CPU cache use.\n//\n// But in real life this doesn't work :)\n//\n\n\nfunction convolveHorizontally(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Bring this value back in range. All of the filter scaling factors\n      // are in fixed point with FIXED_FRAC_BITS bits of fractional part.\n      //\n      // (!) Add 1/2 of value before clamping to get proper rounding. In other\n      // case brightness loss will be noticeable if you resize image with white\n      // border and place it on white background.\n      //\n\n\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Technically, convolvers are the same. But input array and temporary\n// buffer can be of different type (especially, in old browsers). So,\n// keep code in separate functions to avoid deoptimizations & speed loss.\n\n\nfunction convolveVertically(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Bring this value back in range. All of the filter scaling factors\n      // are in fixed point with FIXED_FRAC_BITS bits of fractional part.\n      //\n      // (!) Add 1/2 of value before clamping to get proper rounding. In other\n      // case brightness loss will be noticeable if you resize image with white\n      // border and place it on white background.\n      //\n\n\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n}\n\nmodule.exports = {\n  convolveHorizontally: convolveHorizontally,\n  convolveVertically: convolveVertically\n};\n\n},{}],3:[function(_dereq_,module,exports){\n/* eslint-disable max-len */\n\nmodule.exports = 'AGFzbQEAAAABFAJgBn9/f39/fwBgB39/f39/f38AAg8BA2VudgZtZW1vcnkCAAEDAwIAAQQEAXAAAAcZAghjb252b2x2ZQAACmNvbnZvbHZlSFYAAQkBAArmAwLBAwEQfwJAIANFDQAgBEUNACAFQQRqIRVBACEMQQAhDQNAIA0hDkEAIRFBACEHA0AgB0ECaiESAn8gBSAHQQF0IgdqIgZBAmouAQAiEwRAQQAhCEEAIBNrIRQgFSAHaiEPIAAgDCAGLgEAakECdGohEEEAIQlBACEKQQAhCwNAIBAoAgAiB0EYdiAPLgEAIgZsIAtqIQsgB0H/AXEgBmwgCGohCCAHQRB2Qf8BcSAGbCAKaiEKIAdBCHZB/wFxIAZsIAlqIQkgD0ECaiEPIBBBBGohECAUQQFqIhQNAAsgEiATagwBC0EAIQtBACEKQQAhCUEAIQggEgshByABIA5BAnRqIApBgMAAakEOdSIGQf8BIAZB/wFIG0EQdEGAgPwHcUEAIAZBAEobIAtBgMAAakEOdSIGQf8BIAZB/wFIG0EYdEEAIAZBAEobciAJQYDAAGpBDnUiBkH/ASAGQf8BSBtBCHRBgP4DcUEAIAZBAEobciAIQYDAAGpBDnUiBkH/ASAGQf8BSBtB/wFxQQAgBkEAShtyNgIAIA4gA2ohDiARQQFqIhEgBEcNAAsgDCACaiEMIA1BAWoiDSADRw0ACwsLIQACQEEAIAIgAyAEIAUgABAAIAJBACAEIAUgBiABEAALCw==';\n\n},{}],4:[function(_dereq_,module,exports){\n\nmodule.exports = {\n  name: 'resize',\n  fn: _dereq_('./resize'),\n  wasm_fn: _dereq_('./resize_wasm'),\n  wasm_src: _dereq_('./convolve_wasm_base64')\n};\n\n},{\"./convolve_wasm_base64\":3,\"./resize\":5,\"./resize_wasm\":8}],5:[function(_dereq_,module,exports){\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nvar convolveHorizontally = _dereq_('./convolve').convolveHorizontally;\n\nvar convolveVertically = _dereq_('./convolve').convolveVertically;\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nmodule.exports = function resize(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0;\n  var offsetY = options.offsetY || 0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var quality = typeof options.quality === 'undefined' ? 3 : options.quality;\n  var alpha = options.alpha || false;\n  var filtersX = createFilters(quality, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(quality, srcH, destH, scaleY, offsetY);\n  var tmp = new Uint8Array(destW * srcH * 4); // To use single function we need src & tmp of the same type.\n  // But src can be CanvasPixelArray, and tmp - Uint8Array. So, keep\n  // vertical and horizontal passes separately to avoid deoptimization.\n\n  convolveHorizontally(src, tmp, srcW, srcH, destW, filtersX);\n  convolveVertically(tmp, dest, srcH, destW, destH, filtersY); // That's faster than doing checks in convolver.\n  // !!! Note, canvas data is not premultipled. We don't need other\n  // alpha corrections.\n\n  if (!alpha) resetAlpha(dest, destW, destH);\n  return dest;\n};\n\n},{\"./convolve\":2,\"./resize_filter_gen\":6}],6:[function(_dereq_,module,exports){\n\nvar FILTER_INFO = _dereq_('./resize_filter_info'); // Precision of fixed FP values\n\n\nvar FIXED_FRAC_BITS = 14;\n\nfunction toFixedPoint(num) {\n  return Math.round(num * ((1 << FIXED_FRAC_BITS) - 1));\n}\n\nmodule.exports = function resizeFilterGen(quality, srcSize, destSize, scale, offset) {\n  var filterFunction = FILTER_INFO[quality].filter;\n  var scaleInverted = 1.0 / scale;\n  var scaleClamped = Math.min(1.0, scale); // For upscale\n  // Filter window (averaging interval), scaled to src image\n\n  var srcWindow = FILTER_INFO[quality].win / scaleClamped;\n  var destPixel, srcPixel, srcFirst, srcLast, filterElementSize, floatFilter, fxpFilter, total, pxl, idx, floatVal, filterTotal, filterVal;\n  var leftNotEmpty, rightNotEmpty, filterShift, filterSize;\n  var maxFilterElementSize = Math.floor((srcWindow + 1) * 2);\n  var packedFilter = new Int16Array((maxFilterElementSize + 2) * destSize);\n  var packedFilterPtr = 0;\n  var slowCopy = !packedFilter.subarray || !packedFilter.set; // For each destination pixel calculate source range and built filter values\n\n  for (destPixel = 0; destPixel < destSize; destPixel++) {\n    // Scaling should be done relative to central pixel point\n    srcPixel = (destPixel + 0.5) * scaleInverted + offset;\n    srcFirst = Math.max(0, Math.floor(srcPixel - srcWindow));\n    srcLast = Math.min(srcSize - 1, Math.ceil(srcPixel + srcWindow));\n    filterElementSize = srcLast - srcFirst + 1;\n    floatFilter = new Float32Array(filterElementSize);\n    fxpFilter = new Int16Array(filterElementSize);\n    total = 0.0; // Fill filter values for calculated range\n\n    for (pxl = srcFirst, idx = 0; pxl <= srcLast; pxl++, idx++) {\n      floatVal = filterFunction((pxl + 0.5 - srcPixel) * scaleClamped);\n      total += floatVal;\n      floatFilter[idx] = floatVal;\n    } // Normalize filter, convert to fixed point and accumulate conversion error\n\n\n    filterTotal = 0;\n\n    for (idx = 0; idx < floatFilter.length; idx++) {\n      filterVal = floatFilter[idx] / total;\n      filterTotal += filterVal;\n      fxpFilter[idx] = toFixedPoint(filterVal);\n    } // Compensate normalization error, to minimize brightness drift\n\n\n    fxpFilter[destSize >> 1] += toFixedPoint(1.0 - filterTotal); //\n    // Now pack filter to useable form\n    //\n    // 1. Trim heading and tailing zero values, and compensate shitf/length\n    // 2. Put all to single array in this format:\n    //\n    //    [ pos shift, data length, value1, value2, value3, ... ]\n    //\n\n    leftNotEmpty = 0;\n\n    while (leftNotEmpty < fxpFilter.length && fxpFilter[leftNotEmpty] === 0) {\n      leftNotEmpty++;\n    }\n\n    if (leftNotEmpty < fxpFilter.length) {\n      rightNotEmpty = fxpFilter.length - 1;\n\n      while (rightNotEmpty > 0 && fxpFilter[rightNotEmpty] === 0) {\n        rightNotEmpty--;\n      }\n\n      filterShift = srcFirst + leftNotEmpty;\n      filterSize = rightNotEmpty - leftNotEmpty + 1;\n      packedFilter[packedFilterPtr++] = filterShift; // shift\n\n      packedFilter[packedFilterPtr++] = filterSize; // size\n\n      if (!slowCopy) {\n        packedFilter.set(fxpFilter.subarray(leftNotEmpty, rightNotEmpty + 1), packedFilterPtr);\n        packedFilterPtr += filterSize;\n      } else {\n        // fallback for old IE < 11, without subarray/set methods\n        for (idx = leftNotEmpty; idx <= rightNotEmpty; idx++) {\n          packedFilter[packedFilterPtr++] = fxpFilter[idx];\n        }\n      }\n    } else {\n      // zero data, write header only\n      packedFilter[packedFilterPtr++] = 0; // shift\n\n      packedFilter[packedFilterPtr++] = 0; // size\n    }\n  }\n\n  return packedFilter;\n};\n\n},{\"./resize_filter_info\":7}],7:[function(_dereq_,module,exports){\n\nmodule.exports = [{\n  // Nearest neibor (Box)\n  win: 0.5,\n  filter: function filter(x) {\n    return x >= -0.5 && x < 0.5 ? 1.0 : 0.0;\n  }\n}, {\n  // Hamming\n  win: 1.0,\n  filter: function filter(x) {\n    if (x <= -1.0 || x >= 1.0) {\n      return 0.0;\n    }\n\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * (0.54 + 0.46 * Math.cos(xpi / 1.0));\n  }\n}, {\n  // Lanczos, win = 2\n  win: 2.0,\n  filter: function filter(x) {\n    if (x <= -2.0 || x >= 2.0) {\n      return 0.0;\n    }\n\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * Math.sin(xpi / 2.0) / (xpi / 2.0);\n  }\n}, {\n  // Lanczos, win = 3\n  win: 3.0,\n  filter: function filter(x) {\n    if (x <= -3.0 || x >= 3.0) {\n      return 0.0;\n    }\n\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * Math.sin(xpi / 3.0) / (xpi / 3.0);\n  }\n}];\n\n},{}],8:[function(_dereq_,module,exports){\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nfunction asUint8Array(src) {\n  return new Uint8Array(src.buffer, 0, src.byteLength);\n}\n\nvar IS_LE = true; // should not crash everything on module load in old browsers\n\ntry {\n  IS_LE = new Uint32Array(new Uint8Array([1, 0, 0, 0]).buffer)[0] === 1;\n} catch (__) {}\n\nfunction copyInt16asLE(src, target, target_offset) {\n  if (IS_LE) {\n    target.set(asUint8Array(src), target_offset);\n    return;\n  }\n\n  for (var ptr = target_offset, i = 0; i < src.length; i++) {\n    var data = src[i];\n    target[ptr++] = data & 0xFF;\n    target[ptr++] = data >> 8 & 0xFF;\n  }\n}\n\nmodule.exports = function resize_wasm(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0.0;\n  var offsetY = options.offsetY || 0.0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var quality = typeof options.quality === 'undefined' ? 3 : options.quality;\n  var alpha = options.alpha || false;\n  var filtersX = createFilters(quality, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(quality, srcH, destH, scaleY, offsetY); // destination is 0 too.\n\n  var src_offset = 0; // buffer between convolve passes\n\n  var tmp_offset = this.__align(src_offset + Math.max(src.byteLength, dest.byteLength));\n\n  var filtersX_offset = this.__align(tmp_offset + srcH * destW * 4);\n\n  var filtersY_offset = this.__align(filtersX_offset + filtersX.byteLength);\n\n  var alloc_bytes = filtersY_offset + filtersY.byteLength;\n\n  var instance = this.__instance('resize', alloc_bytes); //\n  // Fill memory block with data to process\n  //\n\n\n  var mem = new Uint8Array(this.__memory.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer); // 32-bit copy is much faster in chrome\n\n  var src32 = new Uint32Array(src.buffer);\n  mem32.set(src32); // We should guarantee LE bytes order. Filters are not big, so\n  // speed difference is not significant vs direct .set()\n\n  copyInt16asLE(filtersX, mem, filtersX_offset);\n  copyInt16asLE(filtersY, mem, filtersY_offset); //\n  // Now call webassembly method\n  // emsdk does method names with '_'\n\n  var fn = instance.exports.convolveHV || instance.exports._convolveHV;\n  fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH); //\n  // Copy data back to typed array\n  //\n  // 32-bit copy is much faster in chrome\n\n  var dest32 = new Uint32Array(dest.buffer);\n  dest32.set(new Uint32Array(this.__memory.buffer, 0, destH * destW)); // That's faster than doing checks in convolver.\n  // !!! Note, canvas data is not premultipled. We don't need other\n  // alpha corrections.\n\n  if (!alpha) resetAlpha(dest, destW, destH);\n  return dest;\n};\n\n},{\"./resize_filter_gen\":6}],9:[function(_dereq_,module,exports){\n\nvar GC_INTERVAL = 100;\n\nfunction Pool(create, idle) {\n  this.create = create;\n  this.available = [];\n  this.acquired = {};\n  this.lastId = 1;\n  this.timeoutId = 0;\n  this.idle = idle || 2000;\n}\n\nPool.prototype.acquire = function () {\n  var _this = this;\n\n  var resource;\n\n  if (this.available.length !== 0) {\n    resource = this.available.pop();\n  } else {\n    resource = this.create();\n    resource.id = this.lastId++;\n\n    resource.release = function () {\n      return _this.release(resource);\n    };\n  }\n\n  this.acquired[resource.id] = resource;\n  return resource;\n};\n\nPool.prototype.release = function (resource) {\n  var _this2 = this;\n\n  delete this.acquired[resource.id];\n  resource.lastUsed = Date.now();\n  this.available.push(resource);\n\n  if (this.timeoutId === 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this2.gc();\n    }, GC_INTERVAL);\n  }\n};\n\nPool.prototype.gc = function () {\n  var _this3 = this;\n\n  var now = Date.now();\n  this.available = this.available.filter(function (resource) {\n    if (now - resource.lastUsed > _this3.idle) {\n      resource.destroy();\n      return false;\n    }\n\n    return true;\n  });\n\n  if (this.available.length !== 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this3.gc();\n    }, GC_INTERVAL);\n  } else {\n    this.timeoutId = 0;\n  }\n};\n\nmodule.exports = Pool;\n\n},{}],10:[function(_dereq_,module,exports){\n// min size = 1 can consume large amount of memory\n\nvar MIN_INNER_TILE_SIZE = 2;\n\nmodule.exports = function createStages(fromWidth, fromHeight, toWidth, toHeight, srcTileSize, destTileBorder) {\n  var scaleX = toWidth / fromWidth;\n  var scaleY = toHeight / fromHeight; // derived from createRegions equation:\n  // innerTileWidth = pixelFloor(srcTileSize * scaleX) - 2 * destTileBorder;\n\n  var minScale = (2 * destTileBorder + MIN_INNER_TILE_SIZE + 1) / srcTileSize; // refuse to scale image multiple times by less than twice each time,\n  // it could only happen because of invalid options\n\n  if (minScale > 0.5) return [[toWidth, toHeight]];\n  var stageCount = Math.ceil(Math.log(Math.min(scaleX, scaleY)) / Math.log(minScale)); // no additional resizes are necessary,\n  // stageCount can be zero or be negative when enlarging the image\n\n  if (stageCount <= 1) return [[toWidth, toHeight]];\n  var result = [];\n\n  for (var i = 0; i < stageCount; i++) {\n    var width = Math.round(Math.pow(Math.pow(fromWidth, stageCount - i - 1) * Math.pow(toWidth, i + 1), 1 / stageCount));\n    var height = Math.round(Math.pow(Math.pow(fromHeight, stageCount - i - 1) * Math.pow(toHeight, i + 1), 1 / stageCount));\n    result.push([width, height]);\n  }\n\n  return result;\n};\n\n},{}],11:[function(_dereq_,module,exports){\n/*\n * pixelFloor and pixelCeil are modified versions of Math.floor and Math.ceil\n * functions which take into account floating point arithmetic errors.\n * Those errors can cause undesired increments/decrements of sizes and offsets:\n * Math.ceil(36 / (36 / 500)) = 501\n * pixelCeil(36 / (36 / 500)) = 500\n */\n\nvar PIXEL_EPSILON = 1e-5;\n\nfunction pixelFloor(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.floor(x);\n}\n\nfunction pixelCeil(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.ceil(x);\n}\n\nmodule.exports = function createRegions(options) {\n  var scaleX = options.toWidth / options.width;\n  var scaleY = options.toHeight / options.height;\n  var innerTileWidth = pixelFloor(options.srcTileSize * scaleX) - 2 * options.destTileBorder;\n  var innerTileHeight = pixelFloor(options.srcTileSize * scaleY) - 2 * options.destTileBorder; // prevent infinite loop, this should never happen\n\n  if (innerTileWidth < 1 || innerTileHeight < 1) {\n    throw new Error('Internal error in pica: target tile width/height is too small.');\n  }\n\n  var x, y;\n  var innerX, innerY, toTileWidth, toTileHeight;\n  var tiles = [];\n  var tile; // we go top-to-down instead of left-to-right to make image displayed from top to\n  // doesn in the browser\n\n  for (innerY = 0; innerY < options.toHeight; innerY += innerTileHeight) {\n    for (innerX = 0; innerX < options.toWidth; innerX += innerTileWidth) {\n      x = innerX - options.destTileBorder;\n\n      if (x < 0) {\n        x = 0;\n      }\n\n      toTileWidth = innerX + innerTileWidth + options.destTileBorder - x;\n\n      if (x + toTileWidth >= options.toWidth) {\n        toTileWidth = options.toWidth - x;\n      }\n\n      y = innerY - options.destTileBorder;\n\n      if (y < 0) {\n        y = 0;\n      }\n\n      toTileHeight = innerY + innerTileHeight + options.destTileBorder - y;\n\n      if (y + toTileHeight >= options.toHeight) {\n        toTileHeight = options.toHeight - y;\n      }\n\n      tile = {\n        toX: x,\n        toY: y,\n        toWidth: toTileWidth,\n        toHeight: toTileHeight,\n        toInnerX: innerX,\n        toInnerY: innerY,\n        toInnerWidth: innerTileWidth,\n        toInnerHeight: innerTileHeight,\n        offsetX: x / scaleX - pixelFloor(x / scaleX),\n        offsetY: y / scaleY - pixelFloor(y / scaleY),\n        scaleX: scaleX,\n        scaleY: scaleY,\n        x: pixelFloor(x / scaleX),\n        y: pixelFloor(y / scaleY),\n        width: pixelCeil(toTileWidth / scaleX),\n        height: pixelCeil(toTileHeight / scaleY)\n      };\n      tiles.push(tile);\n    }\n  }\n\n  return tiles;\n};\n\n},{}],12:[function(_dereq_,module,exports){\n\nfunction objClass(obj) {\n  return Object.prototype.toString.call(obj);\n}\n\nmodule.exports.isCanvas = function isCanvas(element) {\n  var cname = objClass(element);\n  return cname === '[object HTMLCanvasElement]'\n  /* browser */\n  || cname === '[object OffscreenCanvas]' || cname === '[object Canvas]'\n  /* node-canvas */\n  ;\n};\n\nmodule.exports.isImage = function isImage(element) {\n  return objClass(element) === '[object HTMLImageElement]';\n};\n\nmodule.exports.isImageBitmap = function isImageBitmap(element) {\n  return objClass(element) === '[object ImageBitmap]';\n};\n\nmodule.exports.limiter = function limiter(concurrency) {\n  var active = 0,\n      queue = [];\n\n  function roll() {\n    if (active < concurrency && queue.length) {\n      active++;\n      queue.shift()();\n    }\n  }\n\n  return function limit(fn) {\n    return new Promise(function (resolve, reject) {\n      queue.push(function () {\n        fn().then(function (result) {\n          resolve(result);\n          active--;\n          roll();\n        }, function (err) {\n          reject(err);\n          active--;\n          roll();\n        });\n      });\n      roll();\n    });\n  };\n};\n\nmodule.exports.cib_quality_name = function cib_quality_name(num) {\n  switch (num) {\n    case 0:\n      return 'pixelated';\n\n    case 1:\n      return 'low';\n\n    case 2:\n      return 'medium';\n  }\n\n  return 'high';\n};\n\nmodule.exports.cib_support = function cib_support(createCanvas) {\n  return Promise.resolve().then(function () {\n    if (typeof createImageBitmap === 'undefined') {\n      return false;\n    }\n\n    var c = createCanvas(100, 100);\n    return createImageBitmap(c, 0, 0, 100, 100, {\n      resizeWidth: 10,\n      resizeHeight: 10,\n      resizeQuality: 'high'\n    }).then(function (bitmap) {\n      var status = bitmap.width === 10; // Branch below is filtered on upper level. We do not call resize\n      // detection for basic ImageBitmap.\n      //\n      // https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap\n      // old Crome 51 has ImageBitmap without .close(). Then this code\n      // will throw and return 'false' as expected.\n      //\n\n      bitmap.close();\n      c = null;\n      return status;\n    });\n  })[\"catch\"](function () {\n    return false;\n  });\n};\n\n},{}],13:[function(_dereq_,module,exports){\n\nmodule.exports = function () {\n  var MathLib = _dereq_('./mathlib');\n\n  var mathLib;\n  /* eslint-disable no-undef */\n\n  onmessage = function onmessage(ev) {\n    var opts = ev.data.opts;\n    if (!mathLib) mathLib = new MathLib(ev.data.features); // Use multimath's sync auto-init. Avoid Promise use in old browsers,\n    // because polyfills are not propagated to webworker.\n\n    var result = mathLib.resizeAndUnsharp(opts);\n    postMessage({\n      result: result\n    }, [result.buffer]);\n  };\n};\n\n},{\"./mathlib\":1}],14:[function(_dereq_,module,exports){\n// Calculate Gaussian blur of an image using IIR filter\n// The method is taken from Intel's white paper and code example attached to it:\n// https://software.intel.com/en-us/articles/iir-gaussian-blur-filter\n// -implementation-using-intel-advanced-vector-extensions\n\nvar a0, a1, a2, a3, b1, b2, left_corner, right_corner;\n\nfunction gaussCoef(sigma) {\n  if (sigma < 0.5) {\n    sigma = 0.5;\n  }\n\n  var a = Math.exp(0.726 * 0.726) / sigma,\n      g1 = Math.exp(-a),\n      g2 = Math.exp(-2 * a),\n      k = (1 - g1) * (1 - g1) / (1 + 2 * a * g1 - g2);\n\n  a0 = k;\n  a1 = k * (a - 1) * g1;\n  a2 = k * (a + 1) * g1;\n  a3 = -k * g2;\n  b1 = 2 * g1;\n  b2 = -g2;\n  left_corner = (a0 + a1) / (1 - b1 - b2);\n  right_corner = (a2 + a3) / (1 - b1 - b2);\n\n  // Attempt to force type to FP32.\n  return new Float32Array([ a0, a1, a2, a3, b1, b2, left_corner, right_corner ]);\n}\n\nfunction convolveMono16(src, out, line, coeff, width, height) {\n  // takes src image and writes the blurred and transposed result into out\n\n  var prev_src, curr_src, curr_out, prev_out, prev_prev_out;\n  var src_index, out_index, line_index;\n  var i, j;\n  var coeff_a0, coeff_a1, coeff_b1, coeff_b2;\n\n  for (i = 0; i < height; i++) {\n    src_index = i * width;\n    out_index = i;\n    line_index = 0;\n\n    // left to right\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[6];\n    prev_out = prev_prev_out;\n\n    coeff_a0 = coeff[0];\n    coeff_a1 = coeff[1];\n    coeff_b1 = coeff[4];\n    coeff_b2 = coeff[5];\n\n    for (j = 0; j < width; j++) {\n      curr_src = src[src_index];\n\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n      prev_src = curr_src;\n\n      line[line_index] = prev_out;\n      line_index++;\n      src_index++;\n    }\n\n    src_index--;\n    line_index--;\n    out_index += height * (width - 1);\n\n    // right to left\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[7];\n    prev_out = prev_prev_out;\n    curr_src = prev_src;\n\n    coeff_a0 = coeff[2];\n    coeff_a1 = coeff[3];\n\n    for (j = width - 1; j >= 0; j--) {\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n\n      prev_src = curr_src;\n      curr_src = src[src_index];\n\n      out[out_index] = line[line_index] + prev_out;\n\n      src_index--;\n      line_index--;\n      out_index -= height;\n    }\n  }\n}\n\n\nfunction blurMono16(src, width, height, radius) {\n  // Quick exit on zero radius\n  if (!radius) { return; }\n\n  var out      = new Uint16Array(src.length),\n      tmp_line = new Float32Array(Math.max(width, height));\n\n  var coeff = gaussCoef(radius);\n\n  convolveMono16(src, out, tmp_line, coeff, width, height);\n  convolveMono16(out, src, tmp_line, coeff, height, width);\n}\n\nmodule.exports = blurMono16;\n\n},{}],15:[function(_dereq_,module,exports){\nif (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor;\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor;\n      var TempCtor = function () {};\n      TempCtor.prototype = superCtor.prototype;\n      ctor.prototype = new TempCtor();\n      ctor.prototype.constructor = ctor;\n    }\n  };\n}\n\n},{}],16:[function(_dereq_,module,exports){\n\n\nvar assign         = _dereq_('object-assign');\nvar base64decode   = _dereq_('./lib/base64decode');\nvar hasWebAssembly = _dereq_('./lib/wa_detect');\n\n\nvar DEFAULT_OPTIONS = {\n  js: true,\n  wasm: true\n};\n\n\nfunction MultiMath(options) {\n  if (!(this instanceof MultiMath)) return new MultiMath(options);\n\n  var opts = assign({}, DEFAULT_OPTIONS, options || {});\n\n  this.options         = opts;\n\n  this.__cache         = {};\n\n  this.__init_promise  = null;\n  this.__modules       = opts.modules || {};\n  this.__memory        = null;\n  this.__wasm          = {};\n\n  this.__isLE = ((new Uint32Array((new Uint8Array([ 1, 0, 0, 0 ])).buffer))[0] === 1);\n\n  if (!this.options.js && !this.options.wasm) {\n    throw new Error('mathlib: at least \"js\" or \"wasm\" should be enabled');\n  }\n}\n\n\nMultiMath.prototype.has_wasm = hasWebAssembly;\n\n\nMultiMath.prototype.use = function (module) {\n  this.__modules[module.name] = module;\n\n  // Pin the best possible implementation\n  if (this.options.wasm && this.has_wasm() && module.wasm_fn) {\n    this[module.name] = module.wasm_fn;\n  } else {\n    this[module.name] = module.fn;\n  }\n\n  return this;\n};\n\n\nMultiMath.prototype.init = function () {\n  if (this.__init_promise) return this.__init_promise;\n\n  if (!this.options.js && this.options.wasm && !this.has_wasm()) {\n    return Promise.reject(new Error('mathlib: only \"wasm\" was enabled, but it\\'s not supported'));\n  }\n\n  var self = this;\n\n  this.__init_promise = Promise.all(Object.keys(self.__modules).map(function (name) {\n    var module = self.__modules[name];\n\n    if (!self.options.wasm || !self.has_wasm() || !module.wasm_fn) return null;\n\n    // If already compiled - exit\n    if (self.__wasm[name]) return null;\n\n    // Compile wasm source\n    return WebAssembly.compile(self.__base64decode(module.wasm_src))\n      .then(function (m) { self.__wasm[name] = m; });\n  }))\n    .then(function () { return self; });\n\n  return this.__init_promise;\n};\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Methods below are for internal use from plugins\n\n\n// Simple decode base64 to typed array. Useful to load embedded webassembly\n// code. You probably don't need to call this method directly.\n//\nMultiMath.prototype.__base64decode = base64decode;\n\n\n// Increase current memory to include specified number of bytes. Do nothing if\n// size is already ok. You probably don't need to call this method directly,\n// because it will be invoked from `.__instance()`.\n//\nMultiMath.prototype.__reallocate = function mem_grow_to(bytes) {\n  if (!this.__memory) {\n    this.__memory = new WebAssembly.Memory({\n      initial: Math.ceil(bytes / (64 * 1024))\n    });\n    return this.__memory;\n  }\n\n  var mem_size = this.__memory.buffer.byteLength;\n\n  if (mem_size < bytes) {\n    this.__memory.grow(Math.ceil((bytes - mem_size) / (64 * 1024)));\n  }\n\n  return this.__memory;\n};\n\n\n// Returns instantinated webassembly item by name, with specified memory size\n// and environment.\n// - use cache if available\n// - do sync module init, if async init was not called earlier\n// - allocate memory if not enougth\n// - can export functions to webassembly via \"env_extra\",\n//   for example, { exp: Math.exp }\n//\nMultiMath.prototype.__instance = function instance(name, memsize, env_extra) {\n  if (memsize) this.__reallocate(memsize);\n\n  // If .init() was not called, do sync compile\n  if (!this.__wasm[name]) {\n    var module = this.__modules[name];\n    this.__wasm[name] = new WebAssembly.Module(this.__base64decode(module.wasm_src));\n  }\n\n  if (!this.__cache[name]) {\n    var env_base = {\n      memoryBase: 0,\n      memory: this.__memory,\n      tableBase: 0,\n      table: new WebAssembly.Table({ initial: 0, element: 'anyfunc' })\n    };\n\n    this.__cache[name] = new WebAssembly.Instance(this.__wasm[name], {\n      env: assign(env_base, env_extra || {})\n    });\n  }\n\n  return this.__cache[name];\n};\n\n\n// Helper to calculate memory aligh for pointers. Webassembly does not require\n// this, but you may wish to experiment. Default base = 8;\n//\nMultiMath.prototype.__align = function align(number, base) {\n  base = base || 8;\n  var reminder = number % base;\n  return number + (reminder ? base - reminder : 0);\n};\n\n\nmodule.exports = MultiMath;\n\n},{\"./lib/base64decode\":17,\"./lib/wa_detect\":23,\"object-assign\":24}],17:[function(_dereq_,module,exports){\n\n\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n\nmodule.exports = function base64decode(str) {\n  var input = str.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max   = input.length;\n\n  var out = new Uint8Array((max * 3) >> 2);\n\n  // Collect by 6*4 bits (3 bytes)\n\n  var bits = 0;\n  var ptr  = 0;\n\n  for (var idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      out[ptr++] = (bits >> 16) & 0xFF;\n      out[ptr++] = (bits >> 8) & 0xFF;\n      out[ptr++] = bits & 0xFF;\n    }\n\n    bits = (bits << 6) | BASE64_MAP.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  var tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    out[ptr++] = (bits >> 16) & 0xFF;\n    out[ptr++] = (bits >> 8) & 0xFF;\n    out[ptr++] = bits & 0xFF;\n  } else if (tailbits === 18) {\n    out[ptr++] = (bits >> 10) & 0xFF;\n    out[ptr++] = (bits >> 2) & 0xFF;\n  } else if (tailbits === 12) {\n    out[ptr++] = (bits >> 4) & 0xFF;\n  }\n\n  return out;\n};\n\n},{}],18:[function(_dereq_,module,exports){\n\n\nmodule.exports = function hsl_l16_js(img, width, height) {\n  var size = width * height;\n  var out = new Uint16Array(size);\n  var r, g, b, min, max;\n  for (var i = 0; i < size; i++) {\n    r = img[4 * i];\n    g = img[4 * i + 1];\n    b = img[4 * i + 2];\n    max = (r >= g && r >= b) ? r : (g >= b && g >= r) ? g : b;\n    min = (r <= g && r <= b) ? r : (g <= b && g <= r) ? g : b;\n    out[i] = (max + min) * 257 >> 1;\n  }\n  return out;\n};\n\n},{}],19:[function(_dereq_,module,exports){\n\nmodule.exports = {\n  name:     'unsharp_mask',\n  fn:       _dereq_('./unsharp_mask'),\n  wasm_fn:  _dereq_('./unsharp_mask_wasm'),\n  wasm_src: _dereq_('./unsharp_mask_wasm_base64')\n};\n\n},{\"./unsharp_mask\":20,\"./unsharp_mask_wasm\":21,\"./unsharp_mask_wasm_base64\":22}],20:[function(_dereq_,module,exports){\n\n\nvar glur_mono16 = _dereq_('glur/mono16');\nvar hsl_l16     = _dereq_('./hsl_l16');\n\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  var r, g, b;\n  var h, s, l;\n  var min, max;\n  var m1, m2, hShifted;\n  var diff, iTimes4;\n\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var lightness = hsl_l16(img, width, height);\n\n  var blured = new Uint16Array(lightness); // copy, because blur modify src\n\n  glur_mono16(blured, width, height, radius);\n\n  var amountFp = (amount / 100 * 0x1000 + 0.5)|0;\n  var thresholdFp = (threshold * 257)|0;\n\n  var size = width * height;\n\n  /* eslint-disable indent */\n  for (var i = 0; i < size; i++) {\n    diff = 2 * (lightness[i] - blured[i]);\n\n    if (Math.abs(diff) >= thresholdFp) {\n      iTimes4 = i * 4;\n      r = img[iTimes4];\n      g = img[iTimes4 + 1];\n      b = img[iTimes4 + 2];\n\n      // convert RGB to HSL\n      // take RGB, 8-bit unsigned integer per each channel\n      // save HSL, H and L are 16-bit unsigned integers, S is 12-bit unsigned integer\n      // math is taken from here: http://www.easyrgb.com/index.php?X=MATH&H=18\n      // and adopted to be integer (fixed point in fact) for sake of performance\n      max = (r >= g && r >= b) ? r : (g >= r && g >= b) ? g : b; // min and max are in [0..0xff]\n      min = (r <= g && r <= b) ? r : (g <= r && g <= b) ? g : b;\n      l = (max + min) * 257 >> 1; // l is in [0..0xffff] that is caused by multiplication by 257\n\n      if (min === max) {\n        h = s = 0;\n      } else {\n        s = (l <= 0x7fff) ?\n          (((max - min) * 0xfff) / (max + min))|0 :\n          (((max - min) * 0xfff) / (2 * 0xff - max - min))|0; // s is in [0..0xfff]\n        // h could be less 0, it will be fixed in backward conversion to RGB, |h| <= 0xffff / 6\n        h = (r === max) ? (((g - b) * 0xffff) / (6 * (max - min)))|0\n          : (g === max) ? 0x5555 + ((((b - r) * 0xffff) / (6 * (max - min)))|0) // 0x5555 == 0xffff / 3\n          : 0xaaaa + ((((r - g) * 0xffff) / (6 * (max - min)))|0); // 0xaaaa == 0xffff * 2 / 3\n      }\n\n      // add unsharp mask mask to the lightness channel\n      l += (amountFp * diff + 0x800) >> 12;\n      if (l > 0xffff) {\n        l = 0xffff;\n      } else if (l < 0) {\n        l = 0;\n      }\n\n      // convert HSL back to RGB\n      // for information about math look above\n      if (s === 0) {\n        r = g = b = l >> 8;\n      } else {\n        m2 = (l <= 0x7fff) ? (l * (0x1000 + s) + 0x800) >> 12 :\n          l  + (((0xffff - l) * s + 0x800) >>  12);\n        m1 = 2 * l - m2 >> 8;\n        m2 >>= 8;\n        // save result to RGB channels\n        // R channel\n        hShifted = (h + 0x5555) & 0xffff; // 0x5555 == 0xffff / 3\n        r = (hShifted >= 0xaaaa) ? m1 // 0xaaaa == 0xffff * 2 / 3\n          : (hShifted >= 0x7fff) ?  m1 + ((m2 - m1) * 6 * (0xaaaa - hShifted) + 0x8000 >> 16)\n          : (hShifted >= 0x2aaa) ? m2 // 0x2aaa == 0xffff / 6\n          : m1 + ((m2 - m1) * 6 * hShifted + 0x8000 >> 16);\n        // G channel\n        hShifted = h & 0xffff;\n        g = (hShifted >= 0xaaaa) ? m1 // 0xaaaa == 0xffff * 2 / 3\n          : (hShifted >= 0x7fff) ?  m1 + ((m2 - m1) * 6 * (0xaaaa - hShifted) + 0x8000 >> 16)\n          : (hShifted >= 0x2aaa) ? m2 // 0x2aaa == 0xffff / 6\n          : m1 + ((m2 - m1) * 6 * hShifted + 0x8000 >> 16);\n        // B channel\n        hShifted = (h - 0x5555) & 0xffff;\n        b = (hShifted >= 0xaaaa) ? m1 // 0xaaaa == 0xffff * 2 / 3\n          : (hShifted >= 0x7fff) ?  m1 + ((m2 - m1) * 6 * (0xaaaa - hShifted) + 0x8000 >> 16)\n          : (hShifted >= 0x2aaa) ? m2 // 0x2aaa == 0xffff / 6\n          : m1 + ((m2 - m1) * 6 * hShifted + 0x8000 >> 16);\n      }\n\n      img[iTimes4] = r;\n      img[iTimes4 + 1] = g;\n      img[iTimes4 + 2] = b;\n    }\n  }\n};\n\n},{\"./hsl_l16\":18,\"glur/mono16\":14}],21:[function(_dereq_,module,exports){\n\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var pixels = width * height;\n\n  var img_bytes_cnt        = pixels * 4;\n  var hsl_bytes_cnt        = pixels * 2;\n  var blur_bytes_cnt       = pixels * 2;\n  var blur_line_byte_cnt   = Math.max(width, height) * 4; // float32 array\n  var blur_coeffs_byte_cnt = 8 * 4; // float32 array\n\n  var img_offset         = 0;\n  var hsl_offset         = img_bytes_cnt;\n  var blur_offset        = hsl_offset + hsl_bytes_cnt;\n  var blur_tmp_offset    = blur_offset + blur_bytes_cnt;\n  var blur_line_offset   = blur_tmp_offset + blur_bytes_cnt;\n  var blur_coeffs_offset = blur_line_offset + blur_line_byte_cnt;\n\n  var instance = this.__instance(\n    'unsharp_mask',\n    img_bytes_cnt + hsl_bytes_cnt + blur_bytes_cnt * 2 + blur_line_byte_cnt + blur_coeffs_byte_cnt,\n    { exp: Math.exp }\n  );\n\n  // 32-bit copy is much faster in chrome\n  var img32 = new Uint32Array(img.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer);\n  mem32.set(img32);\n\n  // HSL\n  var fn = instance.exports.hsl_l16 || instance.exports._hsl_l16;\n  fn(img_offset, hsl_offset, width, height);\n\n  // BLUR\n  fn = instance.exports.blurMono16 || instance.exports._blurMono16;\n  fn(hsl_offset, blur_offset, blur_tmp_offset,\n    blur_line_offset, blur_coeffs_offset, width, height, radius);\n\n  // UNSHARP\n  fn = instance.exports.unsharp || instance.exports._unsharp;\n  fn(img_offset, img_offset, hsl_offset,\n    blur_offset, width, height, amount, threshold);\n\n  // 32-bit copy is much faster in chrome\n  img32.set(new Uint32Array(this.__memory.buffer, 0, pixels));\n};\n\n},{}],22:[function(_dereq_,module,exports){\n\n/* eslint-disable max-len */\nmodule.exports = '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';\n\n},{}],23:[function(_dereq_,module,exports){\n\n\nvar wa;\n\n\nmodule.exports = function hasWebAssembly() {\n  // use cache if called before;\n  if (typeof wa !== 'undefined') return wa;\n\n  wa = false;\n\n  if (typeof WebAssembly === 'undefined') return wa;\n\n  // If WebAssenbly is disabled, code can throw on compile\n  try {\n    // https://github.com/brion/min-wasm-fail/blob/master/min-wasm-fail.in.js\n    // Additional check that WA internals are correct\n\n    /* eslint-disable comma-spacing, max-len */\n    var bin      = new Uint8Array([ 0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11 ]);\n    var module   = new WebAssembly.Module(bin);\n    var instance = new WebAssembly.Instance(module, {});\n\n    // test storing to and loading from a non-zero location via a parameter.\n    // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n    if (instance.exports.test(4) !== 0) wa = true;\n\n    return wa;\n  } catch (__) {}\n\n  return wa;\n};\n\n},{}],24:[function(_dereq_,module,exports){\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n},{}],25:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],\"/index.js\":[function(_dereq_,module,exports){\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar assign = _dereq_('object-assign');\n\nvar webworkify = _dereq_('webworkify');\n\nvar MathLib = _dereq_('./lib/mathlib');\n\nvar Pool = _dereq_('./lib/pool');\n\nvar utils = _dereq_('./lib/utils');\n\nvar worker = _dereq_('./lib/worker');\n\nvar createStages = _dereq_('./lib/stepper');\n\nvar createRegions = _dereq_('./lib/tiler'); // Deduplicate pools & limiters with the same configs\n// when user creates multiple pica instances.\n\n\nvar singletones = {};\nvar NEED_SAFARI_FIX = false;\n\ntry {\n  if (typeof navigator !== 'undefined' && navigator.userAgent) {\n    NEED_SAFARI_FIX = navigator.userAgent.indexOf('Safari') >= 0;\n  }\n} catch (e) {}\n\nvar concurrency = 1;\n\nif (typeof navigator !== 'undefined') {\n  concurrency = Math.min(navigator.hardwareConcurrency || 1, 4);\n}\n\nvar DEFAULT_PICA_OPTS = {\n  tile: 1024,\n  concurrency: concurrency,\n  features: ['js', 'wasm', 'ww'],\n  idle: 2000,\n  createCanvas: function createCanvas(width, height) {\n    var tmpCanvas = document.createElement('canvas');\n    tmpCanvas.width = width;\n    tmpCanvas.height = height;\n    return tmpCanvas;\n  }\n};\nvar DEFAULT_RESIZE_OPTS = {\n  quality: 3,\n  alpha: false,\n  unsharpAmount: 0,\n  unsharpRadius: 0.0,\n  unsharpThreshold: 0\n};\nvar CAN_NEW_IMAGE_DATA;\nvar CAN_CREATE_IMAGE_BITMAP;\n\nfunction workerFabric() {\n  return {\n    value: webworkify(worker),\n    destroy: function destroy() {\n      this.value.terminate();\n\n      if (typeof window !== 'undefined') {\n        var url = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n        if (url && url.revokeObjectURL && this.value.objectURL) {\n          url.revokeObjectURL(this.value.objectURL);\n        }\n      }\n    }\n  };\n} ////////////////////////////////////////////////////////////////////////////////\n// API methods\n\n\nfunction Pica(options) {\n  if (!(this instanceof Pica)) return new Pica(options);\n  this.options = assign({}, DEFAULT_PICA_OPTS, options || {});\n  var limiter_key = \"lk_\".concat(this.options.concurrency); // Share limiters to avoid multiple parallel workers when user creates\n  // multiple pica instances.\n\n  this.__limit = singletones[limiter_key] || utils.limiter(this.options.concurrency);\n  if (!singletones[limiter_key]) singletones[limiter_key] = this.__limit; // List of supported features, according to options & browser/node.js\n\n  this.features = {\n    js: false,\n    // pure JS implementation, can be disabled for testing\n    wasm: false,\n    // webassembly implementation for heavy functions\n    cib: false,\n    // resize via createImageBitmap (only FF at this moment)\n    ww: false // webworkers\n\n  };\n  this.__workersPool = null; // Store requested features for webworkers\n\n  this.__requested_features = [];\n  this.__mathlib = null;\n}\n\nPica.prototype.init = function () {\n  var _this = this;\n\n  if (this.__initPromise) return this.__initPromise; // Test if we can create ImageData without canvas and memory copy\n\n  if (CAN_NEW_IMAGE_DATA !== false && CAN_NEW_IMAGE_DATA !== true) {\n    CAN_NEW_IMAGE_DATA = false;\n\n    if (typeof ImageData !== 'undefined' && typeof Uint8ClampedArray !== 'undefined') {\n      try {\n        /* eslint-disable no-new */\n        new ImageData(new Uint8ClampedArray(400), 10, 10);\n        CAN_NEW_IMAGE_DATA = true;\n      } catch (__) {}\n    }\n  } // ImageBitmap can be effective in 2 places:\n  //\n  // 1. Threaded jpeg unpack (basic)\n  // 2. Built-in resize (blocked due problem in chrome, see issue #89)\n  //\n  // For basic use we also need ImageBitmap wo support .close() method,\n  // see https://developer.mozilla.org/ru/docs/Web/API/ImageBitmap\n\n\n  if (CAN_CREATE_IMAGE_BITMAP !== false && CAN_CREATE_IMAGE_BITMAP !== true) {\n    CAN_CREATE_IMAGE_BITMAP = false;\n\n    if (typeof ImageBitmap !== 'undefined') {\n      if (ImageBitmap.prototype && ImageBitmap.prototype.close) {\n        CAN_CREATE_IMAGE_BITMAP = true;\n      } else {\n        this.debug('ImageBitmap does not support .close(), disabled');\n      }\n    }\n  }\n\n  var features = this.options.features.slice();\n\n  if (features.indexOf('all') >= 0) {\n    features = ['cib', 'wasm', 'js', 'ww'];\n  }\n\n  this.__requested_features = features;\n  this.__mathlib = new MathLib(features); // Check WebWorker support if requested\n\n  if (features.indexOf('ww') >= 0) {\n    if (typeof window !== 'undefined' && 'Worker' in window) {\n      // IE <= 11 don't allow to create webworkers from string. We should check it.\n      // https://connect.microsoft.com/IE/feedback/details/801810/web-workers-from-blob-urls-in-ie-10-and-11\n      try {\n        var wkr = _dereq_('webworkify')(function () {});\n\n        wkr.terminate();\n        this.features.ww = true; // pool uniqueness depends on pool config + webworker config\n\n        var wpool_key = \"wp_\".concat(JSON.stringify(this.options));\n\n        if (singletones[wpool_key]) {\n          this.__workersPool = singletones[wpool_key];\n        } else {\n          this.__workersPool = new Pool(workerFabric, this.options.idle);\n          singletones[wpool_key] = this.__workersPool;\n        }\n      } catch (__) {}\n    }\n  }\n\n  var initMath = this.__mathlib.init().then(function (mathlib) {\n    // Copy detected features\n    assign(_this.features, mathlib.features);\n  });\n\n  var checkCibResize;\n\n  if (!CAN_CREATE_IMAGE_BITMAP) {\n    checkCibResize = Promise.resolve(false);\n  } else {\n    checkCibResize = utils.cib_support(this.options.createCanvas).then(function (status) {\n      if (_this.features.cib && features.indexOf('cib') < 0) {\n        _this.debug('createImageBitmap() resize supported, but disabled by config');\n\n        return;\n      }\n\n      if (features.indexOf('cib') >= 0) _this.features.cib = status;\n    });\n  } // Init math lib. That's async because can load some\n\n\n  this.__initPromise = Promise.all([initMath, checkCibResize]).then(function () {\n    return _this;\n  });\n  return this.__initPromise;\n};\n\nPica.prototype.resize = function (from, to, options) {\n  var _this2 = this;\n\n  this.debug('Start resize...');\n  var opts = assign({}, DEFAULT_RESIZE_OPTS);\n\n  if (!isNaN(options)) {\n    opts = assign(opts, {\n      quality: options\n    });\n  } else if (options) {\n    opts = assign(opts, options);\n  }\n\n  opts.toWidth = to.width;\n  opts.toHeight = to.height;\n  opts.width = from.naturalWidth || from.width;\n  opts.height = from.naturalHeight || from.height; // Prevent stepper from infinite loop\n\n  if (to.width === 0 || to.height === 0) {\n    return Promise.reject(new Error(\"Invalid output size: \".concat(to.width, \"x\").concat(to.height)));\n  }\n\n  if (opts.unsharpRadius > 2) opts.unsharpRadius = 2;\n  var canceled = false;\n  var cancelToken = null;\n\n  if (opts.cancelToken) {\n    // Wrap cancelToken to avoid successive resolve & set flag\n    cancelToken = opts.cancelToken.then(function (data) {\n      canceled = true;\n      throw data;\n    }, function (err) {\n      canceled = true;\n      throw err;\n    });\n  }\n\n  var DEST_TILE_BORDER = 3; // Max possible filter window size\n\n  var destTileBorder = Math.ceil(Math.max(DEST_TILE_BORDER, 2.5 * opts.unsharpRadius | 0));\n  return this.init().then(function () {\n    if (canceled) return cancelToken; // if createImageBitmap supports resize, just do it and return\n\n    if (_this2.features.cib) {\n      var toCtx = to.getContext('2d', {\n        alpha: Boolean(opts.alpha)\n      });\n\n      _this2.debug('Resize via createImageBitmap()');\n\n      return createImageBitmap(from, {\n        resizeWidth: opts.toWidth,\n        resizeHeight: opts.toHeight,\n        resizeQuality: utils.cib_quality_name(opts.quality)\n      }).then(function (imageBitmap) {\n        if (canceled) return cancelToken; // if no unsharp - draw directly to output canvas\n\n        if (!opts.unsharpAmount) {\n          toCtx.drawImage(imageBitmap, 0, 0);\n          imageBitmap.close();\n          toCtx = null;\n\n          _this2.debug('Finished!');\n\n          return to;\n        }\n\n        _this2.debug('Unsharp result');\n\n        var tmpCanvas = _this2.options.createCanvas(opts.toWidth, opts.toHeight);\n\n        var tmpCtx = tmpCanvas.getContext('2d', {\n          alpha: Boolean(opts.alpha)\n        });\n        tmpCtx.drawImage(imageBitmap, 0, 0);\n        imageBitmap.close();\n        var iData = tmpCtx.getImageData(0, 0, opts.toWidth, opts.toHeight);\n\n        _this2.__mathlib.unsharp_mask(iData.data, opts.toWidth, opts.toHeight, opts.unsharpAmount, opts.unsharpRadius, opts.unsharpThreshold);\n\n        toCtx.putImageData(iData, 0, 0); // Safari 12 workaround\n        // https://github.com/nodeca/pica/issues/199\n\n        tmpCanvas.width = tmpCanvas.height = 0;\n        iData = tmpCtx = tmpCanvas = toCtx = null;\n\n        _this2.debug('Finished!');\n\n        return to;\n      });\n    } //\n    // No easy way, let's resize manually via arrays\n    //\n    // Share cache between calls:\n    //\n    // - wasm instance\n    // - wasm memory object\n    //\n\n\n    var cache = {}; // Call resizer in webworker or locally, depending on config\n\n    var invokeResize = function invokeResize(opts) {\n      return Promise.resolve().then(function () {\n        if (!_this2.features.ww) return _this2.__mathlib.resizeAndUnsharp(opts, cache);\n        return new Promise(function (resolve, reject) {\n          var w = _this2.__workersPool.acquire();\n\n          if (cancelToken) cancelToken[\"catch\"](function (err) {\n            return reject(err);\n          });\n\n          w.value.onmessage = function (ev) {\n            w.release();\n            if (ev.data.err) reject(ev.data.err);else resolve(ev.data.result);\n          };\n\n          w.value.postMessage({\n            opts: opts,\n            features: _this2.__requested_features,\n            preload: {\n              wasm_nodule: _this2.__mathlib.__\n            }\n          }, [opts.src.buffer]);\n        });\n      });\n    };\n\n    var tileAndResize = function tileAndResize(from, to, opts) {\n      var srcCtx;\n      var srcImageBitmap;\n      var isImageBitmapReused = false;\n      var toCtx;\n\n      var processTile = function processTile(tile) {\n        return _this2.__limit(function () {\n          if (canceled) return cancelToken;\n          var srcImageData; // Extract tile RGBA buffer, depending on input type\n\n          if (utils.isCanvas(from)) {\n            _this2.debug('Get tile pixel data'); // If input is Canvas - extract region data directly\n\n\n            srcImageData = srcCtx.getImageData(tile.x, tile.y, tile.width, tile.height);\n          } else {\n            // If input is Image or decoded to ImageBitmap,\n            // draw region to temporary canvas and extract data from it\n            //\n            // Note! Attempt to reuse this canvas causes significant slowdown in chrome\n            //\n            _this2.debug('Draw tile imageBitmap/image to temporary canvas');\n\n            var tmpCanvas = _this2.options.createCanvas(tile.width, tile.height);\n\n            var tmpCtx = tmpCanvas.getContext('2d', {\n              alpha: Boolean(opts.alpha)\n            });\n            tmpCtx.globalCompositeOperation = 'copy';\n            tmpCtx.drawImage(srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height, 0, 0, tile.width, tile.height);\n\n            _this2.debug('Get tile pixel data');\n\n            srcImageData = tmpCtx.getImageData(0, 0, tile.width, tile.height); // Safari 12 workaround\n            // https://github.com/nodeca/pica/issues/199\n\n            tmpCanvas.width = tmpCanvas.height = 0;\n            tmpCtx = tmpCanvas = null;\n          }\n\n          var o = {\n            src: srcImageData.data,\n            width: tile.width,\n            height: tile.height,\n            toWidth: tile.toWidth,\n            toHeight: tile.toHeight,\n            scaleX: tile.scaleX,\n            scaleY: tile.scaleY,\n            offsetX: tile.offsetX,\n            offsetY: tile.offsetY,\n            quality: opts.quality,\n            alpha: opts.alpha,\n            unsharpAmount: opts.unsharpAmount,\n            unsharpRadius: opts.unsharpRadius,\n            unsharpThreshold: opts.unsharpThreshold\n          };\n\n          _this2.debug('Invoke resize math');\n\n          return Promise.resolve().then(function () {\n            return invokeResize(o);\n          }).then(function (result) {\n            if (canceled) return cancelToken;\n            srcImageData = null;\n            var toImageData;\n\n            _this2.debug('Convert raw rgba tile result to ImageData');\n\n            if (CAN_NEW_IMAGE_DATA) {\n              // this branch is for modern browsers\n              // If `new ImageData()` & Uint8ClampedArray suported\n              toImageData = new ImageData(new Uint8ClampedArray(result), tile.toWidth, tile.toHeight);\n            } else {\n              // fallback for `node-canvas` and old browsers\n              // (IE11 has ImageData but does not support `new ImageData()`)\n              toImageData = toCtx.createImageData(tile.toWidth, tile.toHeight);\n\n              if (toImageData.data.set) {\n                toImageData.data.set(result);\n              } else {\n                // IE9 don't have `.set()`\n                for (var i = toImageData.data.length - 1; i >= 0; i--) {\n                  toImageData.data[i] = result[i];\n                }\n              }\n            }\n\n            _this2.debug('Draw tile');\n\n            if (NEED_SAFARI_FIX) {\n              // Safari draws thin white stripes between tiles without this fix\n              toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth + 1e-5, tile.toInnerHeight + 1e-5);\n            } else {\n              toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth, tile.toInnerHeight);\n            }\n\n            return null;\n          });\n        });\n      }; // Need to normalize data source first. It can be canvas or image.\n      // If image - try to decode in background if possible\n\n\n      return Promise.resolve().then(function () {\n        toCtx = to.getContext('2d', {\n          alpha: Boolean(opts.alpha)\n        });\n\n        if (utils.isCanvas(from)) {\n          srcCtx = from.getContext('2d', {\n            alpha: Boolean(opts.alpha)\n          });\n          return null;\n        }\n\n        if (utils.isImageBitmap(from)) {\n          srcImageBitmap = from;\n          isImageBitmapReused = true;\n          return null;\n        }\n\n        if (utils.isImage(from)) {\n          // try do decode image in background for faster next operations\n          if (!CAN_CREATE_IMAGE_BITMAP) return null;\n\n          _this2.debug('Decode image via createImageBitmap');\n\n          return createImageBitmap(from).then(function (imageBitmap) {\n            srcImageBitmap = imageBitmap;\n          }) // Suppress error to use fallback, if method fails\n          // https://github.com/nodeca/pica/issues/190\n\n          /* eslint-disable no-unused-vars */\n          [\"catch\"](function (e) {\n            return null;\n          });\n        }\n\n        throw new Error('Pica: \".from\" should be Image, Canvas or ImageBitmap');\n      }).then(function () {\n        if (canceled) return cancelToken;\n\n        _this2.debug('Calculate tiles'); //\n        // Here we are with \"normalized\" source,\n        // follow to tiling\n        //\n\n\n        var regions = createRegions({\n          width: opts.width,\n          height: opts.height,\n          srcTileSize: _this2.options.tile,\n          toWidth: opts.toWidth,\n          toHeight: opts.toHeight,\n          destTileBorder: destTileBorder\n        });\n        var jobs = regions.map(function (tile) {\n          return processTile(tile);\n        });\n\n        function cleanup() {\n          if (srcImageBitmap) {\n            if (!isImageBitmapReused) srcImageBitmap.close();\n            srcImageBitmap = null;\n          }\n        }\n\n        _this2.debug('Process tiles');\n\n        return Promise.all(jobs).then(function () {\n          _this2.debug('Finished!');\n\n          cleanup();\n          return to;\n        }, function (err) {\n          cleanup();\n          throw err;\n        });\n      });\n    };\n\n    var processStages = function processStages(stages, from, to, opts) {\n      if (canceled) return cancelToken;\n\n      var _stages$shift = stages.shift(),\n          _stages$shift2 = _slicedToArray(_stages$shift, 2),\n          toWidth = _stages$shift2[0],\n          toHeight = _stages$shift2[1];\n\n      var isLastStage = stages.length === 0;\n      opts = assign({}, opts, {\n        toWidth: toWidth,\n        toHeight: toHeight,\n        // only use user-defined quality for the last stage,\n        // use simpler (Hamming) filter for the first stages where\n        // scale factor is large enough (more than 2-3)\n        quality: isLastStage ? opts.quality : Math.min(1, opts.quality)\n      });\n      var tmpCanvas;\n\n      if (!isLastStage) {\n        // create temporary canvas\n        tmpCanvas = _this2.options.createCanvas(toWidth, toHeight);\n      }\n\n      return tileAndResize(from, isLastStage ? to : tmpCanvas, opts).then(function () {\n        if (isLastStage) return to;\n        opts.width = toWidth;\n        opts.height = toHeight;\n        return processStages(stages, tmpCanvas, to, opts);\n      }).then(function (res) {\n        if (tmpCanvas) {\n          // Safari 12 workaround\n          // https://github.com/nodeca/pica/issues/199\n          tmpCanvas.width = tmpCanvas.height = 0;\n        }\n\n        return res;\n      });\n    };\n\n    var stages = createStages(opts.width, opts.height, opts.toWidth, opts.toHeight, _this2.options.tile, destTileBorder);\n    return processStages(stages, from, to, opts);\n  });\n}; // RGBA buffer resize\n//\n\n\nPica.prototype.resizeBuffer = function (options) {\n  var _this3 = this;\n\n  var opts = assign({}, DEFAULT_RESIZE_OPTS, options);\n  return this.init().then(function () {\n    return _this3.__mathlib.resizeAndUnsharp(opts);\n  });\n};\n\nPica.prototype.toBlob = function (canvas, mimeType, quality) {\n  mimeType = mimeType || 'image/png';\n  return new Promise(function (resolve) {\n    if (canvas.toBlob) {\n      canvas.toBlob(function (blob) {\n        return resolve(blob);\n      }, mimeType, quality);\n      return;\n    }\n\n    if (canvas.convertToBlob) {\n      resolve(canvas.convertToBlob({\n        type: mimeType,\n        quality: quality\n      }));\n      return;\n    } // Fallback for old browsers\n\n\n    var asString = atob(canvas.toDataURL(mimeType, quality).split(',')[1]);\n    var len = asString.length;\n    var asBuffer = new Uint8Array(len);\n\n    for (var i = 0; i < len; i++) {\n      asBuffer[i] = asString.charCodeAt(i);\n    }\n\n    resolve(new Blob([asBuffer], {\n      type: mimeType\n    }));\n  });\n};\n\nPica.prototype.debug = function () {};\n\nmodule.exports = Pica;\n\n},{\"./lib/mathlib\":1,\"./lib/pool\":9,\"./lib/stepper\":10,\"./lib/tiler\":11,\"./lib/utils\":12,\"./lib/worker\":13,\"object-assign\":24,\"webworkify\":25}]},{},[])(\"/index.js\")\n});\n});\n\nvar image_traverse = createCommonjsModule(function (module) {\n\n//////////////////////////////////////////////////////////////////////////\n// Helpers\n//\nfunction error(message, code) {\n  var err = new Error(message);\n  err.code = code;\n  return err;\n}\n\n\n// Convert number to 0xHH string\n//\nfunction to_hex(number) {\n  var n = number.toString(16).toUpperCase();\n  for (var i = 2 - n.length; i > 0; i--) n = '0' + n;\n  return '0x' + n;\n}\n\n\nfunction utf8_encode(str) {\n  try {\n    return unescape(encodeURIComponent(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\nfunction utf8_decode(str) {\n  try {\n    return decodeURIComponent(escape(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\n// Check if input is a Uint8Array\n//\nfunction is_uint8array(bin) {\n  return Object.prototype.toString.call(bin) === '[object Uint8Array]';\n}\n\n\n//////////////////////////////////////////////////////////////////////////\n// Exif parser\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - exif_start: Number     - start of TIFF header (after Exif\\0\\0)\n//  - exif_end:   Number     - end of Exif segment\n//  - on_entry:   Number     - callback\n//\nfunction ExifParser(jpeg_bin, exif_start, exif_end) {\n  // Uint8Array, exif without signature (which isn't included in offsets)\n  this.input      = jpeg_bin.subarray(exif_start, exif_end);\n\n  // offset correction for `on_entry` callback\n  this.start      = exif_start;\n\n  // Check TIFF header (includes byte alignment and first IFD offset)\n  var sig = String.fromCharCode.apply(null, this.input.subarray(0, 4));\n\n  if (sig !== 'II\\x2A\\0' && sig !== 'MM\\0\\x2A') {\n    throw error('invalid TIFF signature', 'EBADDATA');\n  }\n\n  // true if motorola (big endian) byte alignment, false if intel\n  this.big_endian = sig[0] === 'M';\n}\n\n\nExifParser.prototype.each = function (on_entry) {\n  // allow premature exit\n  this.aborted = false;\n\n  var offset = this.read_uint32(4);\n\n  this.ifds_to_read = [ {\n    id:     0,\n    offset: offset\n  } ];\n\n  while (this.ifds_to_read.length > 0 && !this.aborted) {\n    var i = this.ifds_to_read.shift();\n    if (!i.offset) continue;\n    this.scan_ifd(i.id, i.offset, on_entry);\n  }\n};\n\n\nExifParser.prototype.filter = function (on_entry) {\n  var ifds = {};\n\n  // make sure IFD0 always exists\n  ifds.ifd0 = { id: 0, entries: [] };\n\n  this.each(function (entry) {\n    if (on_entry(entry) === false && !entry.is_subifd_link) return;\n    if (entry.is_subifd_link && entry.count !== 1 && entry.format !== 4) return; // filter out bogus links\n\n    if (!ifds['ifd' + entry.ifd]) {\n      ifds['ifd' + entry.ifd] = { id: entry.ifd, entries: [] };\n    }\n\n    ifds['ifd' + entry.ifd].entries.push(entry);\n  });\n\n  // thumbnails are not supported just yet, so delete all information related to it\n  delete ifds.ifd1;\n\n  // Calculate output size\n  var length = 8;\n  Object.keys(ifds).forEach(function (ifd_no) {\n    length += 2;\n\n    ifds[ifd_no].entries.forEach(function (entry) {\n      length += 12 + (entry.data_length > 4 ? Math.ceil(entry.data_length / 2) * 2 : 0);\n    });\n\n    length += 4;\n  });\n\n  this.output = new Uint8Array(length);\n  this.output[0] = this.output[1] = (this.big_endian ? 'M' : 'I').charCodeAt(0);\n  this.write_uint16(2, 0x2A);\n\n  var offset = 8;\n  var self = this;\n  this.write_uint32(4, offset);\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    ifds[ifd_no].written_offset = offset;\n\n    var ifd_start = offset;\n    var ifd_end   = ifd_start + 2 + ifds[ifd_no].entries.length * 12 + 4;\n    offset = ifd_end;\n\n    self.write_uint16(ifd_start, ifds[ifd_no].entries.length);\n\n    ifds[ifd_no].entries.sort(function (a, b) {\n      // IFD entries must be in order of increasing tag IDs\n      return a.tag - b.tag;\n    }).forEach(function (entry, idx) {\n      var entry_offset = ifd_start + 2 + idx * 12;\n\n      self.write_uint16(entry_offset, entry.tag);\n      self.write_uint16(entry_offset + 2, entry.format);\n      self.write_uint32(entry_offset + 4, entry.count);\n\n      if (entry.is_subifd_link) {\n        // filled in later\n        if (ifds['ifd' + entry.tag]) ifds['ifd' + entry.tag].link_offset = entry_offset + 8;\n      } else if (entry.data_length <= 4) {\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + 4),\n          entry_offset + 8\n        );\n      } else {\n        self.write_uint32(entry_offset + 8, offset);\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + entry.data_length),\n          offset\n        );\n        offset += Math.ceil(entry.data_length / 2) * 2;\n      }\n    });\n\n    var next_ifd = ifds['ifd' + (ifds[ifd_no].id + 1)];\n    if (next_ifd) next_ifd.link_offset = ifd_end - 4;\n  });\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    if (ifds[ifd_no].written_offset && ifds[ifd_no].link_offset) {\n      self.write_uint32(ifds[ifd_no].link_offset, ifds[ifd_no].written_offset);\n    }\n  });\n\n  if (this.output.length !== offset) throw error('internal error: incorrect buffer size allocated');\n\n  return this.output;\n};\n\n\nExifParser.prototype.read_uint16 = function (offset) {\n  var d = this.input;\n  if (offset + 2 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x100 + d[offset + 1] :\n    d[offset] + d[offset + 1] * 0x100;\n};\n\n\nExifParser.prototype.read_uint32 = function (offset) {\n  var d = this.input;\n  if (offset + 4 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x1000000 + d[offset + 1] * 0x10000 + d[offset + 2] * 0x100 + d[offset + 3] :\n    d[offset] + d[offset + 1] * 0x100 + d[offset + 2] * 0x10000 + d[offset + 3] * 0x1000000;\n};\n\n\nExifParser.prototype.write_uint16 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 8) & 0xFF;\n    d[offset + 1] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.write_uint32 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 24) & 0xFF;\n    d[offset + 1] = (value >>> 16) & 0xFF;\n    d[offset + 2] = (value >>> 8) & 0xFF;\n    d[offset + 3] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n    d[offset + 2] = (value >>> 16) & 0xFF;\n    d[offset + 3] = (value >>> 24) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.is_subifd_link = function (ifd, tag) {\n  return (ifd === 0 && tag === 0x8769) || // SubIFD\n         (ifd === 0 && tag === 0x8825) || // GPS Info\n         (ifd === 0x8769 && tag === 0xA005); // Interop IFD\n};\n\n\n// Returns byte length of a single component of a given format\n//\nExifParser.prototype.exif_format_length = function (format) {\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n    case 6: // sbyte\n    case 7: // undefined\n      return 1;\n\n    case 3: // short\n    case 8: // sshort\n      return 2;\n\n    case 4:  // long\n    case 9:  // slong\n    case 11: // float\n      return 4;\n\n    case 5:  // rational\n    case 10: // srational\n    case 12: // double\n      return 8;\n\n    default:\n      // unknown type\n      return 0;\n  }\n};\n\n\n// Reads Exif data\n//\nExifParser.prototype.exif_format_read = function (format, offset) {\n  var v;\n\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n      v = this.input[offset];\n      return v;\n\n    case 6: // sbyte\n      v = this.input[offset];\n      return v | (v & 0x80) * 0x1fffffe;\n\n    case 3: // short\n      v = this.read_uint16(offset);\n      return v;\n\n    case 8: // sshort\n      v = this.read_uint16(offset);\n      return v | (v & 0x8000) * 0x1fffe;\n\n    case 4: // long\n      v = this.read_uint32(offset);\n      return v;\n\n    case 9: // slong\n      v = this.read_uint32(offset);\n      return v | 0;\n\n    case 5:  // rational\n    case 10: // srational\n    case 11: // float\n    case 12: // double\n      return null; // not implemented\n\n    case 7: // undefined\n      return null; // blob\n\n    default:\n      // unknown type\n      return null;\n  }\n};\n\n\nExifParser.prototype.scan_ifd = function (ifd_no, offset, on_entry) {\n  var entry_count = this.read_uint16(offset);\n\n  offset += 2;\n\n  for (var i = 0; i < entry_count; i++) {\n    var tag    = this.read_uint16(offset);\n    var format = this.read_uint16(offset + 2);\n    var count  = this.read_uint32(offset + 4);\n\n    var comp_length    = this.exif_format_length(format);\n    var data_length    = count * comp_length;\n    var data_offset    = data_length <= 4 ? offset + 8 : this.read_uint32(offset + 8);\n    var is_subifd_link = false;\n\n    if (data_offset + data_length > this.input.length) {\n      throw error('unexpected EOF', 'EBADDATA');\n    }\n\n    var value = [];\n    var comp_offset = data_offset;\n\n    for (var j = 0; j < count; j++, comp_offset += comp_length) {\n      var item = this.exif_format_read(format, comp_offset);\n      if (item === null) {\n        value = null;\n        break;\n      }\n      value.push(item);\n    }\n\n    if (Array.isArray(value) && format === 2) {\n      try {\n        value = utf8_decode(String.fromCharCode.apply(null, value));\n      } catch (_) {\n        value = null;\n      }\n\n      if (value && value[value.length - 1] === '\\0') value = value.slice(0, -1);\n    }\n\n    if (this.is_subifd_link(ifd_no, tag)) {\n      if (Array.isArray(value) && Number.isInteger(value[0]) && value[0] > 0) {\n        this.ifds_to_read.push({\n          id:     tag,\n          offset: value[0]\n        });\n        is_subifd_link = true;\n      }\n    }\n\n    var entry = {\n      is_big_endian:  this.big_endian,\n      ifd:            ifd_no,\n      tag:            tag,\n      format:         format,\n      count:          count,\n      entry_offset:   offset + this.start,\n      data_length:    data_length,\n      data_offset:    data_offset + this.start,\n      value:          value,\n      is_subifd_link: is_subifd_link\n    };\n\n    if (on_entry(entry) === false) {\n      this.aborted = true;\n      return;\n    }\n\n    offset += 12;\n  }\n\n  if (ifd_no === 0) {\n    this.ifds_to_read.push({\n      id:     1,\n      offset: this.read_uint32(offset)\n    });\n  }\n};\n\n\n// Check whether input is a JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//\n// Returns true if it is and false otherwise\n//\nmodule.exports.is_jpeg = function (jpeg_bin) {\n  return jpeg_bin.length >= 4 && jpeg_bin[0] === 0xFF && jpeg_bin[1] === 0xD8 && jpeg_bin[2] === 0xFF;\n};\n\n\n// Call an iterator on each segment in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// Iteration stops when `EOI` (0xFFD9) marker is reached or if `on_segment`\n// function returns `false`.\n//\nmodule.exports.jpeg_segments_each = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  if (!module.exports.is_jpeg(jpeg_bin)) {\n    throw error('Unknown file format', 'ENOTJPEG');\n  }\n\n  var offset = 0, length = jpeg_bin.length, inside_scan = false;\n\n  for (;;) {\n    var segment_code, segment_length;\n\n    if (offset + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n    var byte1 = jpeg_bin[offset];\n    var byte2 = jpeg_bin[offset + 1];\n\n    if (byte1 === 0xFF && byte2 === 0xFF) {\n      // padding\n      segment_code = 0xFF;\n      segment_length = 1;\n\n    } else if (byte1 === 0xFF && byte2 !== 0) {\n      // marker\n      segment_code = byte2;\n      segment_length = 2;\n\n      if ((0xD0 <= segment_code && segment_code <= 0xD9) || segment_code === 0x01) ; else {\n        if (offset + 3 >= length) throw error('Unexpected EOF', 'EBADDATA');\n        segment_length += jpeg_bin[offset + 2] * 0x100 + jpeg_bin[offset + 3];\n        if (segment_length < 2) throw error('Invalid segment length', 'EBADDATA');\n        if (offset + segment_length - 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n      }\n\n      if (inside_scan) {\n        if (segment_code >= 0xD0 && segment_code <= 0xD7) ; else {\n          inside_scan = false;\n        }\n      }\n\n      if (segment_code === 0xDA /* SOS */) inside_scan = true;\n    } else if (inside_scan) {\n      // entropy-encoded segment\n      for (var pos = offset + 1; ; pos++) {\n        // scan until we find FF\n        if (pos >= length) throw error('Unexpected EOF', 'EBADDATA');\n        if (jpeg_bin[pos] === 0xFF) {\n          if (pos + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n          if (jpeg_bin[pos + 1] !== 0) {\n            segment_code = 0;\n            segment_length = pos - offset;\n            break;\n          }\n        }\n      }\n    } else {\n      throw error('Unexpected byte at segment start: ' + to_hex(byte1) +\n        ' (offset ' + to_hex(offset) + ')', 'EBADDATA');\n    }\n\n    if (on_segment({ code: segment_code, offset: offset, length: segment_length }) === false) break;\n    if (segment_code === 0xD9 /* EOI */) break;\n    offset += segment_length;\n  }\n};\n\n\n// Replace or remove segments in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// `on_segment` function should return one of the following:\n//  - `false`        - segment is removed from the output\n//  - Uint8Array     - segment is replaced with the new data\n//  - [ Uint8Array ] - segment is replaced with the new data\n//  - anything else  - segment is copied to the output as is\n//\n// Any data after `EOI` (0xFFD9) marker is removed.\n//\nmodule.exports.jpeg_segments_filter = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  var ranges = [];\n  var out_length = 0;\n\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    var new_segment = on_segment(segment);\n\n    if (is_uint8array(new_segment)) {\n      ranges.push({ data: new_segment });\n      out_length += new_segment.length;\n    } else if (Array.isArray(new_segment)) {\n      new_segment.filter(is_uint8array).forEach(function (s) {\n        ranges.push({ data: s });\n        out_length += s.length;\n      });\n    } else if (new_segment !== false) {\n      var new_range = { start: segment.offset, end: segment.offset + segment.length };\n\n      if (ranges.length > 0 && ranges[ranges.length - 1].end === new_range.start) {\n        ranges[ranges.length - 1].end = new_range.end;\n      } else {\n        ranges.push(new_range);\n      }\n\n      out_length += segment.length;\n    }\n  });\n\n  var result = new Uint8Array(out_length);\n  var offset = 0;\n\n  ranges.forEach(function (range) {\n    var data = range.data || jpeg_bin.subarray(range.start, range.end);\n    result.set(data, offset);\n    offset += data.length;\n  });\n\n  return result;\n};\n\n\n// Call an iterator on each Exif entry in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                 0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                 (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// Iteration stops early if iterator returns `false`.\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed.\n//\nmodule.exports.jpeg_exif_tags_each = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  /* eslint-disable consistent-return */\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    if (segment.code === 0xDA /* SOS */) return false;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length).each(on_exif_entry);\n      return false;\n    }\n  });\n};\n\n\n// Remove Exif entries in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                  0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                  (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// This function removes following from Exif:\n//  - all entries where iterator returned false (except subifd links which are mandatory)\n//  - IFD1 and thumbnail image (the purpose of this function is to reduce file size,\n//    so thumbnail is usually the first thing to go)\n//  - all other data that isn't in IFD0, SubIFD, GPSIFD, InteropIFD\n//    (theoretically possible proprietary extensions, I haven't seen any of these yet)\n//\n// Changing data inside Exif entries is NOT supported yet (modifying `entry` object inside callback may break stuff).\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed, and original JPEG is returned as is.\n//\nmodule.exports.jpeg_exif_tags_filter = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  var stop_search = false;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    if (stop_search) return;\n    if (segment.code === 0xDA /* SOS */) stop_search = true;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      var new_exif = new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length)\n        .filter(on_exif_entry);\n      if (!new_exif) return false;\n\n      var header = new Uint8Array(10);\n\n      header.set(jpeg_bin.slice(segment.offset, segment.offset + 10));\n      header[2] = ((new_exif.length + 8) >>> 8) & 0xFF;\n      header[3] = (new_exif.length + 8) & 0xFF;\n\n      stop_search = true;\n      return [ header, new_exif ];\n    }\n  });\n};\n\n\n// Inserts a custom comment marker segment into JPEG file.\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - comment:  String\n//\n// Comment is inserted after first two bytes (FFD8, SOI).\n//\n// If JFIF (APP0) marker exists immediately after SOI (as mandated by the JFIF\n// spec), we insert comment after it instead.\n//\nmodule.exports.jpeg_add_comment = function (jpeg_bin, comment) {\n  var comment_inserted = false, segment_count = 0;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    segment_count++;\n    if (segment_count === 1 && segment.code === 0xD8 /* SOI  */) return;\n    if (segment_count === 2 && segment.code === 0xE0 /* APP0 */) return;\n\n    if (comment_inserted) return;\n    comment = utf8_encode(comment);\n\n    // comment segment\n    var csegment = new Uint8Array(5 + comment.length);\n    var offset = 0;\n\n    csegment[offset++] = 0xFF;\n    csegment[offset++] = 0xFE;\n    csegment[offset++] = ((comment.length + 3) >>> 8) & 0xFF;\n    csegment[offset++] = (comment.length + 3) & 0xFF;\n\n    comment.split('').forEach(function (c) {\n      csegment[offset++] = c.charCodeAt(0) & 0xFF;\n    });\n\n    csegment[offset++] = 0;\n    comment_inserted = true;\n\n    return [ csegment, jpeg_bin.subarray(segment.offset, segment.offset + segment.length) ];\n  });\n};\n});\n\nfunction jpeg_patch_exif(env) {\n  return this._getUint8Array(env.blob).then(function (data) {\n    env.is_jpeg = image_traverse.is_jpeg(data);\n\n    if (!env.is_jpeg) return Promise.resolve(env);\n\n    env.orig_blob = env.blob;\n\n    try {\n      var exif_is_big_endian, orientation_offset;\n\n      /* eslint-disable consistent-return */\n      image_traverse.jpeg_exif_tags_each(data, function (entry) {\n        if (entry.ifd === 0 && entry.tag === 0x112 && Array.isArray(entry.value)) {\n          env.orientation    = entry.value[0] || 1;\n          exif_is_big_endian = entry.big_endian;\n          orientation_offset = entry.data_offset;\n          return false;\n        }\n      });\n\n      if (orientation_offset) {\n        var orientation_patch = exif_is_big_endian ?\n          new Uint8Array([ 0, 1 ]) :\n          new Uint8Array([ 1, 0 ]);\n\n        env.blob = new Blob([\n          data.slice(0, orientation_offset),\n          orientation_patch,\n          data.slice(orientation_offset + 2)\n        ], { type: 'image/jpeg' });\n      }\n    } catch (_) {}\n\n    return env;\n  });\n}\n\n\nfunction jpeg_rotate_canvas(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  var orientation = env.orientation - 1;\n  if (!orientation) return Promise.resolve(env);\n\n  var canvas;\n\n  if (orientation & 4) {\n    canvas = this.pica.options.createCanvas(env.out_canvas.height, env.out_canvas.width);\n  } else {\n    canvas = this.pica.options.createCanvas(env.out_canvas.width, env.out_canvas.height);\n  }\n\n  var ctx = canvas.getContext('2d');\n\n  ctx.save();\n\n  if (orientation & 1) ctx.transform(-1, 0, 0, 1, canvas.width, 0);\n  if (orientation & 2) ctx.transform(-1, 0, 0, -1, canvas.width, canvas.height);\n  if (orientation & 4) ctx.transform(0, 1, 1, 0, 0, 0);\n\n  ctx.drawImage(env.out_canvas, 0, 0);\n  ctx.restore();\n\n  // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n  env.out_canvas.width = env.out_canvas.height = 0;\n\n  env.out_canvas = canvas;\n\n  return Promise.resolve(env);\n}\n\n\nfunction jpeg_attach_orig_segments(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  return Promise.all([\n    this._getUint8Array(env.blob),\n    this._getUint8Array(env.out_blob)\n  ]).then(function (res) {\n    var data = res[0];\n    var data_out = res[1];\n\n    if (image_traverse.is_jpeg(data_out)) return Promise.resolve(env);\n\n    var segments = [];\n\n    image_traverse.jpeg_segments_each(data, function (segment) {\n      if (segment.code === 0xDA /* SOS */) return false;\n      segments.push(segment);\n    });\n\n    segments = segments\n      .filter(function (segment) {\n        if (segment.code === 0xE2) {\n          var hdr = data.slice(segment.offset + 4, segment.offset + 11);\n          if (String.fromCharCode.apply(hdr) === 'ICC_PROFILE') {\n            return false;\n          }\n        }\n\n        // Keep all APPn segments excluding APP2 (ICC_PROFILE),\n        // remove others because most of them depend on image data (DCT and such).\n        //\n        // APP0 - JFIF, APP1 - Exif, the rest are photoshop metadata and such\n        //\n        // See full list at https://www.w3.org/Graphics/JPEG/itu-t81.pdf (table B.1 on page 32)\n        //\n        if (segment.code >= 0xE0 && segment.code < 0xF0) return true;\n\n        // Keep comments\n        //\n        if (segment.code === 0xFE) return true;\n\n        return false;\n      })\n      .map(function (segment) {\n        return data.slice(segment.offset, segment.offset + segment.length);\n      });\n\n    env.blob = new Blob(\n      [ data.slice(0, 20) ].concat(segments).concat([ data.slice(20) ]),\n      { type: 'image/jpeg' }\n    );\n\n    return env;\n  });\n}\n\n\nfunction assign$1(reducer) {\n  reducer.before('_blob_to_image', jpeg_patch_exif);\n  reducer.after('_transform',      jpeg_rotate_canvas);\n  reducer.after('_create_blob',    jpeg_attach_orig_segments);\n}\n\n\nvar jpeg_patch_exif_1 = jpeg_patch_exif;\nvar jpeg_rotate_canvas_1 = jpeg_rotate_canvas;\nvar jpeg_attach_orig_segments_1 = jpeg_attach_orig_segments;\nvar assign_1 = assign$1;\n\nvar jpeg_plugins = {\n\tjpeg_patch_exif: jpeg_patch_exif_1,\n\tjpeg_rotate_canvas: jpeg_rotate_canvas_1,\n\tjpeg_attach_orig_segments: jpeg_attach_orig_segments_1,\n\tassign: assign_1\n};\n\nfunction ImageBlobReduce(options) {\n  if (!(this instanceof ImageBlobReduce)) return new ImageBlobReduce(options);\n\n  options = options || {};\n\n  this.pica = options.pica || pica({});\n  this.initialized = false;\n\n  this.utils = utils;\n}\n\n\nImageBlobReduce.prototype.use = function (plugin /*, params, ... */) {\n  var args = [ this ].concat(Array.prototype.slice.call(arguments, 1));\n  plugin.apply(plugin, args);\n  return this;\n};\n\n\nImageBlobReduce.prototype.init = function () {\n  this.use(jpeg_plugins.assign);\n};\n\n\nImageBlobReduce.prototype.toBlob = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(this._create_blob)\n    .then(function (_env) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      _env.out_canvas.width = _env.out_canvas.height = 0;\n\n      return _env.out_blob;\n    });\n};\n\n\nImageBlobReduce.prototype.toCanvas = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(function (_env) { return _env.out_canvas; });\n};\n\n\nImageBlobReduce.prototype.before = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return fn.call(self, env).then(function (_env) {\n      return old_fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype.after = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return old_fn.call(self, env).then(function (_env) {\n      return fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype._blob_to_image = function (env) {\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n  env.image = document.createElement('img');\n  env.image_url = URL.createObjectURL(env.blob);\n  env.image.src = env.image_url;\n\n  return new Promise(function (resolve, reject) {\n    env.image.onerror = function () { reject(new Error('ImageBlobReduce: failed to create Image() from blob')); };\n    env.image.onload = function () { resolve(env); };\n  });\n};\n\n\nImageBlobReduce.prototype._calculate_size = function (env) {\n  //\n  // Note, if your need not \"symmetric\" resize logic, you MUST check\n  // `env.orientation` (set by plugins) and swap width/height appropriately.\n  //\n  var scale_factor = env.opts.max / Math.max(env.image.width, env.image.height);\n\n  if (scale_factor > 1) scale_factor = 1;\n\n  env.transform_width = Math.max(Math.round(env.image.width * scale_factor), 1);\n  env.transform_height = Math.max(Math.round(env.image.height * scale_factor), 1);\n\n  // Info for user plugins, to check if scaling applied\n  env.scale_factor = scale_factor;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._transform = function (env) {\n  env.out_canvas = this.pica.options.createCanvas(env.transform_width, env.transform_height);\n\n  // Dim env temporary vars to prohibit use and avoid confusion when orientation\n  // changed. You should take real size from canvas.\n  env.transform_width = null;\n  env.transform_height = null;\n\n  // By default use alpha for png only\n  var pica_opts = { alpha: env.blob.type === 'image/png' };\n\n  // Extract pica options if been passed\n  this.utils.assign(pica_opts, this.utils.pick_pica_resize_options(env.opts));\n\n  return this.pica\n    .resize(env.image, env.out_canvas, pica_opts)\n    .then(function () { return env; });\n};\n\n\nImageBlobReduce.prototype._cleanup = function (env) {\n  env.image.src = '';\n  env.image = null;\n\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n  if (URL.revokeObjectURL) URL.revokeObjectURL(env.image_url);\n\n  env.image_url = null;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._create_blob = function (env) {\n  return this.pica.toBlob(env.out_canvas, env.blob.type)\n    .then(function (blob) {\n      env.out_blob = blob;\n      return env;\n    });\n};\n\n\nImageBlobReduce.prototype._getUint8Array = function (blob) {\n  if (blob.arrayBuffer) {\n    return blob.arrayBuffer().then(function (buf) {\n      return new Uint8Array(buf);\n    });\n  }\n\n  return new Promise(function (resolve, reject) {\n    var fr = new FileReader();\n\n    fr.readAsArrayBuffer(blob);\n\n    fr.onload = function () { resolve(new Uint8Array(fr.result)); };\n    fr.onerror = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob'));\n      fr.abort();\n    };\n    fr.onabort = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob (aborted)'));\n    };\n  });\n};\n\n\nImageBlobReduce.pica = pica;\n\nvar imageBlobReduce = ImageBlobReduce;\n\nexport default imageBlobReduce;\n","import { Injectable } from '@angular/core';\nimport { RxCollection } from 'rxdb';\nimport { defer, forkJoin, Observable } from 'rxjs';\nimport { concatMap, first, map, pluck, shareReplay } from 'rxjs/operators';\nimport { sha256WithBlob } from '../../utils/crypto';\nimport { getCurrentPositionOrUndefined } from '../../utils/geolocation';\nimport { Database } from '../database/database.service';\nimport { MemontIndex, Moment, schema } from './moment';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class MomentRepository {\n  private readonly collection$: Observable<\n    RxCollection<MemontIndex>\n  > = this.database.main$.pipe(\n    concatMap(database =>\n      database.addCollections({\n        [COLLECTION_NAME]: { schema },\n      })\n    ),\n    pluck(COLLECTION_NAME),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n\n  readonly all$ = this.collection$.pipe(\n    concatMap(c => c.find().sort({ timestamp: 'desc' }).$),\n    map(documents => documents.map(d => new Moment(d)))\n  );\n\n  constructor(private readonly database: Database) {}\n\n  add$(photo: Blob) {\n    return defer(() =>\n      forkJoin([\n        this.collection$.pipe(first()),\n        sha256WithBlob(photo),\n        getCurrentPositionOrUndefined(),\n      ])\n    ).pipe(\n      concatMap(([collection, id, geolocationPosition]) =>\n        collection.insert({\n          id,\n          timestamp: Date.now(),\n          geolocationPosition: geolocationPosition\n            ? {\n                latitude: geolocationPosition.coords.latitude,\n                longitude: geolocationPosition.coords.longitude,\n              }\n            : undefined,\n        })\n      ),\n      concatMap(document =>\n        document.putAttachment(\n          { id: Moment.PHOTO_ATTACHMENT_ID, data: photo, type: photo.type },\n          true\n        )\n      ),\n      map(attachment => attachment.doc)\n    );\n  }\n\n  remove$(id: string) {\n    return this.collection$.pipe(concatMap(c => c.bulkRemove([id])));\n  }\n}\n\nconst COLLECTION_NAME = 'moments';\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { ReactiveComponentModule } from '@ngrx/component';\nimport { ImageComponent } from './image/image.component';\n\n@NgModule({\n  declarations: [ImageComponent],\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    HttpClientModule,\n    ReactiveComponentModule,\n  ],\n  exports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    ReactiveComponentModule,\n    ImageComponent,\n  ],\n})\nexport class SharedModule {}\n","export function arrayBufferToHex(arrayBuffer: ArrayBuffer) {\n  return [...new Uint8Array(arrayBuffer)]\n    .map(b => b.toString(16).padStart(2, '0'))\n    .join('');\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { HomePage } from './home.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomePage,\n  },\n  {\n    path: 'photo',\n    loadChildren: () =>\n      import('./photo/photo.module').then(m => m.PhotoPageModule),\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class HomePageRoutingModule {}\n","import ImageBlobReduce from 'image-blob-reduce';\n\nconst imageBlobReduce = new ImageBlobReduce();\n\nexport async function makeThumbnail({\n  image,\n  maxSize,\n}: {\n  image: Blob;\n  maxSize: number;\n}) {\n  return imageBlobReduce.toBlob(image, { max: maxSize });\n}\n","<ion-button (click)=\"dismiss()\" class=\"dismiss\" fill=\"clear\">\n  <ion-icon slot=\"icon-only\" name=\"close-outline\" color=\"light\"></ion-icon>\n</ion-button>\n<ion-button (click)=\"capture()\" class=\"capture\" fill=\"clear\">\n  <ion-icon\n    slot=\"icon-only\"\n    name=\"radio-button-on-outline\"\n    color=\"light\"\n  ></ion-icon>\n</ion-button>\n<div\n  *ngrxLet=\"capturedImageUrl$ as capturedImageUrl\"\n  class=\"captured ion-margin\"\n>\n  <app-image ionImgViewer [src]=\"capturedImageUrl\"></app-image>\n</div>\n<video #video playsinline autoplay></video>\n","import { Component, ElementRef, OnDestroy, ViewChild } from '@angular/core';\nimport { AlertController, ModalController } from '@ionic/angular';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { BehaviorSubject, combineLatest, defer } from 'rxjs';\nimport {\n  catchError,\n  distinctUntilChanged,\n  map,\n  pairwise,\n  shareReplay,\n  switchMap,\n  tap,\n} from 'rxjs/operators';\nimport { MomentRepository } from '../../../shared/moment/moment-repository.service';\nimport { concatTap, isNonNullable } from '../../../utils/rx-operators';\n\n@UntilDestroy()\n@Component({\n  selector: 'app-camera',\n  templateUrl: './camera.component.html',\n  styleUrls: ['./camera.component.scss'],\n})\nexport class CameraComponent implements OnDestroy {\n  private readonly _videoElement$ = new BehaviorSubject<\n    HTMLVideoElement | undefined\n  >(undefined);\n\n  private readonly videoElement$ = this._videoElement$.pipe(\n    isNonNullable(),\n    distinctUntilChanged()\n  );\n\n  @ViewChild('video')\n  set videoElement(value: ElementRef<HTMLVideoElement>) {\n    this._videoElement$.next(value.nativeElement);\n  }\n\n  private readonly mediaStream$ = defer(() =>\n    navigator.mediaDevices.getUserMedia({\n      video: { facingMode: 'environment' },\n    })\n  ).pipe(\n    catchError(async (err: unknown) => {\n      await this.presentErrorDialog(err);\n      await this.dismiss();\n      return undefined;\n    }),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n\n  private readonly imageCapture$ = this.mediaStream$.pipe(\n    isNonNullable(),\n    map(mediaStream => new ImageCapture(mediaStream.getVideoTracks()[0])),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n\n  private readonly _capturedImageUrl$ = new BehaviorSubject<string | undefined>(\n    undefined\n  );\n\n  private readonly revokePreviousImageUrl$ = this._capturedImageUrl$.pipe(\n    pairwise(),\n    tap(([previous]) => {\n      if (previous) URL.revokeObjectURL(previous);\n    })\n  );\n\n  readonly capturedImageUrl$ = this._capturedImageUrl$.pipe(\n    isNonNullable(),\n    distinctUntilChanged()\n  );\n\n  private readonly cameraPreview$ = combineLatest([\n    this.videoElement$,\n    this.mediaStream$.pipe(isNonNullable()),\n  ]).pipe(\n    tap(([videoElement, mediaStream]) => {\n      videoElement.srcObject = mediaStream;\n    })\n  );\n\n  constructor(\n    private readonly modalController: ModalController,\n    private readonly alertController: AlertController,\n    private readonly momentRepository: MomentRepository\n  ) {\n    this.revokePreviousImageUrl$.pipe(untilDestroyed(this)).subscribe();\n    this.cameraPreview$.pipe(untilDestroyed(this)).subscribe();\n  }\n\n  capture() {\n    this.imageCapture$\n      .pipe(\n        switchMap(imageCapture => imageCapture.takePhoto()),\n        tap(imageBlob => {\n          this._capturedImageUrl$.next(URL.createObjectURL(imageBlob));\n        }),\n        concatTap(imageBlob => this.momentRepository.add$(imageBlob)),\n        catchError(async (err: unknown) => {\n          // eslint-disable-next-line no-console\n          console.error(err);\n          await this.presentErrorDialog(err);\n          return undefined;\n        }),\n        untilDestroyed(this)\n      )\n      .subscribe();\n  }\n\n  async dismiss() {\n    return this.modalController.dismiss();\n  }\n\n  async presentErrorDialog(err: unknown) {\n    const alert = await this.alertController.create({\n      header: err instanceof Error ? err.name : 'Unknown Error',\n      message: err instanceof Error ? err.message : JSON.stringify(err),\n      buttons: [{ text: 'ok' }],\n    });\n    await alert.present();\n  }\n\n  ngOnDestroy() {\n    this.mediaStream$\n      .pipe(\n        isNonNullable(),\n        tap(mediaStream =>\n          mediaStream.getTracks().forEach(track => track.stop())\n        )\n      )\n      .subscribe();\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { NgxIonicImageViewerModule } from 'ngx-ionic-image-viewer';\nimport { SharedModule } from '../../shared/shared.module';\nimport { CameraComponent } from './camera/camera.component';\nimport { HomePageRoutingModule } from './home-routing.module';\nimport { HomePage } from './home.page';\nimport { MomentThumbnailComponent } from './moment-thumbnail/moment-thumbnail.component';\nimport { SettingsComponent } from './settings/settings.component';\n\n@NgModule({\n  imports: [SharedModule, HomePageRoutingModule, NgxIonicImageViewerModule],\n  declarations: [\n    HomePage,\n    SettingsComponent,\n    CameraComponent,\n    MomentThumbnailComponent,\n  ],\n})\nexport class HomePageModule {}\n","<ion-list lines=\"none\">\n  <ion-item>\n    <ion-icon name=\"moon-outline\" slot=\"start\"></ion-icon>\n    <ion-label>Theme</ion-label>\n    <ion-select\n      *ngrxLet=\"theme$ as theme\"\n      [value]=\"theme\"\n      (ionChange)=\"onChangeDarkTheme($event)\"\n    >\n      <ion-select-option *ngFor=\"let theme of themes\" [value]=\"theme\">\n        {{ theme }}\n      </ion-select-option>\n    </ion-select>\n  </ion-item>\n  <ion-item>\n    <ion-icon name=\"information-outline\" slot=\"start\"></ion-icon>\n    <ion-label>Version</ion-label>\n    <ion-note slot=\"end\">{{ version }}</ion-note>\n  </ion-item>\n</ion-list>\n","import { Component } from '@angular/core';\nimport { IonSelect } from '@ionic/angular';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { version } from '../../../../../package.json';\nimport { SettingsService } from '../../../shared/settings/settings.service';\n\n@UntilDestroy()\n@Component({\n  selector: 'app-settings',\n  templateUrl: './settings.component.html',\n  styleUrls: ['./settings.component.scss'],\n})\nexport class SettingsComponent {\n  readonly themes = SettingsService.THEMES;\n\n  readonly theme$ = this.settingsService.theme$;\n\n  readonly version = version;\n\n  constructor(private readonly settingsService: SettingsService) {}\n\n  onChangeDarkTheme(event: Event) {\n    return this.settingsService\n      .setTheme$((event as CustomEvent<IonSelect>).detail.value)\n      .pipe(untilDestroyed(this))\n      .subscribe();\n  }\n}\n","import { Component, Input } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\nimport { distinctUntilChanged } from 'rxjs/operators';\nimport { Moment } from '../../../shared/moment/moment';\nimport { isNonNullable } from '../../../utils/rx-operators';\n\n@Component({\n  selector: 'app-moment-thumbnail',\n  templateUrl: './moment-thumbnail.component.html',\n  styleUrls: ['./moment-thumbnail.component.scss'],\n})\nexport class MomentThumbnailComponent {\n  private readonly _moment$ = new BehaviorSubject<undefined | Moment>(\n    undefined\n  );\n\n  readonly moment$ = this._moment$.pipe(\n    isNonNullable(),\n    distinctUntilChanged((x, y) => x.id === y.id)\n  );\n\n  @Input() set moment(value: Moment) {\n    this._moment$.next(value);\n  }\n}\n","<ng-container *ngrxLet=\"moment$ as moment\">\n  <app-image\n    *ngrxLet=\"moment.thumbnailUrl$ as thumbnailUrl\"\n    routerLink=\"photo\"\n    [queryParams]=\"{ id: moment.id }\"\n    [src]=\"thumbnailUrl\"\n    class=\"ion-activatable\"\n  >\n    <ion-ripple-effect></ion-ripple-effect>\n  </app-image>\n</ng-container>\n","export class DataNotFoundError extends Error {\n  name = DataNotFoundError.name;\n}\n","/**\n * @license Angular v11.2.3\n * (c) 2010-2021 Google LLC. https://angular.io/\n * License: MIT\n */\n\nimport { Injectable, InjectionToken, Inject, PLATFORM_ID, Injector, NgModule } from '@angular/core';\nimport { of, Observable } from 'rxjs';\nimport { concatMap, filter, map } from 'rxjs/operators';\nimport { DOCUMENT, ɵparseCookieValue } from '@angular/common';\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * Transforms an `HttpRequest` into a stream of `HttpEvent`s, one of which will likely be a\n * `HttpResponse`.\n *\n * `HttpHandler` is injectable. When injected, the handler instance dispatches requests to the\n * first interceptor in the chain, which dispatches to the second, etc, eventually reaching the\n * `HttpBackend`.\n *\n * In an `HttpInterceptor`, the `HttpHandler` parameter is the next interceptor in the chain.\n *\n * @publicApi\n */\nimport * as ɵngcc0 from '@angular/core';\nclass HttpHandler {\n}\n/**\n * A final `HttpHandler` which will dispatch the request via browser HTTP APIs to a backend.\n *\n * Interceptors sit between the `HttpClient` interface and the `HttpBackend`.\n *\n * When injected, `HttpBackend` dispatches requests directly to the backend, without going\n * through the interceptor chain.\n *\n * @publicApi\n */\nclass HttpBackend {\n}\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * Represents the header configuration options for an HTTP request.\n * Instances are immutable. Modifying methods return a cloned\n * instance with the change. The original object is never changed.\n *\n * @publicApi\n */\nclass HttpHeaders {\n    /**  Constructs a new HTTP header object with the given values.*/\n    constructor(headers) {\n        /**\n         * Internal map of lowercased header names to the normalized\n         * form of the name (the form seen first).\n         */\n        this.normalizedNames = new Map();\n        /**\n         * Queued updates to be materialized the next initialization.\n         */\n        this.lazyUpdate = null;\n        if (!headers) {\n            this.headers = new Map();\n        }\n        else if (typeof headers === 'string') {\n            this.lazyInit = () => {\n                this.headers = new Map();\n                headers.split('\\n').forEach(line => {\n                    const index = line.indexOf(':');\n                    if (index > 0) {\n                        const name = line.slice(0, index);\n                        const key = name.toLowerCase();\n                        const value = line.slice(index + 1).trim();\n                        this.maybeSetNormalizedName(name, key);\n                        if (this.headers.has(key)) {\n                            this.headers.get(key).push(value);\n                        }\n                        else {\n                            this.headers.set(key, [value]);\n                        }\n                    }\n                });\n            };\n        }\n        else {\n            this.lazyInit = () => {\n                this.headers = new Map();\n                Object.keys(headers).forEach(name => {\n                    let values = headers[name];\n                    const key = name.toLowerCase();\n                    if (typeof values === 'string') {\n                        values = [values];\n                    }\n                    if (values.length > 0) {\n                        this.headers.set(key, values);\n                        this.maybeSetNormalizedName(name, key);\n                    }\n                });\n            };\n        }\n    }\n    /**\n     * Checks for existence of a given header.\n     *\n     * @param name The header name to check for existence.\n     *\n     * @returns True if the header exists, false otherwise.\n     */\n    has(name) {\n        this.init();\n        return this.headers.has(name.toLowerCase());\n    }\n    /**\n     * Retrieves the first value of a given header.\n     *\n     * @param name The header name.\n     *\n     * @returns The value string if the header exists, null otherwise\n     */\n    get(name) {\n        this.init();\n        const values = this.headers.get(name.toLowerCase());\n        return values && values.length > 0 ? values[0] : null;\n    }\n    /**\n     * Retrieves the names of the headers.\n     *\n     * @returns A list of header names.\n     */\n    keys() {\n        this.init();\n        return Array.from(this.normalizedNames.values());\n    }\n    /**\n     * Retrieves a list of values for a given header.\n     *\n     * @param name The header name from which to retrieve values.\n     *\n     * @returns A string of values if the header exists, null otherwise.\n     */\n    getAll(name) {\n        this.init();\n        return this.headers.get(name.toLowerCase()) || null;\n    }\n    /**\n     * Appends a new value to the existing set of values for a header\n     * and returns them in a clone of the original instance.\n     *\n     * @param name The header name for which to append the values.\n     * @param value The value to append.\n     *\n     * @returns A clone of the HTTP headers object with the value appended to the given header.\n     */\n    append(name, value) {\n        return this.clone({ name, value, op: 'a' });\n    }\n    /**\n     * Sets or modifies a value for a given header in a clone of the original instance.\n     * If the header already exists, its value is replaced with the given value\n     * in the returned object.\n     *\n     * @param name The header name.\n     * @param value The value or values to set or overide for the given header.\n     *\n     * @returns A clone of the HTTP headers object with the newly set header value.\n     */\n    set(name, value) {\n        return this.clone({ name, value, op: 's' });\n    }\n    /**\n     * Deletes values for a given header in a clone of the original instance.\n     *\n     * @param name The header name.\n     * @param value The value or values to delete for the given header.\n     *\n     * @returns A clone of the HTTP headers object with the given value deleted.\n     */\n    delete(name, value) {\n        return this.clone({ name, value, op: 'd' });\n    }\n    maybeSetNormalizedName(name, lcName) {\n        if (!this.normalizedNames.has(lcName)) {\n            this.normalizedNames.set(lcName, name);\n        }\n    }\n    init() {\n        if (!!this.lazyInit) {\n            if (this.lazyInit instanceof HttpHeaders) {\n                this.copyFrom(this.lazyInit);\n            }\n            else {\n                this.lazyInit();\n            }\n            this.lazyInit = null;\n            if (!!this.lazyUpdate) {\n                this.lazyUpdate.forEach(update => this.applyUpdate(update));\n                this.lazyUpdate = null;\n            }\n        }\n    }\n    copyFrom(other) {\n        other.init();\n        Array.from(other.headers.keys()).forEach(key => {\n            this.headers.set(key, other.headers.get(key));\n            this.normalizedNames.set(key, other.normalizedNames.get(key));\n        });\n    }\n    clone(update) {\n        const clone = new HttpHeaders();\n        clone.lazyInit =\n            (!!this.lazyInit && this.lazyInit instanceof HttpHeaders) ? this.lazyInit : this;\n        clone.lazyUpdate = (this.lazyUpdate || []).concat([update]);\n        return clone;\n    }\n    applyUpdate(update) {\n        const key = update.name.toLowerCase();\n        switch (update.op) {\n            case 'a':\n            case 's':\n                let value = update.value;\n                if (typeof value === 'string') {\n                    value = [value];\n                }\n                if (value.length === 0) {\n                    return;\n                }\n                this.maybeSetNormalizedName(update.name, key);\n                const base = (update.op === 'a' ? this.headers.get(key) : undefined) || [];\n                base.push(...value);\n                this.headers.set(key, base);\n                break;\n            case 'd':\n                const toDelete = update.value;\n                if (!toDelete) {\n                    this.headers.delete(key);\n                    this.normalizedNames.delete(key);\n                }\n                else {\n                    let existing = this.headers.get(key);\n                    if (!existing) {\n                        return;\n                    }\n                    existing = existing.filter(value => toDelete.indexOf(value) === -1);\n                    if (existing.length === 0) {\n                        this.headers.delete(key);\n                        this.normalizedNames.delete(key);\n                    }\n                    else {\n                        this.headers.set(key, existing);\n                    }\n                }\n                break;\n        }\n    }\n    /**\n     * @internal\n     */\n    forEach(fn) {\n        this.init();\n        Array.from(this.normalizedNames.keys())\n            .forEach(key => fn(this.normalizedNames.get(key), this.headers.get(key)));\n    }\n}\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * Provides encoding and decoding of URL parameter and query-string values.\n *\n * Serializes and parses URL parameter keys and values to encode and decode them.\n * If you pass URL query parameters without encoding,\n * the query parameters can be misinterpreted at the receiving end.\n *\n *\n * @publicApi\n */\nclass HttpUrlEncodingCodec {\n    /**\n     * Encodes a key name for a URL parameter or query-string.\n     * @param key The key name.\n     * @returns The encoded key name.\n     */\n    encodeKey(key) {\n        return standardEncoding(key);\n    }\n    /**\n     * Encodes the value of a URL parameter or query-string.\n     * @param value The value.\n     * @returns The encoded value.\n     */\n    encodeValue(value) {\n        return standardEncoding(value);\n    }\n    /**\n     * Decodes an encoded URL parameter or query-string key.\n     * @param key The encoded key name.\n     * @returns The decoded key name.\n     */\n    decodeKey(key) {\n        return decodeURIComponent(key);\n    }\n    /**\n     * Decodes an encoded URL parameter or query-string value.\n     * @param value The encoded value.\n     * @returns The decoded value.\n     */\n    decodeValue(value) {\n        return decodeURIComponent(value);\n    }\n}\nfunction paramParser(rawParams, codec) {\n    const map = new Map();\n    if (rawParams.length > 0) {\n        // The `window.location.search` can be used while creating an instance of the `HttpParams` class\n        // (e.g. `new HttpParams({ fromString: window.location.search })`). The `window.location.search`\n        // may start with the `?` char, so we strip it if it's present.\n        const params = rawParams.replace(/^\\?/, '').split('&');\n        params.forEach((param) => {\n            const eqIdx = param.indexOf('=');\n            const [key, val] = eqIdx == -1 ?\n                [codec.decodeKey(param), ''] :\n                [codec.decodeKey(param.slice(0, eqIdx)), codec.decodeValue(param.slice(eqIdx + 1))];\n            const list = map.get(key) || [];\n            list.push(val);\n            map.set(key, list);\n        });\n    }\n    return map;\n}\nfunction standardEncoding(v) {\n    return encodeURIComponent(v)\n        .replace(/%40/gi, '@')\n        .replace(/%3A/gi, ':')\n        .replace(/%24/gi, '$')\n        .replace(/%2C/gi, ',')\n        .replace(/%3B/gi, ';')\n        .replace(/%2B/gi, '+')\n        .replace(/%3D/gi, '=')\n        .replace(/%3F/gi, '?')\n        .replace(/%2F/gi, '/');\n}\n/**\n * An HTTP request/response body that represents serialized parameters,\n * per the MIME type `application/x-www-form-urlencoded`.\n *\n * This class is immutable; all mutation operations return a new instance.\n *\n * @publicApi\n */\nclass HttpParams {\n    constructor(options = {}) {\n        this.updates = null;\n        this.cloneFrom = null;\n        this.encoder = options.encoder || new HttpUrlEncodingCodec();\n        if (!!options.fromString) {\n            if (!!options.fromObject) {\n                throw new Error(`Cannot specify both fromString and fromObject.`);\n            }\n            this.map = paramParser(options.fromString, this.encoder);\n        }\n        else if (!!options.fromObject) {\n            this.map = new Map();\n            Object.keys(options.fromObject).forEach(key => {\n                const value = options.fromObject[key];\n                this.map.set(key, Array.isArray(value) ? value : [value]);\n            });\n        }\n        else {\n            this.map = null;\n        }\n    }\n    /**\n     * Reports whether the body includes one or more values for a given parameter.\n     * @param param The parameter name.\n     * @returns True if the parameter has one or more values,\n     * false if it has no value or is not present.\n     */\n    has(param) {\n        this.init();\n        return this.map.has(param);\n    }\n    /**\n     * Retrieves the first value for a parameter.\n     * @param param The parameter name.\n     * @returns The first value of the given parameter,\n     * or `null` if the parameter is not present.\n     */\n    get(param) {\n        this.init();\n        const res = this.map.get(param);\n        return !!res ? res[0] : null;\n    }\n    /**\n     * Retrieves all values for a  parameter.\n     * @param param The parameter name.\n     * @returns All values in a string array,\n     * or `null` if the parameter not present.\n     */\n    getAll(param) {\n        this.init();\n        return this.map.get(param) || null;\n    }\n    /**\n     * Retrieves all the parameters for this body.\n     * @returns The parameter names in a string array.\n     */\n    keys() {\n        this.init();\n        return Array.from(this.map.keys());\n    }\n    /**\n     * Appends a new value to existing values for a parameter.\n     * @param param The parameter name.\n     * @param value The new value to add.\n     * @return A new body with the appended value.\n     */\n    append(param, value) {\n        return this.clone({ param, value, op: 'a' });\n    }\n    /**\n     * Constructs a new body with appended values for the given parameter name.\n     * @param params parameters and values\n     * @return A new body with the new value.\n     */\n    appendAll(params) {\n        const updates = [];\n        Object.keys(params).forEach(param => {\n            const value = params[param];\n            if (Array.isArray(value)) {\n                value.forEach(_value => {\n                    updates.push({ param, value: _value, op: 'a' });\n                });\n            }\n            else {\n                updates.push({ param, value, op: 'a' });\n            }\n        });\n        return this.clone(updates);\n    }\n    /**\n     * Replaces the value for a parameter.\n     * @param param The parameter name.\n     * @param value The new value.\n     * @return A new body with the new value.\n     */\n    set(param, value) {\n        return this.clone({ param, value, op: 's' });\n    }\n    /**\n     * Removes a given value or all values from a parameter.\n     * @param param The parameter name.\n     * @param value The value to remove, if provided.\n     * @return A new body with the given value removed, or with all values\n     * removed if no value is specified.\n     */\n    delete(param, value) {\n        return this.clone({ param, value, op: 'd' });\n    }\n    /**\n     * Serializes the body to an encoded string, where key-value pairs (separated by `=`) are\n     * separated by `&`s.\n     */\n    toString() {\n        this.init();\n        return this.keys()\n            .map(key => {\n            const eKey = this.encoder.encodeKey(key);\n            // `a: ['1']` produces `'a=1'`\n            // `b: []` produces `''`\n            // `c: ['1', '2']` produces `'c=1&c=2'`\n            return this.map.get(key).map(value => eKey + '=' + this.encoder.encodeValue(value))\n                .join('&');\n        })\n            // filter out empty values because `b: []` produces `''`\n            // which results in `a=1&&c=1&c=2` instead of `a=1&c=1&c=2` if we don't\n            .filter(param => param !== '')\n            .join('&');\n    }\n    clone(update) {\n        const clone = new HttpParams({ encoder: this.encoder });\n        clone.cloneFrom = this.cloneFrom || this;\n        clone.updates = (this.updates || []).concat(update);\n        return clone;\n    }\n    init() {\n        if (this.map === null) {\n            this.map = new Map();\n        }\n        if (this.cloneFrom !== null) {\n            this.cloneFrom.init();\n            this.cloneFrom.keys().forEach(key => this.map.set(key, this.cloneFrom.map.get(key)));\n            this.updates.forEach(update => {\n                switch (update.op) {\n                    case 'a':\n                    case 's':\n                        const base = (update.op === 'a' ? this.map.get(update.param) : undefined) || [];\n                        base.push(update.value);\n                        this.map.set(update.param, base);\n                        break;\n                    case 'd':\n                        if (update.value !== undefined) {\n                            let base = this.map.get(update.param) || [];\n                            const idx = base.indexOf(update.value);\n                            if (idx !== -1) {\n                                base.splice(idx, 1);\n                            }\n                            if (base.length > 0) {\n                                this.map.set(update.param, base);\n                            }\n                            else {\n                                this.map.delete(update.param);\n                            }\n                        }\n                        else {\n                            this.map.delete(update.param);\n                            break;\n                        }\n                }\n            });\n            this.cloneFrom = this.updates = null;\n        }\n    }\n}\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * Determine whether the given HTTP method may include a body.\n */\nfunction mightHaveBody(method) {\n    switch (method) {\n        case 'DELETE':\n        case 'GET':\n        case 'HEAD':\n        case 'OPTIONS':\n        case 'JSONP':\n            return false;\n        default:\n            return true;\n    }\n}\n/**\n * Safely assert whether the given value is an ArrayBuffer.\n *\n * In some execution environments ArrayBuffer is not defined.\n */\nfunction isArrayBuffer(value) {\n    return typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer;\n}\n/**\n * Safely assert whether the given value is a Blob.\n *\n * In some execution environments Blob is not defined.\n */\nfunction isBlob(value) {\n    return typeof Blob !== 'undefined' && value instanceof Blob;\n}\n/**\n * Safely assert whether the given value is a FormData instance.\n *\n * In some execution environments FormData is not defined.\n */\nfunction isFormData(value) {\n    return typeof FormData !== 'undefined' && value instanceof FormData;\n}\n/**\n * An outgoing HTTP request with an optional typed body.\n *\n * `HttpRequest` represents an outgoing request, including URL, method,\n * headers, body, and other request configuration options. Instances should be\n * assumed to be immutable. To modify a `HttpRequest`, the `clone`\n * method should be used.\n *\n * @publicApi\n */\nclass HttpRequest {\n    constructor(method, url, third, fourth) {\n        this.url = url;\n        /**\n         * The request body, or `null` if one isn't set.\n         *\n         * Bodies are not enforced to be immutable, as they can include a reference to any\n         * user-defined data type. However, interceptors should take care to preserve\n         * idempotence by treating them as such.\n         */\n        this.body = null;\n        /**\n         * Whether this request should be made in a way that exposes progress events.\n         *\n         * Progress events are expensive (change detection runs on each event) and so\n         * they should only be requested if the consumer intends to monitor them.\n         */\n        this.reportProgress = false;\n        /**\n         * Whether this request should be sent with outgoing credentials (cookies).\n         */\n        this.withCredentials = false;\n        /**\n         * The expected response type of the server.\n         *\n         * This is used to parse the response appropriately before returning it to\n         * the requestee.\n         */\n        this.responseType = 'json';\n        this.method = method.toUpperCase();\n        // Next, need to figure out which argument holds the HttpRequestInit\n        // options, if any.\n        let options;\n        // Check whether a body argument is expected. The only valid way to omit\n        // the body argument is to use a known no-body method like GET.\n        if (mightHaveBody(this.method) || !!fourth) {\n            // Body is the third argument, options are the fourth.\n            this.body = (third !== undefined) ? third : null;\n            options = fourth;\n        }\n        else {\n            // No body required, options are the third argument. The body stays null.\n            options = third;\n        }\n        // If options have been passed, interpret them.\n        if (options) {\n            // Normalize reportProgress and withCredentials.\n            this.reportProgress = !!options.reportProgress;\n            this.withCredentials = !!options.withCredentials;\n            // Override default response type of 'json' if one is provided.\n            if (!!options.responseType) {\n                this.responseType = options.responseType;\n            }\n            // Override headers if they're provided.\n            if (!!options.headers) {\n                this.headers = options.headers;\n            }\n            if (!!options.params) {\n                this.params = options.params;\n            }\n        }\n        // If no headers have been passed in, construct a new HttpHeaders instance.\n        if (!this.headers) {\n            this.headers = new HttpHeaders();\n        }\n        // If no parameters have been passed in, construct a new HttpUrlEncodedParams instance.\n        if (!this.params) {\n            this.params = new HttpParams();\n            this.urlWithParams = url;\n        }\n        else {\n            // Encode the parameters to a string in preparation for inclusion in the URL.\n            const params = this.params.toString();\n            if (params.length === 0) {\n                // No parameters, the visible URL is just the URL given at creation time.\n                this.urlWithParams = url;\n            }\n            else {\n                // Does the URL already have query parameters? Look for '?'.\n                const qIdx = url.indexOf('?');\n                // There are 3 cases to handle:\n                // 1) No existing parameters -> append '?' followed by params.\n                // 2) '?' exists and is followed by existing query string ->\n                //    append '&' followed by params.\n                // 3) '?' exists at the end of the url -> append params directly.\n                // This basically amounts to determining the character, if any, with\n                // which to join the URL and parameters.\n                const sep = qIdx === -1 ? '?' : (qIdx < url.length - 1 ? '&' : '');\n                this.urlWithParams = url + sep + params;\n            }\n        }\n    }\n    /**\n     * Transform the free-form body into a serialized format suitable for\n     * transmission to the server.\n     */\n    serializeBody() {\n        // If no body is present, no need to serialize it.\n        if (this.body === null) {\n            return null;\n        }\n        // Check whether the body is already in a serialized form. If so,\n        // it can just be returned directly.\n        if (isArrayBuffer(this.body) || isBlob(this.body) || isFormData(this.body) ||\n            typeof this.body === 'string') {\n            return this.body;\n        }\n        // Check whether the body is an instance of HttpUrlEncodedParams.\n        if (this.body instanceof HttpParams) {\n            return this.body.toString();\n        }\n        // Check whether the body is an object or array, and serialize with JSON if so.\n        if (typeof this.body === 'object' || typeof this.body === 'boolean' ||\n            Array.isArray(this.body)) {\n            return JSON.stringify(this.body);\n        }\n        // Fall back on toString() for everything else.\n        return this.body.toString();\n    }\n    /**\n     * Examine the body and attempt to infer an appropriate MIME type\n     * for it.\n     *\n     * If no such type can be inferred, this method will return `null`.\n     */\n    detectContentTypeHeader() {\n        // An empty body has no content type.\n        if (this.body === null) {\n            return null;\n        }\n        // FormData bodies rely on the browser's content type assignment.\n        if (isFormData(this.body)) {\n            return null;\n        }\n        // Blobs usually have their own content type. If it doesn't, then\n        // no type can be inferred.\n        if (isBlob(this.body)) {\n            return this.body.type || null;\n        }\n        // Array buffers have unknown contents and thus no type can be inferred.\n        if (isArrayBuffer(this.body)) {\n            return null;\n        }\n        // Technically, strings could be a form of JSON data, but it's safe enough\n        // to assume they're plain strings.\n        if (typeof this.body === 'string') {\n            return 'text/plain';\n        }\n        // `HttpUrlEncodedParams` has its own content-type.\n        if (this.body instanceof HttpParams) {\n            return 'application/x-www-form-urlencoded;charset=UTF-8';\n        }\n        // Arrays, objects, and numbers will be encoded as JSON.\n        if (typeof this.body === 'object' || typeof this.body === 'number' ||\n            Array.isArray(this.body)) {\n            return 'application/json';\n        }\n        // No type could be inferred.\n        return null;\n    }\n    clone(update = {}) {\n        // For method, url, and responseType, take the current value unless\n        // it is overridden in the update hash.\n        const method = update.method || this.method;\n        const url = update.url || this.url;\n        const responseType = update.responseType || this.responseType;\n        // The body is somewhat special - a `null` value in update.body means\n        // whatever current body is present is being overridden with an empty\n        // body, whereas an `undefined` value in update.body implies no\n        // override.\n        const body = (update.body !== undefined) ? update.body : this.body;\n        // Carefully handle the boolean options to differentiate between\n        // `false` and `undefined` in the update args.\n        const withCredentials = (update.withCredentials !== undefined) ? update.withCredentials : this.withCredentials;\n        const reportProgress = (update.reportProgress !== undefined) ? update.reportProgress : this.reportProgress;\n        // Headers and params may be appended to if `setHeaders` or\n        // `setParams` are used.\n        let headers = update.headers || this.headers;\n        let params = update.params || this.params;\n        // Check whether the caller has asked to add headers.\n        if (update.setHeaders !== undefined) {\n            // Set every requested header.\n            headers =\n                Object.keys(update.setHeaders)\n                    .reduce((headers, name) => headers.set(name, update.setHeaders[name]), headers);\n        }\n        // Check whether the caller has asked to set params.\n        if (update.setParams) {\n            // Set every requested param.\n            params = Object.keys(update.setParams)\n                .reduce((params, param) => params.set(param, update.setParams[param]), params);\n        }\n        // Finally, construct the new HttpRequest using the pieces from above.\n        return new HttpRequest(method, url, body, {\n            params,\n            headers,\n            reportProgress,\n            responseType,\n            withCredentials,\n        });\n    }\n}\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * Type enumeration for the different kinds of `HttpEvent`.\n *\n * @publicApi\n */\nvar HttpEventType;\n(function (HttpEventType) {\n    /**\n     * The request was sent out over the wire.\n     */\n    HttpEventType[HttpEventType[\"Sent\"] = 0] = \"Sent\";\n    /**\n     * An upload progress event was received.\n     */\n    HttpEventType[HttpEventType[\"UploadProgress\"] = 1] = \"UploadProgress\";\n    /**\n     * The response status code and headers were received.\n     */\n    HttpEventType[HttpEventType[\"ResponseHeader\"] = 2] = \"ResponseHeader\";\n    /**\n     * A download progress event was received.\n     */\n    HttpEventType[HttpEventType[\"DownloadProgress\"] = 3] = \"DownloadProgress\";\n    /**\n     * The full response including the body was received.\n     */\n    HttpEventType[HttpEventType[\"Response\"] = 4] = \"Response\";\n    /**\n     * A custom event from an interceptor or a backend.\n     */\n    HttpEventType[HttpEventType[\"User\"] = 5] = \"User\";\n})(HttpEventType || (HttpEventType = {}));\n/**\n * Base class for both `HttpResponse` and `HttpHeaderResponse`.\n *\n * @publicApi\n */\nclass HttpResponseBase {\n    /**\n     * Super-constructor for all responses.\n     *\n     * The single parameter accepted is an initialization hash. Any properties\n     * of the response passed there will override the default values.\n     */\n    constructor(init, defaultStatus = 200, defaultStatusText = 'OK') {\n        // If the hash has values passed, use them to initialize the response.\n        // Otherwise use the default values.\n        this.headers = init.headers || new HttpHeaders();\n        this.status = init.status !== undefined ? init.status : defaultStatus;\n        this.statusText = init.statusText || defaultStatusText;\n        this.url = init.url || null;\n        // Cache the ok value to avoid defining a getter.\n        this.ok = this.status >= 200 && this.status < 300;\n    }\n}\n/**\n * A partial HTTP response which only includes the status and header data,\n * but no response body.\n *\n * `HttpHeaderResponse` is a `HttpEvent` available on the response\n * event stream, only when progress events are requested.\n *\n * @publicApi\n */\nclass HttpHeaderResponse extends HttpResponseBase {\n    /**\n     * Create a new `HttpHeaderResponse` with the given parameters.\n     */\n    constructor(init = {}) {\n        super(init);\n        this.type = HttpEventType.ResponseHeader;\n    }\n    /**\n     * Copy this `HttpHeaderResponse`, overriding its contents with the\n     * given parameter hash.\n     */\n    clone(update = {}) {\n        // Perform a straightforward initialization of the new HttpHeaderResponse,\n        // overriding the current parameters with new ones if given.\n        return new HttpHeaderResponse({\n            headers: update.headers || this.headers,\n            status: update.status !== undefined ? update.status : this.status,\n            statusText: update.statusText || this.statusText,\n            url: update.url || this.url || undefined,\n        });\n    }\n}\n/**\n * A full HTTP response, including a typed response body (which may be `null`\n * if one was not returned).\n *\n * `HttpResponse` is a `HttpEvent` available on the response event\n * stream.\n *\n * @publicApi\n */\nclass HttpResponse extends HttpResponseBase {\n    /**\n     * Construct a new `HttpResponse`.\n     */\n    constructor(init = {}) {\n        super(init);\n        this.type = HttpEventType.Response;\n        this.body = init.body !== undefined ? init.body : null;\n    }\n    clone(update = {}) {\n        return new HttpResponse({\n            body: (update.body !== undefined) ? update.body : this.body,\n            headers: update.headers || this.headers,\n            status: (update.status !== undefined) ? update.status : this.status,\n            statusText: update.statusText || this.statusText,\n            url: update.url || this.url || undefined,\n        });\n    }\n}\n/**\n * A response that represents an error or failure, either from a\n * non-successful HTTP status, an error while executing the request,\n * or some other failure which occurred during the parsing of the response.\n *\n * Any error returned on the `Observable` response stream will be\n * wrapped in an `HttpErrorResponse` to provide additional context about\n * the state of the HTTP layer when the error occurred. The error property\n * will contain either a wrapped Error object or the error response returned\n * from the server.\n *\n * @publicApi\n */\nclass HttpErrorResponse extends HttpResponseBase {\n    constructor(init) {\n        // Initialize with a default status of 0 / Unknown Error.\n        super(init, 0, 'Unknown Error');\n        this.name = 'HttpErrorResponse';\n        /**\n         * Errors are never okay, even when the status code is in the 2xx success range.\n         */\n        this.ok = false;\n        // If the response was successful, then this was a parse error. Otherwise, it was\n        // a protocol-level failure of some sort. Either the request failed in transit\n        // or the server returned an unsuccessful status code.\n        if (this.status >= 200 && this.status < 300) {\n            this.message = `Http failure during parsing for ${init.url || '(unknown url)'}`;\n        }\n        else {\n            this.message = `Http failure response for ${init.url || '(unknown url)'}: ${init.status} ${init.statusText}`;\n        }\n        this.error = init.error || null;\n    }\n}\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * Constructs an instance of `HttpRequestOptions<T>` from a source `HttpMethodOptions` and\n * the given `body`. This function clones the object and adds the body.\n *\n * Note that the `responseType` *options* value is a String that identifies the\n * single data type of the response.\n * A single overload version of the method handles each response type.\n * The value of `responseType` cannot be a union, as the combined signature could imply.\n *\n */\nfunction addBody(options, body) {\n    return {\n        body,\n        headers: options.headers,\n        observe: options.observe,\n        params: options.params,\n        reportProgress: options.reportProgress,\n        responseType: options.responseType,\n        withCredentials: options.withCredentials,\n    };\n}\n/**\n * Performs HTTP requests.\n * This service is available as an injectable class, with methods to perform HTTP requests.\n * Each request method has multiple signatures, and the return type varies based on\n * the signature that is called (mainly the values of `observe` and `responseType`).\n *\n * Note that the `responseType` *options* value is a String that identifies the\n * single data type of the response.\n * A single overload version of the method handles each response type.\n * The value of `responseType` cannot be a union, as the combined signature could imply.\n\n *\n * @usageNotes\n * Sample HTTP requests for the [Tour of Heroes](/tutorial/toh-pt0) application.\n *\n * ### HTTP Request Example\n *\n * ```\n *  // GET heroes whose name contains search term\n * searchHeroes(term: string): observable<Hero[]>{\n *\n *  const params = new HttpParams({fromString: 'name=term'});\n *    return this.httpClient.request('GET', this.heroesUrl, {responseType:'json', params});\n * }\n * ```\n * ### JSONP Example\n * ```\n * requestJsonp(url, callback = 'callback') {\n *  return this.httpClient.jsonp(this.heroesURL, callback);\n * }\n * ```\n *\n * ### PATCH Example\n * ```\n * // PATCH one of the heroes' name\n * patchHero (id: number, heroName: string): Observable<{}> {\n * const url = `${this.heroesUrl}/${id}`;   // PATCH api/heroes/42\n *  return this.httpClient.patch(url, {name: heroName}, httpOptions)\n *    .pipe(catchError(this.handleError('patchHero')));\n * }\n * ```\n *\n * @see [HTTP Guide](guide/http)\n *\n * @publicApi\n */\nclass HttpClient {\n    constructor(handler) {\n        this.handler = handler;\n    }\n    /**\n     * Constructs an observable for a generic HTTP request that, when subscribed,\n     * fires the request through the chain of registered interceptors and on to the\n     * server.\n     *\n     * You can pass an `HttpRequest` directly as the only parameter. In this case,\n     * the call returns an observable of the raw `HttpEvent` stream.\n     *\n     * Alternatively you can pass an HTTP method as the first parameter,\n     * a URL string as the second, and an options hash containing the request body as the third.\n     * See `addBody()`. In this case, the specified `responseType` and `observe` options determine the\n     * type of returned observable.\n     *   * The `responseType` value determines how a successful response body is parsed.\n     *   * If `responseType` is the default `json`, you can pass a type interface for the resulting\n     * object as a type parameter to the call.\n     *\n     * The `observe` value determines the return type, according to what you are interested in\n     * observing.\n     *   * An `observe` value of events returns an observable of the raw `HttpEvent` stream, including\n     * progress events by default.\n     *   * An `observe` value of response returns an observable of `HttpResponse<T>`,\n     * where the `T` parameter depends on the `responseType` and any optionally provided type\n     * parameter.\n     *   * An `observe` value of body returns an observable of `<T>` with the same `T` body type.\n     *\n     */\n    request(first, url, options = {}) {\n        let req;\n        // First, check whether the primary argument is an instance of `HttpRequest`.\n        if (first instanceof HttpRequest) {\n            // It is. The other arguments must be undefined (per the signatures) and can be\n            // ignored.\n            req = first;\n        }\n        else {\n            // It's a string, so it represents a URL. Construct a request based on it,\n            // and incorporate the remaining arguments (assuming `GET` unless a method is\n            // provided.\n            // Figure out the headers.\n            let headers = undefined;\n            if (options.headers instanceof HttpHeaders) {\n                headers = options.headers;\n            }\n            else {\n                headers = new HttpHeaders(options.headers);\n            }\n            // Sort out parameters.\n            let params = undefined;\n            if (!!options.params) {\n                if (options.params instanceof HttpParams) {\n                    params = options.params;\n                }\n                else {\n                    params = new HttpParams({ fromObject: options.params });\n                }\n            }\n            // Construct the request.\n            req = new HttpRequest(first, url, (options.body !== undefined ? options.body : null), {\n                headers,\n                params,\n                reportProgress: options.reportProgress,\n                // By default, JSON is assumed to be returned for all calls.\n                responseType: options.responseType || 'json',\n                withCredentials: options.withCredentials,\n            });\n        }\n        // Start with an Observable.of() the initial request, and run the handler (which\n        // includes all interceptors) inside a concatMap(). This way, the handler runs\n        // inside an Observable chain, which causes interceptors to be re-run on every\n        // subscription (this also makes retries re-run the handler, including interceptors).\n        const events$ = of(req).pipe(concatMap((req) => this.handler.handle(req)));\n        // If coming via the API signature which accepts a previously constructed HttpRequest,\n        // the only option is to get the event stream. Otherwise, return the event stream if\n        // that is what was requested.\n        if (first instanceof HttpRequest || options.observe === 'events') {\n            return events$;\n        }\n        // The requested stream contains either the full response or the body. In either\n        // case, the first step is to filter the event stream to extract a stream of\n        // responses(s).\n        const res$ = events$.pipe(filter((event) => event instanceof HttpResponse));\n        // Decide which stream to return.\n        switch (options.observe || 'body') {\n            case 'body':\n                // The requested stream is the body. Map the response stream to the response\n                // body. This could be done more simply, but a misbehaving interceptor might\n                // transform the response body into a different format and ignore the requested\n                // responseType. Guard against this by validating that the response is of the\n                // requested type.\n                switch (req.responseType) {\n                    case 'arraybuffer':\n                        return res$.pipe(map((res) => {\n                            // Validate that the body is an ArrayBuffer.\n                            if (res.body !== null && !(res.body instanceof ArrayBuffer)) {\n                                throw new Error('Response is not an ArrayBuffer.');\n                            }\n                            return res.body;\n                        }));\n                    case 'blob':\n                        return res$.pipe(map((res) => {\n                            // Validate that the body is a Blob.\n                            if (res.body !== null && !(res.body instanceof Blob)) {\n                                throw new Error('Response is not a Blob.');\n                            }\n                            return res.body;\n                        }));\n                    case 'text':\n                        return res$.pipe(map((res) => {\n                            // Validate that the body is a string.\n                            if (res.body !== null && typeof res.body !== 'string') {\n                                throw new Error('Response is not a string.');\n                            }\n                            return res.body;\n                        }));\n                    case 'json':\n                    default:\n                        // No validation needed for JSON responses, as they can be of any type.\n                        return res$.pipe(map((res) => res.body));\n                }\n            case 'response':\n                // The response stream was requested directly, so return it.\n                return res$;\n            default:\n                // Guard against new future observe types being added.\n                throw new Error(`Unreachable: unhandled observe type ${options.observe}}`);\n        }\n    }\n    /**\n     * Constructs an observable that, when subscribed, causes the configured\n     * `DELETE` request to execute on the server. See the individual overloads for\n     * details on the return type.\n     *\n     * @param url     The endpoint URL.\n     * @param options The HTTP options to send with the request.\n     *\n     */\n    delete(url, options = {}) {\n        return this.request('DELETE', url, options);\n    }\n    /**\n     * Constructs an observable that, when subscribed, causes the configured\n     * `GET` request to execute on the server. See the individual overloads for\n     * details on the return type.\n     */\n    get(url, options = {}) {\n        return this.request('GET', url, options);\n    }\n    /**\n     * Constructs an observable that, when subscribed, causes the configured\n     * `HEAD` request to execute on the server. The `HEAD` method returns\n     * meta information about the resource without transferring the\n     * resource itself. See the individual overloads for\n     * details on the return type.\n     */\n    head(url, options = {}) {\n        return this.request('HEAD', url, options);\n    }\n    /**\n     * Constructs an `Observable` that, when subscribed, causes a request with the special method\n     * `JSONP` to be dispatched via the interceptor pipeline.\n     * The [JSONP pattern](https://en.wikipedia.org/wiki/JSONP) works around limitations of certain\n     * API endpoints that don't support newer,\n     * and preferable [CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS) protocol.\n     * JSONP treats the endpoint API as a JavaScript file and tricks the browser to process the\n     * requests even if the API endpoint is not located on the same domain (origin) as the client-side\n     * application making the request.\n     * The endpoint API must support JSONP callback for JSONP requests to work.\n     * The resource API returns the JSON response wrapped in a callback function.\n     * You can pass the callback function name as one of the query parameters.\n     * Note that JSONP requests can only be used with `GET` requests.\n     *\n     * @param url The resource URL.\n     * @param callbackParam The callback function name.\n     *\n     */\n    jsonp(url, callbackParam) {\n        return this.request('JSONP', url, {\n            params: new HttpParams().append(callbackParam, 'JSONP_CALLBACK'),\n            observe: 'body',\n            responseType: 'json',\n        });\n    }\n    /**\n     * Constructs an `Observable` that, when subscribed, causes the configured\n     * `OPTIONS` request to execute on the server. This method allows the client\n     * to determine the supported HTTP methods and other capabilites of an endpoint,\n     * without implying a resource action. See the individual overloads for\n     * details on the return type.\n     */\n    options(url, options = {}) {\n        return this.request('OPTIONS', url, options);\n    }\n    /**\n     * Constructs an observable that, when subscribed, causes the configured\n     * `PATCH` request to execute on the server. See the individual overloads for\n     * details on the return type.\n     */\n    patch(url, body, options = {}) {\n        return this.request('PATCH', url, addBody(options, body));\n    }\n    /**\n     * Constructs an observable that, when subscribed, causes the configured\n     * `POST` request to execute on the server. The server responds with the location of\n     * the replaced resource. See the individual overloads for\n     * details on the return type.\n     */\n    post(url, body, options = {}) {\n        return this.request('POST', url, addBody(options, body));\n    }\n    /**\n     * Constructs an observable that, when subscribed, causes the configured\n     * `PUT` request to execute on the server. The `PUT` method replaces an existing resource\n     * with a new set of values.\n     * See the individual overloads for details on the return type.\n     */\n    put(url, body, options = {}) {\n        return this.request('PUT', url, addBody(options, body));\n    }\n}\nHttpClient.ɵfac = function HttpClient_Factory(t) { return new (t || HttpClient)(ɵngcc0.ɵɵinject(HttpHandler)); };\nHttpClient.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: HttpClient, factory: HttpClient.ɵfac });\nHttpClient.ctorParameters = () => [\n    { type: HttpHandler }\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HttpClient, [{\n        type: Injectable\n    }], function () { return [{ type: HttpHandler }]; }, null); })();\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * `HttpHandler` which applies an `HttpInterceptor` to an `HttpRequest`.\n *\n *\n */\nclass HttpInterceptorHandler {\n    constructor(next, interceptor) {\n        this.next = next;\n        this.interceptor = interceptor;\n    }\n    handle(req) {\n        return this.interceptor.intercept(req, this.next);\n    }\n}\n/**\n * A multi-provider token that represents the array of registered\n * `HttpInterceptor` objects.\n *\n * @publicApi\n */\nconst HTTP_INTERCEPTORS = new InjectionToken('HTTP_INTERCEPTORS');\nclass NoopInterceptor {\n    intercept(req, next) {\n        return next.handle(req);\n    }\n}\nNoopInterceptor.ɵfac = function NoopInterceptor_Factory(t) { return new (t || NoopInterceptor)(); };\nNoopInterceptor.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: NoopInterceptor, factory: NoopInterceptor.ɵfac });\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NoopInterceptor, [{\n        type: Injectable\n    }], null, null); })();\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n// Every request made through JSONP needs a callback name that's unique across the\n// whole page. Each request is assigned an id and the callback name is constructed\n// from that. The next id to be assigned is tracked in a global variable here that\n// is shared among all applications on the page.\nlet nextRequestId = 0;\n// Error text given when a JSONP script is injected, but doesn't invoke the callback\n// passed in its URL.\nconst JSONP_ERR_NO_CALLBACK = 'JSONP injected script did not invoke callback.';\n// Error text given when a request is passed to the JsonpClientBackend that doesn't\n// have a request method JSONP.\nconst JSONP_ERR_WRONG_METHOD = 'JSONP requests must use JSONP request method.';\nconst JSONP_ERR_WRONG_RESPONSE_TYPE = 'JSONP requests must use Json response type.';\n/**\n * DI token/abstract type representing a map of JSONP callbacks.\n *\n * In the browser, this should always be the `window` object.\n *\n *\n */\nclass JsonpCallbackContext {\n}\n/**\n * Processes an `HttpRequest` with the JSONP method,\n * by performing JSONP style requests.\n * @see `HttpHandler`\n * @see `HttpXhrBackend`\n *\n * @publicApi\n */\nclass JsonpClientBackend {\n    constructor(callbackMap, document) {\n        this.callbackMap = callbackMap;\n        this.document = document;\n        /**\n         * A resolved promise that can be used to schedule microtasks in the event handlers.\n         */\n        this.resolvedPromise = Promise.resolve();\n    }\n    /**\n     * Get the name of the next callback method, by incrementing the global `nextRequestId`.\n     */\n    nextCallback() {\n        return `ng_jsonp_callback_${nextRequestId++}`;\n    }\n    /**\n     * Processes a JSONP request and returns an event stream of the results.\n     * @param req The request object.\n     * @returns An observable of the response events.\n     *\n     */\n    handle(req) {\n        // Firstly, check both the method and response type. If either doesn't match\n        // then the request was improperly routed here and cannot be handled.\n        if (req.method !== 'JSONP') {\n            throw new Error(JSONP_ERR_WRONG_METHOD);\n        }\n        else if (req.responseType !== 'json') {\n            throw new Error(JSONP_ERR_WRONG_RESPONSE_TYPE);\n        }\n        // Everything else happens inside the Observable boundary.\n        return new Observable((observer) => {\n            // The first step to make a request is to generate the callback name, and replace the\n            // callback placeholder in the URL with the name. Care has to be taken here to ensure\n            // a trailing &, if matched, gets inserted back into the URL in the correct place.\n            const callback = this.nextCallback();\n            const url = req.urlWithParams.replace(/=JSONP_CALLBACK(&|$)/, `=${callback}$1`);\n            // Construct the <script> tag and point it at the URL.\n            const node = this.document.createElement('script');\n            node.src = url;\n            // A JSONP request requires waiting for multiple callbacks. These variables\n            // are closed over and track state across those callbacks.\n            // The response object, if one has been received, or null otherwise.\n            let body = null;\n            // Whether the response callback has been called.\n            let finished = false;\n            // Whether the request has been cancelled (and thus any other callbacks)\n            // should be ignored.\n            let cancelled = false;\n            // Set the response callback in this.callbackMap (which will be the window\n            // object in the browser. The script being loaded via the <script> tag will\n            // eventually call this callback.\n            this.callbackMap[callback] = (data) => {\n                // Data has been received from the JSONP script. Firstly, delete this callback.\n                delete this.callbackMap[callback];\n                // Next, make sure the request wasn't cancelled in the meantime.\n                if (cancelled) {\n                    return;\n                }\n                // Set state to indicate data was received.\n                body = data;\n                finished = true;\n            };\n            // cleanup() is a utility closure that removes the <script> from the page and\n            // the response callback from the window. This logic is used in both the\n            // success, error, and cancellation paths, so it's extracted out for convenience.\n            const cleanup = () => {\n                // Remove the <script> tag if it's still on the page.\n                if (node.parentNode) {\n                    node.parentNode.removeChild(node);\n                }\n                // Remove the response callback from the callbackMap (window object in the\n                // browser).\n                delete this.callbackMap[callback];\n            };\n            // onLoad() is the success callback which runs after the response callback\n            // if the JSONP script loads successfully. The event itself is unimportant.\n            // If something went wrong, onLoad() may run without the response callback\n            // having been invoked.\n            const onLoad = (event) => {\n                // Do nothing if the request has been cancelled.\n                if (cancelled) {\n                    return;\n                }\n                // We wrap it in an extra Promise, to ensure the microtask\n                // is scheduled after the loaded endpoint has executed any potential microtask itself,\n                // which is not guaranteed in Internet Explorer and EdgeHTML. See issue #39496\n                this.resolvedPromise.then(() => {\n                    // Cleanup the page.\n                    cleanup();\n                    // Check whether the response callback has run.\n                    if (!finished) {\n                        // It hasn't, something went wrong with the request. Return an error via\n                        // the Observable error path. All JSONP errors have status 0.\n                        observer.error(new HttpErrorResponse({\n                            url,\n                            status: 0,\n                            statusText: 'JSONP Error',\n                            error: new Error(JSONP_ERR_NO_CALLBACK),\n                        }));\n                        return;\n                    }\n                    // Success. body either contains the response body or null if none was\n                    // returned.\n                    observer.next(new HttpResponse({\n                        body,\n                        status: 200,\n                        statusText: 'OK',\n                        url,\n                    }));\n                    // Complete the stream, the response is over.\n                    observer.complete();\n                });\n            };\n            // onError() is the error callback, which runs if the script returned generates\n            // a Javascript error. It emits the error via the Observable error channel as\n            // a HttpErrorResponse.\n            const onError = (error) => {\n                // If the request was already cancelled, no need to emit anything.\n                if (cancelled) {\n                    return;\n                }\n                cleanup();\n                // Wrap the error in a HttpErrorResponse.\n                observer.error(new HttpErrorResponse({\n                    error,\n                    status: 0,\n                    statusText: 'JSONP Error',\n                    url,\n                }));\n            };\n            // Subscribe to both the success (load) and error events on the <script> tag,\n            // and add it to the page.\n            node.addEventListener('load', onLoad);\n            node.addEventListener('error', onError);\n            this.document.body.appendChild(node);\n            // The request has now been successfully sent.\n            observer.next({ type: HttpEventType.Sent });\n            // Cancellation handler.\n            return () => {\n                // Track the cancellation so event listeners won't do anything even if already scheduled.\n                cancelled = true;\n                // Remove the event listeners so they won't run if the events later fire.\n                node.removeEventListener('load', onLoad);\n                node.removeEventListener('error', onError);\n                // And finally, clean up the page.\n                cleanup();\n            };\n        });\n    }\n}\nJsonpClientBackend.ɵfac = function JsonpClientBackend_Factory(t) { return new (t || JsonpClientBackend)(ɵngcc0.ɵɵinject(JsonpCallbackContext), ɵngcc0.ɵɵinject(DOCUMENT)); };\nJsonpClientBackend.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: JsonpClientBackend, factory: JsonpClientBackend.ɵfac });\nJsonpClientBackend.ctorParameters = () => [\n    { type: JsonpCallbackContext },\n    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(JsonpClientBackend, [{\n        type: Injectable\n    }], function () { return [{ type: JsonpCallbackContext }, { type: undefined, decorators: [{\n                type: Inject,\n                args: [DOCUMENT]\n            }] }]; }, null); })();\n/**\n * Identifies requests with the method JSONP and\n * shifts them to the `JsonpClientBackend`.\n *\n * @see `HttpInterceptor`\n *\n * @publicApi\n */\nclass JsonpInterceptor {\n    constructor(jsonp) {\n        this.jsonp = jsonp;\n    }\n    /**\n     * Identifies and handles a given JSONP request.\n     * @param req The outgoing request object to handle.\n     * @param next The next interceptor in the chain, or the backend\n     * if no interceptors remain in the chain.\n     * @returns An observable of the event stream.\n     */\n    intercept(req, next) {\n        if (req.method === 'JSONP') {\n            return this.jsonp.handle(req);\n        }\n        // Fall through for normal HTTP requests.\n        return next.handle(req);\n    }\n}\nJsonpInterceptor.ɵfac = function JsonpInterceptor_Factory(t) { return new (t || JsonpInterceptor)(ɵngcc0.ɵɵinject(JsonpClientBackend)); };\nJsonpInterceptor.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: JsonpInterceptor, factory: JsonpInterceptor.ɵfac });\nJsonpInterceptor.ctorParameters = () => [\n    { type: JsonpClientBackend }\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(JsonpInterceptor, [{\n        type: Injectable\n    }], function () { return [{ type: JsonpClientBackend }]; }, null); })();\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nconst XSSI_PREFIX = /^\\)\\]\\}',?\\n/;\n/**\n * Determine an appropriate URL for the response, by checking either\n * XMLHttpRequest.responseURL or the X-Request-URL header.\n */\nfunction getResponseUrl(xhr) {\n    if ('responseURL' in xhr && xhr.responseURL) {\n        return xhr.responseURL;\n    }\n    if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {\n        return xhr.getResponseHeader('X-Request-URL');\n    }\n    return null;\n}\n/**\n * A wrapper around the `XMLHttpRequest` constructor.\n *\n * @publicApi\n */\nclass XhrFactory {\n}\n/**\n * A factory for `HttpXhrBackend` that uses the `XMLHttpRequest` browser API.\n *\n */\nclass BrowserXhr {\n    constructor() { }\n    build() {\n        return (new XMLHttpRequest());\n    }\n}\nBrowserXhr.ɵfac = function BrowserXhr_Factory(t) { return new (t || BrowserXhr)(); };\nBrowserXhr.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: BrowserXhr, factory: BrowserXhr.ɵfac });\nBrowserXhr.ctorParameters = () => [];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(BrowserXhr, [{\n        type: Injectable\n    }], function () { return []; }, null); })();\n/**\n * Uses `XMLHttpRequest` to send requests to a backend server.\n * @see `HttpHandler`\n * @see `JsonpClientBackend`\n *\n * @publicApi\n */\nclass HttpXhrBackend {\n    constructor(xhrFactory) {\n        this.xhrFactory = xhrFactory;\n    }\n    /**\n     * Processes a request and returns a stream of response events.\n     * @param req The request object.\n     * @returns An observable of the response events.\n     */\n    handle(req) {\n        // Quick check to give a better error message when a user attempts to use\n        // HttpClient.jsonp() without installing the HttpClientJsonpModule\n        if (req.method === 'JSONP') {\n            throw new Error(`Attempted to construct Jsonp request without HttpClientJsonpModule installed.`);\n        }\n        // Everything happens on Observable subscription.\n        return new Observable((observer) => {\n            // Start by setting up the XHR object with request method, URL, and withCredentials flag.\n            const xhr = this.xhrFactory.build();\n            xhr.open(req.method, req.urlWithParams);\n            if (!!req.withCredentials) {\n                xhr.withCredentials = true;\n            }\n            // Add all the requested headers.\n            req.headers.forEach((name, values) => xhr.setRequestHeader(name, values.join(',')));\n            // Add an Accept header if one isn't present already.\n            if (!req.headers.has('Accept')) {\n                xhr.setRequestHeader('Accept', 'application/json, text/plain, */*');\n            }\n            // Auto-detect the Content-Type header if one isn't present already.\n            if (!req.headers.has('Content-Type')) {\n                const detectedType = req.detectContentTypeHeader();\n                // Sometimes Content-Type detection fails.\n                if (detectedType !== null) {\n                    xhr.setRequestHeader('Content-Type', detectedType);\n                }\n            }\n            // Set the responseType if one was requested.\n            if (req.responseType) {\n                const responseType = req.responseType.toLowerCase();\n                // JSON responses need to be processed as text. This is because if the server\n                // returns an XSSI-prefixed JSON response, the browser will fail to parse it,\n                // xhr.response will be null, and xhr.responseText cannot be accessed to\n                // retrieve the prefixed JSON data in order to strip the prefix. Thus, all JSON\n                // is parsed by first requesting text and then applying JSON.parse.\n                xhr.responseType = ((responseType !== 'json') ? responseType : 'text');\n            }\n            // Serialize the request body if one is present. If not, this will be set to null.\n            const reqBody = req.serializeBody();\n            // If progress events are enabled, response headers will be delivered\n            // in two events - the HttpHeaderResponse event and the full HttpResponse\n            // event. However, since response headers don't change in between these\n            // two events, it doesn't make sense to parse them twice. So headerResponse\n            // caches the data extracted from the response whenever it's first parsed,\n            // to ensure parsing isn't duplicated.\n            let headerResponse = null;\n            // partialFromXhr extracts the HttpHeaderResponse from the current XMLHttpRequest\n            // state, and memoizes it into headerResponse.\n            const partialFromXhr = () => {\n                if (headerResponse !== null) {\n                    return headerResponse;\n                }\n                // Read status and normalize an IE9 bug (https://bugs.jquery.com/ticket/1450).\n                const status = xhr.status === 1223 ? 204 : xhr.status;\n                const statusText = xhr.statusText || 'OK';\n                // Parse headers from XMLHttpRequest - this step is lazy.\n                const headers = new HttpHeaders(xhr.getAllResponseHeaders());\n                // Read the response URL from the XMLHttpResponse instance and fall back on the\n                // request URL.\n                const url = getResponseUrl(xhr) || req.url;\n                // Construct the HttpHeaderResponse and memoize it.\n                headerResponse = new HttpHeaderResponse({ headers, status, statusText, url });\n                return headerResponse;\n            };\n            // Next, a few closures are defined for the various events which XMLHttpRequest can\n            // emit. This allows them to be unregistered as event listeners later.\n            // First up is the load event, which represents a response being fully available.\n            const onLoad = () => {\n                // Read response state from the memoized partial data.\n                let { headers, status, statusText, url } = partialFromXhr();\n                // The body will be read out if present.\n                let body = null;\n                if (status !== 204) {\n                    // Use XMLHttpRequest.response if set, responseText otherwise.\n                    body = (typeof xhr.response === 'undefined') ? xhr.responseText : xhr.response;\n                }\n                // Normalize another potential bug (this one comes from CORS).\n                if (status === 0) {\n                    status = !!body ? 200 : 0;\n                }\n                // ok determines whether the response will be transmitted on the event or\n                // error channel. Unsuccessful status codes (not 2xx) will always be errors,\n                // but a successful status code can still result in an error if the user\n                // asked for JSON data and the body cannot be parsed as such.\n                let ok = status >= 200 && status < 300;\n                // Check whether the body needs to be parsed as JSON (in many cases the browser\n                // will have done that already).\n                if (req.responseType === 'json' && typeof body === 'string') {\n                    // Save the original body, before attempting XSSI prefix stripping.\n                    const originalBody = body;\n                    body = body.replace(XSSI_PREFIX, '');\n                    try {\n                        // Attempt the parse. If it fails, a parse error should be delivered to the user.\n                        body = body !== '' ? JSON.parse(body) : null;\n                    }\n                    catch (error) {\n                        // Since the JSON.parse failed, it's reasonable to assume this might not have been a\n                        // JSON response. Restore the original body (including any XSSI prefix) to deliver\n                        // a better error response.\n                        body = originalBody;\n                        // If this was an error request to begin with, leave it as a string, it probably\n                        // just isn't JSON. Otherwise, deliver the parsing error to the user.\n                        if (ok) {\n                            // Even though the response status was 2xx, this is still an error.\n                            ok = false;\n                            // The parse error contains the text of the body that failed to parse.\n                            body = { error, text: body };\n                        }\n                    }\n                }\n                if (ok) {\n                    // A successful response is delivered on the event stream.\n                    observer.next(new HttpResponse({\n                        body,\n                        headers,\n                        status,\n                        statusText,\n                        url: url || undefined,\n                    }));\n                    // The full body has been received and delivered, no further events\n                    // are possible. This request is complete.\n                    observer.complete();\n                }\n                else {\n                    // An unsuccessful request is delivered on the error channel.\n                    observer.error(new HttpErrorResponse({\n                        // The error in this case is the response body (error from the server).\n                        error: body,\n                        headers,\n                        status,\n                        statusText,\n                        url: url || undefined,\n                    }));\n                }\n            };\n            // The onError callback is called when something goes wrong at the network level.\n            // Connection timeout, DNS error, offline, etc. These are actual errors, and are\n            // transmitted on the error channel.\n            const onError = (error) => {\n                const { url } = partialFromXhr();\n                const res = new HttpErrorResponse({\n                    error,\n                    status: xhr.status || 0,\n                    statusText: xhr.statusText || 'Unknown Error',\n                    url: url || undefined,\n                });\n                observer.error(res);\n            };\n            // The sentHeaders flag tracks whether the HttpResponseHeaders event\n            // has been sent on the stream. This is necessary to track if progress\n            // is enabled since the event will be sent on only the first download\n            // progerss event.\n            let sentHeaders = false;\n            // The download progress event handler, which is only registered if\n            // progress events are enabled.\n            const onDownProgress = (event) => {\n                // Send the HttpResponseHeaders event if it hasn't been sent already.\n                if (!sentHeaders) {\n                    observer.next(partialFromXhr());\n                    sentHeaders = true;\n                }\n                // Start building the download progress event to deliver on the response\n                // event stream.\n                let progressEvent = {\n                    type: HttpEventType.DownloadProgress,\n                    loaded: event.loaded,\n                };\n                // Set the total number of bytes in the event if it's available.\n                if (event.lengthComputable) {\n                    progressEvent.total = event.total;\n                }\n                // If the request was for text content and a partial response is\n                // available on XMLHttpRequest, include it in the progress event\n                // to allow for streaming reads.\n                if (req.responseType === 'text' && !!xhr.responseText) {\n                    progressEvent.partialText = xhr.responseText;\n                }\n                // Finally, fire the event.\n                observer.next(progressEvent);\n            };\n            // The upload progress event handler, which is only registered if\n            // progress events are enabled.\n            const onUpProgress = (event) => {\n                // Upload progress events are simpler. Begin building the progress\n                // event.\n                let progress = {\n                    type: HttpEventType.UploadProgress,\n                    loaded: event.loaded,\n                };\n                // If the total number of bytes being uploaded is available, include\n                // it.\n                if (event.lengthComputable) {\n                    progress.total = event.total;\n                }\n                // Send the event.\n                observer.next(progress);\n            };\n            // By default, register for load and error events.\n            xhr.addEventListener('load', onLoad);\n            xhr.addEventListener('error', onError);\n            xhr.addEventListener('timeout', onError);\n            xhr.addEventListener('abort', onError);\n            // Progress events are only enabled if requested.\n            if (req.reportProgress) {\n                // Download progress is always enabled if requested.\n                xhr.addEventListener('progress', onDownProgress);\n                // Upload progress depends on whether there is a body to upload.\n                if (reqBody !== null && xhr.upload) {\n                    xhr.upload.addEventListener('progress', onUpProgress);\n                }\n            }\n            // Fire the request, and notify the event stream that it was fired.\n            xhr.send(reqBody);\n            observer.next({ type: HttpEventType.Sent });\n            // This is the return from the Observable function, which is the\n            // request cancellation handler.\n            return () => {\n                // On a cancellation, remove all registered event listeners.\n                xhr.removeEventListener('error', onError);\n                xhr.removeEventListener('abort', onError);\n                xhr.removeEventListener('load', onLoad);\n                xhr.removeEventListener('timeout', onError);\n                if (req.reportProgress) {\n                    xhr.removeEventListener('progress', onDownProgress);\n                    if (reqBody !== null && xhr.upload) {\n                        xhr.upload.removeEventListener('progress', onUpProgress);\n                    }\n                }\n                // Finally, abort the in-flight request.\n                if (xhr.readyState !== xhr.DONE) {\n                    xhr.abort();\n                }\n            };\n        });\n    }\n}\nHttpXhrBackend.ɵfac = function HttpXhrBackend_Factory(t) { return new (t || HttpXhrBackend)(ɵngcc0.ɵɵinject(XhrFactory)); };\nHttpXhrBackend.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: HttpXhrBackend, factory: HttpXhrBackend.ɵfac });\nHttpXhrBackend.ctorParameters = () => [\n    { type: XhrFactory }\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HttpXhrBackend, [{\n        type: Injectable\n    }], function () { return [{ type: XhrFactory }]; }, null); })();\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nconst XSRF_COOKIE_NAME = new InjectionToken('XSRF_COOKIE_NAME');\nconst XSRF_HEADER_NAME = new InjectionToken('XSRF_HEADER_NAME');\n/**\n * Retrieves the current XSRF token to use with the next outgoing request.\n *\n * @publicApi\n */\nclass HttpXsrfTokenExtractor {\n}\n/**\n * `HttpXsrfTokenExtractor` which retrieves the token from a cookie.\n */\nclass HttpXsrfCookieExtractor {\n    constructor(doc, platform, cookieName) {\n        this.doc = doc;\n        this.platform = platform;\n        this.cookieName = cookieName;\n        this.lastCookieString = '';\n        this.lastToken = null;\n        /**\n         * @internal for testing\n         */\n        this.parseCount = 0;\n    }\n    getToken() {\n        if (this.platform === 'server') {\n            return null;\n        }\n        const cookieString = this.doc.cookie || '';\n        if (cookieString !== this.lastCookieString) {\n            this.parseCount++;\n            this.lastToken = ɵparseCookieValue(cookieString, this.cookieName);\n            this.lastCookieString = cookieString;\n        }\n        return this.lastToken;\n    }\n}\nHttpXsrfCookieExtractor.ɵfac = function HttpXsrfCookieExtractor_Factory(t) { return new (t || HttpXsrfCookieExtractor)(ɵngcc0.ɵɵinject(DOCUMENT), ɵngcc0.ɵɵinject(PLATFORM_ID), ɵngcc0.ɵɵinject(XSRF_COOKIE_NAME)); };\nHttpXsrfCookieExtractor.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: HttpXsrfCookieExtractor, factory: HttpXsrfCookieExtractor.ɵfac });\nHttpXsrfCookieExtractor.ctorParameters = () => [\n    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] },\n    { type: String, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] },\n    { type: String, decorators: [{ type: Inject, args: [XSRF_COOKIE_NAME,] }] }\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HttpXsrfCookieExtractor, [{\n        type: Injectable\n    }], function () { return [{ type: undefined, decorators: [{\n                type: Inject,\n                args: [DOCUMENT]\n            }] }, { type: String, decorators: [{\n                type: Inject,\n                args: [PLATFORM_ID]\n            }] }, { type: String, decorators: [{\n                type: Inject,\n                args: [XSRF_COOKIE_NAME]\n            }] }]; }, null); })();\n/**\n * `HttpInterceptor` which adds an XSRF token to eligible outgoing requests.\n */\nclass HttpXsrfInterceptor {\n    constructor(tokenService, headerName) {\n        this.tokenService = tokenService;\n        this.headerName = headerName;\n    }\n    intercept(req, next) {\n        const lcUrl = req.url.toLowerCase();\n        // Skip both non-mutating requests and absolute URLs.\n        // Non-mutating requests don't require a token, and absolute URLs require special handling\n        // anyway as the cookie set\n        // on our origin is not the same as the token expected by another origin.\n        if (req.method === 'GET' || req.method === 'HEAD' || lcUrl.startsWith('http://') ||\n            lcUrl.startsWith('https://')) {\n            return next.handle(req);\n        }\n        const token = this.tokenService.getToken();\n        // Be careful not to overwrite an existing header of the same name.\n        if (token !== null && !req.headers.has(this.headerName)) {\n            req = req.clone({ headers: req.headers.set(this.headerName, token) });\n        }\n        return next.handle(req);\n    }\n}\nHttpXsrfInterceptor.ɵfac = function HttpXsrfInterceptor_Factory(t) { return new (t || HttpXsrfInterceptor)(ɵngcc0.ɵɵinject(HttpXsrfTokenExtractor), ɵngcc0.ɵɵinject(XSRF_HEADER_NAME)); };\nHttpXsrfInterceptor.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: HttpXsrfInterceptor, factory: HttpXsrfInterceptor.ɵfac });\nHttpXsrfInterceptor.ctorParameters = () => [\n    { type: HttpXsrfTokenExtractor },\n    { type: String, decorators: [{ type: Inject, args: [XSRF_HEADER_NAME,] }] }\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HttpXsrfInterceptor, [{\n        type: Injectable\n    }], function () { return [{ type: HttpXsrfTokenExtractor }, { type: String, decorators: [{\n                type: Inject,\n                args: [XSRF_HEADER_NAME]\n            }] }]; }, null); })();\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * An injectable `HttpHandler` that applies multiple interceptors\n * to a request before passing it to the given `HttpBackend`.\n *\n * The interceptors are loaded lazily from the injector, to allow\n * interceptors to themselves inject classes depending indirectly\n * on `HttpInterceptingHandler` itself.\n * @see `HttpInterceptor`\n */\nclass HttpInterceptingHandler {\n    constructor(backend, injector) {\n        this.backend = backend;\n        this.injector = injector;\n        this.chain = null;\n    }\n    handle(req) {\n        if (this.chain === null) {\n            const interceptors = this.injector.get(HTTP_INTERCEPTORS, []);\n            this.chain = interceptors.reduceRight((next, interceptor) => new HttpInterceptorHandler(next, interceptor), this.backend);\n        }\n        return this.chain.handle(req);\n    }\n}\nHttpInterceptingHandler.ɵfac = function HttpInterceptingHandler_Factory(t) { return new (t || HttpInterceptingHandler)(ɵngcc0.ɵɵinject(HttpBackend), ɵngcc0.ɵɵinject(ɵngcc0.Injector)); };\nHttpInterceptingHandler.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: HttpInterceptingHandler, factory: HttpInterceptingHandler.ɵfac });\nHttpInterceptingHandler.ctorParameters = () => [\n    { type: HttpBackend },\n    { type: Injector }\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HttpInterceptingHandler, [{\n        type: Injectable\n    }], function () { return [{ type: HttpBackend }, { type: ɵngcc0.Injector }]; }, null); })();\n/**\n * Constructs an `HttpHandler` that applies interceptors\n * to a request before passing it to the given `HttpBackend`.\n *\n * Use as a factory function within `HttpClientModule`.\n *\n *\n */\nfunction interceptingHandler(backend, interceptors = []) {\n    if (!interceptors) {\n        return backend;\n    }\n    return interceptors.reduceRight((next, interceptor) => new HttpInterceptorHandler(next, interceptor), backend);\n}\n/**\n * Factory function that determines where to store JSONP callbacks.\n *\n * Ordinarily JSONP callbacks are stored on the `window` object, but this may not exist\n * in test environments. In that case, callbacks are stored on an anonymous object instead.\n *\n *\n */\nfunction jsonpCallbackContext() {\n    if (typeof window === 'object') {\n        return window;\n    }\n    return {};\n}\n/**\n * Configures XSRF protection support for outgoing requests.\n *\n * For a server that supports a cookie-based XSRF protection system,\n * use directly to configure XSRF protection with the correct\n * cookie and header names.\n *\n * If no names are supplied, the default cookie name is `XSRF-TOKEN`\n * and the default header name is `X-XSRF-TOKEN`.\n *\n * @publicApi\n */\nclass HttpClientXsrfModule {\n    /**\n     * Disable the default XSRF protection.\n     */\n    static disable() {\n        return {\n            ngModule: HttpClientXsrfModule,\n            providers: [\n                { provide: HttpXsrfInterceptor, useClass: NoopInterceptor },\n            ],\n        };\n    }\n    /**\n     * Configure XSRF protection.\n     * @param options An object that can specify either or both\n     * cookie name or header name.\n     * - Cookie name default is `XSRF-TOKEN`.\n     * - Header name default is `X-XSRF-TOKEN`.\n     *\n     */\n    static withOptions(options = {}) {\n        return {\n            ngModule: HttpClientXsrfModule,\n            providers: [\n                options.cookieName ? { provide: XSRF_COOKIE_NAME, useValue: options.cookieName } : [],\n                options.headerName ? { provide: XSRF_HEADER_NAME, useValue: options.headerName } : [],\n            ],\n        };\n    }\n}\nHttpClientXsrfModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: HttpClientXsrfModule });\nHttpClientXsrfModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function HttpClientXsrfModule_Factory(t) { return new (t || HttpClientXsrfModule)(); }, providers: [\n        HttpXsrfInterceptor,\n        { provide: HTTP_INTERCEPTORS, useExisting: HttpXsrfInterceptor, multi: true },\n        { provide: HttpXsrfTokenExtractor, useClass: HttpXsrfCookieExtractor },\n        { provide: XSRF_COOKIE_NAME, useValue: 'XSRF-TOKEN' },\n        { provide: XSRF_HEADER_NAME, useValue: 'X-XSRF-TOKEN' },\n    ] });\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HttpClientXsrfModule, [{\n        type: NgModule,\n        args: [{\n                providers: [\n                    HttpXsrfInterceptor,\n                    { provide: HTTP_INTERCEPTORS, useExisting: HttpXsrfInterceptor, multi: true },\n                    { provide: HttpXsrfTokenExtractor, useClass: HttpXsrfCookieExtractor },\n                    { provide: XSRF_COOKIE_NAME, useValue: 'XSRF-TOKEN' },\n                    { provide: XSRF_HEADER_NAME, useValue: 'X-XSRF-TOKEN' },\n                ]\n            }]\n    }], null, null); })();\n/**\n * Configures the [dependency injector](guide/glossary#injector) for `HttpClient`\n * with supporting services for XSRF. Automatically imported by `HttpClientModule`.\n *\n * You can add interceptors to the chain behind `HttpClient` by binding them to the\n * multiprovider for built-in [DI token](guide/glossary#di-token) `HTTP_INTERCEPTORS`.\n *\n * @publicApi\n */\nclass HttpClientModule {\n}\nHttpClientModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: HttpClientModule });\nHttpClientModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function HttpClientModule_Factory(t) { return new (t || HttpClientModule)(); }, providers: [\n        HttpClient,\n        { provide: HttpHandler, useClass: HttpInterceptingHandler },\n        HttpXhrBackend,\n        { provide: HttpBackend, useExisting: HttpXhrBackend },\n        BrowserXhr,\n        { provide: XhrFactory, useExisting: BrowserXhr },\n    ], imports: [[\n            HttpClientXsrfModule.withOptions({\n                cookieName: 'XSRF-TOKEN',\n                headerName: 'X-XSRF-TOKEN'\n            }),\n        ]] });\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(HttpClientModule, { imports: [HttpClientXsrfModule] }); })();\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HttpClientModule, [{\n        type: NgModule,\n        args: [{\n                /**\n                 * Optional configuration for XSRF protection.\n                 */\n                imports: [\n                    HttpClientXsrfModule.withOptions({\n                        cookieName: 'XSRF-TOKEN',\n                        headerName: 'X-XSRF-TOKEN'\n                    }),\n                ],\n                /**\n                 * Configures the [dependency injector](guide/glossary#injector) where it is imported\n                 * with supporting services for HTTP communications.\n                 */\n                providers: [\n                    HttpClient,\n                    { provide: HttpHandler, useClass: HttpInterceptingHandler },\n                    HttpXhrBackend,\n                    { provide: HttpBackend, useExisting: HttpXhrBackend },\n                    BrowserXhr,\n                    { provide: XhrFactory, useExisting: BrowserXhr },\n                ]\n            }]\n    }], null, null); })();\n/**\n * Configures the [dependency injector](guide/glossary#injector) for `HttpClient`\n * with supporting services for JSONP.\n * Without this module, Jsonp requests reach the backend\n * with method JSONP, where they are rejected.\n *\n * You can add interceptors to the chain behind `HttpClient` by binding them to the\n * multiprovider for built-in [DI token](guide/glossary#di-token) `HTTP_INTERCEPTORS`.\n *\n * @publicApi\n */\nclass HttpClientJsonpModule {\n}\nHttpClientJsonpModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: HttpClientJsonpModule });\nHttpClientJsonpModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function HttpClientJsonpModule_Factory(t) { return new (t || HttpClientJsonpModule)(); }, providers: [\n        JsonpClientBackend,\n        { provide: JsonpCallbackContext, useFactory: jsonpCallbackContext },\n        { provide: HTTP_INTERCEPTORS, useClass: JsonpInterceptor, multi: true },\n    ] });\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HttpClientJsonpModule, [{\n        type: NgModule,\n        args: [{\n                providers: [\n                    JsonpClientBackend,\n                    { provide: JsonpCallbackContext, useFactory: jsonpCallbackContext },\n                    { provide: HTTP_INTERCEPTORS, useClass: JsonpInterceptor, multi: true },\n                ]\n            }]\n    }], null, null); })();\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { HTTP_INTERCEPTORS, HttpBackend, HttpClient, HttpClientJsonpModule, HttpClientModule, HttpClientXsrfModule, HttpErrorResponse, HttpEventType, HttpHandler, HttpHeaderResponse, HttpHeaders, HttpParams, HttpRequest, HttpResponse, HttpResponseBase, HttpUrlEncodingCodec, HttpXhrBackend, HttpXsrfTokenExtractor, JsonpClientBackend, JsonpInterceptor, XhrFactory, HttpInterceptingHandler as ɵHttpInterceptingHandler, NoopInterceptor as ɵangular_packages_common_http_http_a, JsonpCallbackContext as ɵangular_packages_common_http_http_b, jsonpCallbackContext as ɵangular_packages_common_http_http_c, BrowserXhr as ɵangular_packages_common_http_http_d, XSRF_COOKIE_NAME as ɵangular_packages_common_http_http_e, XSRF_HEADER_NAME as ɵangular_packages_common_http_http_f, HttpXsrfCookieExtractor as ɵangular_packages_common_http_http_g, HttpXsrfInterceptor as ɵangular_packages_common_http_http_h };\n\n//# sourceMappingURL=http.js.map","import { RxDocument, RxJsonSchema } from 'rxdb';\nimport { defer, of } from 'rxjs';\nimport { concatMap, map, shareReplay } from 'rxjs/operators';\nimport { DataNotFoundError } from '../../utils/errors';\nimport { makeThumbnail } from '../../utils/thumbnail';\n\nexport interface MemontIndex {\n  readonly id: string;\n  readonly timestamp: number;\n  readonly geolocationPosition?: {\n    readonly latitude: number;\n    readonly longitude: number;\n  };\n}\n\nexport const schema: RxJsonSchema<MemontIndex> = {\n  version: 0,\n  type: 'object',\n  properties: {\n    id: {\n      type: 'string',\n      primary: true,\n    },\n    timestamp: { type: 'number' },\n    geolocationPosition: {\n      type: 'object',\n      properties: {\n        latitude: { type: 'number' },\n        longitude: { type: 'number' },\n      },\n      required: ['latitude', 'longitude'],\n    },\n  },\n  indexes: ['timestamp'],\n  required: ['timestamp'],\n  attachments: {\n    encrypted: false,\n  },\n};\n\nexport class Moment {\n  static readonly PHOTO_ATTACHMENT_ID = 'original';\n\n  private static readonly THUMBNAIL_ATTACHMENT_ID = 'thumbnail';\n\n  readonly id = this.document.id;\n\n  readonly mimeType = this.getAttachment(Moment.PHOTO_ATTACHMENT_ID).type;\n\n  readonly timestamp = this.document.timestamp;\n\n  readonly geolocationPosition = this.document.geolocationPosition;\n\n  readonly photoUrl$ = defer(() =>\n    this.getAttachment(Moment.PHOTO_ATTACHMENT_ID).getData()\n  ).pipe(\n    map(blob => URL.createObjectURL(blob)),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n\n  readonly thumbnailUrl$ = defer(() =>\n    of(this.document.getAttachment(Moment.THUMBNAIL_ATTACHMENT_ID))\n  ).pipe(\n    concatMap(async attachment => {\n      if (attachment) return attachment.getData();\n      const thumbnail = await makeThumbnail({\n        image: await this.getAttachment(Moment.PHOTO_ATTACHMENT_ID).getData(),\n        maxSize: 300,\n      });\n      await this.document.putAttachment(\n        {\n          id: Moment.THUMBNAIL_ATTACHMENT_ID,\n          data: thumbnail,\n          type: this.mimeType,\n        },\n        true\n      );\n      return thumbnail;\n    }),\n    map(blob => URL.createObjectURL(blob)),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n\n  constructor(private readonly document: RxDocument<MemontIndex>) {}\n\n  private getAttachment(\n    id:\n      | typeof Moment.PHOTO_ATTACHMENT_ID\n      | typeof Moment.THUMBNAIL_ATTACHMENT_ID\n  ) {\n    const attachment = this.document.getAttachment(id);\n    if (attachment) return attachment;\n    throw new DataNotFoundError(`Cannot get the attachment with ID: ${id}`);\n  }\n}\n"]}