(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"/T4s":function(t,e,r){"use strict";r.d(e,"a",function(){return m});var n=r("mrSG"),i=r("1Bn7"),o=r("2Vo4"),s=r("JX91"),a=r("/uUt"),c=r("vkgz"),u=r("KJy6"),h=r("fXoL"),l=r("ofXK"),d=r("TEn/"),f=r("9A8T");function p(t,e){1&t&&h.Lb(0,"ion-icon",3)}function g(t,e){if(1&t){const t=h.Qb();h.Pb(0,"ion-img",4),h.Xb("ionImgDidLoad",function(e){return h.ic(t),h.Zb().onImageLoaded(e)})("ionError",function(){return h.ic(t),h.Zb().onImageError()}),h.ac(1,"ngrxPush"),h.Ob()}if(2&t){const t=h.Zb();h.Bb("src",h.bc(1,1,t.src$))}}function A(t,e){1&t&&h.dc(0,0,["*ngIf","!isImageError"])}const b=["*"];let m=(()=>{class t{constructor(){this._src$=new o.a(void 0),this.src$=this._src$.pipe(Object(s.a)(w),Object(u.b)(),Object(a.a)(),Object(c.a)(()=>this.isImageError=!1)),this.isImageError=!1}set src(t){this._src$.next(t)}onImageLoaded(t){return Object(n.a)(this,void 0,void 0,function*(){const e=t.target;return Object(i.h)().addElement(e).duration(300).iterations(1).fromTo("opacity","0","1").play()})}onImageError(){this.isImageError=!0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=h.Eb({type:t,selectors:[["app-image"]],inputs:{src:"src"},ngContentSelectors:b,decls:3,vars:3,consts:[["src","/assets/icons/broken-image.svg","color","danger","size","large",4,"ngIf"],[3,"ionImgDidLoad","ionError",4,"ngIf"],[4,"ngIf"],["src","/assets/icons/broken-image.svg","color","danger","size","large"],[3,"ionImgDidLoad","ionError"]],template:function(t,e){1&t&&(h.ec(),h.lc(0,p,1,0,"ion-icon",0),h.lc(1,g,2,3,"ion-img",1),h.lc(2,A,1,0,"ng-content",2)),2&t&&(h.fc("ngIf",e.isImageError),h.Ab(1),h.fc("ngIf",!e.isImageError),h.Ab(1),h.fc("ngIf",!e.isImageError))},directives:[l.k,d.n,d.o],pipes:[f.b],styles:["[_nghost-%COMP%]{display:block;overflow:hidden;-o-object-fit:cover;object-fit:cover;position:relative;-webkit-animation:loading 2.5s ease-in-out infinite alternate;animation:loading 2.5s ease-in-out infinite alternate}ion-img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:inherit;object-fit:inherit;-o-object-position:inherit;object-position:inherit;opacity:0}@-webkit-keyframes loading{0%{background-color:var(--ion-color-light-shade)}to{background-color:var(--ion-color-light)}}@keyframes loading{0%{background-color:var(--ion-color-light-shade)}to{background-color:var(--ion-color-light)}}@media (prefers-color-scheme:dark){@-webkit-keyframes loading{0%{background-color:var(--ion-color-step-150)}to{background-color:var(--ion-color-step-100)}}@keyframes loading{0%{background-color:var(--ion-color-step-150)}to{background-color:var(--ion-color-step-100)}}}ion-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;margin-right:-50%;transform:translate(-50%,-50%)}"]}),t})();const w="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="},"6g0+":function(t,e,r){"use strict";r.d(e,"a",function(){return l}),r.d(e,"b",function(){return d});var n=r("fXoL"),i=r("O1h7"),o=r("TEn/"),s=r("ofXK");const a=["sliderRef"],c=function(t){return{"no-title":t}},u=function(t){return{"no-text":t}};let h=(()=>{class t{constructor(t){this.modalController=t,this.alt="",this.scheme="auto",this.slideOptions={},this.srcFallback="",this.srcHighRes="",this.swipeToClose=!0,this.text="",this.title="",this.titleSize="",this.defaultSlideOptions={centeredSlides:!0,passiveListeners:!1,zoom:{enabled:!0}},this.options={},this.swipeState={phase:"init",direction:"none",swipeType:"none",startX:0,startY:0,distance:0,distanceX:0,distanceY:0,threshold:150,restraint:100,allowedTime:500,elapsedTime:0,startTime:0}}ngOnInit(){return Object(i.a)(this,void 0,void 0,function*(){this.options=Object.assign({},this.defaultSlideOptions,this.slideOptions),this.src=this.srcHighRes||this.src,this.setStyle(),this.setScheme(this.scheme),this.initSwipeToClose(this.swipeToClose),(yield this.slides.getSwiper()).appendSlide(`<ion-slide><img alt="${this.alt}" src="${this.src}" onerror="this.src='${this.srcFallback}'"/></ion-slide>`)})}setStyle(){const t=document.querySelector(".ion-img-viewer");t.style.setProperty("--height","100%"),t.style.setProperty("--width","100%"),t.style.setProperty("--border-radius","0")}setScheme(t){if("auto"===t)return;const e=document.querySelector(".ion-img-viewer");"light"===this.scheme&&(e.style.setProperty("--ion-background-color","#ffffff"),e.style.setProperty("--ion-background-color-rgb","255, 255, 255"),e.style.setProperty("--ion-text-color","#000"),e.style.setProperty("--ion-text-color-rgb","0,0,0")),"dark"===this.scheme&&(e.classList.contains("ios")?(e.style.setProperty("--ion-background-color","#000000"),e.style.setProperty("--ion-background-color-rgb","0, 0, 0")):(e.style.setProperty("--ion-background-color","#121212"),e.style.setProperty("--ion-background-color-rgb","18,18,18")),e.style.setProperty("--ion-text-color","#ffffff"),e.style.setProperty("--ion-text-color-rgb","255,255,255"))}initSwipeToClose(t=!0){if(!t)return;const e=document.querySelector("ion-modal");e.addEventListener("mousedown",t=>this.swipeStart(t),!0),e.addEventListener("mousemove",t=>this.swipeMove(t),!0),e.addEventListener("mouseup",t=>this.swipeEnd(t),!0),e.addEventListener("touchstart",t=>this.swipeStart(t),!0),e.addEventListener("touchmove",t=>this.swipeMove(t),!0),e.addEventListener("touchend",t=>this.swipeEnd(t),!0),this.modalController.getTop().then(t=>{t.onWillDismiss().then(()=>{document.removeEventListener("mousedown",this.swipeStart,!0),document.removeEventListener("mousemove",this.swipeMove,!0),document.removeEventListener("mouseup",this.swipeMove,!0),document.removeEventListener("touchstart",this.swipeStart,!0),document.removeEventListener("touchmove",this.swipeMove,!0),document.removeEventListener("touchend",this.swipeMove,!0)})})}swipeStart(t){const{pageX:e,pageY:r}="touchstart"===t.type?t.changedTouches[0]:t;this.swipeState=Object.assign({},this.swipeState,{phase:"start",direction:"none",distance:0,startX:e,startY:r,startTime:(new Date).getTime()})}swipeMove(t){if("none"===this.swipeState.phase)return;const{pageX:e,pageY:r}="touchmove"===t.type?t.changedTouches[0]:t,n=e-this.swipeState.startX,i=r-this.swipeState.startY;let o,s;Math.abs(n)>Math.abs(i)?(o=n<0?"left":"right",s=n):(o=i<0?"up":"down",s=i),this.swipeState=Object.assign({},this.swipeState,{phase:"move",direction:o,distance:s,distanceX:n,distanceY:i}),t.preventDefault()}swipeEnd(t){if("none"===this.swipeState.phase)return;const{allowedTime:e,direction:r,restraint:n,startTime:i,threshold:o,distanceX:s,distanceY:a}=this.swipeState;let c;return(new Date).getTime()-i<=e&&(Math.abs(s)>=o&&Math.abs(a)<=n||Math.abs(a)>=o&&Math.abs(s)<=n)&&(c=r),this.swipeState=Object.assign({},this.swipeState,{phase:"end",swipeType:c}),"down"===c?this.closeModal():void 0}closeModal(){this.modalController.dismiss()}}return t.\u0275fac=function(e){return new(e||t)(n.Kb(o.F))},t.\u0275cmp=n.Eb({type:t,selectors:[["ion-viewer-modal"]],viewQuery:function(t,e){if(1&t&&n.qc(a,3),2&t){let t;n.hc(t=n.Yb())&&(e.slides=t.first)}},inputs:{alt:"alt",scheme:"scheme",slideOptions:"slideOptions",srcFallback:"srcFallback",srcHighRes:"srcHighRes",swipeToClose:"swipeToClose",text:"text",title:"title",titleSize:"titleSize",src:"src"},decls:14,vars:11,consts:[[3,"ngClass"],["slot","primary"],[3,"click"],["slot","icon-only","name","close"],[3,"size"],[3,"forceOverscroll"],[3,"options"],["sliderRef",""],[1,"ion-text-center"]],template:function(t,e){1&t&&(n.Pb(0,"ion-header",0),n.Pb(1,"ion-toolbar"),n.Pb(2,"ion-buttons",1),n.Pb(3,"ion-button",2),n.Xb("click",function(){return e.closeModal()}),n.Lb(4,"ion-icon",3),n.Ob(),n.Ob(),n.Pb(5,"ion-title",4),n.mc(6),n.Ob(),n.Ob(),n.Ob(),n.Pb(7,"ion-content",5),n.Lb(8,"ion-slides",6,7),n.Ob(),n.Pb(10,"ion-footer",0),n.Pb(11,"ion-toolbar",8),n.Pb(12,"ion-text"),n.mc(13),n.Ob(),n.Ob(),n.Ob()),2&t&&(n.fc("ngClass",n.gc(7,c,e.title.length<=0)),n.Ab(5),n.fc("size",e.titleSize),n.Ab(1),n.nc(e.title),n.Ab(1),n.fc("forceOverscroll",!1),n.Ab(1),n.fc("options",e.options),n.Ab(2),n.fc("ngClass",n.gc(9,u,e.text.length<=0)),n.Ab(3),n.nc(e.text))},directives:[o.m,s.i,o.C,o.f,o.e,o.n,o.B,o.h,o.z,o.k,o.A],styles:["ion-slides[_ngcontent-%COMP%]{--height:100%;height:100%}ion-toolbar[_ngcontent-%COMP%]{--border-style:none;--background:rgba(var(--ion-background-color-rgb, (255, 255, 255)), 0.6);background:rgba(var(--ion-background-color-rgb,255,255,255),.6)}ion-header[_ngcontent-%COMP%]{opacity:1;position:absolute}ion-header.no-title[_ngcontent-%COMP%]:after{content:none}ion-header.no-title[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:rgba(0, 0, 0, 0);background:rgba(0,0,0,0)}ion-footer[_ngcontent-%COMP%]{position:absolute;bottom:0}ion-footer.no-text[_ngcontent-%COMP%]:before{content:none}ion-footer.no-text[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:rgba(0, 0, 0, 0);background:rgba(0,0,0,0)}"]}),t})(),l=(()=>{class t{constructor(t,e,r){this.el=t,this.renderer=e,this.modalController=r}onClick(){this.viewImage(this.src,this.srcFallback,this.srcHighRes,this.title,this.titleSize,this.text,this.scheme,this.slideOptions,this.swipeToClose)}onError(t){this.src!==this.el.nativeElement.src&&(this.src=this.el.nativeElement.src),this.srcFallback&&this.renderer.setAttribute(this.el.nativeElement,"src",this.srcFallback)}ngOnInit(){this.el.nativeElement.hasAttribute("src")||this.renderer.setAttribute(this.el.nativeElement,"src",this.src)}viewImage(t,e="",r="",n="",o="",s="",a="auto",c={},u=!0){return Object(i.a)(this,void 0,void 0,function*(){const i=yield this.modalController.create({component:h,componentProps:{src:t,srcFallback:e,srcHighRes:r,title:n,titleSize:o,text:s,scheme:a,slideOptions:c,swipeToClose:u},cssClass:this.cssClass instanceof Array?["ion-img-viewer",...this.cssClass]:["ion-img-viewer",this.cssClass],keyboardClose:!0,showBackdrop:!0});return yield i.present()})}}return t.\u0275fac=function(e){return new(e||t)(n.Kb(n.m),n.Kb(n.F),n.Kb(o.F))},t.\u0275dir=n.Fb({type:t,selectors:[["","ionImgViewer",""]],hostBindings:function(t,e){1&t&&n.Xb("click",function(){return e.onClick()})("error",function(t){return e.onError(t)})},inputs:{src:"src",cssClass:"cssClass",scheme:"scheme",slideOptions:"slideOptions",srcFallback:"srcFallback",srcHighRes:"srcHighRes",swipeToClose:"swipeToClose",text:"text",title:"title",titleSize:"titleSize"}}),t})(),d=(()=>{class t{}return t.\u0275mod=n.Ib({type:t}),t.\u0275inj=n.Hb({factory:function(e){return new(e||t)},imports:[[s.b,o.D]]}),t})()},"9A8T":function(t,e,r){"use strict";r.d(e,"a",function(){return g}),r.d(e,"b",function(){return p}),r.d(e,"c",function(){return A});var n=r("fXoL"),i=r("XNiG"),o=r("EY2u"),s=r("HDdC"),a=r("Cfvw"),c=r("/uUt"),u=r("eIep"),h=r("vkgz"),l=r("JIr8");function d(t){const e=new i.a,r=e.pipe(Object(c.a)()).pipe(Object(u.a)(e=>{if(null==e)return t.updateViewContextObserver.next(e),t.render(),o.a;const r=(n=e)&&(n instanceof s.a||"function"==typeof n.lift&&"function"==typeof n.subscribe)?e:Object(a.a)(e);var n;return t.resetContextObserver.next(),t.render(),r.pipe(Object(c.a)(),Object(h.a)(t.updateViewContextObserver),Object(h.a)(()=>t.render()),Object(l.a)(t=>o.a))}));return{nextPotentialObservable(t){e.next(t)},subscribe:()=>r.subscribe()}}function f(t){return function(){t.ngZone instanceof n.B?t.cdRef.markForCheck():t.cdRef.detectChanges()}}let p=(()=>{class t{constructor(t,e){this.resetContextObserver={next:()=>this.renderedValue=void 0},this.updateViewContextObserver={next:t=>this.renderedValue=t},this.cdAware=d({render:f({cdRef:t,ngZone:e}),updateViewContextObserver:this.updateViewContextObserver,resetContextObserver:this.resetContextObserver}),this.subscription=this.cdAware.subscribe()}transform(t){return this.cdAware.nextPotentialObservable(t),this.renderedValue}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(n.Vb(),n.Kb(n.B))},t.\u0275pipe=n.Jb({name:"ngrxPush",type:t,pure:!1}),t})(),g=(()=>{class t{constructor(t,e,r,n){this.templateRef=r,this.viewContainerRef=n,this.ViewContext={$implicit:void 0,ngrxLet:void 0,$error:!1,$complete:!1},this.resetContextObserver={next:()=>{this.embeddedView&&(this.ViewContext.$implicit=void 0,this.ViewContext.ngrxLet=void 0,this.ViewContext.$error=!1,this.ViewContext.$complete=!1)}},this.updateViewContextObserver={next:t=>{this.embeddedView||this.createEmbeddedView(),this.ViewContext.$implicit=t,this.ViewContext.ngrxLet=t},error:t=>{this.embeddedView||this.createEmbeddedView(),this.ViewContext.$error=!0},complete:()=>{this.embeddedView||this.createEmbeddedView(),this.ViewContext.$complete=!0}},this.cdAware=d({render:f({cdRef:t,ngZone:e}),resetContextObserver:this.resetContextObserver,updateViewContextObserver:this.updateViewContextObserver}),this.subscription=this.cdAware.subscribe()}static ngTemplateContextGuard(t,e){return!0}set ngrxLet(t){this.cdAware.nextPotentialObservable(t)}createEmbeddedView(){this.embeddedView=this.viewContainerRef.createEmbeddedView(this.templateRef,this.ViewContext)}ngOnDestroy(){this.subscription.unsubscribe(),this.viewContainerRef.clear()}}return t.\u0275fac=function(e){return new(e||t)(n.Kb(n.i),n.Kb(n.B),n.Kb(n.M),n.Kb(n.Q))},t.\u0275dir=n.Fb({type:t,selectors:[["","ngrxLet",""]],inputs:{ngrxLet:"ngrxLet"}}),t})(),A=(()=>{class t{}return t.\u0275mod=n.Ib({type:t}),t.\u0275inj=n.Hb({factory:function(e){return new(e||t)}}),t})()},PCNd:function(t,e,r){"use strict";r.d(e,"a",function(){return G});var n=r("ofXK"),i=r("fXoL"),o=r("LRne"),s=r("HDdC"),a=r("bOdf"),c=r("pLZG"),u=r("lJxs");class h{}class l{}class d{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const r=t.slice(0,e),n=r.toLowerCase(),i=t.slice(e+1).trim();this.maybeSetNormalizedName(r,n),this.headers.has(n)?this.headers.get(n).push(i):this.headers.set(n,[i])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const n=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(n,r),this.maybeSetNormalizedName(e,n))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof d?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new d;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof d?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const n=("a"===t.op?this.headers.get(e):void 0)||[];n.push(...r),this.headers.set(e,n);break;case"d":const i=t.value;if(i){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===i.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class f{encodeKey(t){return p(t)}encodeValue(t){return p(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function p(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class g{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new f,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const r=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(t=>{const n=t.indexOf("="),[i,o]=-1==n?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,n)),e.decodeValue(t.slice(n+1))],s=r.get(i)||[];s.push(o),r.set(i,s)}),r}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e];this.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const n=t[r];Array.isArray(n)?n.forEach(t=>{e.push({param:r,value:t,op:"a"})}):e.push({param:r,value:n,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new g({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(t.value),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const r=e.indexOf(t.value);-1!==r&&e.splice(r,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}function A(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function b(t){return"undefined"!=typeof Blob&&t instanceof Blob}function m(t){return"undefined"!=typeof FormData&&t instanceof FormData}class w{constructor(t,e,r,n){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||n?(this.body=void 0!==r?r:null,i=n):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.params&&(this.params=i.params)),this.headers||(this.headers=new d),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const r=e.indexOf("?");this.urlWithParams=e+(-1===r?"?":r<e.length-1?"&":"")+t}}else this.params=new g,this.urlWithParams=e}serializeBody(){return null===this.body?null:A(this.body)||b(this.body)||m(this.body)||"string"==typeof this.body?this.body:this.body instanceof g?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||m(this.body)?null:b(this.body)?this.body.type||null:A(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof g?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(t={}){const e=t.method||this.method,r=t.url||this.url,n=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let a=t.headers||this.headers,c=t.params||this.params;return void 0!==t.setHeaders&&(a=Object.keys(t.setHeaders).reduce((e,r)=>e.set(r,t.setHeaders[r]),a)),t.setParams&&(c=Object.keys(t.setParams).reduce((e,r)=>e.set(r,t.setParams[r]),c)),new w(e,r,i,{params:c,headers:a,reportProgress:s,responseType:n,withCredentials:o})}}var y=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}({});class v{constructor(t,e=200,r="OK"){this.headers=t.headers||new d,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class _ extends v{constructor(t={}){super(t),this.type=y.ResponseHeader}clone(t={}){return new _({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class I extends v{constructor(t={}){super(t),this.type=y.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new I({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class C extends v{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function E(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let O=(()=>{class t{constructor(t){this.handler=t}request(t,e,r={}){let n;if(t instanceof w)n=t;else{let i,o;i=r.headers instanceof d?r.headers:new d(r.headers),r.params&&(o=r.params instanceof g?r.params:new g({fromObject:r.params})),n=new w(t,e,void 0!==r.body?r.body:null,{headers:i,params:o,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const i=Object(o.a)(n).pipe(Object(a.a)(t=>this.handler.handle(t)));if(t instanceof w||"events"===r.observe)return i;const s=i.pipe(Object(c.a)(t=>t instanceof I));switch(r.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return s.pipe(Object(u.a)(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return s.pipe(Object(u.a)(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return s.pipe(Object(u.a)(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return s.pipe(Object(u.a)(t=>t.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new g).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,r={}){return this.request("PATCH",t,E(r,e))}post(t,e,r={}){return this.request("POST",t,E(r,e))}put(t,e,r={}){return this.request("PUT",t,E(r,e))}}return t.\u0275fac=function(e){return new(e||t)(i.Tb(h))},t.\u0275prov=i.Gb({token:t,factory:t.\u0275fac}),t})();class x{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const B=new i.s("HTTP_INTERCEPTORS");let j=(()=>{class t{intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Gb({token:t,factory:t.\u0275fac}),t})();const k=/^\)\]\}',?\n/;class P{}let Q=(()=>{class t{constructor(){}build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Gb({token:t,factory:t.\u0275fac}),t})(),T=(()=>{class t{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new s.a(e=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((t,e)=>r.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&r.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();r.responseType="json"!==e?e:"text"}const n=t.serializeBody();let i=null;const o=()=>{if(null!==i)return i;const e=1223===r.status?204:r.status,n=r.statusText||"OK",o=new d(r.getAllResponseHeaders()),s=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(r)||t.url;return i=new _({headers:o,status:e,statusText:n,url:s}),i},s=()=>{let{headers:n,status:i,statusText:s,url:a}=o(),c=null;204!==i&&(c=void 0===r.response?r.responseText:r.response),0===i&&(i=c?200:0);let u=i>=200&&i<300;if("json"===t.responseType&&"string"==typeof c){const t=c;c=c.replace(k,"");try{c=""!==c?JSON.parse(c):null}catch(h){c=t,u&&(u=!1,c={error:h,text:c})}}u?(e.next(new I({body:c,headers:n,status:i,statusText:s,url:a||void 0})),e.complete()):e.error(new C({error:c,headers:n,status:i,statusText:s,url:a||void 0}))},a=t=>{const{url:n}=o(),i=new C({error:t,status:r.status||0,statusText:r.statusText||"Unknown Error",url:n||void 0});e.error(i)};let c=!1;const u=n=>{c||(e.next(o()),c=!0);let i={type:y.DownloadProgress,loaded:n.loaded};n.lengthComputable&&(i.total=n.total),"text"===t.responseType&&r.responseText&&(i.partialText=r.responseText),e.next(i)},h=t=>{let r={type:y.UploadProgress,loaded:t.loaded};t.lengthComputable&&(r.total=t.total),e.next(r)};return r.addEventListener("load",s),r.addEventListener("error",a),r.addEventListener("timeout",a),r.addEventListener("abort",a),t.reportProgress&&(r.addEventListener("progress",u),null!==n&&r.upload&&r.upload.addEventListener("progress",h)),r.send(n),e.next({type:y.Sent}),()=>{r.removeEventListener("error",a),r.removeEventListener("abort",a),r.removeEventListener("load",s),r.removeEventListener("timeout",a),t.reportProgress&&(r.removeEventListener("progress",u),null!==n&&r.upload&&r.upload.removeEventListener("progress",h)),r.readyState!==r.DONE&&r.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(i.Tb(P))},t.\u0275prov=i.Gb({token:t,factory:t.\u0275fac}),t})();const L=new i.s("XSRF_COOKIE_NAME"),M=new i.s("XSRF_HEADER_NAME");class U{}let S=(()=>{class t{constructor(t,e,r){this.doc=t,this.platform=e,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Object(n.s)(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(i.Tb(n.c),i.Tb(i.D),i.Tb(L))},t.\u0275prov=i.Gb({token:t,factory:t.\u0275fac}),t})(),D=(()=>{class t{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const r=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||r.startsWith("http://")||r.startsWith("https://"))return e.handle(t);const n=this.tokenService.getToken();return null===n||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,n)})),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(i.Tb(U),i.Tb(M))},t.\u0275prov=i.Gb({token:t,factory:t.\u0275fac}),t})(),R=(()=>{class t{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(B,[]);this.chain=t.reduceRight((t,e)=>new x(t,e),this.backend)}return this.chain.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(i.Tb(l),i.Tb(i.t))},t.\u0275prov=i.Gb({token:t,factory:t.\u0275fac}),t})(),H=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:D,useClass:j}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:L,useValue:e.cookieName}:[],e.headerName?{provide:M,useValue:e.headerName}:[]]}}}return t.\u0275mod=i.Ib({type:t}),t.\u0275inj=i.Hb({factory:function(e){return new(e||t)},providers:[D,{provide:B,useExisting:D,multi:!0},{provide:U,useClass:S},{provide:L,useValue:"XSRF-TOKEN"},{provide:M,useValue:"X-XSRF-TOKEN"}]}),t})(),z=(()=>{class t{}return t.\u0275mod=i.Ib({type:t}),t.\u0275inj=i.Hb({factory:function(e){return new(e||t)},providers:[O,{provide:h,useClass:R},T,{provide:l,useExisting:T},Q,{provide:P,useExisting:Q}],imports:[[H.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})();var F=r("3Pt+"),N=r("TEn/"),q=r("9A8T");let G=(()=>{class t{}return t.\u0275mod=i.Ib({type:t}),t.\u0275inj=i.Hb({factory:function(e){return new(e||t)},imports:[[n.b,F.a,F.d,N.D,z,q.c],n.b,F.a,F.d,N.D,q.c]}),t})()},fOOd:function(t,e,r){"use strict";r.r(e),r.d(e,"HomePageModule",function(){return N});var n=r("6g0+"),i=r("PCNd"),o=r("tyNb"),s=r("mrSG"),a=r("TEn/"),c=r("2Vo4"),u=r("XNiG"),h=r("itXk"),l=r("/uUt"),d=r("eIep"),f=r("KJy6"),p=r("VfN6"),g=r("NXyV"),A=r("JIr8"),b=r("UXun"),m=r("lJxs"),w=r("7o/Q");class y{call(t,e){return e.subscribe(new v(t))}}class v extends w.a{constructor(t){super(t),this.hasPrev=!1}_next(t){let e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)}}var _=r("vkgz"),I=r("fXoL"),C=r("kTgZ"),E=r("9A8T"),O=r("/T4s");const x=["video"];function B(t,e){if(1&t&&(I.Pb(0,"div",7),I.Lb(1,"app-image",8),I.Ob()),2&t){const t=e.ngrxLet;I.Ab(1),I.fc("src",t)}}let j=(()=>{let t=class{constructor(t,e,r){this.modalController=t,this.alertController=e,this.junctureRepository=r,this._videoElement$=new c.a(void 0),this.videoElement$=this._videoElement$.pipe(Object(f.b)(),Object(l.a)()),this.mediaStream$=Object(g.a)(()=>navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}})).pipe(Object(A.a)(t=>Object(s.a)(this,void 0,void 0,function*(){yield this.presentErrorDialog(t),yield this.dismiss()})),Object(b.a)({bufferSize:1,refCount:!0})),this.imageCapture$=this.mediaStream$.pipe(Object(f.b)(),Object(m.a)(t=>new ImageCapture(t.getVideoTracks()[0])),Object(b.a)({bufferSize:1,refCount:!0})),this._capturedImageUrl$=new c.a(void 0),this.revokePreviousImageUrl$=this._capturedImageUrl$.pipe(t=>t.lift(new y),Object(_.a)(([t])=>{t&&URL.revokeObjectURL(t)})),this.capturedImageUrl$=this._capturedImageUrl$.pipe(Object(f.b)(),Object(l.a)()),this.cameraPreview$=Object(h.a)([this.videoElement$,this.mediaStream$.pipe(Object(f.b)())]).pipe(Object(_.a)(([t,e])=>{t.srcObject=e})),this.revokePreviousImageUrl$.pipe(Object(p.b)(this)).subscribe(),this.cameraPreview$.pipe(Object(p.b)(this)).subscribe()}set videoElement(t){this._videoElement$.next(t.nativeElement)}capture(){this.imageCapture$.pipe(Object(d.a)(t=>t.takePhoto()),Object(_.a)(t=>{this._capturedImageUrl$.next(URL.createObjectURL(t))}),Object(f.a)(t=>this.junctureRepository.add$(t)),Object(A.a)(t=>Object(s.a)(this,void 0,void 0,function*(){console.error(t),yield this.presentErrorDialog(t)})),Object(p.b)(this)).subscribe()}dismiss(){return Object(s.a)(this,void 0,void 0,function*(){return this.modalController.dismiss()})}presentErrorDialog(t){return Object(s.a)(this,void 0,void 0,function*(){const e=yield this.alertController.create({header:t instanceof Error?t.name:"Unknown Error",message:t instanceof Error?t.message:JSON.stringify(t),buttons:[{text:"ok"}]});yield e.present()})}ngOnDestroy(){this.mediaStream$.pipe(Object(f.b)(),Object(_.a)(t=>t.getTracks().forEach(t=>t.stop()))).subscribe()}};return t.\u0275fac=function(e){return new(e||t)(I.Kb(a.F),I.Kb(a.a),I.Kb(C.a))},t.\u0275cmp=I.Eb({type:t,selectors:[["app-camera"]],viewQuery:function(t,e){if(1&t&&I.qc(x,1),2&t){let t;I.hc(t=I.Yb())&&(e.videoElement=t.first)}},decls:7,vars:1,consts:[["fill","clear",1,"dismiss",3,"click"],["slot","icon-only","name","close-outline","color","light"],["fill","clear",1,"capture",3,"click"],["slot","icon-only","name","radio-button-on-outline","color","light"],["class","captured ion-margin",4,"ngrxLet"],["playsinline","","autoplay",""],["video",""],[1,"captured","ion-margin"],["ionImgViewer","",3,"src"]],template:function(t,e){1&t&&(I.Pb(0,"ion-button",0),I.Xb("click",function(){return e.dismiss()}),I.Lb(1,"ion-icon",1),I.Ob(),I.Pb(2,"ion-button",2),I.Xb("click",function(){return e.capture()}),I.Lb(3,"ion-icon",3),I.Ob(),I.lc(4,B,2,1,"div",4),I.Lb(5,"video",5,6)),2&t&&(I.Ab(4),I.fc("ngrxLet",e.capturedImageUrl$))},directives:[a.e,a.n,E.a,O.a,n.a],styles:["[_nghost-%COMP%]{display:contents;position:relative}video[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center}ion-button.dismiss[_ngcontent-%COMP%]{right:0;width:48px;height:48px}ion-button.capture[_ngcontent-%COMP%], ion-button.dismiss[_ngcontent-%COMP%]{position:absolute;z-index:1;--border-radius:50%;--padding-end:0;--padding-start:0}ion-button.capture[_ngcontent-%COMP%]{bottom:0;left:50%;transform:translate(-50%);height:72px;width:72px;margin:0 0 var(--ion-margin,16px);--background:rgba(0,0,0,0.4)}ion-button.capture[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px}.captured[_ngcontent-%COMP%]{position:absolute;bottom:16px;right:16px;overflow:hidden;border-radius:4px;border:1px solid var(--ion-color-light-shade)}.captured[_ngcontent-%COMP%]   app-image[_ngcontent-%COMP%]{z-index:1;width:60px;height:60px}"]}),t=Object(s.b)([Object(p.a)()],t),t})();var k=r("kiQV"),P=r("kgew"),Q=r("ofXK");function T(t,e){if(1&t&&(I.Pb(0,"ion-select-option",7),I.mc(1),I.Ob()),2&t){const t=e.$implicit;I.fc("value",t),I.Ab(1),I.oc(" ",t," ")}}function L(t,e){if(1&t){const t=I.Qb();I.Pb(0,"ion-select",5),I.Xb("ionChange",function(e){return I.ic(t),I.Zb().onChangeDarkTheme(e)}),I.lc(1,T,2,2,"ion-select-option",6),I.Ob()}if(2&t){const t=e.ngrxLet,r=I.Zb();I.fc("value",t),I.Ab(1),I.fc("ngForOf",r.themes)}}let M=(()=>{let t=class{constructor(t){this.settingsService=t,this.themes=P.a.THEMES,this.theme$=this.settingsService.theme$,this.version=k.a}onChangeDarkTheme(t){return this.settingsService.setTheme$(t.detail.value).pipe(Object(p.b)(this)).subscribe()}};return t.\u0275fac=function(e){return new(e||t)(I.Kb(P.a))},t.\u0275cmp=I.Eb({type:t,selectors:[["app-settings"]],decls:12,vars:2,consts:[["lines","none"],["name","moon-outline","slot","start"],[3,"value","ionChange",4,"ngrxLet"],["name","information-outline","slot","start"],["slot","end"],[3,"value","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){1&t&&(I.Pb(0,"ion-list",0),I.Pb(1,"ion-item"),I.Lb(2,"ion-icon",1),I.Pb(3,"ion-label"),I.mc(4,"Theme"),I.Ob(),I.lc(5,L,2,2,"ion-select",2),I.Ob(),I.Pb(6,"ion-item"),I.Lb(7,"ion-icon",3),I.Pb(8,"ion-label"),I.mc(9,"Version"),I.Ob(),I.Pb(10,"ion-note",4),I.mc(11),I.Ob(),I.Ob(),I.Ob()),2&t&&(I.Ab(5),I.fc("ngrxLet",e.theme$),I.Ab(6),I.nc(e.version))},directives:[a.r,a.p,a.n,a.q,E.a,a.s,a.w,a.J,Q.j,a.x],styles:["ion-select[_ngcontent-%COMP%]{max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content}"]}),t=Object(s.b)([Object(p.a)()],t),t})();const U=function(t){return{id:t}};function S(t,e){if(1&t&&(I.Pb(0,"app-image",2),I.Lb(1,"ion-ripple-effect"),I.Ob()),2&t){const t=e.ngrxLet,r=I.Zb().ngrxLet;I.fc("queryParams",I.gc(2,U,r.id))("src",t)}}function D(t,e){if(1&t&&(I.Nb(0),I.lc(1,S,2,4,"app-image",1),I.Mb()),2&t){const t=e.ngrxLet;I.Ab(1),I.fc("ngrxLet",t.thumbnailUrl$)}}let R=(()=>{class t{constructor(){this._juncture$=new c.a(void 0),this.juncture$=this._juncture$.pipe(Object(f.b)(),Object(l.a)((t,e)=>t.id===e.id))}set juncture(t){this._juncture$.next(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=I.Eb({type:t,selectors:[["app-juncture-thumbnail"]],inputs:{juncture:"juncture"},decls:1,vars:1,consts:[[4,"ngrxLet"],["routerLink","photo","class","ion-activatable",3,"queryParams","src",4,"ngrxLet"],["routerLink","photo",1,"ion-activatable",3,"queryParams","src"]],template:function(t,e){1&t&&I.lc(0,D,2,1,"ng-container",0),2&t&&I.fc("ngrxLet",e.juncture$)},directives:[E.a,O.a,a.I,o.h,a.t],styles:["[_nghost-%COMP%]{display:block;overflow:hidden}app-image[_ngcontent-%COMP%]{position:relative;height:100%;width:100%}"]}),t})();function H(t,e){if(1&t&&(I.Pb(0,"ion-col",8,9),I.Lb(2,"app-juncture-thumbnail",10),I.Ob()),2&t){const t=e.$implicit;I.Ab(2),I.fc("juncture",t)}}const z=[{path:"",component:(()=>{class t{constructor(t,e,r){this.popoverController=t,this.modalController=e,this.junctureRepository=r,this.junctures$=this.junctureRepository.all$,this._ionContent$=new c.a(void 0),this.ionContent$=this._ionContent$.pipe(Object(f.b)(),Object(l.a)()),this._scrollEvent$=new u.a,this.scrollEvent$=this._scrollEvent$.pipe(Object(l.a)()),this.noFooterBorder$=Object(h.a)([this.ionContent$,this.scrollEvent$]).pipe(Object(d.a)(([t])=>this.detectBottom(t)))}set ionContent(t){this._ionContent$.next(t)}onScroll(t){this._scrollEvent$.next(t)}detectBottom(t){return Object(s.a)(this,void 0,void 0,function*(){const e=yield t.getScrollElement();return e.scrollTop===e.scrollHeight-e.clientHeight})}presentSettings(t){return Object(s.a)(this,void 0,void 0,function*(){const e=yield this.popoverController.create({component:M,event:t});return yield e.present()})}presentCamera(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:j});return yield t.present()})}trackJuncture(t,e){return e.id}}return t.\u0275fac=function(e){return new(e||t)(I.Kb(a.H),I.Kb(a.F),I.Kb(C.a))},t.\u0275cmp=I.Eb({type:t,selectors:[["app-home"]],viewQuery:function(t,e){if(1&t&&I.qc(a.h,1),2&t){let t;I.hc(t=I.Yb())&&(e.ionContent=t.first)}},decls:14,vars:8,consts:[["scrollEvents","",3,"ionScroll"],["size","6","size-sm","4","size-md","3","size-lg","2",4,"ngFor","ngForOf","ngForTrackBy"],["vertical","bottom","horizontal","center","slot","fixed","edge",""],[3,"click"],["name","camera-outline"],["slot","primary"],["slot","secondary",3,"click"],["slot","icon-only","name","settings-outline"],["size","6","size-sm","4","size-md","3","size-lg","2"],["col",""],[3,"juncture"]],template:function(t,e){1&t&&(I.Pb(0,"ion-content",0),I.Xb("ionScroll",function(t){return e.onScroll(t)}),I.Pb(1,"ion-grid"),I.Pb(2,"ion-row"),I.lc(3,H,3,1,"ion-col",1),I.ac(4,"ngrxPush"),I.Ob(),I.Ob(),I.Pb(5,"ion-fab",2),I.Pb(6,"ion-fab-button",3),I.Xb("click",function(){return e.presentCamera()}),I.Lb(7,"ion-icon",4),I.Ob(),I.Ob(),I.Ob(),I.Pb(8,"ion-footer"),I.ac(9,"ngrxPush"),I.Pb(10,"ion-toolbar"),I.Pb(11,"ion-buttons",5),I.Pb(12,"ion-button",6),I.Xb("click",function(t){return e.presentSettings(t)}),I.Lb(13,"ion-icon",7),I.Ob(),I.Ob(),I.Ob(),I.Ob()),2&t&&(I.Ab(3),I.fc("ngForOf",I.bc(4,4,e.junctures$))("ngForTrackBy",e.trackJuncture),I.Ab(5),I.Cb("ion-no-border",I.bc(9,6,e.noFooterBorder$)))},directives:[a.h,a.l,a.v,Q.j,a.i,a.j,a.n,a.k,a.C,a.f,a.e,a.g,R],pipes:[E.b],styles:["app-juncture-thumbnail[_ngcontent-%COMP%]{height:150px;border-radius:4px;box-shadow:0 2px 8px 0 rgba(99,99,99,.2)}"]}),t})()},{path:"photo",loadChildren:()=>r.e(61).then(r.bind(null,"MTLF")).then(t=>t.PhotoPageModule)}];let F=(()=>{class t{}return t.\u0275mod=I.Ib({type:t}),t.\u0275inj=I.Hb({factory:function(e){return new(e||t)},imports:[[o.i.forChild(z)],o.i]}),t})(),N=(()=>{class t{}return t.\u0275mod=I.Ib({type:t}),t.\u0275inj=I.Hb({factory:function(e){return new(e||t)},imports:[[i.a,F,n.b]]}),t})()},kTgZ:function(t,e,r){"use strict";r.d(e,"a",function(){return P});var n=r("NXyV"),i=r("cp0P"),o=r("bOdf"),s=r("wO+i"),a=r("UXun"),c=r("lJxs"),u=r("SxV6"),h=r("mrSG");function l(t){return Object(h.a)(this,void 0,void 0,function*(){const e=yield crypto.subtle.digest("SHA-256",yield t.arrayBuffer());return[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join("")})}function d(){return Object(h.a)(this,void 0,void 0,function*(){try{return function(){return Object(h.a)(this,void 0,void 0,function*(){return new Promise((t,e)=>{navigator.geolocation.getCurrentPosition(e=>t(e),t=>e(t),{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})})})}()}catch(t){return}})}var f=r("LRne");class p extends Error{constructor(){super(...arguments),this.name=p.name}}function g(t,e){var r={};return e.forEach(function(e){Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])}),r}var A={assign:function(t){for(var e,r=1;r<arguments.length;r++)for(var n in e=Object(arguments[r]))Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},pick:g,pick_pica_resize_options:function(t){return g(t,["alpha","unsharpAmount","unsharpRadius","unsharpThreshold","cancelToken"])}};function b(t){var e={exports:{}};return t(e,e.exports),e.exports}function m(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}var w=b(function(t,e){t.exports=function t(e,r,n){function i(s,a){if(!r[s]){if(!e[s]){if(!a&&m)return m(s);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[s]={exports:{}};e[s][0].call(u.exports,function(t){return i(e[s][1][t]||t)},u,u.exports,t,e,r,n)}return r[s].exports}for(var o=m,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){var n=t("inherits"),i=t("multimath"),o=t("multimath/lib/unsharp_mask"),s=t("./mm_resize");function a(t){var e=t||[],r={js:e.indexOf("js")>=0,wasm:e.indexOf("wasm")>=0};i.call(this,r),this.features={js:r.js,wasm:r.wasm&&this.has_wasm()},this.use(o),this.use(s)}n(a,i),a.prototype.resizeAndUnsharp=function(t,e){var r=this.resize(t,e);return t.unsharpAmount&&this.unsharp_mask(r,t.toWidth,t.toHeight,t.unsharpAmount,t.unsharpRadius,t.unsharpThreshold),r},e.exports=a},{"./mm_resize":4,inherits:15,multimath:16,"multimath/lib/unsharp_mask":19}],2:[function(t,e,r){function n(t){return t<0?0:t>255?255:t}e.exports={convolveHorizontally:function(t,e,r,i,o,s){var a,c,u,h,l,d,f,p,g,A,b,m=0,w=0;for(g=0;g<i;g++){for(l=0,A=0;A<o;A++){for(d=s[l++],f=s[l++],p=m+4*d|0,a=c=u=h=0;f>0;f--)h=h+(b=s[l++])*t[p+3]|0,u=u+b*t[p+2]|0,c=c+b*t[p+1]|0,a=a+b*t[p]|0,p=p+4|0;e[w+3]=n(h+8192>>14),e[w+2]=n(u+8192>>14),e[w+1]=n(c+8192>>14),e[w]=n(a+8192>>14),w=w+4*i|0}w=4*(g+1)|0,m=(g+1)*r*4|0}},convolveVertically:function(t,e,r,i,o,s){var a,c,u,h,l,d,f,p,g,A,b,m=0,w=0;for(g=0;g<i;g++){for(l=0,A=0;A<o;A++){for(d=s[l++],f=s[l++],p=m+4*d|0,a=c=u=h=0;f>0;f--)h=h+(b=s[l++])*t[p+3]|0,u=u+b*t[p+2]|0,c=c+b*t[p+1]|0,a=a+b*t[p]|0,p=p+4|0;e[w+3]=n(h+8192>>14),e[w+2]=n(u+8192>>14),e[w+1]=n(c+8192>>14),e[w]=n(a+8192>>14),w=w+4*i|0}w=4*(g+1)|0,m=(g+1)*r*4|0}}}},{}],3:[function(t,e,r){e.exports="AGFzbQEAAAABFAJgBn9/f39/fwBgB39/f39/f38AAg8BA2VudgZtZW1vcnkCAAEDAwIAAQQEAXAAAAcZAghjb252b2x2ZQAACmNvbnZvbHZlSFYAAQkBAArmAwLBAwEQfwJAIANFDQAgBEUNACAFQQRqIRVBACEMQQAhDQNAIA0hDkEAIRFBACEHA0AgB0ECaiESAn8gBSAHQQF0IgdqIgZBAmouAQAiEwRAQQAhCEEAIBNrIRQgFSAHaiEPIAAgDCAGLgEAakECdGohEEEAIQlBACEKQQAhCwNAIBAoAgAiB0EYdiAPLgEAIgZsIAtqIQsgB0H/AXEgBmwgCGohCCAHQRB2Qf8BcSAGbCAKaiEKIAdBCHZB/wFxIAZsIAlqIQkgD0ECaiEPIBBBBGohECAUQQFqIhQNAAsgEiATagwBC0EAIQtBACEKQQAhCUEAIQggEgshByABIA5BAnRqIApBgMAAakEOdSIGQf8BIAZB/wFIG0EQdEGAgPwHcUEAIAZBAEobIAtBgMAAakEOdSIGQf8BIAZB/wFIG0EYdEEAIAZBAEobciAJQYDAAGpBDnUiBkH/ASAGQf8BSBtBCHRBgP4DcUEAIAZBAEobciAIQYDAAGpBDnUiBkH/ASAGQf8BSBtB/wFxQQAgBkEAShtyNgIAIA4gA2ohDiARQQFqIhEgBEcNAAsgDCACaiEMIA1BAWoiDSADRw0ACwsLIQACQEEAIAIgAyAEIAUgABAAIAJBACAEIAUgBiABEAALCw=="},{}],4:[function(t,e,r){e.exports={name:"resize",fn:t("./resize"),wasm_fn:t("./resize_wasm"),wasm_src:t("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(t,e,r){var n=t("./resize_filter_gen"),i=t("./convolve").convolveHorizontally,o=t("./convolve").convolveVertically;e.exports=function(t){var e=t.src,r=t.width,s=t.height,a=t.toWidth,c=t.toHeight,u=t.scaleX||t.toWidth/t.width,h=t.scaleY||t.toHeight/t.height,l=t.offsetX||0,d=t.offsetY||0,f=t.dest||new Uint8Array(a*c*4),p=void 0===t.quality?3:t.quality,g=t.alpha||!1,A=n(p,r,a,u,l),b=n(p,s,c,h,d),m=new Uint8Array(a*s*4);return i(e,m,r,s,a,A),o(m,f,s,a,c,b),g||function(t,e,r){for(var n=3,i=e*r*4|0;n<i;)t[n]=255,n=n+4|0}(f,a,c),f}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(t,e,r){var n=t("./resize_filter_info");function i(t){return Math.round(16383*t)}e.exports=function(t,e,r,o,s){var a,c,u,h,l,d,f,p,g,A,b,m,w,y,v,_,I=n[t].filter,C=1/o,E=Math.min(1,o),O=n[t].win/E,x=Math.floor(2*(O+1)),B=new Int16Array((x+2)*r),j=0,k=!B.subarray||!B.set;for(a=0;a<r;a++){for(c=(a+.5)*C+s,u=Math.max(0,Math.floor(c-O)),l=(h=Math.min(e-1,Math.ceil(c+O)))-u+1,d=new Float32Array(l),f=new Int16Array(l),p=0,g=u,A=0;g<=h;g++,A++)p+=b=I((g+.5-c)*E),d[A]=b;for(m=0,A=0;A<d.length;A++)m+=w=d[A]/p,f[A]=i(w);for(f[r>>1]+=i(1-m),y=0;y<f.length&&0===f[y];)y++;if(y<f.length){for(v=f.length-1;v>0&&0===f[v];)v--;if(_=v-y+1,B[j++]=u+y,B[j++]=_,k)for(A=y;A<=v;A++)B[j++]=f[A];else B.set(f.subarray(y,v+1),j),j+=_}else B[j++]=0,B[j++]=0}return B}},{"./resize_filter_info":7}],7:[function(t,e,r){e.exports=[{win:.5,filter:function(t){return t>=-.5&&t<.5?1:0}},{win:1,filter:function(t){if(t<=-1||t>=1)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*(.54+.46*Math.cos(e/1))}},{win:2,filter:function(t){if(t<=-2||t>=2)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*Math.sin(e/2)/(e/2)}},{win:3,filter:function(t){if(t<=-3||t>=3)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*Math.sin(e/3)/(e/3)}}]},{}],8:[function(t,e,r){var n=t("./resize_filter_gen"),i=!0;try{i=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]}catch(s){}function o(t,e,r){if(i)e.set(function(t){return new Uint8Array(t.buffer,0,t.byteLength)}(t),r);else for(var n=r,o=0;o<t.length;o++){var s=t[o];e[n++]=255&s,e[n++]=s>>8&255}}e.exports=function(t){var e=t.src,r=t.width,i=t.height,s=t.toWidth,a=t.toHeight,c=t.scaleX||t.toWidth/t.width,u=t.scaleY||t.toHeight/t.height,h=t.offsetX||0,l=t.offsetY||0,d=t.dest||new Uint8Array(s*a*4),f=void 0===t.quality?3:t.quality,p=t.alpha||!1,g=n(f,r,s,c,h),A=n(f,i,a,u,l),b=this.__align(0+Math.max(e.byteLength,d.byteLength)),m=this.__align(b+i*s*4),w=this.__align(m+g.byteLength),y=this.__instance("resize",w+A.byteLength),v=new Uint8Array(this.__memory.buffer),_=new Uint32Array(this.__memory.buffer),I=new Uint32Array(e.buffer);return _.set(I),o(g,v,m),o(A,v,w),(y.exports.convolveHV||y.exports._convolveHV)(m,w,b,r,i,s,a),new Uint32Array(d.buffer).set(new Uint32Array(this.__memory.buffer,0,a*s)),p||function(t,e,r){for(var n=3,i=e*r*4|0;n<i;)t[n]=255,n=n+4|0}(d,s,a),d}},{"./resize_filter_gen":6}],9:[function(t,e,r){function n(t,e){this.create=t,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=e||2e3}n.prototype.acquire=function(){var t,e=this;return 0!==this.available.length?t=this.available.pop():((t=this.create()).id=this.lastId++,t.release=function(){return e.release(t)}),this.acquired[t.id]=t,t},n.prototype.release=function(t){var e=this;delete this.acquired[t.id],t.lastUsed=Date.now(),this.available.push(t),0===this.timeoutId&&(this.timeoutId=setTimeout(function(){return e.gc()},100))},n.prototype.gc=function(){var t=this,e=Date.now();this.available=this.available.filter(function(r){return!(e-r.lastUsed>t.idle&&(r.destroy(),1))}),this.timeoutId=0!==this.available.length?setTimeout(function(){return t.gc()},100):0},e.exports=n},{}],10:[function(t,e,r){e.exports=function(t,e,r,n,i,o){var s=(2*o+2+1)/i;if(s>.5)return[[r,n]];var a=Math.ceil(Math.log(Math.min(r/t,n/e))/Math.log(s));if(a<=1)return[[r,n]];for(var c=[],u=0;u<a;u++){var h=Math.round(Math.pow(Math.pow(t,a-u-1)*Math.pow(r,u+1),1/a)),l=Math.round(Math.pow(Math.pow(e,a-u-1)*Math.pow(n,u+1),1/a));c.push([h,l])}return c}},{}],11:[function(t,e,r){function n(t){var e=Math.round(t);return Math.abs(t-e)<1e-5?e:Math.floor(t)}function i(t){var e=Math.round(t);return Math.abs(t-e)<1e-5?e:Math.ceil(t)}e.exports=function(t){var e,r,o,s,a,c,u=t.toWidth/t.width,h=t.toHeight/t.height,l=n(t.srcTileSize*u)-2*t.destTileBorder,d=n(t.srcTileSize*h)-2*t.destTileBorder;if(l<1||d<1)throw new Error("Internal error in pica: target tile width/height is too small.");var f,p=[];for(s=0;s<t.toHeight;s+=d)for(o=0;o<t.toWidth;o+=l)(e=o-t.destTileBorder)<0&&(e=0),e+(a=o+l+t.destTileBorder-e)>=t.toWidth&&(a=t.toWidth-e),(r=s-t.destTileBorder)<0&&(r=0),r+(c=s+d+t.destTileBorder-r)>=t.toHeight&&(c=t.toHeight-r),f={toX:e,toY:r,toWidth:a,toHeight:c,toInnerX:o,toInnerY:s,toInnerWidth:l,toInnerHeight:d,offsetX:e/u-n(e/u),offsetY:r/h-n(r/h),scaleX:u,scaleY:h,x:n(e/u),y:n(r/h),width:i(a/u),height:i(c/h)},p.push(f);return p}},{}],12:[function(t,e,r){function n(t){return Object.prototype.toString.call(t)}e.exports.isCanvas=function(t){var e=n(t);return"[object HTMLCanvasElement]"===e||"[object OffscreenCanvas]"===e||"[object Canvas]"===e},e.exports.isImage=function(t){return"[object HTMLImageElement]"===n(t)},e.exports.isImageBitmap=function(t){return"[object ImageBitmap]"===n(t)},e.exports.limiter=function(t){var e=0,r=[];function n(){e<t&&r.length&&(e++,r.shift()())}return function(t){return new Promise(function(i,o){r.push(function(){t().then(function(t){i(t),e--,n()},function(t){o(t),e--,n()})}),n()})}},e.exports.cib_quality_name=function(t){switch(t){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},e.exports.cib_support=function(t){return Promise.resolve().then(function(){if("undefined"==typeof createImageBitmap)return!1;var e=t(100,100);return createImageBitmap(e,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(t){var r=10===t.width;return t.close(),e=null,r})}).catch(function(){return!1})}},{}],13:[function(t,e,r){e.exports=function(){var e,r=t("./mathlib");onmessage=function(t){var n=t.data.opts;e||(e=new r(t.data.features));var i=e.resizeAndUnsharp(n);postMessage({result:i},[i.buffer])}}},{"./mathlib":1}],14:[function(t,e,r){var n,i,o,s,a,c;function u(t,e,r,n,i,o){var s,a,c,u,h,l,d,f,p,g,A,b,m,w;for(p=0;p<o;p++){for(d=p,f=0,u=h=(s=t[l=p*i])*n[6],A=n[0],b=n[1],m=n[4],w=n[5],g=0;g<i;g++)c=(a=t[l])*A+s*b+u*m+h*w,h=u,s=a,r[f]=u=c,f++,l++;for(f--,d+=o*(i-1),u=h=(s=t[--l])*n[7],a=s,A=n[2],b=n[3],g=i-1;g>=0;g--)c=a*A+s*b+u*m+h*w,h=u,s=a,a=t[l],e[d]=r[f]+(u=c),l--,f--,d-=o}}e.exports=function(t,e,r,h){if(h){var l=new Uint16Array(t.length),d=new Float32Array(Math.max(e,r)),f=function(t){t<.5&&(t=.5);var e=Math.exp(.527076)/t,r=Math.exp(-e),u=Math.exp(-2*e),h=(1-r)*(1-r)/(1+2*e*r-u);return n=h,i=h*(e-1)*r,o=h*(e+1)*r,s=-h*u,a=2*r,c=-u,new Float32Array([n,i,o,s,a,c,(n+i)/(1-a-c),(o+s)/(1-a-c)])}(h);u(t,l,d,f,e,r),u(l,t,d,f,r,e)}}},{}],15:[function(t,e,r){e.exports="function"==typeof Object.create?function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}},{}],16:[function(t,e,r){var n=t("object-assign"),i=t("./lib/base64decode"),o=t("./lib/wa_detect"),s={js:!0,wasm:!0};function a(t){if(!(this instanceof a))return new a(t);var e=n({},s,t||{});if(this.options=e,this.__cache={},this.__init_promise=null,this.__modules=e.modules||{},this.__memory=null,this.__wasm={},this.__isLE=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0],!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}a.prototype.has_wasm=o,a.prototype.use=function(t){return this.__modules[t.name]=t,this[t.name]=this.options.wasm&&this.has_wasm()&&t.wasm_fn?t.wasm_fn:t.fn,this},a.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error('mathlib: only "wasm" was enabled, but it\'s not supported'));var t=this;return this.__init_promise=Promise.all(Object.keys(t.__modules).map(function(e){var r=t.__modules[e];return t.options.wasm&&t.has_wasm()&&r.wasm_fn?t.__wasm[e]?null:WebAssembly.compile(t.__base64decode(r.wasm_src)).then(function(r){t.__wasm[e]=r}):null})).then(function(){return t}),this.__init_promise},a.prototype.__base64decode=i,a.prototype.__reallocate=function(t){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(t/65536)}),this.__memory;var e=this.__memory.buffer.byteLength;return e<t&&this.__memory.grow(Math.ceil((t-e)/65536)),this.__memory},a.prototype.__instance=function(t,e,r){if(e&&this.__reallocate(e),this.__wasm[t]||(this.__wasm[t]=new WebAssembly.Module(this.__base64decode(this.__modules[t].wasm_src))),!this.__cache[t]){var i={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[t]=new WebAssembly.Instance(this.__wasm[t],{env:n(i,r||{})})}return this.__cache[t]},a.prototype.__align=function(t,e){var r=t%(e=e||8);return t+(r?e-r:0)},e.exports=a},{"./lib/base64decode":17,"./lib/wa_detect":23,"object-assign":24}],17:[function(t,e,r){e.exports=function(t){for(var e=t.replace(/[\r\n=]/g,""),r=e.length,n=new Uint8Array(3*r>>2),i=0,o=0,s=0;s<r;s++)s%4==0&&s&&(n[o++]=i>>16&255,n[o++]=i>>8&255,n[o++]=255&i),i=i<<6|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e.charAt(s));var a=r%4*6;return 0===a?(n[o++]=i>>16&255,n[o++]=i>>8&255,n[o++]=255&i):18===a?(n[o++]=i>>10&255,n[o++]=i>>2&255):12===a&&(n[o++]=i>>4&255),n}},{}],18:[function(t,e,r){e.exports=function(t,e,r){for(var n,i,o,s=e*r,a=new Uint16Array(s),c=0;c<s;c++)o=t[4*c+2],a[c]=257*(((n=t[4*c])>=(i=t[4*c+1])&&n>=o?n:i>=o&&i>=n?i:o)+(n<=i&&n<=o?n:i<=o&&i<=n?i:o))>>1;return a}},{}],19:[function(t,e,r){e.exports={name:"unsharp_mask",fn:t("./unsharp_mask"),wasm_fn:t("./unsharp_mask_wasm"),wasm_src:t("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":20,"./unsharp_mask_wasm":21,"./unsharp_mask_wasm_base64":22}],20:[function(t,e,r){var n=t("glur/mono16"),i=t("./hsl_l16");e.exports=function(t,e,r,o,s,a){var c,u,h,l,d,f,p,g,A,b,m,w,y;if(!(0===o||s<.5)){s>2&&(s=2);var v=i(t,e,r),_=new Uint16Array(v);n(_,e,r,s);for(var I=o/100*4096+.5|0,C=257*a|0,E=e*r,O=0;O<E;O++)w=2*(v[O]-_[O]),Math.abs(w)>=C&&(h=t[2+(y=4*O)],f=257*((g=(c=t[y])>=(u=t[y+1])&&c>=h?c:u>=c&&u>=h?u:h)+(p=c<=u&&c<=h?c:u<=c&&u<=h?u:h))>>1,p===g?l=d=0:(d=f<=32767?4095*(g-p)/(g+p)|0:4095*(g-p)/(510-g-p)|0,l=c===g?65535*(u-h)/(6*(g-p))|0:u===g?21845+(65535*(h-c)/(6*(g-p))|0):43690+(65535*(c-u)/(6*(g-p))|0)),(f+=I*w+2048>>12)>65535?f=65535:f<0&&(f=0),0===d?c=u=h=f>>8:(A=2*f-(b=f<=32767?f*(4096+d)+2048>>12:f+((65535-f)*d+2048>>12))>>8,b>>=8,c=(m=l+21845&65535)>=43690?A:m>=32767?A+(6*(b-A)*(43690-m)+32768>>16):m>=10922?b:A+(6*(b-A)*m+32768>>16),u=(m=65535&l)>=43690?A:m>=32767?A+(6*(b-A)*(43690-m)+32768>>16):m>=10922?b:A+(6*(b-A)*m+32768>>16),h=(m=l-21845&65535)>=43690?A:m>=32767?A+(6*(b-A)*(43690-m)+32768>>16):m>=10922?b:A+(6*(b-A)*m+32768>>16)),t[y]=c,t[y+1]=u,t[y+2]=h)}}},{"./hsl_l16":18,"glur/mono16":14}],21:[function(t,e,r){e.exports=function(t,e,r,n,i,o){if(!(0===n||i<.5)){i>2&&(i=2);var s=e*r,a=4*s,c=2*s,u=2*s,h=4*Math.max(e,r),l=a,d=l+c,f=d+u,p=f+u,g=p+h,A=this.__instance("unsharp_mask",a+c+2*u+h+32,{exp:Math.exp}),b=new Uint32Array(t.buffer);new Uint32Array(this.__memory.buffer).set(b);var m=A.exports.hsl_l16||A.exports._hsl_l16;m(0,l,e,r),(m=A.exports.blurMono16||A.exports._blurMono16)(l,d,f,p,g,e,r,i),(m=A.exports.unsharp||A.exports._unsharp)(0,0,l,d,e,r,n,o),b.set(new Uint32Array(this.__memory.buffer,0,s))}}},{}],22:[function(t,e,r){e.exports="AGFzbQEAAAABMQZgAXwBfGACfX8AYAZ/f39/f38AYAh/f39/f39/fQBgBH9/f38AYAh/f39/f39/fwACGQIDZW52A2V4cAAAA2VudgZtZW1vcnkCAAEDBgUBAgMEBQQEAXAAAAdMBRZfX2J1aWxkX2dhdXNzaWFuX2NvZWZzAAEOX19nYXVzczE2X2xpbmUAAgpibHVyTW9ubzE2AAMHaHNsX2wxNgAEB3Vuc2hhcnAABQkBAAqJEAXZAQEGfAJAIAFE24a6Q4Ia+z8gALujIgOaEAAiBCAEoCIGtjgCECABIANEAAAAAAAAAMCiEAAiBbaMOAIUIAFEAAAAAAAA8D8gBKEiAiACoiAEIAMgA6CiRAAAAAAAAPA/oCAFoaMiArY4AgAgASAEIANEAAAAAAAA8L+gIAKioiIHtjgCBCABIAQgA0QAAAAAAADwP6AgAqKiIgO2OAIIIAEgBSACoiIEtow4AgwgASACIAegIAVEAAAAAAAA8D8gBqGgIgKjtjgCGCABIAMgBKEgAqO2OAIcCwu3AwMDfwR9CHwCQCADKgIUIQkgAyoCECEKIAMqAgwhCyADKgIIIQwCQCAEQX9qIgdBAEgiCA0AIAIgAC8BALgiDSADKgIYu6IiDiAJuyIQoiAOIAq7IhGiIA0gAyoCBLsiEqIgAyoCALsiEyANoqCgoCIPtjgCACACQQRqIQIgAEECaiEAIAdFDQAgBCEGA0AgAiAOIBCiIA8iDiARoiANIBKiIBMgAC8BALgiDaKgoKAiD7Y4AgAgAkEEaiECIABBAmohACAGQX9qIgZBAUoNAAsLAkAgCA0AIAEgByAFbEEBdGogAEF+ai8BACIIuCINIAu7IhGiIA0gDLsiEqKgIA0gAyoCHLuiIg4gCrsiE6KgIA4gCbsiFKKgIg8gAkF8aioCALugqzsBACAHRQ0AIAJBeGohAiAAQXxqIQBBACAFQQF0ayEHIAEgBSAEQQF0QXxqbGohBgNAIAghAyAALwEAIQggBiANIBGiIAO4Ig0gEqKgIA8iECAToqAgDiAUoqAiDyACKgIAu6CrOwEAIAYgB2ohBiAAQX5qIQAgAkF8aiECIBAhDiAEQX9qIgRBAUoNAAsLCwvfAgIDfwZ8AkAgB0MAAAAAWw0AIARE24a6Q4Ia+z8gB0MAAAA/l7ujIgyaEAAiDSANoCIPtjgCECAEIAxEAAAAAAAAAMCiEAAiDraMOAIUIAREAAAAAAAA8D8gDaEiCyALoiANIAwgDKCiRAAAAAAAAPA/oCAOoaMiC7Y4AgAgBCANIAxEAAAAAAAA8L+gIAuioiIQtjgCBCAEIA0gDEQAAAAAAADwP6AgC6KiIgy2OAIIIAQgDiALoiINtow4AgwgBCALIBCgIA5EAAAAAAAA8D8gD6GgIgujtjgCGCAEIAwgDaEgC6O2OAIcIAYEQCAFQQF0IQogBiEJIAIhCANAIAAgCCADIAQgBSAGEAIgACAKaiEAIAhBAmohCCAJQX9qIgkNAAsLIAVFDQAgBkEBdCEIIAUhAANAIAIgASADIAQgBiAFEAIgAiAIaiECIAFBAmohASAAQX9qIgANAAsLC7wBAQV/IAMgAmwiAwRAQQAgA2shBgNAIAAoAgAiBEEIdiIHQf8BcSECAn8gBEH/AXEiAyAEQRB2IgRB/wFxIgVPBEAgAyIIIAMgAk8NARoLIAQgBCAHIAIgA0kbIAIgBUkbQf8BcQshCAJAIAMgAk0EQCADIAVNDQELIAQgByAEIAMgAk8bIAIgBUsbQf8BcSEDCyAAQQRqIQAgASADIAhqQYECbEEBdjsBACABQQJqIQEgBkEBaiIGDQALCwvTBgEKfwJAIAazQwAAgEWUQwAAyEKVu0QAAAAAAADgP6CqIQ0gBSAEbCILBEAgB0GBAmwhDgNAQQAgAi8BACADLwEAayIGQQF0IgdrIAcgBkEASBsgDk8EQCAAQQJqLQAAIQUCfyAALQAAIgYgAEEBai0AACIESSIJRQRAIAYiCCAGIAVPDQEaCyAFIAUgBCAEIAVJGyAGIARLGwshCAJ/IAYgBE0EQCAGIgogBiAFTQ0BGgsgBSAFIAQgBCAFSxsgCRsLIgogCGoiD0GBAmwiEEEBdiERQQAhDAJ/QQAiCSAIIApGDQAaIAggCmsiCUH/H2wgD0H+AyAIayAKayAQQYCABEkbbSEMIAYgCEYEQCAEIAVrQf//A2wgCUEGbG0MAQsgBSAGayAGIARrIAQgCEYiBhtB//8DbCAJQQZsbUHVqgFBqtUCIAYbagshCSARIAcgDWxBgBBqQQx1aiIGQQAgBkEAShsiBkH//wMgBkH//wNIGyEGAkACfwJAIAxB//8DcSIFBEAgBkH//wFKDQEgBUGAIGogBmxBgBBqQQx2DAILIAZBCHYiBiEFIAYhBAwCCyAFIAZB//8Dc2xBgBBqQQx2IAZqCyIFQQh2IQcgBkEBdCAFa0EIdiIGIQQCQCAJQdWqAWpB//8DcSIFQanVAksNACAFQf//AU8EQEGq1QIgBWsgByAGa2xBBmxBgIACakEQdiAGaiEEDAELIAchBCAFQanVAEsNACAFIAcgBmtsQQZsQYCAAmpBEHYgBmohBAsCfyAGIgUgCUH//wNxIghBqdUCSw0AGkGq1QIgCGsgByAGa2xBBmxBgIACakEQdiAGaiAIQf//AU8NABogByIFIAhBqdUASw0AGiAIIAcgBmtsQQZsQYCAAmpBEHYgBmoLIQUgCUGr1QJqQf//A3EiCEGp1QJLDQAgCEH//wFPBEBBqtUCIAhrIAcgBmtsQQZsQYCAAmpBEHYgBmohBgwBCyAIQanVAEsEQCAHIQYMAQsgCCAHIAZrbEEGbEGAgAJqQRB2IAZqIQYLIAEgBDoAACABQQFqIAU6AAAgAUECaiAGOgAACyADQQJqIQMgAkECaiECIABBBGohACABQQRqIQEgC0F/aiILDQALCwsL"},{}],23:[function(t,e,r){var n;e.exports=function(){if(void 0!==n)return n;if(n=!1,"undefined"==typeof WebAssembly)return n;try{var t=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),e=new WebAssembly.Module(t);return 0!==new WebAssembly.Instance(e,{}).exports.test(4)&&(n=!0),n}catch(r){}return n}},{}],24:[function(t,e,r){var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function s(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}e.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(i){return!1}}()?Object.assign:function(t,e){for(var r,a,c=s(t),u=1;u<arguments.length;u++){for(var h in r=Object(arguments[u]))i.call(r,h)&&(c[h]=r[h]);if(n){a=n(r);for(var l=0;l<a.length;l++)o.call(r,a[l])&&(c[a[l]]=r[a[l]])}}return c}},{}],25:[function(t,e,r){var n=arguments[3],i=arguments[4],o=arguments[5],s=JSON.stringify;e.exports=function(t,e){for(var r,a=Object.keys(o),c=0,u=a.length;c<u;c++){var h=o[d=a[c]].exports;if(h===t||h&&h.default===t){r=d;break}}if(!r){r=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var l={};for(c=0,u=a.length;c<u;c++){var d;l[d=a[c]]=d}i[r]=["function(require,module,exports){"+t+"(self); }",l]}var f=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[r]=r,i[f]=["function(require,module,exports){var f = require("+s(r)+");(f.default ? f.default : f)(self);}",p];var g={};!function t(e){for(var r in g[e]=!0,i[e][1]){var n=i[e][1][r];g[n]||t(n)}}(f);var A="("+n+")({"+Object.keys(g).map(function(t){return s(t)+":["+i[t][0]+","+s(i[t][1])+"]"}).join(",")+"},{},["+s(f)+"])",b=window.URL||window.webkitURL||window.mozURL||window.msURL,m=new Blob([A],{type:"text/javascript"});if(e&&e.bare)return m;var w=b.createObjectURL(m),y=new Worker(w);return y.objectURL=w,y}},{}],"/index.js":[function(t,e,r){function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var i=t("object-assign"),o=t("webworkify"),s=t("./lib/mathlib"),a=t("./lib/pool"),c=t("./lib/utils"),u=t("./lib/worker"),h=t("./lib/stepper"),l=t("./lib/tiler"),d={},f=!1;try{"undefined"!=typeof navigator&&navigator.userAgent&&(f=navigator.userAgent.indexOf("Safari")>=0)}catch(v){}var p=1;"undefined"!=typeof navigator&&(p=Math.min(navigator.hardwareConcurrency||1,4));var g,A,b={tile:1024,concurrency:p,features:["js","wasm","ww"],idle:2e3,createCanvas:function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,r}},m={quality:3,alpha:!1,unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0};function w(){return{value:o(u),destroy:function(){if(this.value.terminate(),"undefined"!=typeof window){var t=window.URL||window.webkitURL||window.mozURL||window.msURL;t&&t.revokeObjectURL&&this.value.objectURL&&t.revokeObjectURL(this.value.objectURL)}}}}function y(t){if(!(this instanceof y))return new y(t);this.options=i({},b,t||{});var e="lk_".concat(this.options.concurrency);this.__limit=d[e]||c.limiter(this.options.concurrency),d[e]||(d[e]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}y.prototype.init=function(){var e=this;if(this.__initPromise)return this.__initPromise;if(!1!==g&&!0!==g&&(g=!1,"undefined"!=typeof ImageData&&"undefined"!=typeof Uint8ClampedArray))try{new ImageData(new Uint8ClampedArray(400),10,10),g=!0}catch(h){}!1!==A&&!0!==A&&(A=!1,"undefined"!=typeof ImageBitmap&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?A=!0:this.debug("ImageBitmap does not support .close(), disabled")));var r=this.options.features.slice();if(r.indexOf("all")>=0&&(r=["cib","wasm","js","ww"]),this.__requested_features=r,this.__mathlib=new s(r),r.indexOf("ww")>=0&&"undefined"!=typeof window&&"Worker"in window)try{t("webworkify")(function(){}).terminate(),this.features.ww=!0;var n="wp_".concat(JSON.stringify(this.options));d[n]?this.__workersPool=d[n]:(this.__workersPool=new a(w,this.options.idle),d[n]=this.__workersPool)}catch(h){}var o,u=this.__mathlib.init().then(function(t){i(e.features,t.features)});return o=A?c.cib_support(this.options.createCanvas).then(function(t){e.features.cib&&r.indexOf("cib")<0?e.debug("createImageBitmap() resize supported, but disabled by config"):r.indexOf("cib")>=0&&(e.features.cib=t)}):Promise.resolve(!1),this.__initPromise=Promise.all([u,o]).then(function(){return e}),this.__initPromise},y.prototype.resize=function(t,e,r){var o=this;this.debug("Start resize...");var s=i({},m);if(isNaN(r)?r&&(s=i(s,r)):s=i(s,{quality:r}),s.toWidth=e.width,s.toHeight=e.height,s.width=t.naturalWidth||t.width,s.height=t.naturalHeight||t.height,0===e.width||0===e.height)return Promise.reject(new Error("Invalid output size: ".concat(e.width,"x").concat(e.height)));s.unsharpRadius>2&&(s.unsharpRadius=2);var a=!1,u=null;s.cancelToken&&(u=s.cancelToken.then(function(t){throw a=!0,t},function(t){throw a=!0,t}));var d=Math.ceil(Math.max(3,2.5*s.unsharpRadius|0));return this.init().then(function(){if(a)return u;if(o.features.cib){var r=e.getContext("2d",{alpha:Boolean(s.alpha)});return o.debug("Resize via createImageBitmap()"),createImageBitmap(t,{resizeWidth:s.toWidth,resizeHeight:s.toHeight,resizeQuality:c.cib_quality_name(s.quality)}).then(function(t){if(a)return u;if(!s.unsharpAmount)return r.drawImage(t,0,0),t.close(),r=null,o.debug("Finished!"),e;o.debug("Unsharp result");var n=o.options.createCanvas(s.toWidth,s.toHeight),i=n.getContext("2d",{alpha:Boolean(s.alpha)});i.drawImage(t,0,0),t.close();var c=i.getImageData(0,0,s.toWidth,s.toHeight);return o.__mathlib.unsharp_mask(c.data,s.toWidth,s.toHeight,s.unsharpAmount,s.unsharpRadius,s.unsharpThreshold),r.putImageData(c,0,0),n.width=n.height=0,c=i=n=r=null,o.debug("Finished!"),e})}var p={},b=function(t,e,r){var n,i,s,h=!1;return Promise.resolve().then(function(){if(s=e.getContext("2d",{alpha:Boolean(r.alpha)}),c.isCanvas(t))return n=t.getContext("2d",{alpha:Boolean(r.alpha)}),null;if(c.isImageBitmap(t))return i=t,h=!0,null;if(c.isImage(t))return A?(o.debug("Decode image via createImageBitmap"),createImageBitmap(t).then(function(t){i=t}).catch(function(t){return null})):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')}).then(function(){if(a)return u;o.debug("Calculate tiles");var A=l({width:r.width,height:r.height,srcTileSize:o.options.tile,toWidth:r.toWidth,toHeight:r.toHeight,destTileBorder:d}).map(function(e){return function(e){return o.__limit(function(){if(a)return u;var h;if(c.isCanvas(t))o.debug("Get tile pixel data"),h=n.getImageData(e.x,e.y,e.width,e.height);else{o.debug("Draw tile imageBitmap/image to temporary canvas");var l=o.options.createCanvas(e.width,e.height),d=l.getContext("2d",{alpha:Boolean(r.alpha)});d.globalCompositeOperation="copy",d.drawImage(i||t,e.x,e.y,e.width,e.height,0,0,e.width,e.height),o.debug("Get tile pixel data"),h=d.getImageData(0,0,e.width,e.height),l.width=l.height=0,d=l=null}var A={src:h.data,width:e.width,height:e.height,toWidth:e.toWidth,toHeight:e.toHeight,scaleX:e.scaleX,scaleY:e.scaleY,offsetX:e.offsetX,offsetY:e.offsetY,quality:r.quality,alpha:r.alpha,unsharpAmount:r.unsharpAmount,unsharpRadius:r.unsharpRadius,unsharpThreshold:r.unsharpThreshold};return o.debug("Invoke resize math"),Promise.resolve().then(function(){return function(t){return Promise.resolve().then(function(){return o.features.ww?new Promise(function(e,r){var n=o.__workersPool.acquire();u&&u.catch(function(t){return r(t)}),n.value.onmessage=function(t){n.release(),t.data.err?r(t.data.err):e(t.data.result)},n.value.postMessage({opts:t,features:o.__requested_features,preload:{wasm_nodule:o.__mathlib.__}},[t.src.buffer])}):o.__mathlib.resizeAndUnsharp(t,p)})}(A)}).then(function(t){if(a)return u;var r;if(h=null,o.debug("Convert raw rgba tile result to ImageData"),g)r=new ImageData(new Uint8ClampedArray(t),e.toWidth,e.toHeight);else if((r=s.createImageData(e.toWidth,e.toHeight)).data.set)r.data.set(t);else for(var n=r.data.length-1;n>=0;n--)r.data[n]=t[n];return o.debug("Draw tile"),f?s.putImageData(r,e.toX,e.toY,e.toInnerX-e.toX,e.toInnerY-e.toY,e.toInnerWidth+1e-5,e.toInnerHeight+1e-5):s.putImageData(r,e.toX,e.toY,e.toInnerX-e.toX,e.toInnerY-e.toY,e.toInnerWidth,e.toInnerHeight),null})})}(e)});function b(){i&&(h||i.close(),i=null)}return o.debug("Process tiles"),Promise.all(A).then(function(){return o.debug("Finished!"),b(),e},function(t){throw b(),t})})};return function t(e,r,s,c){if(a)return u;var h,l,d,f=(l=e.shift(),d=2,function(t){if(Array.isArray(t))return t}(l)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(c){i=!0,o=c}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}}(l,d)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(l,d)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=f[0],g=f[1],A=0===e.length;return c=i({},c,{toWidth:p,toHeight:g,quality:A?c.quality:Math.min(1,c.quality)}),A||(h=o.options.createCanvas(p,g)),b(r,A?s:h,c).then(function(){return A?s:(c.width=p,c.height=g,t(e,h,s,c))}).then(function(t){return h&&(h.width=h.height=0),t})}(h(s.width,s.height,s.toWidth,s.toHeight,o.options.tile,d),t,e,s)})},y.prototype.resizeBuffer=function(t){var e=this,r=i({},m,t);return this.init().then(function(){return e.__mathlib.resizeAndUnsharp(r)})},y.prototype.toBlob=function(t,e,r){return e=e||"image/png",new Promise(function(n){if(t.toBlob)t.toBlob(function(t){return n(t)},e,r);else if(t.convertToBlob)n(t.convertToBlob({type:e,quality:r}));else{for(var i=atob(t.toDataURL(e,r).split(",")[1]),o=i.length,s=new Uint8Array(o),a=0;a<o;a++)s[a]=i.charCodeAt(a);n(new Blob([s],{type:e}))}})},y.prototype.debug=function(){},e.exports=y},{"./lib/mathlib":1,"./lib/pool":9,"./lib/stepper":10,"./lib/tiler":11,"./lib/utils":12,"./lib/worker":13,"object-assign":24,webworkify:25}]},{},[])("/index.js")}),y=b(function(t){function e(t,e){var r=new Error(t);return r.code=e,r}function r(t){for(var e=t.toString(16).toUpperCase(),r=2-e.length;r>0;r--)e="0"+e;return"0x"+e}function n(t){try{return decodeURIComponent(escape(t))}catch(e){return t}}function i(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}function o(t,r,n){this.input=t.subarray(r,n),this.start=r;var i=String.fromCharCode.apply(null,this.input.subarray(0,4));if("II*\0"!==i&&"MM\0*"!==i)throw e("invalid TIFF signature","EBADDATA");this.big_endian="M"===i[0]}o.prototype.each=function(t){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var r=this.ifds_to_read.shift();r.offset&&this.scan_ifd(r.id,r.offset,t)}},o.prototype.filter=function(t){var r={ifd0:{id:0,entries:[]}};this.each(function(e){(!1!==t(e)||e.is_subifd_link)&&(e.is_subifd_link&&1!==e.count&&4!==e.format||(r["ifd"+e.ifd]||(r["ifd"+e.ifd]={id:e.ifd,entries:[]}),r["ifd"+e.ifd].entries.push(e)))}),delete r.ifd1;var n=8;Object.keys(r).forEach(function(t){n+=2,r[t].entries.forEach(function(t){n+=12+(t.data_length>4?2*Math.ceil(t.data_length/2):0)}),n+=4}),this.output=new Uint8Array(n),this.output[0]=this.output[1]=(this.big_endian?"M":"I").charCodeAt(0),this.write_uint16(2,42);var i=8,o=this;if(this.write_uint32(4,i),Object.keys(r).forEach(function(t){r[t].written_offset=i;var e=i,n=e+2+12*r[t].entries.length+4;i=n,o.write_uint16(e,r[t].entries.length),r[t].entries.sort(function(t,e){return t.tag-e.tag}).forEach(function(t,n){var s=e+2+12*n;o.write_uint16(s,t.tag),o.write_uint16(s+2,t.format),o.write_uint32(s+4,t.count),t.is_subifd_link?r["ifd"+t.tag]&&(r["ifd"+t.tag].link_offset=s+8):t.data_length<=4?o.output.set(o.input.subarray(t.data_offset-o.start,t.data_offset-o.start+4),s+8):(o.write_uint32(s+8,i),o.output.set(o.input.subarray(t.data_offset-o.start,t.data_offset-o.start+t.data_length),i),i+=2*Math.ceil(t.data_length/2))});var s=r["ifd"+(r[t].id+1)];s&&(s.link_offset=n-4)}),Object.keys(r).forEach(function(t){r[t].written_offset&&r[t].link_offset&&o.write_uint32(r[t].link_offset,r[t].written_offset)}),this.output.length!==i)throw e("internal error: incorrect buffer size allocated");return this.output},o.prototype.read_uint16=function(t){var r=this.input;if(t+2>r.length)throw e("unexpected EOF","EBADDATA");return this.big_endian?256*r[t]+r[t+1]:r[t]+256*r[t+1]},o.prototype.read_uint32=function(t){var r=this.input;if(t+4>r.length)throw e("unexpected EOF","EBADDATA");return this.big_endian?16777216*r[t]+65536*r[t+1]+256*r[t+2]+r[t+3]:r[t]+256*r[t+1]+65536*r[t+2]+16777216*r[t+3]},o.prototype.write_uint16=function(t,e){var r=this.output;this.big_endian?(r[t]=e>>>8&255,r[t+1]=255&e):(r[t]=255&e,r[t+1]=e>>>8&255)},o.prototype.write_uint32=function(t,e){var r=this.output;this.big_endian?(r[t]=e>>>24&255,r[t+1]=e>>>16&255,r[t+2]=e>>>8&255,r[t+3]=255&e):(r[t]=255&e,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255)},o.prototype.is_subifd_link=function(t,e){return 0===t&&34665===e||0===t&&34853===e||34665===t&&40965===e},o.prototype.exif_format_length=function(t){switch(t){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},o.prototype.exif_format_read=function(t,e){var r;switch(t){case 1:case 2:return this.input[e];case 6:return(r=this.input[e])|33554430*(128&r);case 3:return this.read_uint16(e);case 8:return(r=this.read_uint16(e))|131070*(32768&r);case 4:return this.read_uint32(e);case 9:return 0|this.read_uint32(e);case 5:case 10:case 11:case 12:case 7:default:return null}},o.prototype.scan_ifd=function(t,r,i){var o=this.read_uint16(r);r+=2;for(var s=0;s<o;s++){var a=this.read_uint16(r),c=this.read_uint16(r+2),u=this.read_uint32(r+4),h=this.exif_format_length(c),l=u*h,d=l<=4?r+8:this.read_uint32(r+8),f=!1;if(d+l>this.input.length)throw e("unexpected EOF","EBADDATA");for(var p=[],g=d,A=0;A<u;A++,g+=h){var b=this.exif_format_read(c,g);if(null===b){p=null;break}p.push(b)}if(Array.isArray(p)&&2===c){try{p=n(String.fromCharCode.apply(null,p))}catch(m){p=null}p&&"\0"===p[p.length-1]&&(p=p.slice(0,-1))}if(this.is_subifd_link(t,a)&&Array.isArray(p)&&Number.isInteger(p[0])&&p[0]>0&&(this.ifds_to_read.push({id:a,offset:p[0]}),f=!0),!1===i({is_big_endian:this.big_endian,ifd:t,tag:a,format:c,count:u,entry_offset:r+this.start,data_length:l,data_offset:d+this.start,value:p,is_subifd_link:f}))return void(this.aborted=!0);r+=12}0===t&&this.ifds_to_read.push({id:1,offset:this.read_uint32(r)})},t.exports.is_jpeg=function(t){return t.length>=4&&255===t[0]&&216===t[1]&&255===t[2]},t.exports.jpeg_segments_each=function(n,o){if(!i(n))throw e("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if("function"!=typeof o)throw e("Invalid argument (on_segment), Function expected","EINVAL");if(!t.exports.is_jpeg(n))throw e("Unknown file format","ENOTJPEG");for(var s=0,a=n.length,c=!1;;){var u,h;if(s+1>=a)throw e("Unexpected EOF","EBADDATA");var l=n[s],d=n[s+1];if(255===l&&255===d)u=255,h=1;else if(255===l&&0!==d){if(h=2,208<=(u=d)&&u<=217||1===u);else{if(s+3>=a)throw e("Unexpected EOF","EBADDATA");if((h+=256*n[s+2]+n[s+3])<2)throw e("Invalid segment length","EBADDATA");if(s+h-1>=a)throw e("Unexpected EOF","EBADDATA")}c&&(u>=208&&u<=215||(c=!1)),218===u&&(c=!0)}else{if(!c)throw e("Unexpected byte at segment start: "+r(l)+" (offset "+r(s)+")","EBADDATA");for(var f=s+1;;f++){if(f>=a)throw e("Unexpected EOF","EBADDATA");if(255===n[f]){if(f+1>=a)throw e("Unexpected EOF","EBADDATA");if(0!==n[f+1]){u=0,h=f-s;break}}}}if(!1===o({code:u,offset:s,length:h}))break;if(217===u)break;s+=h}},t.exports.jpeg_segments_filter=function(r,n){if(!i(r))throw e("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if("function"!=typeof n)throw e("Invalid argument (on_segment), Function expected","EINVAL");var o=[],s=0;t.exports.jpeg_segments_each(r,function(t){var e=n(t);if(i(e))o.push({data:e}),s+=e.length;else if(Array.isArray(e))e.filter(i).forEach(function(t){o.push({data:t}),s+=t.length});else if(!1!==e){var r={start:t.offset,end:t.offset+t.length};o.length>0&&o[o.length-1].end===r.start?o[o.length-1].end=r.end:o.push(r),s+=t.length}});var a=new Uint8Array(s),c=0;return o.forEach(function(t){var e=t.data||r.subarray(t.start,t.end);a.set(e,c),c+=e.length}),a},t.exports.jpeg_exif_tags_each=function(r,n){if(!i(r))throw e("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if("function"!=typeof n)throw e("Invalid argument (on_exif_entry), Function expected","EINVAL");t.exports.jpeg_segments_each(r,function(t){return 218!==t.code&&(225===t.code&&t.length>=10&&69===r[t.offset+4]&&120===r[t.offset+5]&&105===r[t.offset+6]&&102===r[t.offset+7]&&0===r[t.offset+8]&&0===r[t.offset+9]?(new o(r,t.offset+10,t.offset+t.length).each(n),!1):void 0)})},t.exports.jpeg_exif_tags_filter=function(r,n){if(!i(r))throw e("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if("function"!=typeof n)throw e("Invalid argument (on_exif_entry), Function expected","EINVAL");var s=!1;return t.exports.jpeg_segments_filter(r,function(t){if(!s&&(218===t.code&&(s=!0),225===t.code&&t.length>=10&&69===r[t.offset+4]&&120===r[t.offset+5]&&105===r[t.offset+6]&&102===r[t.offset+7]&&0===r[t.offset+8]&&0===r[t.offset+9])){var e=new o(r,t.offset+10,t.offset+t.length).filter(n);if(!e)return!1;var i=new Uint8Array(10);return i.set(r.slice(t.offset,t.offset+10)),i[2]=e.length+8>>>8&255,i[3]=e.length+8&255,s=!0,[i,e]}})},t.exports.jpeg_add_comment=function(e,r){var n=!1,i=0;return t.exports.jpeg_segments_filter(e,function(t){if(!(1==++i&&216===t.code||2===i&&224===t.code||n)){r=function(t){try{return unescape(encodeURIComponent(t))}catch(e){return t}}(r);var o=new Uint8Array(5+r.length),s=0;return o[s++]=255,o[s++]=254,o[s++]=r.length+3>>>8&255,o[s++]=r.length+3&255,r.split("").forEach(function(t){o[s++]=255&t.charCodeAt(0)}),o[s++]=0,n=!0,[o,e.subarray(t.offset,t.offset+t.length)]}})}});function v(t){return this._getUint8Array(t.blob).then(function(e){if(t.is_jpeg=y.is_jpeg(e),!t.is_jpeg)return Promise.resolve(t);t.orig_blob=t.blob;try{var r,n;if(y.jpeg_exif_tags_each(e,function(e){if(0===e.ifd&&274===e.tag&&Array.isArray(e.value))return t.orientation=e.value[0]||1,r=e.big_endian,n=e.data_offset,!1}),n){var i=r?new Uint8Array([0,1]):new Uint8Array([1,0]);t.blob=new Blob([e.slice(0,n),i,e.slice(n+2)],{type:"image/jpeg"})}}catch(o){}return t})}function _(t){if(!t.is_jpeg)return Promise.resolve(t);var e,r=t.orientation-1;if(!r)return Promise.resolve(t);var n=(e=4&r?this.pica.options.createCanvas(t.out_canvas.height,t.out_canvas.width):this.pica.options.createCanvas(t.out_canvas.width,t.out_canvas.height)).getContext("2d");return n.save(),1&r&&n.transform(-1,0,0,1,e.width,0),2&r&&n.transform(-1,0,0,-1,e.width,e.height),4&r&&n.transform(0,1,1,0,0,0),n.drawImage(t.out_canvas,0,0),n.restore(),t.out_canvas.width=t.out_canvas.height=0,t.out_canvas=e,Promise.resolve(t)}function I(t){return t.is_jpeg?Promise.all([this._getUint8Array(t.blob),this._getUint8Array(t.out_blob)]).then(function(e){var r=e[0];if(y.is_jpeg(e[1]))return Promise.resolve(t);var n=[];return y.jpeg_segments_each(r,function(t){if(218===t.code)return!1;n.push(t)}),n=n.filter(function(t){if(226===t.code){var e=r.slice(t.offset+4,t.offset+11);if("ICC_PROFILE"===String.fromCharCode.apply(e))return!1}return t.code>=224&&t.code<240||254===t.code}).map(function(t){return r.slice(t.offset,t.offset+t.length)}),t.blob=new Blob([r.slice(0,20)].concat(n).concat([r.slice(20)]),{type:"image/jpeg"}),t}):Promise.resolve(t)}var C=function(t){t.before("_blob_to_image",v),t.after("_transform",_),t.after("_create_blob",I)};function E(t){if(!(this instanceof E))return new E(t);this.pica=(t=t||{}).pica||w({}),this.initialized=!1,this.utils=A}E.prototype.use=function(t){var e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this},E.prototype.init=function(){this.use(C)},E.prototype.toBlob=function(t,e){var r={blob:t,opts:A.assign({max:1/0},e)};return this.initialized||(this.init(),this.initialized=!0),Promise.resolve(r).then(this._blob_to_image).then(this._calculate_size).then(this._transform).then(this._cleanup).then(this._create_blob).then(function(t){return t.out_canvas.width=t.out_canvas.height=0,t.out_blob})},E.prototype.toCanvas=function(t,e){var r={blob:t,opts:A.assign({max:1/0},e)};return this.initialized||(this.init(),this.initialized=!0),Promise.resolve(r).then(this._blob_to_image).then(this._calculate_size).then(this._transform).then(this._cleanup).then(function(t){return t.out_canvas})},E.prototype.before=function(t,e){if(!this[t])throw new Error('Method "'+t+'" does not exist');if("function"!=typeof e)throw new Error('Invalid argument "fn", function expected');var r=this[t],n=this;return this[t]=function(t){return e.call(n,t).then(function(t){return r.call(n,t)})},this},E.prototype.after=function(t,e){if(!this[t])throw new Error('Method "'+t+'" does not exist');if("function"!=typeof e)throw new Error('Invalid argument "fn", function expected');var r=this[t],n=this;return this[t]=function(t){return r.call(n,t).then(function(t){return e.call(n,t)})},this},E.prototype._blob_to_image=function(t){var e=window.URL||window.webkitURL||window.mozURL||window.msURL;return t.image=document.createElement("img"),t.image_url=e.createObjectURL(t.blob),t.image.src=t.image_url,new Promise(function(e,r){t.image.onerror=function(){r(new Error("ImageBlobReduce: failed to create Image() from blob"))},t.image.onload=function(){e(t)}})},E.prototype._calculate_size=function(t){var e=t.opts.max/Math.max(t.image.width,t.image.height);return e>1&&(e=1),t.transform_width=Math.max(Math.round(t.image.width*e),1),t.transform_height=Math.max(Math.round(t.image.height*e),1),t.scale_factor=e,Promise.resolve(t)},E.prototype._transform=function(t){t.out_canvas=this.pica.options.createCanvas(t.transform_width,t.transform_height),t.transform_width=null,t.transform_height=null;var e={alpha:"image/png"===t.blob.type};return this.utils.assign(e,this.utils.pick_pica_resize_options(t.opts)),this.pica.resize(t.image,t.out_canvas,e).then(function(){return t})},E.prototype._cleanup=function(t){t.image.src="",t.image=null;var e=window.URL||window.webkitURL||window.mozURL||window.msURL;return e.revokeObjectURL&&e.revokeObjectURL(t.image_url),t.image_url=null,Promise.resolve(t)},E.prototype._create_blob=function(t){return this.pica.toBlob(t.out_canvas,t.blob.type).then(function(e){return t.out_blob=e,t})},E.prototype._getUint8Array=function(t){return t.arrayBuffer?t.arrayBuffer().then(function(t){return new Uint8Array(t)}):new Promise(function(e,r){var n=new FileReader;n.readAsArrayBuffer(t),n.onload=function(){e(new Uint8Array(n.result))},n.onerror=function(){r(new Error("ImageBlobReduce: failed to load data from input blob")),n.abort()},n.onabort=function(){r(new Error("ImageBlobReduce: failed to load data from input blob (aborted)"))}})},E.pica=w;const O=new E,x={version:0,type:"object",properties:{id:{type:"string",primary:!0},timestamp:{type:"number"},geolocationPosition:{type:"object",properties:{latitude:{type:"number"},longitude:{type:"number"}}}},indexes:["timestamp"],required:["timestamp"],attachments:{encrypted:!1}};let B=(()=>{class t{constructor(e){this.document=e,this.id=this.document.id,this.mimeType=this.getAttachment(t.PHOTO_ATTACHMENT_ID).type,this.timestamp=this.document.timestamp,this.geolocationPosition=this.document.geolocationPosition,this.photoUrl$=Object(n.a)(()=>this.getAttachment(t.PHOTO_ATTACHMENT_ID).getData()).pipe(Object(c.a)(t=>URL.createObjectURL(t)),Object(a.a)({bufferSize:1,refCount:!0})),this.thumbnailUrl$=Object(n.a)(()=>Object(f.a)(this.document.getAttachment(t.THUMBNAIL_ATTACHMENT_ID))).pipe(Object(o.a)(e=>Object(h.a)(this,void 0,void 0,function*(){if(e)return e.getData();const r=yield function({image:t,maxSize:e}){return Object(h.a)(this,void 0,void 0,function*(){return O.toBlob(t,{max:e})})}({image:yield this.getAttachment(t.PHOTO_ATTACHMENT_ID).getData(),maxSize:300});return yield this.document.putAttachment({id:t.THUMBNAIL_ATTACHMENT_ID,data:r,type:this.mimeType},!0),r})),Object(c.a)(t=>URL.createObjectURL(t)),Object(a.a)({bufferSize:1,refCount:!0}))}getAttachment(t){const e=this.document.getAttachment(t);if(e)return e;throw new p(`Cannot get the attachment with ID: ${t}`)}}return t.PHOTO_ATTACHMENT_ID="original",t.THUMBNAIL_ATTACHMENT_ID="thumbnail",t})();var j=r("fXoL"),k=r("aNgo");let P=(()=>{class t{constructor(t){this.database=t,this.collection$=this.database.main$.pipe(Object(o.a)(t=>t.addCollections({[Q]:{schema:x}})),Object(s.a)(Q),Object(a.a)({bufferSize:1,refCount:!0})),this.all$=this.collection$.pipe(Object(o.a)(t=>t.find().sort({timestamp:"desc"}).$),Object(c.a)(t=>t.map(t=>new B(t))))}add$(t){return Object(n.a)(()=>Object(i.a)([this.collection$.pipe(Object(u.a)()),l(t),d()])).pipe(Object(o.a)(([t,e,r])=>t.insert({id:e,timestamp:Date.now(),geolocationPosition:{latitude:null==r?void 0:r.coords.latitude,longitude:null==r?void 0:r.coords.longitude}})),Object(o.a)(e=>e.putAttachment({id:B.PHOTO_ATTACHMENT_ID,data:t,type:t.type},!0)),Object(c.a)(t=>t.doc))}remove$(t){return this.collection$.pipe(Object(o.a)(e=>e.bulkRemove([t])))}}return t.\u0275fac=function(e){return new(e||t)(j.Tb(k.a))},t.\u0275prov=j.Gb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Q="junctures"},kiQV:function(t){t.exports=JSON.parse('{"a":"0.0.1"}')}}]);