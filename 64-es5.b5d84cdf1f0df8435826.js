!function(){function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=o(e);if(t){var c=o(this).constructor;n=Reflect.construct(r,arguments,c)}else n=r.apply(this,arguments);return i(this,n)}}function i(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{QDOj:function(t,i,o){"use strict";o.r(i),o.d(i,"CameraPageModule",function(){return re});var a,s,f=o("6g0+"),l=o("PCNd"),b=o("tyNb"),p=o("mrSG"),d=o("VfN6"),v=o("2Vo4"),h=o("/uUt"),m=o("bOdf"),g=o("JIr8"),O=o("KJy6"),j=o("fXoL"),y=o("TEn/"),w=((a=function(){function e(t){c(this,e),this.alertController=t}return u(e,[{key:"presentError",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.error(e),t.next=3,this.alertController.create({header:e instanceof Error?e.name:"Unknown Error",message:e instanceof Error?e.message:JSON.stringify(e),buttons:[{text:"ok"}]});case 3:return n=t.sent,t.next=6,n.present();case 6:case"end":return t.stop()}},t,this)}))}}]),e}()).\u0275fac=function(e){return new(e||a)(j.Wb(y.a))},a.\u0275prov=j.Jb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),x=o("BJdS"),k=o("r0o6"),C=o("NXyV"),$=o("jtHE"),S=o("lJxs"),P=o("UXun"),_=o("vkgz"),R=o("CqXF"),E=o("SxV6"),I=o("eIep"),M=o("q7zd"),U=o("JX91"),D=o("7o/Q"),V=function(){function e(){c(this,e)}return u(e,[{key:"call",value:function(e,t){return t.subscribe(new z(e))}}]),e}(),z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(i,e);var t=r(i);function i(e){var n;return c(this,i),(n=t.call(this,e)).hasPrev=!1,n}return u(i,[{key:"_next",value:function(e){var t;this.hasPrev?t=[this.prev,e]:this.hasPrev=!0,this.prev=e,t&&this.destination.next(t)}}]),i}(D.a),L=((s=function(){function t(){c(this,t),this.videoStreamSelector=new T,this.videoDevices$=this.videoStreamSelector.devices$,this.mediaStream$=this.videoStreamSelector.stream$,this.imageCapture$=this.mediaStream$.pipe(Object(S.a)(function(e){return e.getVideoTracks()[0]}),Object(O.c)(),Object(S.a)(function(e){return new ImageCapture(e)}),Object(P.a)({bufferSize:1,refCount:!0})),this._capturedImageUrl$=new v.a(void 0),this.capturedImageUrl$=this._capturedImageUrl$.pipe(Object(O.c)(),Object(h.a)(),function(t){return t.pipe(Object(U.a)(void 0),function(e){return e.lift(new V)},Object(_.a)(function(t){var n=e(t,1)[0];n&&URL.revokeObjectURL(n)}),Object(M.a)(t))})}return u(t,[{key:"connectPreview$",value:function(e){return this.mediaStream$.pipe(Object(_.a)(function(t){return e.srcObject=t}),Object(R.a)(e))}},{key:"capture$",value:function(){var e=this;return this.imageCapture$.pipe(Object(E.a)(),Object(I.a)(function(e){return e.takePhoto()}),Object(_.a)(function(t){e._capturedImageUrl$.next(URL.createObjectURL(t))}),Object(g.a)(function(t){return Object(p.a)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof DOMException&&("InvalidStateError"===t.name||"UnknownError"===t.name||"OperationError"===t.name)){e.next=2;break}throw t;case 2:case"end":return e.stop()}},e)}))}),Object(O.c)())}},{key:"nextCamera$",value:function(e){var t=this;return this.videoDevices$.pipe(Object(E.a)(),Object(m.a)(function(n){return Object(k.a)(function(){return n.length>1},Object(C.a)(function(){return Object(p.a)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.srcObject=null);case 1:case"end":return t.stop()}},t)}))}).pipe(Object(M.a)(t.videoStreamSelector.next$())))}))}}]),t}()).\u0275fac=function(e){return new(e||s)},s.\u0275prov=j.Jb({token:s,factory:s.\u0275fac,providedIn:"root"}),s),T=function(){function e(){var t=this;c(this,e),this.devices$=Object(C.a)(function(){return navigator.mediaDevices.enumerateDevices()}).pipe(Object(S.a)(function(e){return e.filter(function(e){return"videoinput"===e.kind})}),Object(P.a)({bufferSize:1,refCount:!0})),this.currentVideoDeviceIndex=0,this._stream$=new $.a(1),this.stream$=this.devices$.pipe(Object(E.a)(),Object(m.a)(function(e){return t.getCurrentVideoMedia(e)}),Object(_.a)(function(e){return t._stream$.next(e)}),Object(M.a)(this._stream$),Object(P.a)({bufferSize:1,refCount:!0}),Object(O.c)(),Object(O.b)(function(e){return function(e){return e.getVideoTracks().forEach(function(e){return e.stop()}),e}(e)}),Object(P.a)({bufferSize:1,refCount:!0}))}return u(e,[{key:"next$",value:function(){var e=this;return this.stream$.pipe(Object(E.a)(),Object(_.a)(function(e){return e.getVideoTracks().forEach(function(e){return e.stop()})}),Object(M.a)(this.devices$),Object(_.a)(function(){return e.currentVideoDeviceIndex++}),Object(m.a)(function(t){return e.getCurrentVideoMedia(t)}),Object(_.a)(function(t){return e._stream$.next(t)}))}},{key:"getCurrentVideoMedia",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",navigator.mediaDevices.getUserMedia({video:{deviceId:e[this.currentVideoDeviceIndex%e.length].deviceId}}));case 1:case"end":return t.stop()}},t,this)}))}}]),e}(),J=o("zXXW"),N=o("ofXK"),X=o("9A8T"),A=o("/T4s"),B=o("QPBi"),Q=["video"];function K(e,t){if(1&e){var n=j.Tb();j.Sb(0,"ion-button",9),j.ac("click",function(){return j.nc(n),j.cc(2).reverseCamera()}),j.Ob(1,"ion-icon",10),j.Rb()}}var F=function(e){return["/image-viewer",e]};function q(e,t){if(1&e&&(j.Sb(0,"div",11),j.Ob(1,"app-image",12),j.Rb()),2&e){var n=t.ngrxLet;j.Cb(1),j.ic("routerLink",j.kc(2,F,n))("src",n)}}function H(e,t){if(1&e){var n=j.Tb();j.Qb(0),j.Sb(1,"ion-button",3),j.ac("click",function(){return j.nc(n),j.cc().capture()}),j.Ob(2,"ion-icon",4),j.Rb(),j.uc(3,K,2,0,"ion-button",5),j.dc(4,"ngrxPush"),j.uc(5,q,2,4,"div",6),j.Ob(6,"video",7,8),j.Pb()}if(2&e){var r,i=j.cc();j.Cb(3),j.ic("ngIf",(null==(r=j.ec(4,2,i.videoDevices$))?null:r.length)>1),j.Cb(2),j.ic("ngrxLet",i.capturedImageUrl$)}}function W(e,t){if(1&e&&(j.Sb(0,"div",15),j.Ob(1,"ion-img",16),j.Sb(2,"h3"),j.wc(3),j.Rb(),j.Sb(4,"p"),j.wc(5),j.Rb(),j.Rb()),2&e){var n=t.$implicit;j.Cb(3),j.xc(n("noCameraFound")),j.Cb(2),j.xc(n("message.noCameraFound"))}}function G(e,t){1&e&&(j.Sb(0,"div",13),j.uc(1,W,6,2,"div",14),j.Rb())}var Y,Z,ee,te=[{path:"",component:(Y=function(){function e(t,n,r){c(this,e),this.dialogsService=t,this.momentRepository=n,this.cameraService=r,this.videoDevices$=this.cameraService.videoDevices$,this._videoElement$=new v.a(void 0),this.videoElement$=this._videoElement$.pipe(Object(O.c)(),Object(h.a)()),this.capturedImageUrl$=this.cameraService.capturedImageUrl$,this.startPreview()}return u(e,[{key:"videoElement",set:function(e){e&&this._videoElement$.next(e.nativeElement)}},{key:"startPreview",value:function(){var e=this;return this.videoElement$.pipe(Object(m.a)(function(t){return e.cameraService.connectPreview$(t)}),Object(g.a)(function(t){return Object(p.a)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dialogsService.presentError(t));case 1:case"end":return e.stop()}},e,this)}))}),Object(d.b)(this)).subscribe()}},{key:"capture",value:function(){var e=this;this.cameraService.capture$().pipe(Object(O.a)(function(t){return e.momentRepository.add$(t)}),Object(g.a)(function(t){return Object(p.a)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dialogsService.presentError(t));case 1:case"end":return e.stop()}},e,this)}))}),Object(d.b)(this)).subscribe()}},{key:"reverseCamera",value:function(){var e=this;return this.videoElement$.pipe(Object(m.a)(function(t){return e.cameraService.nextCamera$(t)}),Object(d.b)(this)).subscribe()}}]),e}(),Y.\u0275fac=function(e){return new(e||Y)(j.Nb(w),j.Nb(x.a),j.Nb(L))},Y.\u0275cmp=j.Hb({type:Y,selectors:[["app-camera"]],viewQuery:function(e,t){var n;1&e&&j.Bc(Q,1),2&e&&j.lc(n=j.bc())&&(t.videoElement=n.first)},decls:5,vars:5,consts:[["color","light","fill","clear",1,"dismiss",3,"standalone"],[4,"ngIf","ngIfElse"],["noCamera",""],["fill","clear",1,"capture",3,"click"],["slot","icon-only","name","radio-button-on-outline","color","light"],["class","capture","class","reverse-camera","fill","clear",3,"click",4,"ngIf"],["class","captured ion-margin",4,"ngrxLet"],["playsinline","","autoplay",""],["video",""],["fill","clear",1,"reverse-camera",3,"click"],["slot","icon-only","name","camera-reverse-outline","color","light"],[1,"captured","ion-margin"],[3,"routerLink","src"],[1,"no-camera"],["class","no-camera-illustration",4,"transloco"],[1,"no-camera-illustration"],["src","./assets/icons/undraw-void.svg"]],template:function(e,t){if(1&e&&(j.Ob(0,"app-back-button",0),j.uc(1,H,8,4,"ng-container",1),j.dc(2,"ngrxPush"),j.uc(3,G,2,0,"ng-template",null,2,j.vc)),2&e){var n,r=j.mc(4);j.ic("standalone",!0),j.Cb(1),j.ic("ngIf",0!==(null==(n=j.ec(2,3,t.videoDevices$))?null:n.length))("ngIfElse",r)}},directives:[J.a,N.l,y.c,y.m,X.a,A.a,y.I,b.h,B.c,y.n],pipes:[X.b],styles:["[_nghost-%COMP%]{background:var(--ion-color-dark)}video[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center}.dismiss[_ngcontent-%COMP%]{position:absolute;left:0;z-index:1}ion-button.capture[_ngcontent-%COMP%]{position:absolute;bottom:0;left:50%;transform:translate(-50%);z-index:1;height:72px;width:72px;margin:0 0 var(--ion-margin,16px);--border-radius:50%;--padding-end:0;--padding-start:0;--background:rgba(0,0,0,0.4)}ion-button.capture[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px}ion-button.reverse-camera[_ngcontent-%COMP%]{position:absolute;bottom:16px;left:16px;z-index:1;height:48px;width:48px;--border-radius:50%;--padding-end:0;--padding-start:0;--background:rgba(0,0,0,0.4)}.captured[_ngcontent-%COMP%]{position:absolute;bottom:16px;right:16px;overflow:hidden;border-radius:4px;border:1px solid var(--ion-color-light-shade)}.captured[_ngcontent-%COMP%]   app-image[_ngcontent-%COMP%]{z-index:1;width:60px;height:60px}.no-camera[_ngcontent-%COMP%]{width:100%;height:100%;background:var(--ion-color-light-shade)}.no-camera-illustration[_ngcontent-%COMP%]{width:70%;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center}.no-camera-illustration[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{margin:auto;max-width:400px}.no-camera-illustration[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{white-space:pre-line}"]}),Y=Object(p.b)([Object(d.a)()],Y))}],ne=((ee=function e(){c(this,e)}).\u0275fac=function(e){return new(e||ee)},ee.\u0275mod=j.Lb({type:ee}),ee.\u0275inj=j.Kb({imports:[[b.i.forChild(te)],b.i]}),ee),re=((Z=function e(){c(this,e)}).\u0275fac=function(e){return new(e||Z)},Z.\u0275mod=j.Lb({type:Z}),Z.\u0275inj=j.Kb({imports:[[l.a,ne,f.a]]}),Z)}}])}();